var a1_0x2d32=['email','link','locale','timezone','user','flash','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','tokens','push','facebook','profile','givenName','gender','_json','picture','https://graph.facebook.com/','/picture?type=large','save','info','Facebook\x20account\x20has\x20been\x20linked.','familyName','location','isAuthenticated','redirect','/login','path','split','slice','find','/auth/','__importDefault','__esModule','defineProperty','passport','passport-facebook','lodash','default','Strategy','serializeUser','deserializeUser','findById','use','findOne','toLowerCase','Email\x20','\x20not\x20found.','comparePassword','Invalid\x20email\x20or\x20password.','env','FACEBOOK_ID','FACEBOOK_SECRET','/auth/facebook/callback','name'];(function(_0x4f4b5e,_0x9535a4){var _0x38bf92=function(_0x52d954){while(--_0x52d954){_0x4f4b5e['push'](_0x4f4b5e['shift']());}};_0x38bf92(++_0x9535a4);}(a1_0x2d32,0x8b));var a1_0x5813=function(_0x12c115,_0x248457){_0x12c115=_0x12c115-0x0;var _0x2df0a7=a1_0x2d32[_0x12c115];return _0x2df0a7;};'use strict';var __importDefault=this&&this[a1_0x5813('0x0')]||function(_0x427ffb){return _0x427ffb&&_0x427ffb[a1_0x5813('0x1')]?_0x427ffb:{'default':_0x427ffb};};Object[a1_0x5813('0x2')](exports,a1_0x5813('0x1'),{'value':!![]});const passport_1=__importDefault(require(a1_0x5813('0x3')));const passport_local_1=__importDefault(require('passport-local'));const passport_facebook_1=__importDefault(require(a1_0x5813('0x4')));const lodash_1=__importDefault(require(a1_0x5813('0x5')));const User_1=__importDefault(require('../models/User'));const LocalStrategy=passport_local_1[a1_0x5813('0x6')]['Strategy'];const FacebookStrategy=passport_facebook_1[a1_0x5813('0x6')][a1_0x5813('0x7')];passport_1[a1_0x5813('0x6')][a1_0x5813('0x8')]((_0x5a9294,_0x255f80)=>{_0x255f80(undefined,_0x5a9294['id']);});passport_1[a1_0x5813('0x6')][a1_0x5813('0x9')]((_0x5dc6b5,_0x599e01)=>{User_1[a1_0x5813('0x6')][a1_0x5813('0xa')](_0x5dc6b5,(_0x254444,_0x5a33c2)=>{_0x599e01(_0x254444,_0x5a33c2);});});passport_1[a1_0x5813('0x6')][a1_0x5813('0xb')](new LocalStrategy({'usernameField':'email'},(_0x48ab68,_0x1f4151,_0x63cd28)=>{User_1['default'][a1_0x5813('0xc')]({'email':_0x48ab68[a1_0x5813('0xd')]()},(_0xd39662,_0x2929b1)=>{if(_0xd39662){return _0x63cd28(_0xd39662);}if(!_0x2929b1){return _0x63cd28(undefined,![],{'message':a1_0x5813('0xe')+_0x48ab68+a1_0x5813('0xf')});}_0x2929b1[a1_0x5813('0x10')](_0x1f4151,(_0xd39662,_0x1a14a3)=>{if(_0xd39662){return _0x63cd28(_0xd39662);}if(_0x1a14a3){return _0x63cd28(undefined,_0x2929b1);}return _0x63cd28(undefined,![],{'message':a1_0x5813('0x11')});});});}));passport_1[a1_0x5813('0x6')]['use'](new FacebookStrategy({'clientID':process[a1_0x5813('0x12')][a1_0x5813('0x13')],'clientSecret':process[a1_0x5813('0x12')][a1_0x5813('0x14')],'callbackURL':a1_0x5813('0x15'),'profileFields':[a1_0x5813('0x16'),a1_0x5813('0x17'),a1_0x5813('0x18'),a1_0x5813('0x19'),a1_0x5813('0x1a')],'passReqToCallback':!![]},(_0x7e5b49,_0x53a9c1,_0x4559c6,_0x58b870,_0x1d82b9)=>{if(_0x7e5b49[a1_0x5813('0x1b')]){User_1[a1_0x5813('0x6')]['findOne']({'facebook':_0x58b870['id']},(_0x42b163,_0x4dddab)=>{if(_0x42b163){return _0x1d82b9(_0x42b163);}if(_0x4dddab){_0x7e5b49[a1_0x5813('0x1c')](a1_0x5813('0x1d'),{'msg':a1_0x5813('0x1e')});_0x1d82b9(_0x42b163);}else{User_1[a1_0x5813('0x6')][a1_0x5813('0xa')](_0x7e5b49['user']['id'],(_0x42b163,_0x4e4127)=>{if(_0x42b163){return _0x1d82b9(_0x42b163);}_0x4e4127['facebook']=_0x58b870['id'];_0x4e4127[a1_0x5813('0x1f')][a1_0x5813('0x20')]({'kind':a1_0x5813('0x21'),'accessToken':_0x53a9c1});_0x4e4127[a1_0x5813('0x22')][a1_0x5813('0x16')]=_0x4e4127[a1_0x5813('0x22')][a1_0x5813('0x16')]||_0x58b870[a1_0x5813('0x16')][a1_0x5813('0x23')]+'\x20'+_0x58b870[a1_0x5813('0x16')]['familyName'];_0x4e4127[a1_0x5813('0x22')][a1_0x5813('0x24')]=_0x4e4127['profile'][a1_0x5813('0x24')]||_0x58b870[a1_0x5813('0x25')][a1_0x5813('0x24')];_0x4e4127[a1_0x5813('0x22')][a1_0x5813('0x26')]=_0x4e4127[a1_0x5813('0x22')][a1_0x5813('0x26')]||a1_0x5813('0x27')+_0x58b870['id']+a1_0x5813('0x28');_0x4e4127[a1_0x5813('0x29')](_0x42b163=>{_0x7e5b49[a1_0x5813('0x1c')](a1_0x5813('0x2a'),{'msg':a1_0x5813('0x2b')});_0x1d82b9(_0x42b163,_0x4e4127);});});}});}else{User_1[a1_0x5813('0x6')][a1_0x5813('0xc')]({'facebook':_0x58b870['id']},(_0x5c6b18,_0x3697d7)=>{if(_0x5c6b18){return _0x1d82b9(_0x5c6b18);}if(_0x3697d7){return _0x1d82b9(undefined,_0x3697d7);}User_1['default']['findOne']({'email':_0x58b870[a1_0x5813('0x25')][a1_0x5813('0x17')]},(_0x5c6b18,_0x2bed39)=>{if(_0x5c6b18){return _0x1d82b9(_0x5c6b18);}if(_0x2bed39){_0x7e5b49[a1_0x5813('0x1c')](a1_0x5813('0x1d'),{'msg':'There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.'});_0x1d82b9(_0x5c6b18);}else{const _0x4d34aa=new User_1[(a1_0x5813('0x6'))]();_0x4d34aa['email']=_0x58b870[a1_0x5813('0x25')]['email'];_0x4d34aa[a1_0x5813('0x21')]=_0x58b870['id'];_0x4d34aa[a1_0x5813('0x1f')]['push']({'kind':a1_0x5813('0x21'),'accessToken':_0x53a9c1});_0x4d34aa[a1_0x5813('0x22')][a1_0x5813('0x16')]=_0x58b870[a1_0x5813('0x16')][a1_0x5813('0x23')]+'\x20'+_0x58b870[a1_0x5813('0x16')][a1_0x5813('0x2c')];_0x4d34aa[a1_0x5813('0x22')][a1_0x5813('0x24')]=_0x58b870[a1_0x5813('0x25')][a1_0x5813('0x24')];_0x4d34aa[a1_0x5813('0x22')][a1_0x5813('0x26')]=a1_0x5813('0x27')+_0x58b870['id']+a1_0x5813('0x28');_0x4d34aa['profile'][a1_0x5813('0x2d')]=_0x58b870[a1_0x5813('0x25')][a1_0x5813('0x2d')]?_0x58b870[a1_0x5813('0x25')][a1_0x5813('0x2d')][a1_0x5813('0x16')]:'';_0x4d34aa[a1_0x5813('0x29')](_0x5c6b18=>{_0x1d82b9(_0x5c6b18,_0x4d34aa);});}});});}}));exports['isAuthenticated']=(_0x546a5f,_0x207da6,_0x1cf9a1)=>{if(_0x546a5f[a1_0x5813('0x2e')]()){return _0x1cf9a1();}_0x207da6[a1_0x5813('0x2f')](a1_0x5813('0x30'));};exports['isAuthorized']=(_0x224a7e,_0x79bf75,_0x5292c4)=>{const _0x4fe762=_0x224a7e[a1_0x5813('0x31')][a1_0x5813('0x32')]('/')[a1_0x5813('0x33')](-0x1)[0x0];if(lodash_1[a1_0x5813('0x6')][a1_0x5813('0x34')](_0x224a7e[a1_0x5813('0x1b')][a1_0x5813('0x1f')],{'kind':_0x4fe762})){_0x5292c4();}else{_0x79bf75['redirect'](a1_0x5813('0x35')+_0x4fe762);}};
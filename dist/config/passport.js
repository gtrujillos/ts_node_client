var a1_0x16d1=['Facebook\x20account\x20has\x20been\x20linked.','errors','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','/picture?type=large','location','isAuthenticated','redirect','/login','isAuthorized','path','split','slice','find','/auth/','__importDefault','defineProperty','passport-local','passport-facebook','../models/User','default','Strategy','deserializeUser','use','email','findOne','\x20not\x20found.','comparePassword','env','FACEBOOK_ID','timezone','flash','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','findById','user','tokens','push','facebook','profile','name','givenName','familyName','gender','_json','picture','https://graph.facebook.com/','save','info'];(function(_0x4c913a,_0x284a5e){var _0x105697=function(_0xd86424){while(--_0xd86424){_0x4c913a['push'](_0x4c913a['shift']());}};_0x105697(++_0x284a5e);}(a1_0x16d1,0xca));var a1_0x1150=function(_0x46caf1,_0x378dbc){_0x46caf1=_0x46caf1-0x0;var _0xbeb153=a1_0x16d1[_0x46caf1];return _0xbeb153;};'use strict';var __importDefault=this&&this[a1_0x1150('0x0')]||function(_0x1495a7){return _0x1495a7&&_0x1495a7['__esModule']?_0x1495a7:{'default':_0x1495a7};};Object[a1_0x1150('0x1')](exports,'__esModule',{'value':!![]});const passport_1=__importDefault(require('passport'));const passport_local_1=__importDefault(require(a1_0x1150('0x2')));const passport_facebook_1=__importDefault(require(a1_0x1150('0x3')));const lodash_1=__importDefault(require('lodash'));const User_1=__importDefault(require(a1_0x1150('0x4')));const LocalStrategy=passport_local_1[a1_0x1150('0x5')][a1_0x1150('0x6')];const FacebookStrategy=passport_facebook_1[a1_0x1150('0x5')][a1_0x1150('0x6')];passport_1['default']['serializeUser']((_0x5b262c,_0x20520c)=>{_0x20520c(undefined,_0x5b262c['id']);});passport_1['default'][a1_0x1150('0x7')]((_0x876070,_0x3c1e3a)=>{User_1[a1_0x1150('0x5')]['findById'](_0x876070,(_0x3cf6d6,_0x20afd6)=>{_0x3c1e3a(_0x3cf6d6,_0x20afd6);});});passport_1[a1_0x1150('0x5')][a1_0x1150('0x8')](new LocalStrategy({'usernameField':a1_0x1150('0x9')},(_0x4f31ca,_0x5bdfc5,_0x12dfe7)=>{User_1[a1_0x1150('0x5')][a1_0x1150('0xa')]({'email':_0x4f31ca['toLowerCase']()},(_0x2bffd9,_0xebd5b0)=>{if(_0x2bffd9){return _0x12dfe7(_0x2bffd9);}if(!_0xebd5b0){return _0x12dfe7(undefined,![],{'message':'Email\x20'+_0x4f31ca+a1_0x1150('0xb')});}_0xebd5b0[a1_0x1150('0xc')](_0x5bdfc5,(_0x2bffd9,_0x4aa993)=>{if(_0x2bffd9){return _0x12dfe7(_0x2bffd9);}if(_0x4aa993){return _0x12dfe7(undefined,_0xebd5b0);}return _0x12dfe7(undefined,![],{'message':'Invalid\x20email\x20or\x20password.'});});});}));passport_1[a1_0x1150('0x5')][a1_0x1150('0x8')](new FacebookStrategy({'clientID':process[a1_0x1150('0xd')][a1_0x1150('0xe')],'clientSecret':process[a1_0x1150('0xd')]['FACEBOOK_SECRET'],'callbackURL':'/auth/facebook/callback','profileFields':['name','email','link','locale',a1_0x1150('0xf')],'passReqToCallback':!![]},(_0x312c43,_0x3f6eb1,_0x2d78d8,_0x5616bc,_0x77ec71)=>{if(_0x312c43['user']){User_1[a1_0x1150('0x5')]['findOne']({'facebook':_0x5616bc['id']},(_0x3c47bc,_0x3f49d7)=>{if(_0x3c47bc){return _0x77ec71(_0x3c47bc);}if(_0x3f49d7){_0x312c43[a1_0x1150('0x10')]('errors',{'msg':a1_0x1150('0x11')});_0x77ec71(_0x3c47bc);}else{User_1[a1_0x1150('0x5')][a1_0x1150('0x12')](_0x312c43[a1_0x1150('0x13')]['id'],(_0x3c47bc,_0x5e0e62)=>{if(_0x3c47bc){return _0x77ec71(_0x3c47bc);}_0x5e0e62['facebook']=_0x5616bc['id'];_0x5e0e62[a1_0x1150('0x14')][a1_0x1150('0x15')]({'kind':a1_0x1150('0x16'),'accessToken':_0x3f6eb1});_0x5e0e62[a1_0x1150('0x17')][a1_0x1150('0x18')]=_0x5e0e62[a1_0x1150('0x17')][a1_0x1150('0x18')]||_0x5616bc[a1_0x1150('0x18')][a1_0x1150('0x19')]+'\x20'+_0x5616bc['name'][a1_0x1150('0x1a')];_0x5e0e62[a1_0x1150('0x17')]['gender']=_0x5e0e62[a1_0x1150('0x17')][a1_0x1150('0x1b')]||_0x5616bc[a1_0x1150('0x1c')][a1_0x1150('0x1b')];_0x5e0e62[a1_0x1150('0x17')][a1_0x1150('0x1d')]=_0x5e0e62[a1_0x1150('0x17')][a1_0x1150('0x1d')]||a1_0x1150('0x1e')+_0x5616bc['id']+'/picture?type=large';_0x5e0e62[a1_0x1150('0x1f')](_0x3c47bc=>{_0x312c43['flash'](a1_0x1150('0x20'),{'msg':a1_0x1150('0x21')});_0x77ec71(_0x3c47bc,_0x5e0e62);});});}});}else{User_1[a1_0x1150('0x5')][a1_0x1150('0xa')]({'facebook':_0x5616bc['id']},(_0x231645,_0x2028bf)=>{if(_0x231645){return _0x77ec71(_0x231645);}if(_0x2028bf){return _0x77ec71(undefined,_0x2028bf);}User_1[a1_0x1150('0x5')][a1_0x1150('0xa')]({'email':_0x5616bc[a1_0x1150('0x1c')]['email']},(_0x231645,_0xd0eedc)=>{if(_0x231645){return _0x77ec71(_0x231645);}if(_0xd0eedc){_0x312c43['flash'](a1_0x1150('0x22'),{'msg':a1_0x1150('0x23')});_0x77ec71(_0x231645);}else{const _0x561c65=new User_1[(a1_0x1150('0x5'))]();_0x561c65['email']=_0x5616bc['_json'][a1_0x1150('0x9')];_0x561c65['facebook']=_0x5616bc['id'];_0x561c65[a1_0x1150('0x14')]['push']({'kind':'facebook','accessToken':_0x3f6eb1});_0x561c65['profile'][a1_0x1150('0x18')]=_0x5616bc[a1_0x1150('0x18')][a1_0x1150('0x19')]+'\x20'+_0x5616bc[a1_0x1150('0x18')][a1_0x1150('0x1a')];_0x561c65[a1_0x1150('0x17')][a1_0x1150('0x1b')]=_0x5616bc['_json'][a1_0x1150('0x1b')];_0x561c65['profile'][a1_0x1150('0x1d')]=a1_0x1150('0x1e')+_0x5616bc['id']+a1_0x1150('0x24');_0x561c65[a1_0x1150('0x17')][a1_0x1150('0x25')]=_0x5616bc['_json']['location']?_0x5616bc['_json'][a1_0x1150('0x25')][a1_0x1150('0x18')]:'';_0x561c65[a1_0x1150('0x1f')](_0x231645=>{_0x77ec71(_0x231645,_0x561c65);});}});});}}));exports[a1_0x1150('0x26')]=(_0xedc3b6,_0x94ce58,_0x2325c3)=>{if(_0xedc3b6['isAuthenticated']()){return _0x2325c3();}_0x94ce58[a1_0x1150('0x27')](a1_0x1150('0x28'));};exports[a1_0x1150('0x29')]=(_0x25bf12,_0x1e6cfd,_0x2c2237)=>{const _0x5a1a59=_0x25bf12[a1_0x1150('0x2a')][a1_0x1150('0x2b')]('/')[a1_0x1150('0x2c')](-0x1)[0x0];if(lodash_1[a1_0x1150('0x5')][a1_0x1150('0x2d')](_0x25bf12[a1_0x1150('0x13')][a1_0x1150('0x14')],{'kind':_0x5a1a59})){_0x2c2237();}else{_0x1e6cfd[a1_0x1150('0x27')](a1_0x1150('0x2e')+_0x5a1a59);}};
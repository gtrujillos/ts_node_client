var a1_0x5016=['lodash','../models/User','Strategy','default','deserializeUser','findById','use','email','findOne','toLowerCase','\x20not\x20found.','comparePassword','env','FACEBOOK_ID','FACEBOOK_SECRET','/auth/facebook/callback','name','link','locale','user','flash','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','facebook','tokens','push','profile','givenName','familyName','gender','_json','picture','/picture?type=large','info','Facebook\x20account\x20has\x20been\x20linked.','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','https://graph.facebook.com/','location','isAuthenticated','redirect','/login','isAuthorized','path','slice','/auth/','__importDefault','__esModule','defineProperty','passport','passport-facebook'];(function(_0x4bf7db,_0x2c03b0){var _0x4070ed=function(_0x5af48f){while(--_0x5af48f){_0x4bf7db['push'](_0x4bf7db['shift']());}};_0x4070ed(++_0x2c03b0);}(a1_0x5016,0x18b));var a1_0x4f48=function(_0x1196c6,_0x44e6fa){_0x1196c6=_0x1196c6-0x0;var _0x18d0d0=a1_0x5016[_0x1196c6];return _0x18d0d0;};'use strict';var __importDefault=this&&this[a1_0x4f48('0x0')]||function(_0x5d1ee3){return _0x5d1ee3&&_0x5d1ee3[a1_0x4f48('0x1')]?_0x5d1ee3:{'default':_0x5d1ee3};};Object[a1_0x4f48('0x2')](exports,'__esModule',{'value':!![]});const passport_1=__importDefault(require(a1_0x4f48('0x3')));const passport_local_1=__importDefault(require('passport-local'));const passport_facebook_1=__importDefault(require(a1_0x4f48('0x4')));const lodash_1=__importDefault(require(a1_0x4f48('0x5')));const User_1=__importDefault(require(a1_0x4f48('0x6')));const LocalStrategy=passport_local_1['default'][a1_0x4f48('0x7')];const FacebookStrategy=passport_facebook_1[a1_0x4f48('0x8')]['Strategy'];passport_1[a1_0x4f48('0x8')]['serializeUser']((_0x3fea7e,_0x35e94c)=>{_0x35e94c(undefined,_0x3fea7e['id']);});passport_1[a1_0x4f48('0x8')][a1_0x4f48('0x9')]((_0x2fee47,_0x577dac)=>{User_1[a1_0x4f48('0x8')][a1_0x4f48('0xa')](_0x2fee47,(_0x39ca54,_0x5b6eb1)=>{_0x577dac(_0x39ca54,_0x5b6eb1);});});passport_1['default'][a1_0x4f48('0xb')](new LocalStrategy({'usernameField':a1_0x4f48('0xc')},(_0x38e935,_0x3262c9,_0x7dea4c)=>{User_1[a1_0x4f48('0x8')][a1_0x4f48('0xd')]({'email':_0x38e935[a1_0x4f48('0xe')]()},(_0x3adbab,_0x2e0ea2)=>{if(_0x3adbab){return _0x7dea4c(_0x3adbab);}if(!_0x2e0ea2){return _0x7dea4c(undefined,![],{'message':'Email\x20'+_0x38e935+a1_0x4f48('0xf')});}_0x2e0ea2[a1_0x4f48('0x10')](_0x3262c9,(_0x3adbab,_0x4dd604)=>{if(_0x3adbab){return _0x7dea4c(_0x3adbab);}if(_0x4dd604){return _0x7dea4c(undefined,_0x2e0ea2);}return _0x7dea4c(undefined,![],{'message':'Invalid\x20email\x20or\x20password.'});});});}));passport_1[a1_0x4f48('0x8')]['use'](new FacebookStrategy({'clientID':process[a1_0x4f48('0x11')][a1_0x4f48('0x12')],'clientSecret':process[a1_0x4f48('0x11')][a1_0x4f48('0x13')],'callbackURL':a1_0x4f48('0x14'),'profileFields':[a1_0x4f48('0x15'),a1_0x4f48('0xc'),a1_0x4f48('0x16'),a1_0x4f48('0x17'),'timezone'],'passReqToCallback':!![]},(_0x37f477,_0x4e373d,_0x2762b6,_0x3a3a4,_0x802d13)=>{if(_0x37f477[a1_0x4f48('0x18')]){User_1[a1_0x4f48('0x8')][a1_0x4f48('0xd')]({'facebook':_0x3a3a4['id']},(_0x14cb78,_0x2d4033)=>{if(_0x14cb78){return _0x802d13(_0x14cb78);}if(_0x2d4033){_0x37f477[a1_0x4f48('0x19')](a1_0x4f48('0x1a'),{'msg':a1_0x4f48('0x1b')});_0x802d13(_0x14cb78);}else{User_1[a1_0x4f48('0x8')][a1_0x4f48('0xa')](_0x37f477[a1_0x4f48('0x18')]['id'],(_0x14cb78,_0x28da26)=>{if(_0x14cb78){return _0x802d13(_0x14cb78);}_0x28da26[a1_0x4f48('0x1c')]=_0x3a3a4['id'];_0x28da26[a1_0x4f48('0x1d')][a1_0x4f48('0x1e')]({'kind':a1_0x4f48('0x1c'),'accessToken':_0x4e373d});_0x28da26[a1_0x4f48('0x1f')][a1_0x4f48('0x15')]=_0x28da26[a1_0x4f48('0x1f')]['name']||_0x3a3a4[a1_0x4f48('0x15')][a1_0x4f48('0x20')]+'\x20'+_0x3a3a4['name'][a1_0x4f48('0x21')];_0x28da26[a1_0x4f48('0x1f')][a1_0x4f48('0x22')]=_0x28da26[a1_0x4f48('0x1f')]['gender']||_0x3a3a4[a1_0x4f48('0x23')][a1_0x4f48('0x22')];_0x28da26[a1_0x4f48('0x1f')][a1_0x4f48('0x24')]=_0x28da26[a1_0x4f48('0x1f')][a1_0x4f48('0x24')]||'https://graph.facebook.com/'+_0x3a3a4['id']+a1_0x4f48('0x25');_0x28da26['save'](_0x14cb78=>{_0x37f477[a1_0x4f48('0x19')](a1_0x4f48('0x26'),{'msg':a1_0x4f48('0x27')});_0x802d13(_0x14cb78,_0x28da26);});});}});}else{User_1['default'][a1_0x4f48('0xd')]({'facebook':_0x3a3a4['id']},(_0x1c89ba,_0x308e5b)=>{if(_0x1c89ba){return _0x802d13(_0x1c89ba);}if(_0x308e5b){return _0x802d13(undefined,_0x308e5b);}User_1[a1_0x4f48('0x8')][a1_0x4f48('0xd')]({'email':_0x3a3a4[a1_0x4f48('0x23')][a1_0x4f48('0xc')]},(_0x1c89ba,_0x263cad)=>{if(_0x1c89ba){return _0x802d13(_0x1c89ba);}if(_0x263cad){_0x37f477['flash'](a1_0x4f48('0x1a'),{'msg':a1_0x4f48('0x28')});_0x802d13(_0x1c89ba);}else{const _0x5dd3a8=new User_1[(a1_0x4f48('0x8'))]();_0x5dd3a8['email']=_0x3a3a4[a1_0x4f48('0x23')][a1_0x4f48('0xc')];_0x5dd3a8[a1_0x4f48('0x1c')]=_0x3a3a4['id'];_0x5dd3a8[a1_0x4f48('0x1d')][a1_0x4f48('0x1e')]({'kind':'facebook','accessToken':_0x4e373d});_0x5dd3a8[a1_0x4f48('0x1f')]['name']=_0x3a3a4[a1_0x4f48('0x15')][a1_0x4f48('0x20')]+'\x20'+_0x3a3a4[a1_0x4f48('0x15')]['familyName'];_0x5dd3a8[a1_0x4f48('0x1f')][a1_0x4f48('0x22')]=_0x3a3a4[a1_0x4f48('0x23')]['gender'];_0x5dd3a8[a1_0x4f48('0x1f')][a1_0x4f48('0x24')]=a1_0x4f48('0x29')+_0x3a3a4['id']+'/picture?type=large';_0x5dd3a8[a1_0x4f48('0x1f')]['location']=_0x3a3a4[a1_0x4f48('0x23')][a1_0x4f48('0x2a')]?_0x3a3a4[a1_0x4f48('0x23')][a1_0x4f48('0x2a')][a1_0x4f48('0x15')]:'';_0x5dd3a8['save'](_0x1c89ba=>{_0x802d13(_0x1c89ba,_0x5dd3a8);});}});});}}));exports['isAuthenticated']=(_0x13acab,_0x4401b7,_0x3d69a4)=>{if(_0x13acab[a1_0x4f48('0x2b')]()){return _0x3d69a4();}_0x4401b7[a1_0x4f48('0x2c')](a1_0x4f48('0x2d'));};exports[a1_0x4f48('0x2e')]=(_0x2670f2,_0x5d618c,_0x3d3bd0)=>{const _0x524fb3=_0x2670f2[a1_0x4f48('0x2f')]['split']('/')[a1_0x4f48('0x30')](-0x1)[0x0];if(lodash_1['default']['find'](_0x2670f2[a1_0x4f48('0x18')]['tokens'],{'kind':_0x524fb3})){_0x3d3bd0();}else{_0x5d618c[a1_0x4f48('0x2c')](a1_0x4f48('0x31')+_0x524fb3);}};
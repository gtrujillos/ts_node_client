var a1_0x1822=['facebook','tokens','push','profile','givenName','familyName','gender','/picture?type=large','save','info','Facebook\x20account\x20has\x20been\x20linked.','_json','errors','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','picture','https://graph.facebook.com/','location','isAuthenticated','redirect','/login','isAuthorized','path','split','/auth/','__importDefault','__esModule','defineProperty','passport','passport-facebook','default','Strategy','serializeUser','deserializeUser','findById','email','toLowerCase','\x20not\x20found.','use','env','FACEBOOK_ID','/auth/facebook/callback','name','link','locale','timezone','user','findOne','flash','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.'];(function(_0x53d361,_0x8a1931){var _0xa199ce=function(_0x464920){while(--_0x464920){_0x53d361['push'](_0x53d361['shift']());}};_0xa199ce(++_0x8a1931);}(a1_0x1822,0x1d1));var a1_0xd374=function(_0x31a824,_0x362937){_0x31a824=_0x31a824-0x0;var _0x44ad38=a1_0x1822[_0x31a824];return _0x44ad38;};'use strict';var __importDefault=this&&this[a1_0xd374('0x0')]||function(_0x4db106){return _0x4db106&&_0x4db106[a1_0xd374('0x1')]?_0x4db106:{'default':_0x4db106};};Object[a1_0xd374('0x2')](exports,a1_0xd374('0x1'),{'value':!![]});const passport_1=__importDefault(require(a1_0xd374('0x3')));const passport_local_1=__importDefault(require('passport-local'));const passport_facebook_1=__importDefault(require(a1_0xd374('0x4')));const lodash_1=__importDefault(require('lodash'));const User_1=__importDefault(require('../models/User'));const LocalStrategy=passport_local_1[a1_0xd374('0x5')][a1_0xd374('0x6')];const FacebookStrategy=passport_facebook_1[a1_0xd374('0x5')][a1_0xd374('0x6')];passport_1[a1_0xd374('0x5')][a1_0xd374('0x7')]((_0x111e62,_0x1b9be5)=>{_0x1b9be5(undefined,_0x111e62['id']);});passport_1['default'][a1_0xd374('0x8')]((_0x1664d2,_0x54bb3b)=>{User_1[a1_0xd374('0x5')][a1_0xd374('0x9')](_0x1664d2,(_0x36c668,_0xa4c2e1)=>{_0x54bb3b(_0x36c668,_0xa4c2e1);});});passport_1[a1_0xd374('0x5')]['use'](new LocalStrategy({'usernameField':a1_0xd374('0xa')},(_0x5162ba,_0x5a1297,_0x1242fd)=>{User_1[a1_0xd374('0x5')]['findOne']({'email':_0x5162ba[a1_0xd374('0xb')]()},(_0x241bf3,_0x1f6b71)=>{if(_0x241bf3){return _0x1242fd(_0x241bf3);}if(!_0x1f6b71){return _0x1242fd(undefined,![],{'message':'Email\x20'+_0x5162ba+a1_0xd374('0xc')});}_0x1f6b71['comparePassword'](_0x5a1297,(_0x241bf3,_0x45063b)=>{if(_0x241bf3){return _0x1242fd(_0x241bf3);}if(_0x45063b){return _0x1242fd(undefined,_0x1f6b71);}return _0x1242fd(undefined,![],{'message':'Invalid\x20email\x20or\x20password.'});});});}));passport_1['default'][a1_0xd374('0xd')](new FacebookStrategy({'clientID':process[a1_0xd374('0xe')][a1_0xd374('0xf')],'clientSecret':process[a1_0xd374('0xe')]['FACEBOOK_SECRET'],'callbackURL':a1_0xd374('0x10'),'profileFields':[a1_0xd374('0x11'),a1_0xd374('0xa'),a1_0xd374('0x12'),a1_0xd374('0x13'),a1_0xd374('0x14')],'passReqToCallback':!![]},(_0x3f8725,_0x6b56c4,_0x47d17b,_0x8ccbe,_0x5ee7b5)=>{if(_0x3f8725[a1_0xd374('0x15')]){User_1[a1_0xd374('0x5')][a1_0xd374('0x16')]({'facebook':_0x8ccbe['id']},(_0x4fc4d9,_0x5d4346)=>{if(_0x4fc4d9){return _0x5ee7b5(_0x4fc4d9);}if(_0x5d4346){_0x3f8725[a1_0xd374('0x17')]('errors',{'msg':a1_0xd374('0x18')});_0x5ee7b5(_0x4fc4d9);}else{User_1['default'][a1_0xd374('0x9')](_0x3f8725[a1_0xd374('0x15')]['id'],(_0x4fc4d9,_0x162e6e)=>{if(_0x4fc4d9){return _0x5ee7b5(_0x4fc4d9);}_0x162e6e[a1_0xd374('0x19')]=_0x8ccbe['id'];_0x162e6e[a1_0xd374('0x1a')][a1_0xd374('0x1b')]({'kind':a1_0xd374('0x19'),'accessToken':_0x6b56c4});_0x162e6e[a1_0xd374('0x1c')][a1_0xd374('0x11')]=_0x162e6e[a1_0xd374('0x1c')][a1_0xd374('0x11')]||_0x8ccbe['name'][a1_0xd374('0x1d')]+'\x20'+_0x8ccbe[a1_0xd374('0x11')][a1_0xd374('0x1e')];_0x162e6e[a1_0xd374('0x1c')][a1_0xd374('0x1f')]=_0x162e6e[a1_0xd374('0x1c')][a1_0xd374('0x1f')]||_0x8ccbe['_json'][a1_0xd374('0x1f')];_0x162e6e[a1_0xd374('0x1c')]['picture']=_0x162e6e[a1_0xd374('0x1c')]['picture']||'https://graph.facebook.com/'+_0x8ccbe['id']+a1_0xd374('0x20');_0x162e6e[a1_0xd374('0x21')](_0x4fc4d9=>{_0x3f8725['flash'](a1_0xd374('0x22'),{'msg':a1_0xd374('0x23')});_0x5ee7b5(_0x4fc4d9,_0x162e6e);});});}});}else{User_1[a1_0xd374('0x5')][a1_0xd374('0x16')]({'facebook':_0x8ccbe['id']},(_0x524bf4,_0x51fd58)=>{if(_0x524bf4){return _0x5ee7b5(_0x524bf4);}if(_0x51fd58){return _0x5ee7b5(undefined,_0x51fd58);}User_1['default'][a1_0xd374('0x16')]({'email':_0x8ccbe[a1_0xd374('0x24')][a1_0xd374('0xa')]},(_0x524bf4,_0x5a9c65)=>{if(_0x524bf4){return _0x5ee7b5(_0x524bf4);}if(_0x5a9c65){_0x3f8725[a1_0xd374('0x17')](a1_0xd374('0x25'),{'msg':a1_0xd374('0x26')});_0x5ee7b5(_0x524bf4);}else{const _0x2f8e88=new User_1[(a1_0xd374('0x5'))]();_0x2f8e88[a1_0xd374('0xa')]=_0x8ccbe[a1_0xd374('0x24')][a1_0xd374('0xa')];_0x2f8e88[a1_0xd374('0x19')]=_0x8ccbe['id'];_0x2f8e88['tokens'][a1_0xd374('0x1b')]({'kind':a1_0xd374('0x19'),'accessToken':_0x6b56c4});_0x2f8e88[a1_0xd374('0x1c')][a1_0xd374('0x11')]=_0x8ccbe[a1_0xd374('0x11')][a1_0xd374('0x1d')]+'\x20'+_0x8ccbe[a1_0xd374('0x11')][a1_0xd374('0x1e')];_0x2f8e88['profile'][a1_0xd374('0x1f')]=_0x8ccbe[a1_0xd374('0x24')]['gender'];_0x2f8e88[a1_0xd374('0x1c')][a1_0xd374('0x27')]=a1_0xd374('0x28')+_0x8ccbe['id']+a1_0xd374('0x20');_0x2f8e88['profile'][a1_0xd374('0x29')]=_0x8ccbe[a1_0xd374('0x24')][a1_0xd374('0x29')]?_0x8ccbe[a1_0xd374('0x24')][a1_0xd374('0x29')][a1_0xd374('0x11')]:'';_0x2f8e88[a1_0xd374('0x21')](_0x524bf4=>{_0x5ee7b5(_0x524bf4,_0x2f8e88);});}});});}}));exports[a1_0xd374('0x2a')]=(_0x586e78,_0xa35de6,_0x259fa7)=>{if(_0x586e78[a1_0xd374('0x2a')]()){return _0x259fa7();}_0xa35de6[a1_0xd374('0x2b')](a1_0xd374('0x2c'));};exports[a1_0xd374('0x2d')]=(_0x5f96d9,_0x21dc52,_0x40b8fc)=>{const _0x2f73b3=_0x5f96d9[a1_0xd374('0x2e')][a1_0xd374('0x2f')]('/')['slice'](-0x1)[0x0];if(lodash_1['default']['find'](_0x5f96d9['user'][a1_0xd374('0x1a')],{'kind':_0x2f73b3})){_0x40b8fc();}else{_0x21dc52[a1_0xd374('0x2b')](a1_0xd374('0x30')+_0x2f73b3);}};
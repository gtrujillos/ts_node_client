var a1_0x2e23=['location','_json','save','isAuthenticated','redirect','/login','isAuthorized','path','split','slice','find','/auth/','__importDefault','__esModule','defineProperty','passport','passport-local','passport-facebook','lodash','default','Strategy','serializeUser','deserializeUser','findById','email','toLowerCase','Email\x20','\x20not\x20found.','comparePassword','Invalid\x20email\x20or\x20password.','use','FACEBOOK_ID','env','/auth/facebook/callback','name','link','locale','timezone','user','findOne','flash','errors','facebook','tokens','push','profile','gender','picture','https://graph.facebook.com/','info','Facebook\x20account\x20has\x20been\x20linked.','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','familyName','/picture?type=large'];(function(_0x34fa94,_0x1d67de){var _0x1d4c00=function(_0x148185){while(--_0x148185){_0x34fa94['push'](_0x34fa94['shift']());}};_0x1d4c00(++_0x1d67de);}(a1_0x2e23,0x1f2));var a1_0x5778=function(_0x2a07de,_0x1b3f02){_0x2a07de=_0x2a07de-0x0;var _0x200450=a1_0x2e23[_0x2a07de];return _0x200450;};'use strict';var __importDefault=this&&this[a1_0x5778('0x0')]||function(_0x19e0b6){return _0x19e0b6&&_0x19e0b6[a1_0x5778('0x1')]?_0x19e0b6:{'default':_0x19e0b6};};Object[a1_0x5778('0x2')](exports,a1_0x5778('0x1'),{'value':!![]});const passport_1=__importDefault(require(a1_0x5778('0x3')));const passport_local_1=__importDefault(require(a1_0x5778('0x4')));const passport_facebook_1=__importDefault(require(a1_0x5778('0x5')));const lodash_1=__importDefault(require(a1_0x5778('0x6')));const User_1=__importDefault(require('../models/User'));const LocalStrategy=passport_local_1[a1_0x5778('0x7')][a1_0x5778('0x8')];const FacebookStrategy=passport_facebook_1[a1_0x5778('0x7')]['Strategy'];passport_1[a1_0x5778('0x7')][a1_0x5778('0x9')]((_0x577158,_0x55da78)=>{_0x55da78(undefined,_0x577158['id']);});passport_1['default'][a1_0x5778('0xa')]((_0x2881fd,_0x5df318)=>{User_1[a1_0x5778('0x7')][a1_0x5778('0xb')](_0x2881fd,(_0xb020d3,_0x11018a)=>{_0x5df318(_0xb020d3,_0x11018a);});});passport_1[a1_0x5778('0x7')]['use'](new LocalStrategy({'usernameField':a1_0x5778('0xc')},(_0x2e554a,_0x25364b,_0xab4dde)=>{User_1['default']['findOne']({'email':_0x2e554a[a1_0x5778('0xd')]()},(_0x27b619,_0x3134f3)=>{if(_0x27b619){return _0xab4dde(_0x27b619);}if(!_0x3134f3){return _0xab4dde(undefined,![],{'message':a1_0x5778('0xe')+_0x2e554a+a1_0x5778('0xf')});}_0x3134f3[a1_0x5778('0x10')](_0x25364b,(_0x27b619,_0x22b8ba)=>{if(_0x27b619){return _0xab4dde(_0x27b619);}if(_0x22b8ba){return _0xab4dde(undefined,_0x3134f3);}return _0xab4dde(undefined,![],{'message':a1_0x5778('0x11')});});});}));passport_1[a1_0x5778('0x7')][a1_0x5778('0x12')](new FacebookStrategy({'clientID':process['env'][a1_0x5778('0x13')],'clientSecret':process[a1_0x5778('0x14')]['FACEBOOK_SECRET'],'callbackURL':a1_0x5778('0x15'),'profileFields':[a1_0x5778('0x16'),a1_0x5778('0xc'),a1_0x5778('0x17'),a1_0x5778('0x18'),a1_0x5778('0x19')],'passReqToCallback':!![]},(_0x16c8b7,_0x5b6150,_0x48ed65,_0xa8d8ee,_0x380c18)=>{if(_0x16c8b7[a1_0x5778('0x1a')]){User_1[a1_0x5778('0x7')][a1_0x5778('0x1b')]({'facebook':_0xa8d8ee['id']},(_0x26b7d2,_0x1b8e76)=>{if(_0x26b7d2){return _0x380c18(_0x26b7d2);}if(_0x1b8e76){_0x16c8b7[a1_0x5778('0x1c')](a1_0x5778('0x1d'),{'msg':'There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.'});_0x380c18(_0x26b7d2);}else{User_1['default'][a1_0x5778('0xb')](_0x16c8b7[a1_0x5778('0x1a')]['id'],(_0x26b7d2,_0x6ef1fd)=>{if(_0x26b7d2){return _0x380c18(_0x26b7d2);}_0x6ef1fd[a1_0x5778('0x1e')]=_0xa8d8ee['id'];_0x6ef1fd[a1_0x5778('0x1f')][a1_0x5778('0x20')]({'kind':a1_0x5778('0x1e'),'accessToken':_0x5b6150});_0x6ef1fd['profile'][a1_0x5778('0x16')]=_0x6ef1fd[a1_0x5778('0x21')][a1_0x5778('0x16')]||_0xa8d8ee[a1_0x5778('0x16')]['givenName']+'\x20'+_0xa8d8ee[a1_0x5778('0x16')]['familyName'];_0x6ef1fd[a1_0x5778('0x21')][a1_0x5778('0x22')]=_0x6ef1fd[a1_0x5778('0x21')]['gender']||_0xa8d8ee['_json'][a1_0x5778('0x22')];_0x6ef1fd[a1_0x5778('0x21')][a1_0x5778('0x23')]=_0x6ef1fd[a1_0x5778('0x21')][a1_0x5778('0x23')]||a1_0x5778('0x24')+_0xa8d8ee['id']+'/picture?type=large';_0x6ef1fd['save'](_0x26b7d2=>{_0x16c8b7['flash'](a1_0x5778('0x25'),{'msg':a1_0x5778('0x26')});_0x380c18(_0x26b7d2,_0x6ef1fd);});});}});}else{User_1[a1_0x5778('0x7')][a1_0x5778('0x1b')]({'facebook':_0xa8d8ee['id']},(_0x308b9e,_0xfe33e5)=>{if(_0x308b9e){return _0x380c18(_0x308b9e);}if(_0xfe33e5){return _0x380c18(undefined,_0xfe33e5);}User_1[a1_0x5778('0x7')][a1_0x5778('0x1b')]({'email':_0xa8d8ee['_json'][a1_0x5778('0xc')]},(_0x308b9e,_0x4acc4a)=>{if(_0x308b9e){return _0x380c18(_0x308b9e);}if(_0x4acc4a){_0x16c8b7[a1_0x5778('0x1c')](a1_0x5778('0x1d'),{'msg':a1_0x5778('0x27')});_0x380c18(_0x308b9e);}else{const _0x3101cc=new User_1[(a1_0x5778('0x7'))]();_0x3101cc[a1_0x5778('0xc')]=_0xa8d8ee['_json'][a1_0x5778('0xc')];_0x3101cc[a1_0x5778('0x1e')]=_0xa8d8ee['id'];_0x3101cc['tokens']['push']({'kind':a1_0x5778('0x1e'),'accessToken':_0x5b6150});_0x3101cc[a1_0x5778('0x21')][a1_0x5778('0x16')]=_0xa8d8ee[a1_0x5778('0x16')]['givenName']+'\x20'+_0xa8d8ee[a1_0x5778('0x16')][a1_0x5778('0x28')];_0x3101cc[a1_0x5778('0x21')]['gender']=_0xa8d8ee['_json']['gender'];_0x3101cc[a1_0x5778('0x21')][a1_0x5778('0x23')]=a1_0x5778('0x24')+_0xa8d8ee['id']+a1_0x5778('0x29');_0x3101cc[a1_0x5778('0x21')][a1_0x5778('0x2a')]=_0xa8d8ee[a1_0x5778('0x2b')]['location']?_0xa8d8ee[a1_0x5778('0x2b')]['location'][a1_0x5778('0x16')]:'';_0x3101cc[a1_0x5778('0x2c')](_0x308b9e=>{_0x380c18(_0x308b9e,_0x3101cc);});}});});}}));exports[a1_0x5778('0x2d')]=(_0x168446,_0x8852fc,_0x1e7fc7)=>{if(_0x168446['isAuthenticated']()){return _0x1e7fc7();}_0x8852fc[a1_0x5778('0x2e')](a1_0x5778('0x2f'));};exports[a1_0x5778('0x30')]=(_0x1dedbc,_0x44ba8a,_0x497197)=>{const _0x46941e=_0x1dedbc[a1_0x5778('0x31')][a1_0x5778('0x32')]('/')[a1_0x5778('0x33')](-0x1)[0x0];if(lodash_1['default'][a1_0x5778('0x34')](_0x1dedbc[a1_0x5778('0x1a')][a1_0x5778('0x1f')],{'kind':_0x46941e})){_0x497197();}else{_0x44ba8a[a1_0x5778('0x2e')](a1_0x5778('0x35')+_0x46941e);}};
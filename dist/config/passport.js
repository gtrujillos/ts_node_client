var a1_0x5ee5=['\x20not\x20found.','comparePassword','Invalid\x20email\x20or\x20password.','env','FACEBOOK_ID','FACEBOOK_SECRET','/auth/facebook/callback','name','email','link','locale','timezone','user','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','tokens','facebook','profile','gender','_json','picture','/picture?type=large','save','info','Facebook\x20account\x20has\x20been\x20linked.','flash','givenName','familyName','https://graph.facebook.com/','location','isAuthenticated','redirect','/login','isAuthorized','slice','/auth/','__importDefault','__esModule','passport-local','passport-facebook','lodash','../models/User','default','Strategy','serializeUser','deserializeUser','findById','use','findOne','toLowerCase','Email\x20'];(function(_0x2d8f05,_0x4b81bb){var _0x4d74cb=function(_0x32719f){while(--_0x32719f){_0x2d8f05['push'](_0x2d8f05['shift']());}};_0x4d74cb(++_0x4b81bb);}(a1_0x5ee5,0x189));var a1_0x4857=function(_0x1ad7c4,_0x3ad724){_0x1ad7c4=_0x1ad7c4-0x0;var _0x126f5a=a1_0x5ee5[_0x1ad7c4];return _0x126f5a;};'use strict';var __importDefault=this&&this[a1_0x4857('0x0')]||function(_0x58b4a0){return _0x58b4a0&&_0x58b4a0['__esModule']?_0x58b4a0:{'default':_0x58b4a0};};Object['defineProperty'](exports,a1_0x4857('0x1'),{'value':!![]});const passport_1=__importDefault(require('passport'));const passport_local_1=__importDefault(require(a1_0x4857('0x2')));const passport_facebook_1=__importDefault(require(a1_0x4857('0x3')));const lodash_1=__importDefault(require(a1_0x4857('0x4')));const User_1=__importDefault(require(a1_0x4857('0x5')));const LocalStrategy=passport_local_1[a1_0x4857('0x6')][a1_0x4857('0x7')];const FacebookStrategy=passport_facebook_1[a1_0x4857('0x6')][a1_0x4857('0x7')];passport_1[a1_0x4857('0x6')][a1_0x4857('0x8')]((_0x20c672,_0x25989a)=>{_0x25989a(undefined,_0x20c672['id']);});passport_1[a1_0x4857('0x6')][a1_0x4857('0x9')]((_0x430ca2,_0x57e3d1)=>{User_1['default'][a1_0x4857('0xa')](_0x430ca2,(_0x1d76cd,_0x56ba80)=>{_0x57e3d1(_0x1d76cd,_0x56ba80);});});passport_1[a1_0x4857('0x6')][a1_0x4857('0xb')](new LocalStrategy({'usernameField':'email'},(_0x247440,_0x6c0e13,_0x2c1114)=>{User_1[a1_0x4857('0x6')][a1_0x4857('0xc')]({'email':_0x247440[a1_0x4857('0xd')]()},(_0x4366ec,_0xe01b6c)=>{if(_0x4366ec){return _0x2c1114(_0x4366ec);}if(!_0xe01b6c){return _0x2c1114(undefined,![],{'message':a1_0x4857('0xe')+_0x247440+a1_0x4857('0xf')});}_0xe01b6c[a1_0x4857('0x10')](_0x6c0e13,(_0x4366ec,_0x3a56b5)=>{if(_0x4366ec){return _0x2c1114(_0x4366ec);}if(_0x3a56b5){return _0x2c1114(undefined,_0xe01b6c);}return _0x2c1114(undefined,![],{'message':a1_0x4857('0x11')});});});}));passport_1[a1_0x4857('0x6')]['use'](new FacebookStrategy({'clientID':process[a1_0x4857('0x12')][a1_0x4857('0x13')],'clientSecret':process[a1_0x4857('0x12')][a1_0x4857('0x14')],'callbackURL':a1_0x4857('0x15'),'profileFields':[a1_0x4857('0x16'),a1_0x4857('0x17'),a1_0x4857('0x18'),a1_0x4857('0x19'),a1_0x4857('0x1a')],'passReqToCallback':!![]},(_0x3487d7,_0x5b091a,_0x4d27f0,_0x2b201b,_0x217efb)=>{if(_0x3487d7[a1_0x4857('0x1b')]){User_1[a1_0x4857('0x6')][a1_0x4857('0xc')]({'facebook':_0x2b201b['id']},(_0x24e8c9,_0x384ba8)=>{if(_0x24e8c9){return _0x217efb(_0x24e8c9);}if(_0x384ba8){_0x3487d7['flash'](a1_0x4857('0x1c'),{'msg':a1_0x4857('0x1d')});_0x217efb(_0x24e8c9);}else{User_1[a1_0x4857('0x6')][a1_0x4857('0xa')](_0x3487d7[a1_0x4857('0x1b')]['id'],(_0x24e8c9,_0x5e1b60)=>{if(_0x24e8c9){return _0x217efb(_0x24e8c9);}_0x5e1b60['facebook']=_0x2b201b['id'];_0x5e1b60[a1_0x4857('0x1e')]['push']({'kind':a1_0x4857('0x1f'),'accessToken':_0x5b091a});_0x5e1b60[a1_0x4857('0x20')][a1_0x4857('0x16')]=_0x5e1b60[a1_0x4857('0x20')][a1_0x4857('0x16')]||_0x2b201b[a1_0x4857('0x16')]['givenName']+'\x20'+_0x2b201b[a1_0x4857('0x16')]['familyName'];_0x5e1b60['profile'][a1_0x4857('0x21')]=_0x5e1b60[a1_0x4857('0x20')][a1_0x4857('0x21')]||_0x2b201b[a1_0x4857('0x22')][a1_0x4857('0x21')];_0x5e1b60[a1_0x4857('0x20')]['picture']=_0x5e1b60[a1_0x4857('0x20')][a1_0x4857('0x23')]||'https://graph.facebook.com/'+_0x2b201b['id']+a1_0x4857('0x24');_0x5e1b60[a1_0x4857('0x25')](_0x24e8c9=>{_0x3487d7['flash'](a1_0x4857('0x26'),{'msg':a1_0x4857('0x27')});_0x217efb(_0x24e8c9,_0x5e1b60);});});}});}else{User_1['default'][a1_0x4857('0xc')]({'facebook':_0x2b201b['id']},(_0x211550,_0x2095d5)=>{if(_0x211550){return _0x217efb(_0x211550);}if(_0x2095d5){return _0x217efb(undefined,_0x2095d5);}User_1[a1_0x4857('0x6')][a1_0x4857('0xc')]({'email':_0x2b201b[a1_0x4857('0x22')][a1_0x4857('0x17')]},(_0x211550,_0x372d0b)=>{if(_0x211550){return _0x217efb(_0x211550);}if(_0x372d0b){_0x3487d7[a1_0x4857('0x28')](a1_0x4857('0x1c'),{'msg':'There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.'});_0x217efb(_0x211550);}else{const _0x58cf25=new User_1[(a1_0x4857('0x6'))]();_0x58cf25['email']=_0x2b201b[a1_0x4857('0x22')][a1_0x4857('0x17')];_0x58cf25[a1_0x4857('0x1f')]=_0x2b201b['id'];_0x58cf25[a1_0x4857('0x1e')]['push']({'kind':'facebook','accessToken':_0x5b091a});_0x58cf25[a1_0x4857('0x20')][a1_0x4857('0x16')]=_0x2b201b[a1_0x4857('0x16')][a1_0x4857('0x29')]+'\x20'+_0x2b201b[a1_0x4857('0x16')][a1_0x4857('0x2a')];_0x58cf25['profile']['gender']=_0x2b201b[a1_0x4857('0x22')][a1_0x4857('0x21')];_0x58cf25[a1_0x4857('0x20')][a1_0x4857('0x23')]=a1_0x4857('0x2b')+_0x2b201b['id']+a1_0x4857('0x24');_0x58cf25[a1_0x4857('0x20')][a1_0x4857('0x2c')]=_0x2b201b[a1_0x4857('0x22')]['location']?_0x2b201b['_json'][a1_0x4857('0x2c')]['name']:'';_0x58cf25[a1_0x4857('0x25')](_0x211550=>{_0x217efb(_0x211550,_0x58cf25);});}});});}}));exports[a1_0x4857('0x2d')]=(_0x3f4006,_0x1c6804,_0x2798d7)=>{if(_0x3f4006['isAuthenticated']()){return _0x2798d7();}_0x1c6804[a1_0x4857('0x2e')](a1_0x4857('0x2f'));};exports[a1_0x4857('0x30')]=(_0x94674a,_0x40eaa7,_0x34e4ee)=>{const _0x2c346c=_0x94674a['path']['split']('/')[a1_0x4857('0x31')](-0x1)[0x0];if(lodash_1[a1_0x4857('0x6')]['find'](_0x94674a[a1_0x4857('0x1b')]['tokens'],{'kind':_0x2c346c})){_0x34e4ee();}else{_0x40eaa7[a1_0x4857('0x2e')](a1_0x4857('0x32')+_0x2c346c);}};
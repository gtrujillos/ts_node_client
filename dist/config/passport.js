var a1_0x3549=['locale','timezone','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','user','facebook','tokens','push','profile','givenName','gender','_json','picture','/picture?type=large','save','flash','info','Facebook\x20account\x20has\x20been\x20linked.','email','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','familyName','https://graph.facebook.com/','location','isAuthenticated','/login','isAuthorized','path','split','find','/auth/','__importDefault','defineProperty','__esModule','passport','passport-local','../models/User','default','Strategy','serializeUser','deserializeUser','findById','use','findOne','toLowerCase','Email\x20','\x20not\x20found.','comparePassword','Invalid\x20email\x20or\x20password.','env','FACEBOOK_SECRET','/auth/facebook/callback','name'];(function(_0x33d933,_0x1ac21c){var _0x240c81=function(_0x361286){while(--_0x361286){_0x33d933['push'](_0x33d933['shift']());}};_0x240c81(++_0x1ac21c);}(a1_0x3549,0x1f2));var a1_0x311c=function(_0x1d6eee,_0x102174){_0x1d6eee=_0x1d6eee-0x0;var _0x45b4d7=a1_0x3549[_0x1d6eee];return _0x45b4d7;};'use strict';var __importDefault=this&&this[a1_0x311c('0x0')]||function(_0x3fc77f){return _0x3fc77f&&_0x3fc77f['__esModule']?_0x3fc77f:{'default':_0x3fc77f};};Object[a1_0x311c('0x1')](exports,a1_0x311c('0x2'),{'value':!![]});const passport_1=__importDefault(require(a1_0x311c('0x3')));const passport_local_1=__importDefault(require(a1_0x311c('0x4')));const passport_facebook_1=__importDefault(require('passport-facebook'));const lodash_1=__importDefault(require('lodash'));const User_1=__importDefault(require(a1_0x311c('0x5')));const LocalStrategy=passport_local_1[a1_0x311c('0x6')][a1_0x311c('0x7')];const FacebookStrategy=passport_facebook_1[a1_0x311c('0x6')][a1_0x311c('0x7')];passport_1['default'][a1_0x311c('0x8')]((_0x875954,_0x3d1b43)=>{_0x3d1b43(undefined,_0x875954['id']);});passport_1[a1_0x311c('0x6')][a1_0x311c('0x9')]((_0x1d668c,_0x1e2e4d)=>{User_1['default'][a1_0x311c('0xa')](_0x1d668c,(_0x34ec6c,_0x184fe1)=>{_0x1e2e4d(_0x34ec6c,_0x184fe1);});});passport_1[a1_0x311c('0x6')][a1_0x311c('0xb')](new LocalStrategy({'usernameField':'email'},(_0x30e28a,_0x3ea495,_0x102e4b)=>{User_1[a1_0x311c('0x6')][a1_0x311c('0xc')]({'email':_0x30e28a[a1_0x311c('0xd')]()},(_0x58767b,_0x3018fc)=>{if(_0x58767b){return _0x102e4b(_0x58767b);}if(!_0x3018fc){return _0x102e4b(undefined,![],{'message':a1_0x311c('0xe')+_0x30e28a+a1_0x311c('0xf')});}_0x3018fc[a1_0x311c('0x10')](_0x3ea495,(_0x58767b,_0x160757)=>{if(_0x58767b){return _0x102e4b(_0x58767b);}if(_0x160757){return _0x102e4b(undefined,_0x3018fc);}return _0x102e4b(undefined,![],{'message':a1_0x311c('0x11')});});});}));passport_1[a1_0x311c('0x6')]['use'](new FacebookStrategy({'clientID':process[a1_0x311c('0x12')]['FACEBOOK_ID'],'clientSecret':process[a1_0x311c('0x12')][a1_0x311c('0x13')],'callbackURL':a1_0x311c('0x14'),'profileFields':[a1_0x311c('0x15'),'email','link',a1_0x311c('0x16'),a1_0x311c('0x17')],'passReqToCallback':!![]},(_0x55a86f,_0x2367af,_0xdc0932,_0x87b899,_0x1179bb)=>{if(_0x55a86f['user']){User_1[a1_0x311c('0x6')][a1_0x311c('0xc')]({'facebook':_0x87b899['id']},(_0x212e81,_0x4dcb13)=>{if(_0x212e81){return _0x1179bb(_0x212e81);}if(_0x4dcb13){_0x55a86f['flash'](a1_0x311c('0x18'),{'msg':a1_0x311c('0x19')});_0x1179bb(_0x212e81);}else{User_1['default'][a1_0x311c('0xa')](_0x55a86f[a1_0x311c('0x1a')]['id'],(_0x212e81,_0x4c9945)=>{if(_0x212e81){return _0x1179bb(_0x212e81);}_0x4c9945[a1_0x311c('0x1b')]=_0x87b899['id'];_0x4c9945[a1_0x311c('0x1c')][a1_0x311c('0x1d')]({'kind':a1_0x311c('0x1b'),'accessToken':_0x2367af});_0x4c9945['profile']['name']=_0x4c9945[a1_0x311c('0x1e')]['name']||_0x87b899[a1_0x311c('0x15')][a1_0x311c('0x1f')]+'\x20'+_0x87b899[a1_0x311c('0x15')]['familyName'];_0x4c9945['profile'][a1_0x311c('0x20')]=_0x4c9945[a1_0x311c('0x1e')]['gender']||_0x87b899[a1_0x311c('0x21')][a1_0x311c('0x20')];_0x4c9945[a1_0x311c('0x1e')][a1_0x311c('0x22')]=_0x4c9945[a1_0x311c('0x1e')][a1_0x311c('0x22')]||'https://graph.facebook.com/'+_0x87b899['id']+a1_0x311c('0x23');_0x4c9945[a1_0x311c('0x24')](_0x212e81=>{_0x55a86f[a1_0x311c('0x25')](a1_0x311c('0x26'),{'msg':a1_0x311c('0x27')});_0x1179bb(_0x212e81,_0x4c9945);});});}});}else{User_1[a1_0x311c('0x6')]['findOne']({'facebook':_0x87b899['id']},(_0x453a92,_0x52d35e)=>{if(_0x453a92){return _0x1179bb(_0x453a92);}if(_0x52d35e){return _0x1179bb(undefined,_0x52d35e);}User_1[a1_0x311c('0x6')][a1_0x311c('0xc')]({'email':_0x87b899[a1_0x311c('0x21')][a1_0x311c('0x28')]},(_0x453a92,_0x2486bd)=>{if(_0x453a92){return _0x1179bb(_0x453a92);}if(_0x2486bd){_0x55a86f[a1_0x311c('0x25')](a1_0x311c('0x18'),{'msg':a1_0x311c('0x29')});_0x1179bb(_0x453a92);}else{const _0x44e41a=new User_1[(a1_0x311c('0x6'))]();_0x44e41a[a1_0x311c('0x28')]=_0x87b899[a1_0x311c('0x21')]['email'];_0x44e41a['facebook']=_0x87b899['id'];_0x44e41a['tokens']['push']({'kind':a1_0x311c('0x1b'),'accessToken':_0x2367af});_0x44e41a[a1_0x311c('0x1e')][a1_0x311c('0x15')]=_0x87b899['name'][a1_0x311c('0x1f')]+'\x20'+_0x87b899[a1_0x311c('0x15')][a1_0x311c('0x2a')];_0x44e41a[a1_0x311c('0x1e')][a1_0x311c('0x20')]=_0x87b899[a1_0x311c('0x21')][a1_0x311c('0x20')];_0x44e41a[a1_0x311c('0x1e')][a1_0x311c('0x22')]=a1_0x311c('0x2b')+_0x87b899['id']+a1_0x311c('0x23');_0x44e41a[a1_0x311c('0x1e')][a1_0x311c('0x2c')]=_0x87b899[a1_0x311c('0x21')]['location']?_0x87b899[a1_0x311c('0x21')][a1_0x311c('0x2c')][a1_0x311c('0x15')]:'';_0x44e41a[a1_0x311c('0x24')](_0x453a92=>{_0x1179bb(_0x453a92,_0x44e41a);});}});});}}));exports[a1_0x311c('0x2d')]=(_0x183ab5,_0xcebe0d,_0x46c72a)=>{if(_0x183ab5[a1_0x311c('0x2d')]()){return _0x46c72a();}_0xcebe0d['redirect'](a1_0x311c('0x2e'));};exports[a1_0x311c('0x2f')]=(_0x5902dc,_0x2103b3,_0x53f2ee)=>{const _0xdfa7a0=_0x5902dc[a1_0x311c('0x30')][a1_0x311c('0x31')]('/')['slice'](-0x1)[0x0];if(lodash_1[a1_0x311c('0x6')][a1_0x311c('0x32')](_0x5902dc['user'][a1_0x311c('0x1c')],{'kind':_0xdfa7a0})){_0x53f2ee();}else{_0x2103b3['redirect'](a1_0x311c('0x33')+_0xdfa7a0);}};
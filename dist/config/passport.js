var a1_0x1c66=['profile','gender','_json','picture','https://graph.facebook.com/','/picture?type=large','save','Facebook\x20account\x20has\x20been\x20linked.','givenName','location','isAuthenticated','redirect','/login','isAuthorized','path','find','__esModule','passport','passport-local','passport-facebook','lodash','../models/User','default','Strategy','serializeUser','deserializeUser','findById','use','email','findOne','Email\x20','comparePassword','env','FACEBOOK_ID','FACEBOOK_SECRET','link','locale','timezone','user','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','tokens','push','facebook','name','familyName'];(function(_0x2c0fca,_0x1a0d22){var _0x15df01=function(_0x2c308f){while(--_0x2c308f){_0x2c0fca['push'](_0x2c0fca['shift']());}};_0x15df01(++_0x1a0d22);}(a1_0x1c66,0x152));var a1_0x392c=function(_0x29d0b3,_0x431aaf){_0x29d0b3=_0x29d0b3-0x0;var _0x576b8d=a1_0x1c66[_0x29d0b3];return _0x576b8d;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x2375f7){return _0x2375f7&&_0x2375f7['__esModule']?_0x2375f7:{'default':_0x2375f7};};Object['defineProperty'](exports,a1_0x392c('0x0'),{'value':!![]});const passport_1=__importDefault(require(a1_0x392c('0x1')));const passport_local_1=__importDefault(require(a1_0x392c('0x2')));const passport_facebook_1=__importDefault(require(a1_0x392c('0x3')));const lodash_1=__importDefault(require(a1_0x392c('0x4')));const User_1=__importDefault(require(a1_0x392c('0x5')));const LocalStrategy=passport_local_1[a1_0x392c('0x6')][a1_0x392c('0x7')];const FacebookStrategy=passport_facebook_1[a1_0x392c('0x6')][a1_0x392c('0x7')];passport_1[a1_0x392c('0x6')][a1_0x392c('0x8')]((_0x11c34a,_0x25234c)=>{_0x25234c(undefined,_0x11c34a['id']);});passport_1[a1_0x392c('0x6')][a1_0x392c('0x9')]((_0x4da93b,_0x117adb)=>{User_1['default'][a1_0x392c('0xa')](_0x4da93b,(_0xeb08,_0x4fe747)=>{_0x117adb(_0xeb08,_0x4fe747);});});passport_1[a1_0x392c('0x6')][a1_0x392c('0xb')](new LocalStrategy({'usernameField':a1_0x392c('0xc')},(_0x2a5480,_0x2637af,_0x52d1da)=>{User_1['default'][a1_0x392c('0xd')]({'email':_0x2a5480['toLowerCase']()},(_0x3d96e6,_0x5c5690)=>{if(_0x3d96e6){return _0x52d1da(_0x3d96e6);}if(!_0x5c5690){return _0x52d1da(undefined,![],{'message':a1_0x392c('0xe')+_0x2a5480+'\x20not\x20found.'});}_0x5c5690[a1_0x392c('0xf')](_0x2637af,(_0x3d96e6,_0x1d787a)=>{if(_0x3d96e6){return _0x52d1da(_0x3d96e6);}if(_0x1d787a){return _0x52d1da(undefined,_0x5c5690);}return _0x52d1da(undefined,![],{'message':'Invalid\x20email\x20or\x20password.'});});});}));passport_1[a1_0x392c('0x6')][a1_0x392c('0xb')](new FacebookStrategy({'clientID':process[a1_0x392c('0x10')][a1_0x392c('0x11')],'clientSecret':process['env'][a1_0x392c('0x12')],'callbackURL':'/auth/facebook/callback','profileFields':['name','email',a1_0x392c('0x13'),a1_0x392c('0x14'),a1_0x392c('0x15')],'passReqToCallback':!![]},(_0x3426cb,_0x2b39d9,_0x15ac03,_0x586193,_0x6873f0)=>{if(_0x3426cb[a1_0x392c('0x16')]){User_1[a1_0x392c('0x6')]['findOne']({'facebook':_0x586193['id']},(_0x3b8cd0,_0x8a681b)=>{if(_0x3b8cd0){return _0x6873f0(_0x3b8cd0);}if(_0x8a681b){_0x3426cb['flash'](a1_0x392c('0x17'),{'msg':a1_0x392c('0x18')});_0x6873f0(_0x3b8cd0);}else{User_1[a1_0x392c('0x6')][a1_0x392c('0xa')](_0x3426cb['user']['id'],(_0x3b8cd0,_0x21b659)=>{if(_0x3b8cd0){return _0x6873f0(_0x3b8cd0);}_0x21b659['facebook']=_0x586193['id'];_0x21b659[a1_0x392c('0x19')][a1_0x392c('0x1a')]({'kind':a1_0x392c('0x1b'),'accessToken':_0x2b39d9});_0x21b659['profile']['name']=_0x21b659['profile'][a1_0x392c('0x1c')]||_0x586193[a1_0x392c('0x1c')]['givenName']+'\x20'+_0x586193[a1_0x392c('0x1c')][a1_0x392c('0x1d')];_0x21b659[a1_0x392c('0x1e')][a1_0x392c('0x1f')]=_0x21b659[a1_0x392c('0x1e')][a1_0x392c('0x1f')]||_0x586193[a1_0x392c('0x20')][a1_0x392c('0x1f')];_0x21b659[a1_0x392c('0x1e')][a1_0x392c('0x21')]=_0x21b659[a1_0x392c('0x1e')][a1_0x392c('0x21')]||a1_0x392c('0x22')+_0x586193['id']+a1_0x392c('0x23');_0x21b659[a1_0x392c('0x24')](_0x3b8cd0=>{_0x3426cb['flash']('info',{'msg':a1_0x392c('0x25')});_0x6873f0(_0x3b8cd0,_0x21b659);});});}});}else{User_1[a1_0x392c('0x6')][a1_0x392c('0xd')]({'facebook':_0x586193['id']},(_0x4bca85,_0x59ddb8)=>{if(_0x4bca85){return _0x6873f0(_0x4bca85);}if(_0x59ddb8){return _0x6873f0(undefined,_0x59ddb8);}User_1[a1_0x392c('0x6')][a1_0x392c('0xd')]({'email':_0x586193[a1_0x392c('0x20')][a1_0x392c('0xc')]},(_0x4bca85,_0x539035)=>{if(_0x4bca85){return _0x6873f0(_0x4bca85);}if(_0x539035){_0x3426cb['flash'](a1_0x392c('0x17'),{'msg':'There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.'});_0x6873f0(_0x4bca85);}else{const _0x232bbc=new User_1[(a1_0x392c('0x6'))]();_0x232bbc['email']=_0x586193[a1_0x392c('0x20')][a1_0x392c('0xc')];_0x232bbc[a1_0x392c('0x1b')]=_0x586193['id'];_0x232bbc[a1_0x392c('0x19')][a1_0x392c('0x1a')]({'kind':a1_0x392c('0x1b'),'accessToken':_0x2b39d9});_0x232bbc[a1_0x392c('0x1e')][a1_0x392c('0x1c')]=_0x586193[a1_0x392c('0x1c')][a1_0x392c('0x26')]+'\x20'+_0x586193[a1_0x392c('0x1c')][a1_0x392c('0x1d')];_0x232bbc[a1_0x392c('0x1e')][a1_0x392c('0x1f')]=_0x586193['_json'][a1_0x392c('0x1f')];_0x232bbc[a1_0x392c('0x1e')][a1_0x392c('0x21')]=a1_0x392c('0x22')+_0x586193['id']+'/picture?type=large';_0x232bbc['profile'][a1_0x392c('0x27')]=_0x586193[a1_0x392c('0x20')][a1_0x392c('0x27')]?_0x586193[a1_0x392c('0x20')][a1_0x392c('0x27')]['name']:'';_0x232bbc[a1_0x392c('0x24')](_0x4bca85=>{_0x6873f0(_0x4bca85,_0x232bbc);});}});});}}));exports[a1_0x392c('0x28')]=(_0x3b81c4,_0x8511b6,_0x336fae)=>{if(_0x3b81c4['isAuthenticated']()){return _0x336fae();}_0x8511b6[a1_0x392c('0x29')](a1_0x392c('0x2a'));};exports[a1_0x392c('0x2b')]=(_0x523309,_0x568873,_0x21430e)=>{const _0x5f1b93=_0x523309[a1_0x392c('0x2c')]['split']('/')['slice'](-0x1)[0x0];if(lodash_1[a1_0x392c('0x6')][a1_0x392c('0x2d')](_0x523309[a1_0x392c('0x16')][a1_0x392c('0x19')],{'kind':_0x5f1b93})){_0x21430e();}else{_0x568873[a1_0x392c('0x29')]('/auth/'+_0x5f1b93);}};
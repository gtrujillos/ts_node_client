var a1_0x2807=['passport','passport-facebook','lodash','../models/User','Strategy','default','serializeUser','deserializeUser','findById','use','email','findOne','Email\x20','\x20not\x20found.','comparePassword','Invalid\x20email\x20or\x20password.','env','FACEBOOK_ID','FACEBOOK_SECRET','/auth/facebook/callback','link','locale','timezone','user','flash','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','facebook','name','profile','gender','_json','picture','https://graph.facebook.com/','/picture?type=large','save','info','Facebook\x20account\x20has\x20been\x20linked.','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','givenName','familyName','location','isAuthenticated','redirect','isAuthorized','path','slice','find','tokens','/auth/','__importDefault','__esModule','defineProperty'];(function(_0x5c784a,_0x12fbab){var _0x207f75=function(_0x143d46){while(--_0x143d46){_0x5c784a['push'](_0x5c784a['shift']());}};_0x207f75(++_0x12fbab);}(a1_0x2807,0x106));var a1_0x434b=function(_0x2bc1c3,_0x11c393){_0x2bc1c3=_0x2bc1c3-0x0;var _0x1c9b90=a1_0x2807[_0x2bc1c3];return _0x1c9b90;};'use strict';var __importDefault=this&&this[a1_0x434b('0x0')]||function(_0x12a0cb){return _0x12a0cb&&_0x12a0cb[a1_0x434b('0x1')]?_0x12a0cb:{'default':_0x12a0cb};};Object[a1_0x434b('0x2')](exports,'__esModule',{'value':!![]});const passport_1=__importDefault(require(a1_0x434b('0x3')));const passport_local_1=__importDefault(require('passport-local'));const passport_facebook_1=__importDefault(require(a1_0x434b('0x4')));const lodash_1=__importDefault(require(a1_0x434b('0x5')));const User_1=__importDefault(require(a1_0x434b('0x6')));const LocalStrategy=passport_local_1['default'][a1_0x434b('0x7')];const FacebookStrategy=passport_facebook_1['default'][a1_0x434b('0x7')];passport_1[a1_0x434b('0x8')][a1_0x434b('0x9')]((_0x29c7fd,_0x5b7eb3)=>{_0x5b7eb3(undefined,_0x29c7fd['id']);});passport_1[a1_0x434b('0x8')][a1_0x434b('0xa')]((_0x375375,_0x486f4e)=>{User_1[a1_0x434b('0x8')][a1_0x434b('0xb')](_0x375375,(_0x3e3ae1,_0x27abf1)=>{_0x486f4e(_0x3e3ae1,_0x27abf1);});});passport_1['default'][a1_0x434b('0xc')](new LocalStrategy({'usernameField':a1_0x434b('0xd')},(_0x59cb36,_0x5ce331,_0xd5e275)=>{User_1['default'][a1_0x434b('0xe')]({'email':_0x59cb36['toLowerCase']()},(_0x2c6bba,_0x20adc9)=>{if(_0x2c6bba){return _0xd5e275(_0x2c6bba);}if(!_0x20adc9){return _0xd5e275(undefined,![],{'message':a1_0x434b('0xf')+_0x59cb36+a1_0x434b('0x10')});}_0x20adc9[a1_0x434b('0x11')](_0x5ce331,(_0x2c6bba,_0x420947)=>{if(_0x2c6bba){return _0xd5e275(_0x2c6bba);}if(_0x420947){return _0xd5e275(undefined,_0x20adc9);}return _0xd5e275(undefined,![],{'message':a1_0x434b('0x12')});});});}));passport_1[a1_0x434b('0x8')][a1_0x434b('0xc')](new FacebookStrategy({'clientID':process[a1_0x434b('0x13')][a1_0x434b('0x14')],'clientSecret':process['env'][a1_0x434b('0x15')],'callbackURL':a1_0x434b('0x16'),'profileFields':['name',a1_0x434b('0xd'),a1_0x434b('0x17'),a1_0x434b('0x18'),a1_0x434b('0x19')],'passReqToCallback':!![]},(_0x1aed1b,_0x41e7a1,_0x33867c,_0x19e5d5,_0x1a66d6)=>{if(_0x1aed1b[a1_0x434b('0x1a')]){User_1[a1_0x434b('0x8')][a1_0x434b('0xe')]({'facebook':_0x19e5d5['id']},(_0x4d1129,_0x29d40f)=>{if(_0x4d1129){return _0x1a66d6(_0x4d1129);}if(_0x29d40f){_0x1aed1b[a1_0x434b('0x1b')](a1_0x434b('0x1c'),{'msg':a1_0x434b('0x1d')});_0x1a66d6(_0x4d1129);}else{User_1[a1_0x434b('0x8')][a1_0x434b('0xb')](_0x1aed1b[a1_0x434b('0x1a')]['id'],(_0x4d1129,_0x5055e0)=>{if(_0x4d1129){return _0x1a66d6(_0x4d1129);}_0x5055e0[a1_0x434b('0x1e')]=_0x19e5d5['id'];_0x5055e0['tokens']['push']({'kind':a1_0x434b('0x1e'),'accessToken':_0x41e7a1});_0x5055e0['profile'][a1_0x434b('0x1f')]=_0x5055e0[a1_0x434b('0x20')][a1_0x434b('0x1f')]||_0x19e5d5[a1_0x434b('0x1f')]['givenName']+'\x20'+_0x19e5d5[a1_0x434b('0x1f')]['familyName'];_0x5055e0['profile']['gender']=_0x5055e0['profile'][a1_0x434b('0x21')]||_0x19e5d5[a1_0x434b('0x22')]['gender'];_0x5055e0[a1_0x434b('0x20')][a1_0x434b('0x23')]=_0x5055e0[a1_0x434b('0x20')][a1_0x434b('0x23')]||a1_0x434b('0x24')+_0x19e5d5['id']+a1_0x434b('0x25');_0x5055e0[a1_0x434b('0x26')](_0x4d1129=>{_0x1aed1b[a1_0x434b('0x1b')](a1_0x434b('0x27'),{'msg':a1_0x434b('0x28')});_0x1a66d6(_0x4d1129,_0x5055e0);});});}});}else{User_1[a1_0x434b('0x8')][a1_0x434b('0xe')]({'facebook':_0x19e5d5['id']},(_0x112fec,_0x3f7d15)=>{if(_0x112fec){return _0x1a66d6(_0x112fec);}if(_0x3f7d15){return _0x1a66d6(undefined,_0x3f7d15);}User_1[a1_0x434b('0x8')][a1_0x434b('0xe')]({'email':_0x19e5d5[a1_0x434b('0x22')]['email']},(_0x112fec,_0x56aae1)=>{if(_0x112fec){return _0x1a66d6(_0x112fec);}if(_0x56aae1){_0x1aed1b['flash'](a1_0x434b('0x1c'),{'msg':a1_0x434b('0x29')});_0x1a66d6(_0x112fec);}else{const _0x4ae2e9=new User_1[(a1_0x434b('0x8'))]();_0x4ae2e9[a1_0x434b('0xd')]=_0x19e5d5['_json'][a1_0x434b('0xd')];_0x4ae2e9[a1_0x434b('0x1e')]=_0x19e5d5['id'];_0x4ae2e9['tokens']['push']({'kind':a1_0x434b('0x1e'),'accessToken':_0x41e7a1});_0x4ae2e9[a1_0x434b('0x20')][a1_0x434b('0x1f')]=_0x19e5d5[a1_0x434b('0x1f')][a1_0x434b('0x2a')]+'\x20'+_0x19e5d5[a1_0x434b('0x1f')][a1_0x434b('0x2b')];_0x4ae2e9['profile'][a1_0x434b('0x21')]=_0x19e5d5[a1_0x434b('0x22')][a1_0x434b('0x21')];_0x4ae2e9[a1_0x434b('0x20')][a1_0x434b('0x23')]='https://graph.facebook.com/'+_0x19e5d5['id']+a1_0x434b('0x25');_0x4ae2e9[a1_0x434b('0x20')][a1_0x434b('0x2c')]=_0x19e5d5['_json'][a1_0x434b('0x2c')]?_0x19e5d5[a1_0x434b('0x22')]['location'][a1_0x434b('0x1f')]:'';_0x4ae2e9[a1_0x434b('0x26')](_0x112fec=>{_0x1a66d6(_0x112fec,_0x4ae2e9);});}});});}}));exports[a1_0x434b('0x2d')]=(_0x31ee68,_0x500eed,_0x39a5a3)=>{if(_0x31ee68[a1_0x434b('0x2d')]()){return _0x39a5a3();}_0x500eed[a1_0x434b('0x2e')]('/login');};exports[a1_0x434b('0x2f')]=(_0x344be0,_0x2b6717,_0x538a70)=>{const _0x40cccf=_0x344be0[a1_0x434b('0x30')]['split']('/')[a1_0x434b('0x31')](-0x1)[0x0];if(lodash_1[a1_0x434b('0x8')][a1_0x434b('0x32')](_0x344be0[a1_0x434b('0x1a')][a1_0x434b('0x33')],{'kind':_0x40cccf})){_0x538a70();}else{_0x2b6717[a1_0x434b('0x2e')](a1_0x434b('0x34')+_0x40cccf);}};
var a1_0x46d0=['Email\x20','Invalid\x20email\x20or\x20password.','env','FACEBOOK_ID','link','locale','user','flash','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','facebook','tokens','push','profile','name','givenName','familyName','gender','_json','picture','https://graph.facebook.com/','/picture?type=large','info','Facebook\x20account\x20has\x20been\x20linked.','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','location','save','isAuthenticated','redirect','/login','isAuthorized','path','split','/auth/','__importDefault','__esModule','defineProperty','passport','passport-local','passport-facebook','lodash','../models/User','default','Strategy','serializeUser','deserializeUser','findById','email','findOne','toLowerCase'];(function(_0x1279ce,_0x59fbaa){var _0x2d9cb4=function(_0x191786){while(--_0x191786){_0x1279ce['push'](_0x1279ce['shift']());}};_0x2d9cb4(++_0x59fbaa);}(a1_0x46d0,0x86));var a1_0xe73c=function(_0x5600ea,_0x542171){_0x5600ea=_0x5600ea-0x0;var _0x59484c=a1_0x46d0[_0x5600ea];return _0x59484c;};'use strict';var __importDefault=this&&this[a1_0xe73c('0x0')]||function(_0x172f94){return _0x172f94&&_0x172f94[a1_0xe73c('0x1')]?_0x172f94:{'default':_0x172f94};};Object[a1_0xe73c('0x2')](exports,'__esModule',{'value':!![]});const passport_1=__importDefault(require(a1_0xe73c('0x3')));const passport_local_1=__importDefault(require(a1_0xe73c('0x4')));const passport_facebook_1=__importDefault(require(a1_0xe73c('0x5')));const lodash_1=__importDefault(require(a1_0xe73c('0x6')));const User_1=__importDefault(require(a1_0xe73c('0x7')));const LocalStrategy=passport_local_1[a1_0xe73c('0x8')][a1_0xe73c('0x9')];const FacebookStrategy=passport_facebook_1[a1_0xe73c('0x8')][a1_0xe73c('0x9')];passport_1[a1_0xe73c('0x8')][a1_0xe73c('0xa')]((_0x1c0a5c,_0x5be5bc)=>{_0x5be5bc(undefined,_0x1c0a5c['id']);});passport_1[a1_0xe73c('0x8')][a1_0xe73c('0xb')]((_0x4fea78,_0x127554)=>{User_1[a1_0xe73c('0x8')][a1_0xe73c('0xc')](_0x4fea78,(_0x296534,_0x5c1fd8)=>{_0x127554(_0x296534,_0x5c1fd8);});});passport_1[a1_0xe73c('0x8')]['use'](new LocalStrategy({'usernameField':a1_0xe73c('0xd')},(_0xa4576a,_0xf34349,_0x33504f)=>{User_1[a1_0xe73c('0x8')][a1_0xe73c('0xe')]({'email':_0xa4576a[a1_0xe73c('0xf')]()},(_0x4104a4,_0x3324c0)=>{if(_0x4104a4){return _0x33504f(_0x4104a4);}if(!_0x3324c0){return _0x33504f(undefined,![],{'message':a1_0xe73c('0x10')+_0xa4576a+'\x20not\x20found.'});}_0x3324c0['comparePassword'](_0xf34349,(_0x4104a4,_0x2c316e)=>{if(_0x4104a4){return _0x33504f(_0x4104a4);}if(_0x2c316e){return _0x33504f(undefined,_0x3324c0);}return _0x33504f(undefined,![],{'message':a1_0xe73c('0x11')});});});}));passport_1['default']['use'](new FacebookStrategy({'clientID':process[a1_0xe73c('0x12')][a1_0xe73c('0x13')],'clientSecret':process[a1_0xe73c('0x12')]['FACEBOOK_SECRET'],'callbackURL':'/auth/facebook/callback','profileFields':['name','email',a1_0xe73c('0x14'),a1_0xe73c('0x15'),'timezone'],'passReqToCallback':!![]},(_0x79e4f3,_0x2e4dea,_0x2c4ec5,_0x55f067,_0x1df33b)=>{if(_0x79e4f3[a1_0xe73c('0x16')]){User_1[a1_0xe73c('0x8')][a1_0xe73c('0xe')]({'facebook':_0x55f067['id']},(_0x5879c0,_0x40eba6)=>{if(_0x5879c0){return _0x1df33b(_0x5879c0);}if(_0x40eba6){_0x79e4f3[a1_0xe73c('0x17')](a1_0xe73c('0x18'),{'msg':a1_0xe73c('0x19')});_0x1df33b(_0x5879c0);}else{User_1[a1_0xe73c('0x8')]['findById'](_0x79e4f3[a1_0xe73c('0x16')]['id'],(_0x5879c0,_0x585589)=>{if(_0x5879c0){return _0x1df33b(_0x5879c0);}_0x585589[a1_0xe73c('0x1a')]=_0x55f067['id'];_0x585589[a1_0xe73c('0x1b')][a1_0xe73c('0x1c')]({'kind':'facebook','accessToken':_0x2e4dea});_0x585589[a1_0xe73c('0x1d')]['name']=_0x585589[a1_0xe73c('0x1d')][a1_0xe73c('0x1e')]||_0x55f067[a1_0xe73c('0x1e')][a1_0xe73c('0x1f')]+'\x20'+_0x55f067[a1_0xe73c('0x1e')][a1_0xe73c('0x20')];_0x585589[a1_0xe73c('0x1d')][a1_0xe73c('0x21')]=_0x585589['profile'][a1_0xe73c('0x21')]||_0x55f067[a1_0xe73c('0x22')][a1_0xe73c('0x21')];_0x585589['profile'][a1_0xe73c('0x23')]=_0x585589[a1_0xe73c('0x1d')][a1_0xe73c('0x23')]||a1_0xe73c('0x24')+_0x55f067['id']+a1_0xe73c('0x25');_0x585589['save'](_0x5879c0=>{_0x79e4f3[a1_0xe73c('0x17')](a1_0xe73c('0x26'),{'msg':a1_0xe73c('0x27')});_0x1df33b(_0x5879c0,_0x585589);});});}});}else{User_1[a1_0xe73c('0x8')]['findOne']({'facebook':_0x55f067['id']},(_0x34e86b,_0x5426b2)=>{if(_0x34e86b){return _0x1df33b(_0x34e86b);}if(_0x5426b2){return _0x1df33b(undefined,_0x5426b2);}User_1[a1_0xe73c('0x8')][a1_0xe73c('0xe')]({'email':_0x55f067[a1_0xe73c('0x22')][a1_0xe73c('0xd')]},(_0x34e86b,_0x1a2afa)=>{if(_0x34e86b){return _0x1df33b(_0x34e86b);}if(_0x1a2afa){_0x79e4f3[a1_0xe73c('0x17')]('errors',{'msg':a1_0xe73c('0x28')});_0x1df33b(_0x34e86b);}else{const _0x5ed0da=new User_1['default']();_0x5ed0da[a1_0xe73c('0xd')]=_0x55f067[a1_0xe73c('0x22')][a1_0xe73c('0xd')];_0x5ed0da['facebook']=_0x55f067['id'];_0x5ed0da[a1_0xe73c('0x1b')][a1_0xe73c('0x1c')]({'kind':a1_0xe73c('0x1a'),'accessToken':_0x2e4dea});_0x5ed0da[a1_0xe73c('0x1d')][a1_0xe73c('0x1e')]=_0x55f067[a1_0xe73c('0x1e')][a1_0xe73c('0x1f')]+'\x20'+_0x55f067[a1_0xe73c('0x1e')][a1_0xe73c('0x20')];_0x5ed0da['profile'][a1_0xe73c('0x21')]=_0x55f067[a1_0xe73c('0x22')]['gender'];_0x5ed0da['profile'][a1_0xe73c('0x23')]='https://graph.facebook.com/'+_0x55f067['id']+a1_0xe73c('0x25');_0x5ed0da[a1_0xe73c('0x1d')][a1_0xe73c('0x29')]=_0x55f067[a1_0xe73c('0x22')]['location']?_0x55f067[a1_0xe73c('0x22')][a1_0xe73c('0x29')]['name']:'';_0x5ed0da[a1_0xe73c('0x2a')](_0x34e86b=>{_0x1df33b(_0x34e86b,_0x5ed0da);});}});});}}));exports[a1_0xe73c('0x2b')]=(_0x22d098,_0x34b9d9,_0x3517ee)=>{if(_0x22d098[a1_0xe73c('0x2b')]()){return _0x3517ee();}_0x34b9d9[a1_0xe73c('0x2c')](a1_0xe73c('0x2d'));};exports[a1_0xe73c('0x2e')]=(_0x5e6bda,_0x471475,_0x2440ba)=>{const _0x2d23e3=_0x5e6bda[a1_0xe73c('0x2f')][a1_0xe73c('0x30')]('/')['slice'](-0x1)[0x0];if(lodash_1[a1_0xe73c('0x8')]['find'](_0x5e6bda['user'][a1_0xe73c('0x1b')],{'kind':_0x2d23e3})){_0x2440ba();}else{_0x471475[a1_0xe73c('0x2c')](a1_0xe73c('0x31')+_0x2d23e3);}};
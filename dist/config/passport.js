var a1_0x4bd4=['comparePassword','Invalid\x20email\x20or\x20password.','env','FACEBOOK_SECRET','name','link','timezone','user','errors','tokens','push','facebook','profile','givenName','familyName','gender','_json','picture','/picture?type=large','save','info','Facebook\x20account\x20has\x20been\x20linked.','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','email','https://graph.facebook.com/','location','redirect','/login','path','split','slice','find','/auth/','__importDefault','__esModule','defineProperty','passport','passport-local','passport-facebook','lodash','../models/User','default','Strategy','serializeUser','deserializeUser','findById','use','findOne','toLowerCase','Email\x20','\x20not\x20found.'];(function(_0x5349ab,_0x22fe6e){var _0x21cee6=function(_0x5a9114){while(--_0x5a9114){_0x5349ab['push'](_0x5349ab['shift']());}};_0x21cee6(++_0x22fe6e);}(a1_0x4bd4,0x153));var a1_0x449c=function(_0x5e7566,_0x15ed08){_0x5e7566=_0x5e7566-0x0;var _0x442cfb=a1_0x4bd4[_0x5e7566];return _0x442cfb;};'use strict';var __importDefault=this&&this[a1_0x449c('0x0')]||function(_0x539ff5){return _0x539ff5&&_0x539ff5[a1_0x449c('0x1')]?_0x539ff5:{'default':_0x539ff5};};Object[a1_0x449c('0x2')](exports,a1_0x449c('0x1'),{'value':!![]});const passport_1=__importDefault(require(a1_0x449c('0x3')));const passport_local_1=__importDefault(require(a1_0x449c('0x4')));const passport_facebook_1=__importDefault(require(a1_0x449c('0x5')));const lodash_1=__importDefault(require(a1_0x449c('0x6')));const User_1=__importDefault(require(a1_0x449c('0x7')));const LocalStrategy=passport_local_1[a1_0x449c('0x8')][a1_0x449c('0x9')];const FacebookStrategy=passport_facebook_1[a1_0x449c('0x8')]['Strategy'];passport_1[a1_0x449c('0x8')][a1_0x449c('0xa')]((_0x5ec4d1,_0x55e1b6)=>{_0x55e1b6(undefined,_0x5ec4d1['id']);});passport_1['default'][a1_0x449c('0xb')]((_0x305748,_0x5b2664)=>{User_1[a1_0x449c('0x8')][a1_0x449c('0xc')](_0x305748,(_0x34f4f6,_0x30f12d)=>{_0x5b2664(_0x34f4f6,_0x30f12d);});});passport_1[a1_0x449c('0x8')][a1_0x449c('0xd')](new LocalStrategy({'usernameField':'email'},(_0x81b967,_0x1eba9f,_0x206f2f)=>{User_1[a1_0x449c('0x8')][a1_0x449c('0xe')]({'email':_0x81b967[a1_0x449c('0xf')]()},(_0x11cfca,_0x378b5d)=>{if(_0x11cfca){return _0x206f2f(_0x11cfca);}if(!_0x378b5d){return _0x206f2f(undefined,![],{'message':a1_0x449c('0x10')+_0x81b967+a1_0x449c('0x11')});}_0x378b5d[a1_0x449c('0x12')](_0x1eba9f,(_0x11cfca,_0x58fc2d)=>{if(_0x11cfca){return _0x206f2f(_0x11cfca);}if(_0x58fc2d){return _0x206f2f(undefined,_0x378b5d);}return _0x206f2f(undefined,![],{'message':a1_0x449c('0x13')});});});}));passport_1[a1_0x449c('0x8')][a1_0x449c('0xd')](new FacebookStrategy({'clientID':process[a1_0x449c('0x14')]['FACEBOOK_ID'],'clientSecret':process[a1_0x449c('0x14')][a1_0x449c('0x15')],'callbackURL':'/auth/facebook/callback','profileFields':[a1_0x449c('0x16'),'email',a1_0x449c('0x17'),'locale',a1_0x449c('0x18')],'passReqToCallback':!![]},(_0x4c40af,_0xd688ec,_0x6d79c4,_0x163814,_0x39b10b)=>{if(_0x4c40af[a1_0x449c('0x19')]){User_1[a1_0x449c('0x8')][a1_0x449c('0xe')]({'facebook':_0x163814['id']},(_0x45bbc9,_0xb6733e)=>{if(_0x45bbc9){return _0x39b10b(_0x45bbc9);}if(_0xb6733e){_0x4c40af['flash'](a1_0x449c('0x1a'),{'msg':'There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.'});_0x39b10b(_0x45bbc9);}else{User_1[a1_0x449c('0x8')][a1_0x449c('0xc')](_0x4c40af[a1_0x449c('0x19')]['id'],(_0x45bbc9,_0x3ecf09)=>{if(_0x45bbc9){return _0x39b10b(_0x45bbc9);}_0x3ecf09['facebook']=_0x163814['id'];_0x3ecf09[a1_0x449c('0x1b')][a1_0x449c('0x1c')]({'kind':a1_0x449c('0x1d'),'accessToken':_0xd688ec});_0x3ecf09['profile'][a1_0x449c('0x16')]=_0x3ecf09[a1_0x449c('0x1e')][a1_0x449c('0x16')]||_0x163814[a1_0x449c('0x16')][a1_0x449c('0x1f')]+'\x20'+_0x163814[a1_0x449c('0x16')][a1_0x449c('0x20')];_0x3ecf09[a1_0x449c('0x1e')]['gender']=_0x3ecf09[a1_0x449c('0x1e')][a1_0x449c('0x21')]||_0x163814[a1_0x449c('0x22')]['gender'];_0x3ecf09[a1_0x449c('0x1e')][a1_0x449c('0x23')]=_0x3ecf09[a1_0x449c('0x1e')]['picture']||'https://graph.facebook.com/'+_0x163814['id']+a1_0x449c('0x24');_0x3ecf09[a1_0x449c('0x25')](_0x45bbc9=>{_0x4c40af['flash'](a1_0x449c('0x26'),{'msg':a1_0x449c('0x27')});_0x39b10b(_0x45bbc9,_0x3ecf09);});});}});}else{User_1['default'][a1_0x449c('0xe')]({'facebook':_0x163814['id']},(_0x1fdc1b,_0x265d90)=>{if(_0x1fdc1b){return _0x39b10b(_0x1fdc1b);}if(_0x265d90){return _0x39b10b(undefined,_0x265d90);}User_1[a1_0x449c('0x8')]['findOne']({'email':_0x163814[a1_0x449c('0x22')]['email']},(_0x1fdc1b,_0x1d14f3)=>{if(_0x1fdc1b){return _0x39b10b(_0x1fdc1b);}if(_0x1d14f3){_0x4c40af['flash'](a1_0x449c('0x1a'),{'msg':a1_0x449c('0x28')});_0x39b10b(_0x1fdc1b);}else{const _0xfa6c97=new User_1[(a1_0x449c('0x8'))]();_0xfa6c97[a1_0x449c('0x29')]=_0x163814['_json'][a1_0x449c('0x29')];_0xfa6c97[a1_0x449c('0x1d')]=_0x163814['id'];_0xfa6c97[a1_0x449c('0x1b')][a1_0x449c('0x1c')]({'kind':a1_0x449c('0x1d'),'accessToken':_0xd688ec});_0xfa6c97['profile'][a1_0x449c('0x16')]=_0x163814[a1_0x449c('0x16')][a1_0x449c('0x1f')]+'\x20'+_0x163814[a1_0x449c('0x16')][a1_0x449c('0x20')];_0xfa6c97[a1_0x449c('0x1e')]['gender']=_0x163814['_json']['gender'];_0xfa6c97[a1_0x449c('0x1e')][a1_0x449c('0x23')]=a1_0x449c('0x2a')+_0x163814['id']+a1_0x449c('0x24');_0xfa6c97['profile']['location']=_0x163814[a1_0x449c('0x22')]['location']?_0x163814[a1_0x449c('0x22')][a1_0x449c('0x2b')][a1_0x449c('0x16')]:'';_0xfa6c97[a1_0x449c('0x25')](_0x1fdc1b=>{_0x39b10b(_0x1fdc1b,_0xfa6c97);});}});});}}));exports['isAuthenticated']=(_0x2394f2,_0x415d13,_0x590126)=>{if(_0x2394f2['isAuthenticated']()){return _0x590126();}_0x415d13[a1_0x449c('0x2c')](a1_0x449c('0x2d'));};exports['isAuthorized']=(_0x163d18,_0x3cc28c,_0x5df817)=>{const _0x3d2fc0=_0x163d18[a1_0x449c('0x2e')][a1_0x449c('0x2f')]('/')[a1_0x449c('0x30')](-0x1)[0x0];if(lodash_1[a1_0x449c('0x8')][a1_0x449c('0x31')](_0x163d18[a1_0x449c('0x19')][a1_0x449c('0x1b')],{'kind':_0x3d2fc0})){_0x5df817();}else{_0x3cc28c[a1_0x449c('0x2c')](a1_0x449c('0x32')+_0x3d2fc0);}};
var a1_0x18fc=['redirect','isAuthorized','path','split','slice','find','/auth/','__importDefault','defineProperty','__esModule','passport-local','passport-facebook','lodash','../models/User','default','Strategy','serializeUser','deserializeUser','findById','use','toLowerCase','Email\x20','\x20not\x20found.','comparePassword','Invalid\x20email\x20or\x20password.','env','FACEBOOK_ID','FACEBOOK_SECRET','/auth/facebook/callback','email','link','locale','timezone','user','findOne','facebook','tokens','profile','name','familyName','gender','_json','picture','https://graph.facebook.com/','/picture?type=large','save','flash','info','Facebook\x20account\x20has\x20been\x20linked.','errors','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','push','location'];(function(_0x2eaac5,_0x37a462){var _0x4798b5=function(_0x33a2cb){while(--_0x33a2cb){_0x2eaac5['push'](_0x2eaac5['shift']());}};_0x4798b5(++_0x37a462);}(a1_0x18fc,0x145));var a1_0x58af=function(_0x226ad8,_0x572fce){_0x226ad8=_0x226ad8-0x0;var _0x5ca9e6=a1_0x18fc[_0x226ad8];return _0x5ca9e6;};'use strict';var __importDefault=this&&this[a1_0x58af('0x0')]||function(_0x3241af){return _0x3241af&&_0x3241af['__esModule']?_0x3241af:{'default':_0x3241af};};Object[a1_0x58af('0x1')](exports,a1_0x58af('0x2'),{'value':!![]});const passport_1=__importDefault(require('passport'));const passport_local_1=__importDefault(require(a1_0x58af('0x3')));const passport_facebook_1=__importDefault(require(a1_0x58af('0x4')));const lodash_1=__importDefault(require(a1_0x58af('0x5')));const User_1=__importDefault(require(a1_0x58af('0x6')));const LocalStrategy=passport_local_1[a1_0x58af('0x7')]['Strategy'];const FacebookStrategy=passport_facebook_1[a1_0x58af('0x7')][a1_0x58af('0x8')];passport_1[a1_0x58af('0x7')][a1_0x58af('0x9')]((_0x58e67e,_0x4dd6af)=>{_0x4dd6af(undefined,_0x58e67e['id']);});passport_1['default'][a1_0x58af('0xa')]((_0x271445,_0x19fd59)=>{User_1[a1_0x58af('0x7')][a1_0x58af('0xb')](_0x271445,(_0x5b2b42,_0x42e32b)=>{_0x19fd59(_0x5b2b42,_0x42e32b);});});passport_1[a1_0x58af('0x7')][a1_0x58af('0xc')](new LocalStrategy({'usernameField':'email'},(_0x505fdb,_0x53835f,_0xaef137)=>{User_1[a1_0x58af('0x7')]['findOne']({'email':_0x505fdb[a1_0x58af('0xd')]()},(_0x3e3889,_0x222550)=>{if(_0x3e3889){return _0xaef137(_0x3e3889);}if(!_0x222550){return _0xaef137(undefined,![],{'message':a1_0x58af('0xe')+_0x505fdb+a1_0x58af('0xf')});}_0x222550[a1_0x58af('0x10')](_0x53835f,(_0x3e3889,_0x22ac02)=>{if(_0x3e3889){return _0xaef137(_0x3e3889);}if(_0x22ac02){return _0xaef137(undefined,_0x222550);}return _0xaef137(undefined,![],{'message':a1_0x58af('0x11')});});});}));passport_1[a1_0x58af('0x7')][a1_0x58af('0xc')](new FacebookStrategy({'clientID':process[a1_0x58af('0x12')][a1_0x58af('0x13')],'clientSecret':process[a1_0x58af('0x12')][a1_0x58af('0x14')],'callbackURL':a1_0x58af('0x15'),'profileFields':['name',a1_0x58af('0x16'),a1_0x58af('0x17'),a1_0x58af('0x18'),a1_0x58af('0x19')],'passReqToCallback':!![]},(_0x393933,_0x25f2a7,_0x1585b7,_0xaa0629,_0x5aaba5)=>{if(_0x393933[a1_0x58af('0x1a')]){User_1['default'][a1_0x58af('0x1b')]({'facebook':_0xaa0629['id']},(_0x44e133,_0x26eea1)=>{if(_0x44e133){return _0x5aaba5(_0x44e133);}if(_0x26eea1){_0x393933['flash']('errors',{'msg':'There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.'});_0x5aaba5(_0x44e133);}else{User_1[a1_0x58af('0x7')][a1_0x58af('0xb')](_0x393933[a1_0x58af('0x1a')]['id'],(_0x44e133,_0x37711f)=>{if(_0x44e133){return _0x5aaba5(_0x44e133);}_0x37711f[a1_0x58af('0x1c')]=_0xaa0629['id'];_0x37711f[a1_0x58af('0x1d')]['push']({'kind':a1_0x58af('0x1c'),'accessToken':_0x25f2a7});_0x37711f[a1_0x58af('0x1e')]['name']=_0x37711f[a1_0x58af('0x1e')][a1_0x58af('0x1f')]||_0xaa0629['name']['givenName']+'\x20'+_0xaa0629[a1_0x58af('0x1f')][a1_0x58af('0x20')];_0x37711f[a1_0x58af('0x1e')][a1_0x58af('0x21')]=_0x37711f[a1_0x58af('0x1e')][a1_0x58af('0x21')]||_0xaa0629[a1_0x58af('0x22')]['gender'];_0x37711f[a1_0x58af('0x1e')][a1_0x58af('0x23')]=_0x37711f[a1_0x58af('0x1e')][a1_0x58af('0x23')]||a1_0x58af('0x24')+_0xaa0629['id']+a1_0x58af('0x25');_0x37711f[a1_0x58af('0x26')](_0x44e133=>{_0x393933[a1_0x58af('0x27')](a1_0x58af('0x28'),{'msg':a1_0x58af('0x29')});_0x5aaba5(_0x44e133,_0x37711f);});});}});}else{User_1['default'][a1_0x58af('0x1b')]({'facebook':_0xaa0629['id']},(_0x3cfff6,_0x460e31)=>{if(_0x3cfff6){return _0x5aaba5(_0x3cfff6);}if(_0x460e31){return _0x5aaba5(undefined,_0x460e31);}User_1[a1_0x58af('0x7')][a1_0x58af('0x1b')]({'email':_0xaa0629[a1_0x58af('0x22')][a1_0x58af('0x16')]},(_0x3cfff6,_0x183343)=>{if(_0x3cfff6){return _0x5aaba5(_0x3cfff6);}if(_0x183343){_0x393933[a1_0x58af('0x27')](a1_0x58af('0x2a'),{'msg':a1_0x58af('0x2b')});_0x5aaba5(_0x3cfff6);}else{const _0x15b183=new User_1[(a1_0x58af('0x7'))]();_0x15b183[a1_0x58af('0x16')]=_0xaa0629[a1_0x58af('0x22')][a1_0x58af('0x16')];_0x15b183[a1_0x58af('0x1c')]=_0xaa0629['id'];_0x15b183[a1_0x58af('0x1d')][a1_0x58af('0x2c')]({'kind':a1_0x58af('0x1c'),'accessToken':_0x25f2a7});_0x15b183[a1_0x58af('0x1e')][a1_0x58af('0x1f')]=_0xaa0629[a1_0x58af('0x1f')]['givenName']+'\x20'+_0xaa0629[a1_0x58af('0x1f')][a1_0x58af('0x20')];_0x15b183['profile'][a1_0x58af('0x21')]=_0xaa0629['_json'][a1_0x58af('0x21')];_0x15b183[a1_0x58af('0x1e')][a1_0x58af('0x23')]=a1_0x58af('0x24')+_0xaa0629['id']+a1_0x58af('0x25');_0x15b183[a1_0x58af('0x1e')][a1_0x58af('0x2d')]=_0xaa0629[a1_0x58af('0x22')][a1_0x58af('0x2d')]?_0xaa0629[a1_0x58af('0x22')][a1_0x58af('0x2d')][a1_0x58af('0x1f')]:'';_0x15b183[a1_0x58af('0x26')](_0x3cfff6=>{_0x5aaba5(_0x3cfff6,_0x15b183);});}});});}}));exports['isAuthenticated']=(_0x3da7e4,_0x3ca107,_0x1f891e)=>{if(_0x3da7e4['isAuthenticated']()){return _0x1f891e();}_0x3ca107[a1_0x58af('0x2e')]('/login');};exports[a1_0x58af('0x2f')]=(_0x126985,_0x4a531f,_0x532eaf)=>{const _0x466956=_0x126985[a1_0x58af('0x30')][a1_0x58af('0x31')]('/')[a1_0x58af('0x32')](-0x1)[0x0];if(lodash_1[a1_0x58af('0x7')][a1_0x58af('0x33')](_0x126985[a1_0x58af('0x1a')]['tokens'],{'kind':_0x466956})){_0x532eaf();}else{_0x4a531f[a1_0x58af('0x2e')](a1_0x58af('0x34')+_0x466956);}};
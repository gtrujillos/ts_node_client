var a1_0x5510=['familyName','location','save','isAuthenticated','redirect','/login','isAuthorized','path','split','find','/auth/','__importDefault','__esModule','passport','passport-local','passport-facebook','lodash','../models/User','default','Strategy','deserializeUser','findById','use','toLowerCase','\x20not\x20found.','comparePassword','env','FACEBOOK_ID','FACEBOOK_SECRET','email','link','locale','timezone','user','flash','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','facebook','push','profile','name','givenName','gender','picture','https://graph.facebook.com/','/picture?type=large','Facebook\x20account\x20has\x20been\x20linked.','findOne','_json','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','tokens'];(function(_0x2e2e2f,_0x1649a5){var _0x2dc62c=function(_0x40a49d){while(--_0x40a49d){_0x2e2e2f['push'](_0x2e2e2f['shift']());}};_0x2dc62c(++_0x1649a5);}(a1_0x5510,0x13d));var a1_0x36c1=function(_0x2d0394,_0xd2689){_0x2d0394=_0x2d0394-0x0;var _0x367908=a1_0x5510[_0x2d0394];return _0x367908;};'use strict';var __importDefault=this&&this[a1_0x36c1('0x0')]||function(_0x577f1d){return _0x577f1d&&_0x577f1d['__esModule']?_0x577f1d:{'default':_0x577f1d};};Object['defineProperty'](exports,a1_0x36c1('0x1'),{'value':!![]});const passport_1=__importDefault(require(a1_0x36c1('0x2')));const passport_local_1=__importDefault(require(a1_0x36c1('0x3')));const passport_facebook_1=__importDefault(require(a1_0x36c1('0x4')));const lodash_1=__importDefault(require(a1_0x36c1('0x5')));const User_1=__importDefault(require(a1_0x36c1('0x6')));const LocalStrategy=passport_local_1[a1_0x36c1('0x7')][a1_0x36c1('0x8')];const FacebookStrategy=passport_facebook_1['default'][a1_0x36c1('0x8')];passport_1[a1_0x36c1('0x7')]['serializeUser']((_0x4b1479,_0x32bb57)=>{_0x32bb57(undefined,_0x4b1479['id']);});passport_1[a1_0x36c1('0x7')][a1_0x36c1('0x9')]((_0x55a406,_0x5d9770)=>{User_1[a1_0x36c1('0x7')][a1_0x36c1('0xa')](_0x55a406,(_0x3facb9,_0x203735)=>{_0x5d9770(_0x3facb9,_0x203735);});});passport_1['default'][a1_0x36c1('0xb')](new LocalStrategy({'usernameField':'email'},(_0x368d65,_0x2436e6,_0x39a2f7)=>{User_1[a1_0x36c1('0x7')]['findOne']({'email':_0x368d65[a1_0x36c1('0xc')]()},(_0x465c59,_0x1b136f)=>{if(_0x465c59){return _0x39a2f7(_0x465c59);}if(!_0x1b136f){return _0x39a2f7(undefined,![],{'message':'Email\x20'+_0x368d65+a1_0x36c1('0xd')});}_0x1b136f[a1_0x36c1('0xe')](_0x2436e6,(_0x465c59,_0xd80ad9)=>{if(_0x465c59){return _0x39a2f7(_0x465c59);}if(_0xd80ad9){return _0x39a2f7(undefined,_0x1b136f);}return _0x39a2f7(undefined,![],{'message':'Invalid\x20email\x20or\x20password.'});});});}));passport_1[a1_0x36c1('0x7')][a1_0x36c1('0xb')](new FacebookStrategy({'clientID':process[a1_0x36c1('0xf')][a1_0x36c1('0x10')],'clientSecret':process[a1_0x36c1('0xf')][a1_0x36c1('0x11')],'callbackURL':'/auth/facebook/callback','profileFields':['name',a1_0x36c1('0x12'),a1_0x36c1('0x13'),a1_0x36c1('0x14'),a1_0x36c1('0x15')],'passReqToCallback':!![]},(_0x4d6e75,_0x553ebd,_0x20b558,_0x335db1,_0x56243f)=>{if(_0x4d6e75[a1_0x36c1('0x16')]){User_1[a1_0x36c1('0x7')]['findOne']({'facebook':_0x335db1['id']},(_0x4a5de3,_0x49d1ea)=>{if(_0x4a5de3){return _0x56243f(_0x4a5de3);}if(_0x49d1ea){_0x4d6e75[a1_0x36c1('0x17')](a1_0x36c1('0x18'),{'msg':a1_0x36c1('0x19')});_0x56243f(_0x4a5de3);}else{User_1[a1_0x36c1('0x7')]['findById'](_0x4d6e75['user']['id'],(_0x4a5de3,_0x2cb1c3)=>{if(_0x4a5de3){return _0x56243f(_0x4a5de3);}_0x2cb1c3[a1_0x36c1('0x1a')]=_0x335db1['id'];_0x2cb1c3['tokens'][a1_0x36c1('0x1b')]({'kind':'facebook','accessToken':_0x553ebd});_0x2cb1c3[a1_0x36c1('0x1c')][a1_0x36c1('0x1d')]=_0x2cb1c3[a1_0x36c1('0x1c')][a1_0x36c1('0x1d')]||_0x335db1[a1_0x36c1('0x1d')][a1_0x36c1('0x1e')]+'\x20'+_0x335db1[a1_0x36c1('0x1d')]['familyName'];_0x2cb1c3[a1_0x36c1('0x1c')][a1_0x36c1('0x1f')]=_0x2cb1c3['profile'][a1_0x36c1('0x1f')]||_0x335db1['_json'][a1_0x36c1('0x1f')];_0x2cb1c3[a1_0x36c1('0x1c')][a1_0x36c1('0x20')]=_0x2cb1c3['profile'][a1_0x36c1('0x20')]||a1_0x36c1('0x21')+_0x335db1['id']+a1_0x36c1('0x22');_0x2cb1c3['save'](_0x4a5de3=>{_0x4d6e75[a1_0x36c1('0x17')]('info',{'msg':a1_0x36c1('0x23')});_0x56243f(_0x4a5de3,_0x2cb1c3);});});}});}else{User_1[a1_0x36c1('0x7')]['findOne']({'facebook':_0x335db1['id']},(_0x27cf07,_0x5a549b)=>{if(_0x27cf07){return _0x56243f(_0x27cf07);}if(_0x5a549b){return _0x56243f(undefined,_0x5a549b);}User_1[a1_0x36c1('0x7')][a1_0x36c1('0x24')]({'email':_0x335db1[a1_0x36c1('0x25')]['email']},(_0x27cf07,_0x42e1e6)=>{if(_0x27cf07){return _0x56243f(_0x27cf07);}if(_0x42e1e6){_0x4d6e75[a1_0x36c1('0x17')](a1_0x36c1('0x18'),{'msg':a1_0x36c1('0x26')});_0x56243f(_0x27cf07);}else{const _0x291275=new User_1[(a1_0x36c1('0x7'))]();_0x291275[a1_0x36c1('0x12')]=_0x335db1[a1_0x36c1('0x25')][a1_0x36c1('0x12')];_0x291275['facebook']=_0x335db1['id'];_0x291275[a1_0x36c1('0x27')]['push']({'kind':a1_0x36c1('0x1a'),'accessToken':_0x553ebd});_0x291275[a1_0x36c1('0x1c')][a1_0x36c1('0x1d')]=_0x335db1['name'][a1_0x36c1('0x1e')]+'\x20'+_0x335db1['name'][a1_0x36c1('0x28')];_0x291275[a1_0x36c1('0x1c')][a1_0x36c1('0x1f')]=_0x335db1[a1_0x36c1('0x25')][a1_0x36c1('0x1f')];_0x291275[a1_0x36c1('0x1c')]['picture']=a1_0x36c1('0x21')+_0x335db1['id']+a1_0x36c1('0x22');_0x291275[a1_0x36c1('0x1c')][a1_0x36c1('0x29')]=_0x335db1[a1_0x36c1('0x25')][a1_0x36c1('0x29')]?_0x335db1[a1_0x36c1('0x25')][a1_0x36c1('0x29')][a1_0x36c1('0x1d')]:'';_0x291275[a1_0x36c1('0x2a')](_0x27cf07=>{_0x56243f(_0x27cf07,_0x291275);});}});});}}));exports[a1_0x36c1('0x2b')]=(_0x53f3e1,_0x5b4fe2,_0x4ac9e1)=>{if(_0x53f3e1['isAuthenticated']()){return _0x4ac9e1();}_0x5b4fe2[a1_0x36c1('0x2c')](a1_0x36c1('0x2d'));};exports[a1_0x36c1('0x2e')]=(_0x3fee1f,_0x3c2fbd,_0x744ea1)=>{const _0x2d0e6d=_0x3fee1f[a1_0x36c1('0x2f')][a1_0x36c1('0x30')]('/')['slice'](-0x1)[0x0];if(lodash_1['default'][a1_0x36c1('0x31')](_0x3fee1f[a1_0x36c1('0x16')][a1_0x36c1('0x27')],{'kind':_0x2d0e6d})){_0x744ea1();}else{_0x3c2fbd[a1_0x36c1('0x2c')](a1_0x36c1('0x32')+_0x2d0e6d);}};
var a1_0x1f7b=['env','FACEBOOK_SECRET','/auth/facebook/callback','name','link','locale','user','flash','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','tokens','push','facebook','profile','givenName','familyName','gender','_json','picture','https://graph.facebook.com/','/picture?type=large','save','Facebook\x20account\x20has\x20been\x20linked.','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','location','isAuthenticated','redirect','/login','path','split','slice','find','defineProperty','passport','passport-local','passport-facebook','../models/User','default','Strategy','serializeUser','findById','email','findOne','toLowerCase','Email\x20','\x20not\x20found.','comparePassword','Invalid\x20email\x20or\x20password.','use','FACEBOOK_ID'];(function(_0x3c079a,_0x558ea4){var _0x51693c=function(_0x414eb1){while(--_0x414eb1){_0x3c079a['push'](_0x3c079a['shift']());}};_0x51693c(++_0x558ea4);}(a1_0x1f7b,0x14c));var a1_0x3873=function(_0x1c9c07,_0x282e14){_0x1c9c07=_0x1c9c07-0x0;var _0x34c603=a1_0x1f7b[_0x1c9c07];return _0x34c603;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x123237){return _0x123237&&_0x123237['__esModule']?_0x123237:{'default':_0x123237};};Object[a1_0x3873('0x0')](exports,'__esModule',{'value':!![]});const passport_1=__importDefault(require(a1_0x3873('0x1')));const passport_local_1=__importDefault(require(a1_0x3873('0x2')));const passport_facebook_1=__importDefault(require(a1_0x3873('0x3')));const lodash_1=__importDefault(require('lodash'));const User_1=__importDefault(require(a1_0x3873('0x4')));const LocalStrategy=passport_local_1[a1_0x3873('0x5')]['Strategy'];const FacebookStrategy=passport_facebook_1[a1_0x3873('0x5')][a1_0x3873('0x6')];passport_1[a1_0x3873('0x5')][a1_0x3873('0x7')]((_0x110456,_0x2a623a)=>{_0x2a623a(undefined,_0x110456['id']);});passport_1['default']['deserializeUser']((_0x47394b,_0x365aac)=>{User_1[a1_0x3873('0x5')][a1_0x3873('0x8')](_0x47394b,(_0x4da180,_0x57286a)=>{_0x365aac(_0x4da180,_0x57286a);});});passport_1['default']['use'](new LocalStrategy({'usernameField':a1_0x3873('0x9')},(_0x5936ee,_0x308121,_0x1886a4)=>{User_1['default'][a1_0x3873('0xa')]({'email':_0x5936ee[a1_0x3873('0xb')]()},(_0x194e21,_0xef6894)=>{if(_0x194e21){return _0x1886a4(_0x194e21);}if(!_0xef6894){return _0x1886a4(undefined,![],{'message':a1_0x3873('0xc')+_0x5936ee+a1_0x3873('0xd')});}_0xef6894[a1_0x3873('0xe')](_0x308121,(_0x194e21,_0x4b3db8)=>{if(_0x194e21){return _0x1886a4(_0x194e21);}if(_0x4b3db8){return _0x1886a4(undefined,_0xef6894);}return _0x1886a4(undefined,![],{'message':a1_0x3873('0xf')});});});}));passport_1[a1_0x3873('0x5')][a1_0x3873('0x10')](new FacebookStrategy({'clientID':process['env'][a1_0x3873('0x11')],'clientSecret':process[a1_0x3873('0x12')][a1_0x3873('0x13')],'callbackURL':a1_0x3873('0x14'),'profileFields':[a1_0x3873('0x15'),a1_0x3873('0x9'),a1_0x3873('0x16'),a1_0x3873('0x17'),'timezone'],'passReqToCallback':!![]},(_0x255a79,_0x4d0b42,_0x4a1fbb,_0x3d8442,_0x431668)=>{if(_0x255a79[a1_0x3873('0x18')]){User_1[a1_0x3873('0x5')][a1_0x3873('0xa')]({'facebook':_0x3d8442['id']},(_0x1293d7,_0x39932d)=>{if(_0x1293d7){return _0x431668(_0x1293d7);}if(_0x39932d){_0x255a79[a1_0x3873('0x19')](a1_0x3873('0x1a'),{'msg':a1_0x3873('0x1b')});_0x431668(_0x1293d7);}else{User_1[a1_0x3873('0x5')]['findById'](_0x255a79[a1_0x3873('0x18')]['id'],(_0x1293d7,_0x3b662d)=>{if(_0x1293d7){return _0x431668(_0x1293d7);}_0x3b662d['facebook']=_0x3d8442['id'];_0x3b662d[a1_0x3873('0x1c')][a1_0x3873('0x1d')]({'kind':a1_0x3873('0x1e'),'accessToken':_0x4d0b42});_0x3b662d['profile'][a1_0x3873('0x15')]=_0x3b662d[a1_0x3873('0x1f')][a1_0x3873('0x15')]||_0x3d8442[a1_0x3873('0x15')][a1_0x3873('0x20')]+'\x20'+_0x3d8442[a1_0x3873('0x15')][a1_0x3873('0x21')];_0x3b662d['profile'][a1_0x3873('0x22')]=_0x3b662d['profile']['gender']||_0x3d8442[a1_0x3873('0x23')][a1_0x3873('0x22')];_0x3b662d[a1_0x3873('0x1f')][a1_0x3873('0x24')]=_0x3b662d[a1_0x3873('0x1f')]['picture']||a1_0x3873('0x25')+_0x3d8442['id']+a1_0x3873('0x26');_0x3b662d[a1_0x3873('0x27')](_0x1293d7=>{_0x255a79[a1_0x3873('0x19')]('info',{'msg':a1_0x3873('0x28')});_0x431668(_0x1293d7,_0x3b662d);});});}});}else{User_1[a1_0x3873('0x5')][a1_0x3873('0xa')]({'facebook':_0x3d8442['id']},(_0x415144,_0x2870a9)=>{if(_0x415144){return _0x431668(_0x415144);}if(_0x2870a9){return _0x431668(undefined,_0x2870a9);}User_1[a1_0x3873('0x5')][a1_0x3873('0xa')]({'email':_0x3d8442[a1_0x3873('0x23')]['email']},(_0x415144,_0x4bff06)=>{if(_0x415144){return _0x431668(_0x415144);}if(_0x4bff06){_0x255a79[a1_0x3873('0x19')](a1_0x3873('0x1a'),{'msg':a1_0x3873('0x29')});_0x431668(_0x415144);}else{const _0x516f5e=new User_1[(a1_0x3873('0x5'))]();_0x516f5e[a1_0x3873('0x9')]=_0x3d8442['_json'][a1_0x3873('0x9')];_0x516f5e['facebook']=_0x3d8442['id'];_0x516f5e[a1_0x3873('0x1c')][a1_0x3873('0x1d')]({'kind':a1_0x3873('0x1e'),'accessToken':_0x4d0b42});_0x516f5e[a1_0x3873('0x1f')][a1_0x3873('0x15')]=_0x3d8442[a1_0x3873('0x15')]['givenName']+'\x20'+_0x3d8442[a1_0x3873('0x15')][a1_0x3873('0x21')];_0x516f5e[a1_0x3873('0x1f')][a1_0x3873('0x22')]=_0x3d8442[a1_0x3873('0x23')][a1_0x3873('0x22')];_0x516f5e['profile'][a1_0x3873('0x24')]='https://graph.facebook.com/'+_0x3d8442['id']+a1_0x3873('0x26');_0x516f5e[a1_0x3873('0x1f')][a1_0x3873('0x2a')]=_0x3d8442[a1_0x3873('0x23')][a1_0x3873('0x2a')]?_0x3d8442[a1_0x3873('0x23')][a1_0x3873('0x2a')][a1_0x3873('0x15')]:'';_0x516f5e['save'](_0x415144=>{_0x431668(_0x415144,_0x516f5e);});}});});}}));exports[a1_0x3873('0x2b')]=(_0x4c93a0,_0x5d9eff,_0x3df638)=>{if(_0x4c93a0[a1_0x3873('0x2b')]()){return _0x3df638();}_0x5d9eff[a1_0x3873('0x2c')](a1_0x3873('0x2d'));};exports['isAuthorized']=(_0x23d1e2,_0x5d3421,_0x502eed)=>{const _0x5e0ed3=_0x23d1e2[a1_0x3873('0x2e')][a1_0x3873('0x2f')]('/')[a1_0x3873('0x30')](-0x1)[0x0];if(lodash_1[a1_0x3873('0x5')][a1_0x3873('0x31')](_0x23d1e2[a1_0x3873('0x18')][a1_0x3873('0x1c')],{'kind':_0x5e0ed3})){_0x502eed();}else{_0x5d3421[a1_0x3873('0x2c')]('/auth/'+_0x5e0ed3);}};
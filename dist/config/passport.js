var a1_0x5bda=['locale','flash','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','user','facebook','tokens','profile','givenName','familyName','gender','_json','picture','https://graph.facebook.com/','/picture?type=large','save','info','Facebook\x20account\x20has\x20been\x20linked.','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','push','location','isAuthenticated','/login','isAuthorized','split','slice','redirect','/auth/','__esModule','defineProperty','passport','lodash','../models/User','default','Strategy','serializeUser','deserializeUser','findById','use','email','findOne','toLowerCase','Email\x20','\x20not\x20found.','Invalid\x20email\x20or\x20password.','env','FACEBOOK_ID','FACEBOOK_SECRET','/auth/facebook/callback','name','link'];(function(_0x2d8f05,_0x4b81bb){var _0x4d74cb=function(_0x32719f){while(--_0x32719f){_0x2d8f05['push'](_0x2d8f05['shift']());}};_0x4d74cb(++_0x4b81bb);}(a1_0x5bda,0x1e7));var a1_0x4370=function(_0x1f4efb,_0x414f20){_0x1f4efb=_0x1f4efb-0x0;var _0x2db796=a1_0x5bda[_0x1f4efb];return _0x2db796;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x68ce1d){return _0x68ce1d&&_0x68ce1d[a1_0x4370('0x0')]?_0x68ce1d:{'default':_0x68ce1d};};Object[a1_0x4370('0x1')](exports,'__esModule',{'value':!![]});const passport_1=__importDefault(require(a1_0x4370('0x2')));const passport_local_1=__importDefault(require('passport-local'));const passport_facebook_1=__importDefault(require('passport-facebook'));const lodash_1=__importDefault(require(a1_0x4370('0x3')));const User_1=__importDefault(require(a1_0x4370('0x4')));const LocalStrategy=passport_local_1[a1_0x4370('0x5')][a1_0x4370('0x6')];const FacebookStrategy=passport_facebook_1[a1_0x4370('0x5')][a1_0x4370('0x6')];passport_1[a1_0x4370('0x5')][a1_0x4370('0x7')]((_0x5e79f7,_0x522643)=>{_0x522643(undefined,_0x5e79f7['id']);});passport_1['default'][a1_0x4370('0x8')]((_0x319514,_0x5e62b8)=>{User_1[a1_0x4370('0x5')][a1_0x4370('0x9')](_0x319514,(_0xb68895,_0x53eb7f)=>{_0x5e62b8(_0xb68895,_0x53eb7f);});});passport_1['default'][a1_0x4370('0xa')](new LocalStrategy({'usernameField':a1_0x4370('0xb')},(_0x1c82b8,_0x2b510b,_0x2932ab)=>{User_1['default'][a1_0x4370('0xc')]({'email':_0x1c82b8[a1_0x4370('0xd')]()},(_0x3485c8,_0x1be187)=>{if(_0x3485c8){return _0x2932ab(_0x3485c8);}if(!_0x1be187){return _0x2932ab(undefined,![],{'message':a1_0x4370('0xe')+_0x1c82b8+a1_0x4370('0xf')});}_0x1be187['comparePassword'](_0x2b510b,(_0x3485c8,_0x258b35)=>{if(_0x3485c8){return _0x2932ab(_0x3485c8);}if(_0x258b35){return _0x2932ab(undefined,_0x1be187);}return _0x2932ab(undefined,![],{'message':a1_0x4370('0x10')});});});}));passport_1['default'][a1_0x4370('0xa')](new FacebookStrategy({'clientID':process[a1_0x4370('0x11')][a1_0x4370('0x12')],'clientSecret':process[a1_0x4370('0x11')][a1_0x4370('0x13')],'callbackURL':a1_0x4370('0x14'),'profileFields':[a1_0x4370('0x15'),'email',a1_0x4370('0x16'),a1_0x4370('0x17'),'timezone'],'passReqToCallback':!![]},(_0x1465f3,_0x437607,_0x1a4b2d,_0x14705a,_0x573388)=>{if(_0x1465f3['user']){User_1[a1_0x4370('0x5')][a1_0x4370('0xc')]({'facebook':_0x14705a['id']},(_0x133482,_0x265ff1)=>{if(_0x133482){return _0x573388(_0x133482);}if(_0x265ff1){_0x1465f3[a1_0x4370('0x18')](a1_0x4370('0x19'),{'msg':a1_0x4370('0x1a')});_0x573388(_0x133482);}else{User_1['default'][a1_0x4370('0x9')](_0x1465f3[a1_0x4370('0x1b')]['id'],(_0x133482,_0x294587)=>{if(_0x133482){return _0x573388(_0x133482);}_0x294587[a1_0x4370('0x1c')]=_0x14705a['id'];_0x294587[a1_0x4370('0x1d')]['push']({'kind':a1_0x4370('0x1c'),'accessToken':_0x437607});_0x294587['profile'][a1_0x4370('0x15')]=_0x294587[a1_0x4370('0x1e')][a1_0x4370('0x15')]||_0x14705a[a1_0x4370('0x15')][a1_0x4370('0x1f')]+'\x20'+_0x14705a[a1_0x4370('0x15')][a1_0x4370('0x20')];_0x294587[a1_0x4370('0x1e')]['gender']=_0x294587[a1_0x4370('0x1e')][a1_0x4370('0x21')]||_0x14705a[a1_0x4370('0x22')][a1_0x4370('0x21')];_0x294587[a1_0x4370('0x1e')][a1_0x4370('0x23')]=_0x294587[a1_0x4370('0x1e')][a1_0x4370('0x23')]||a1_0x4370('0x24')+_0x14705a['id']+a1_0x4370('0x25');_0x294587[a1_0x4370('0x26')](_0x133482=>{_0x1465f3[a1_0x4370('0x18')](a1_0x4370('0x27'),{'msg':a1_0x4370('0x28')});_0x573388(_0x133482,_0x294587);});});}});}else{User_1[a1_0x4370('0x5')][a1_0x4370('0xc')]({'facebook':_0x14705a['id']},(_0x1f315e,_0x360298)=>{if(_0x1f315e){return _0x573388(_0x1f315e);}if(_0x360298){return _0x573388(undefined,_0x360298);}User_1[a1_0x4370('0x5')]['findOne']({'email':_0x14705a[a1_0x4370('0x22')][a1_0x4370('0xb')]},(_0x1f315e,_0x4c9e30)=>{if(_0x1f315e){return _0x573388(_0x1f315e);}if(_0x4c9e30){_0x1465f3[a1_0x4370('0x18')](a1_0x4370('0x19'),{'msg':a1_0x4370('0x29')});_0x573388(_0x1f315e);}else{const _0x430ede=new User_1[(a1_0x4370('0x5'))]();_0x430ede[a1_0x4370('0xb')]=_0x14705a[a1_0x4370('0x22')][a1_0x4370('0xb')];_0x430ede[a1_0x4370('0x1c')]=_0x14705a['id'];_0x430ede[a1_0x4370('0x1d')][a1_0x4370('0x2a')]({'kind':a1_0x4370('0x1c'),'accessToken':_0x437607});_0x430ede[a1_0x4370('0x1e')]['name']=_0x14705a['name'][a1_0x4370('0x1f')]+'\x20'+_0x14705a[a1_0x4370('0x15')][a1_0x4370('0x20')];_0x430ede['profile'][a1_0x4370('0x21')]=_0x14705a['_json'][a1_0x4370('0x21')];_0x430ede['profile'][a1_0x4370('0x23')]=a1_0x4370('0x24')+_0x14705a['id']+a1_0x4370('0x25');_0x430ede[a1_0x4370('0x1e')][a1_0x4370('0x2b')]=_0x14705a[a1_0x4370('0x22')][a1_0x4370('0x2b')]?_0x14705a[a1_0x4370('0x22')][a1_0x4370('0x2b')][a1_0x4370('0x15')]:'';_0x430ede[a1_0x4370('0x26')](_0x1f315e=>{_0x573388(_0x1f315e,_0x430ede);});}});});}}));exports[a1_0x4370('0x2c')]=(_0x4df100,_0x4bd13c,_0x2c754e)=>{if(_0x4df100[a1_0x4370('0x2c')]()){return _0x2c754e();}_0x4bd13c['redirect'](a1_0x4370('0x2d'));};exports[a1_0x4370('0x2e')]=(_0x2b5127,_0x478d0f,_0x1300a5)=>{const _0x116142=_0x2b5127['path'][a1_0x4370('0x2f')]('/')[a1_0x4370('0x30')](-0x1)[0x0];if(lodash_1[a1_0x4370('0x5')]['find'](_0x2b5127[a1_0x4370('0x1b')]['tokens'],{'kind':_0x116142})){_0x1300a5();}else{_0x478d0f[a1_0x4370('0x31')](a1_0x4370('0x32')+_0x116142);}};
var a1_0x5282=['../models/User','default','Strategy','serializeUser','deserializeUser','findById','use','findOne','Email\x20','comparePassword','Invalid\x20email\x20or\x20password.','env','FACEBOOK_ID','FACEBOOK_SECRET','/auth/facebook/callback','name','email','link','timezone','tokens','push','facebook','profile','givenName','familyName','gender','_json','picture','https://graph.facebook.com/','/picture?type=large','save','flash','info','Facebook\x20account\x20has\x20been\x20linked.','errors','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','location','isAuthenticated','redirect','isAuthorized','split','user','__importDefault','__esModule','defineProperty','passport-local','passport-facebook'];(function(_0x6b1209,_0x5133a2){var _0x2243d2=function(_0x5d2efe){while(--_0x5d2efe){_0x6b1209['push'](_0x6b1209['shift']());}};_0x2243d2(++_0x5133a2);}(a1_0x5282,0xe6));var a1_0xb58e=function(_0x4502e1,_0x49a0e7){_0x4502e1=_0x4502e1-0x0;var _0x1516bd=a1_0x5282[_0x4502e1];return _0x1516bd;};'use strict';var __importDefault=this&&this[a1_0xb58e('0x0')]||function(_0x1e4304){return _0x1e4304&&_0x1e4304[a1_0xb58e('0x1')]?_0x1e4304:{'default':_0x1e4304};};Object[a1_0xb58e('0x2')](exports,a1_0xb58e('0x1'),{'value':!![]});const passport_1=__importDefault(require('passport'));const passport_local_1=__importDefault(require(a1_0xb58e('0x3')));const passport_facebook_1=__importDefault(require(a1_0xb58e('0x4')));const lodash_1=__importDefault(require('lodash'));const User_1=__importDefault(require(a1_0xb58e('0x5')));const LocalStrategy=passport_local_1[a1_0xb58e('0x6')]['Strategy'];const FacebookStrategy=passport_facebook_1[a1_0xb58e('0x6')][a1_0xb58e('0x7')];passport_1[a1_0xb58e('0x6')][a1_0xb58e('0x8')]((_0x40d9d4,_0x3e9547)=>{_0x3e9547(undefined,_0x40d9d4['id']);});passport_1[a1_0xb58e('0x6')][a1_0xb58e('0x9')]((_0x318aec,_0x1ec6a4)=>{User_1['default'][a1_0xb58e('0xa')](_0x318aec,(_0x488a8b,_0x5502c1)=>{_0x1ec6a4(_0x488a8b,_0x5502c1);});});passport_1['default'][a1_0xb58e('0xb')](new LocalStrategy({'usernameField':'email'},(_0x1f683c,_0x409261,_0x75891d)=>{User_1['default'][a1_0xb58e('0xc')]({'email':_0x1f683c['toLowerCase']()},(_0x4d820c,_0xb5cebb)=>{if(_0x4d820c){return _0x75891d(_0x4d820c);}if(!_0xb5cebb){return _0x75891d(undefined,![],{'message':a1_0xb58e('0xd')+_0x1f683c+'\x20not\x20found.'});}_0xb5cebb[a1_0xb58e('0xe')](_0x409261,(_0x4d820c,_0x369d20)=>{if(_0x4d820c){return _0x75891d(_0x4d820c);}if(_0x369d20){return _0x75891d(undefined,_0xb5cebb);}return _0x75891d(undefined,![],{'message':a1_0xb58e('0xf')});});});}));passport_1[a1_0xb58e('0x6')][a1_0xb58e('0xb')](new FacebookStrategy({'clientID':process[a1_0xb58e('0x10')][a1_0xb58e('0x11')],'clientSecret':process['env'][a1_0xb58e('0x12')],'callbackURL':a1_0xb58e('0x13'),'profileFields':[a1_0xb58e('0x14'),a1_0xb58e('0x15'),a1_0xb58e('0x16'),'locale',a1_0xb58e('0x17')],'passReqToCallback':!![]},(_0x431b54,_0x5bcfef,_0x544d06,_0xf092d,_0xeec6e0)=>{if(_0x431b54['user']){User_1['default'][a1_0xb58e('0xc')]({'facebook':_0xf092d['id']},(_0x4fc119,_0x238293)=>{if(_0x4fc119){return _0xeec6e0(_0x4fc119);}if(_0x238293){_0x431b54['flash']('errors',{'msg':'There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.'});_0xeec6e0(_0x4fc119);}else{User_1[a1_0xb58e('0x6')][a1_0xb58e('0xa')](_0x431b54['user']['id'],(_0x4fc119,_0x5c02b8)=>{if(_0x4fc119){return _0xeec6e0(_0x4fc119);}_0x5c02b8['facebook']=_0xf092d['id'];_0x5c02b8[a1_0xb58e('0x18')][a1_0xb58e('0x19')]({'kind':a1_0xb58e('0x1a'),'accessToken':_0x5bcfef});_0x5c02b8[a1_0xb58e('0x1b')][a1_0xb58e('0x14')]=_0x5c02b8[a1_0xb58e('0x1b')]['name']||_0xf092d['name'][a1_0xb58e('0x1c')]+'\x20'+_0xf092d[a1_0xb58e('0x14')][a1_0xb58e('0x1d')];_0x5c02b8['profile'][a1_0xb58e('0x1e')]=_0x5c02b8['profile'][a1_0xb58e('0x1e')]||_0xf092d[a1_0xb58e('0x1f')][a1_0xb58e('0x1e')];_0x5c02b8[a1_0xb58e('0x1b')][a1_0xb58e('0x20')]=_0x5c02b8[a1_0xb58e('0x1b')][a1_0xb58e('0x20')]||a1_0xb58e('0x21')+_0xf092d['id']+a1_0xb58e('0x22');_0x5c02b8[a1_0xb58e('0x23')](_0x4fc119=>{_0x431b54[a1_0xb58e('0x24')](a1_0xb58e('0x25'),{'msg':a1_0xb58e('0x26')});_0xeec6e0(_0x4fc119,_0x5c02b8);});});}});}else{User_1[a1_0xb58e('0x6')]['findOne']({'facebook':_0xf092d['id']},(_0x148d6d,_0x55ea46)=>{if(_0x148d6d){return _0xeec6e0(_0x148d6d);}if(_0x55ea46){return _0xeec6e0(undefined,_0x55ea46);}User_1['default'][a1_0xb58e('0xc')]({'email':_0xf092d[a1_0xb58e('0x1f')][a1_0xb58e('0x15')]},(_0x148d6d,_0x11bf27)=>{if(_0x148d6d){return _0xeec6e0(_0x148d6d);}if(_0x11bf27){_0x431b54[a1_0xb58e('0x24')](a1_0xb58e('0x27'),{'msg':a1_0xb58e('0x28')});_0xeec6e0(_0x148d6d);}else{const _0x478a45=new User_1['default']();_0x478a45['email']=_0xf092d[a1_0xb58e('0x1f')]['email'];_0x478a45['facebook']=_0xf092d['id'];_0x478a45[a1_0xb58e('0x18')][a1_0xb58e('0x19')]({'kind':a1_0xb58e('0x1a'),'accessToken':_0x5bcfef});_0x478a45[a1_0xb58e('0x1b')]['name']=_0xf092d[a1_0xb58e('0x14')][a1_0xb58e('0x1c')]+'\x20'+_0xf092d[a1_0xb58e('0x14')][a1_0xb58e('0x1d')];_0x478a45[a1_0xb58e('0x1b')]['gender']=_0xf092d[a1_0xb58e('0x1f')][a1_0xb58e('0x1e')];_0x478a45[a1_0xb58e('0x1b')][a1_0xb58e('0x20')]='https://graph.facebook.com/'+_0xf092d['id']+a1_0xb58e('0x22');_0x478a45[a1_0xb58e('0x1b')][a1_0xb58e('0x29')]=_0xf092d[a1_0xb58e('0x1f')][a1_0xb58e('0x29')]?_0xf092d[a1_0xb58e('0x1f')]['location'][a1_0xb58e('0x14')]:'';_0x478a45['save'](_0x148d6d=>{_0xeec6e0(_0x148d6d,_0x478a45);});}});});}}));exports[a1_0xb58e('0x2a')]=(_0x15e90b,_0x145810,_0x35cbee)=>{if(_0x15e90b[a1_0xb58e('0x2a')]()){return _0x35cbee();}_0x145810[a1_0xb58e('0x2b')]('/login');};exports[a1_0xb58e('0x2c')]=(_0x38cb4f,_0x266df9,_0x507528)=>{const _0x714ddc=_0x38cb4f['path'][a1_0xb58e('0x2d')]('/')['slice'](-0x1)[0x0];if(lodash_1[a1_0xb58e('0x6')]['find'](_0x38cb4f[a1_0xb58e('0x2e')][a1_0xb58e('0x18')],{'kind':_0x714ddc})){_0x507528();}else{_0x266df9[a1_0xb58e('0x2b')]('/auth/'+_0x714ddc);}};
var a1_0x1973=['defineProperty','passport-local','passport-facebook','lodash','default','Strategy','serializeUser','deserializeUser','findById','use','email','findOne','toLowerCase','Email\x20','\x20not\x20found.','comparePassword','Invalid\x20email\x20or\x20password.','env','FACEBOOK_ID','/auth/facebook/callback','name','locale','user','flash','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','facebook','profile','givenName','familyName','gender','_json','picture','/picture?type=large','save','info','Facebook\x20account\x20has\x20been\x20linked.','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','tokens','push','location','isAuthenticated','redirect','path','find','/auth/','__importDefault','__esModule'];(function(_0x46d51a,_0x1981c9){var _0x3ed9fa=function(_0x5f1726){while(--_0x5f1726){_0x46d51a['push'](_0x46d51a['shift']());}};_0x3ed9fa(++_0x1981c9);}(a1_0x1973,0x17e));var a1_0x5d12=function(_0x4a3343,_0x1a9abb){_0x4a3343=_0x4a3343-0x0;var _0x201080=a1_0x1973[_0x4a3343];return _0x201080;};'use strict';var __importDefault=this&&this[a1_0x5d12('0x0')]||function(_0x3926cd){return _0x3926cd&&_0x3926cd[a1_0x5d12('0x1')]?_0x3926cd:{'default':_0x3926cd};};Object[a1_0x5d12('0x2')](exports,a1_0x5d12('0x1'),{'value':!![]});const passport_1=__importDefault(require('passport'));const passport_local_1=__importDefault(require(a1_0x5d12('0x3')));const passport_facebook_1=__importDefault(require(a1_0x5d12('0x4')));const lodash_1=__importDefault(require(a1_0x5d12('0x5')));const User_1=__importDefault(require('../models/User'));const LocalStrategy=passport_local_1[a1_0x5d12('0x6')]['Strategy'];const FacebookStrategy=passport_facebook_1[a1_0x5d12('0x6')][a1_0x5d12('0x7')];passport_1[a1_0x5d12('0x6')][a1_0x5d12('0x8')]((_0x3a1fb9,_0x47dfe6)=>{_0x47dfe6(undefined,_0x3a1fb9['id']);});passport_1[a1_0x5d12('0x6')][a1_0x5d12('0x9')]((_0x2ed9cd,_0x50c8b2)=>{User_1[a1_0x5d12('0x6')][a1_0x5d12('0xa')](_0x2ed9cd,(_0x2f3445,_0x497d95)=>{_0x50c8b2(_0x2f3445,_0x497d95);});});passport_1[a1_0x5d12('0x6')][a1_0x5d12('0xb')](new LocalStrategy({'usernameField':a1_0x5d12('0xc')},(_0x1b4f04,_0x1f3597,_0x588d7f)=>{User_1[a1_0x5d12('0x6')][a1_0x5d12('0xd')]({'email':_0x1b4f04[a1_0x5d12('0xe')]()},(_0x1fd800,_0x1244cb)=>{if(_0x1fd800){return _0x588d7f(_0x1fd800);}if(!_0x1244cb){return _0x588d7f(undefined,![],{'message':a1_0x5d12('0xf')+_0x1b4f04+a1_0x5d12('0x10')});}_0x1244cb[a1_0x5d12('0x11')](_0x1f3597,(_0x1fd800,_0x4769f2)=>{if(_0x1fd800){return _0x588d7f(_0x1fd800);}if(_0x4769f2){return _0x588d7f(undefined,_0x1244cb);}return _0x588d7f(undefined,![],{'message':a1_0x5d12('0x12')});});});}));passport_1[a1_0x5d12('0x6')][a1_0x5d12('0xb')](new FacebookStrategy({'clientID':process[a1_0x5d12('0x13')][a1_0x5d12('0x14')],'clientSecret':process[a1_0x5d12('0x13')]['FACEBOOK_SECRET'],'callbackURL':a1_0x5d12('0x15'),'profileFields':[a1_0x5d12('0x16'),a1_0x5d12('0xc'),'link',a1_0x5d12('0x17'),'timezone'],'passReqToCallback':!![]},(_0x432876,_0x2e0317,_0x2b0c7b,_0x4a78c9,_0x5e9468)=>{if(_0x432876[a1_0x5d12('0x18')]){User_1[a1_0x5d12('0x6')][a1_0x5d12('0xd')]({'facebook':_0x4a78c9['id']},(_0x3fcc90,_0x33ae86)=>{if(_0x3fcc90){return _0x5e9468(_0x3fcc90);}if(_0x33ae86){_0x432876[a1_0x5d12('0x19')](a1_0x5d12('0x1a'),{'msg':a1_0x5d12('0x1b')});_0x5e9468(_0x3fcc90);}else{User_1['default'][a1_0x5d12('0xa')](_0x432876[a1_0x5d12('0x18')]['id'],(_0x3fcc90,_0x522b0f)=>{if(_0x3fcc90){return _0x5e9468(_0x3fcc90);}_0x522b0f[a1_0x5d12('0x1c')]=_0x4a78c9['id'];_0x522b0f['tokens']['push']({'kind':'facebook','accessToken':_0x2e0317});_0x522b0f['profile'][a1_0x5d12('0x16')]=_0x522b0f[a1_0x5d12('0x1d')][a1_0x5d12('0x16')]||_0x4a78c9[a1_0x5d12('0x16')][a1_0x5d12('0x1e')]+'\x20'+_0x4a78c9['name'][a1_0x5d12('0x1f')];_0x522b0f[a1_0x5d12('0x1d')][a1_0x5d12('0x20')]=_0x522b0f['profile'][a1_0x5d12('0x20')]||_0x4a78c9[a1_0x5d12('0x21')][a1_0x5d12('0x20')];_0x522b0f[a1_0x5d12('0x1d')][a1_0x5d12('0x22')]=_0x522b0f[a1_0x5d12('0x1d')]['picture']||'https://graph.facebook.com/'+_0x4a78c9['id']+a1_0x5d12('0x23');_0x522b0f[a1_0x5d12('0x24')](_0x3fcc90=>{_0x432876[a1_0x5d12('0x19')](a1_0x5d12('0x25'),{'msg':a1_0x5d12('0x26')});_0x5e9468(_0x3fcc90,_0x522b0f);});});}});}else{User_1[a1_0x5d12('0x6')][a1_0x5d12('0xd')]({'facebook':_0x4a78c9['id']},(_0x568668,_0x1dcc42)=>{if(_0x568668){return _0x5e9468(_0x568668);}if(_0x1dcc42){return _0x5e9468(undefined,_0x1dcc42);}User_1[a1_0x5d12('0x6')][a1_0x5d12('0xd')]({'email':_0x4a78c9[a1_0x5d12('0x21')][a1_0x5d12('0xc')]},(_0x568668,_0xe758f5)=>{if(_0x568668){return _0x5e9468(_0x568668);}if(_0xe758f5){_0x432876['flash']('errors',{'msg':a1_0x5d12('0x27')});_0x5e9468(_0x568668);}else{const _0x5d949e=new User_1[(a1_0x5d12('0x6'))]();_0x5d949e[a1_0x5d12('0xc')]=_0x4a78c9['_json']['email'];_0x5d949e['facebook']=_0x4a78c9['id'];_0x5d949e[a1_0x5d12('0x28')][a1_0x5d12('0x29')]({'kind':a1_0x5d12('0x1c'),'accessToken':_0x2e0317});_0x5d949e[a1_0x5d12('0x1d')][a1_0x5d12('0x16')]=_0x4a78c9[a1_0x5d12('0x16')][a1_0x5d12('0x1e')]+'\x20'+_0x4a78c9[a1_0x5d12('0x16')][a1_0x5d12('0x1f')];_0x5d949e[a1_0x5d12('0x1d')][a1_0x5d12('0x20')]=_0x4a78c9['_json'][a1_0x5d12('0x20')];_0x5d949e['profile'][a1_0x5d12('0x22')]='https://graph.facebook.com/'+_0x4a78c9['id']+a1_0x5d12('0x23');_0x5d949e['profile'][a1_0x5d12('0x2a')]=_0x4a78c9['_json']['location']?_0x4a78c9['_json'][a1_0x5d12('0x2a')][a1_0x5d12('0x16')]:'';_0x5d949e[a1_0x5d12('0x24')](_0x568668=>{_0x5e9468(_0x568668,_0x5d949e);});}});});}}));exports['isAuthenticated']=(_0x24e0f9,_0xf5fb81,_0x402d43)=>{if(_0x24e0f9[a1_0x5d12('0x2b')]()){return _0x402d43();}_0xf5fb81[a1_0x5d12('0x2c')]('/login');};exports['isAuthorized']=(_0x186afd,_0x228699,_0x4db1b4)=>{const _0x45f253=_0x186afd[a1_0x5d12('0x2d')]['split']('/')['slice'](-0x1)[0x0];if(lodash_1['default'][a1_0x5d12('0x2e')](_0x186afd[a1_0x5d12('0x18')][a1_0x5d12('0x28')],{'kind':_0x45f253})){_0x4db1b4();}else{_0x228699[a1_0x5d12('0x2c')](a1_0x5d12('0x2f')+_0x45f253);}};
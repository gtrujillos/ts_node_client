var a1_0x4817=['deserializeUser','findById','use','email','toLowerCase','Email\x20','comparePassword','Invalid\x20email\x20or\x20password.','env','FACEBOOK_ID','/auth/facebook/callback','link','locale','timezone','user','findOne','flash','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','facebook','tokens','push','profile','name','givenName','gender','_json','picture','/picture?type=large','save','info','Facebook\x20account\x20has\x20been\x20linked.','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','familyName','location','isAuthenticated','redirect','/login','path','split','slice','find','__importDefault','defineProperty','__esModule','passport','passport-local','passport-facebook','lodash','default','Strategy','serializeUser'];(function(_0x1f7b2a,_0x58bda6){var _0x1c543c=function(_0x38704e){while(--_0x38704e){_0x1f7b2a['push'](_0x1f7b2a['shift']());}};_0x1c543c(++_0x58bda6);}(a1_0x4817,0x196));var a1_0x27d5=function(_0x195a52,_0x511313){_0x195a52=_0x195a52-0x0;var _0x4c5f19=a1_0x4817[_0x195a52];return _0x4c5f19;};'use strict';var __importDefault=this&&this[a1_0x27d5('0x0')]||function(_0x3dd762){return _0x3dd762&&_0x3dd762['__esModule']?_0x3dd762:{'default':_0x3dd762};};Object[a1_0x27d5('0x1')](exports,a1_0x27d5('0x2'),{'value':!![]});const passport_1=__importDefault(require(a1_0x27d5('0x3')));const passport_local_1=__importDefault(require(a1_0x27d5('0x4')));const passport_facebook_1=__importDefault(require(a1_0x27d5('0x5')));const lodash_1=__importDefault(require(a1_0x27d5('0x6')));const User_1=__importDefault(require('../models/User'));const LocalStrategy=passport_local_1[a1_0x27d5('0x7')][a1_0x27d5('0x8')];const FacebookStrategy=passport_facebook_1[a1_0x27d5('0x7')][a1_0x27d5('0x8')];passport_1['default'][a1_0x27d5('0x9')]((_0x20f247,_0x1778c6)=>{_0x1778c6(undefined,_0x20f247['id']);});passport_1[a1_0x27d5('0x7')][a1_0x27d5('0xa')]((_0x577a48,_0x22893c)=>{User_1[a1_0x27d5('0x7')][a1_0x27d5('0xb')](_0x577a48,(_0x3669f9,_0x3dc498)=>{_0x22893c(_0x3669f9,_0x3dc498);});});passport_1[a1_0x27d5('0x7')][a1_0x27d5('0xc')](new LocalStrategy({'usernameField':a1_0x27d5('0xd')},(_0x4f8e6b,_0x37acda,_0x2c6d73)=>{User_1[a1_0x27d5('0x7')]['findOne']({'email':_0x4f8e6b[a1_0x27d5('0xe')]()},(_0x2dad04,_0x5388be)=>{if(_0x2dad04){return _0x2c6d73(_0x2dad04);}if(!_0x5388be){return _0x2c6d73(undefined,![],{'message':a1_0x27d5('0xf')+_0x4f8e6b+'\x20not\x20found.'});}_0x5388be[a1_0x27d5('0x10')](_0x37acda,(_0x2dad04,_0x109ec6)=>{if(_0x2dad04){return _0x2c6d73(_0x2dad04);}if(_0x109ec6){return _0x2c6d73(undefined,_0x5388be);}return _0x2c6d73(undefined,![],{'message':a1_0x27d5('0x11')});});});}));passport_1['default'][a1_0x27d5('0xc')](new FacebookStrategy({'clientID':process[a1_0x27d5('0x12')][a1_0x27d5('0x13')],'clientSecret':process[a1_0x27d5('0x12')]['FACEBOOK_SECRET'],'callbackURL':a1_0x27d5('0x14'),'profileFields':['name',a1_0x27d5('0xd'),a1_0x27d5('0x15'),a1_0x27d5('0x16'),a1_0x27d5('0x17')],'passReqToCallback':!![]},(_0x1b0ff5,_0x481ce8,_0x1b67d9,_0xed810d,_0x4ccdee)=>{if(_0x1b0ff5[a1_0x27d5('0x18')]){User_1[a1_0x27d5('0x7')][a1_0x27d5('0x19')]({'facebook':_0xed810d['id']},(_0x198c1a,_0xc8074b)=>{if(_0x198c1a){return _0x4ccdee(_0x198c1a);}if(_0xc8074b){_0x1b0ff5[a1_0x27d5('0x1a')](a1_0x27d5('0x1b'),{'msg':a1_0x27d5('0x1c')});_0x4ccdee(_0x198c1a);}else{User_1[a1_0x27d5('0x7')][a1_0x27d5('0xb')](_0x1b0ff5[a1_0x27d5('0x18')]['id'],(_0x198c1a,_0x16de77)=>{if(_0x198c1a){return _0x4ccdee(_0x198c1a);}_0x16de77[a1_0x27d5('0x1d')]=_0xed810d['id'];_0x16de77[a1_0x27d5('0x1e')][a1_0x27d5('0x1f')]({'kind':'facebook','accessToken':_0x481ce8});_0x16de77[a1_0x27d5('0x20')]['name']=_0x16de77[a1_0x27d5('0x20')][a1_0x27d5('0x21')]||_0xed810d[a1_0x27d5('0x21')][a1_0x27d5('0x22')]+'\x20'+_0xed810d[a1_0x27d5('0x21')]['familyName'];_0x16de77['profile'][a1_0x27d5('0x23')]=_0x16de77['profile'][a1_0x27d5('0x23')]||_0xed810d[a1_0x27d5('0x24')][a1_0x27d5('0x23')];_0x16de77['profile']['picture']=_0x16de77[a1_0x27d5('0x20')][a1_0x27d5('0x25')]||'https://graph.facebook.com/'+_0xed810d['id']+a1_0x27d5('0x26');_0x16de77[a1_0x27d5('0x27')](_0x198c1a=>{_0x1b0ff5[a1_0x27d5('0x1a')](a1_0x27d5('0x28'),{'msg':a1_0x27d5('0x29')});_0x4ccdee(_0x198c1a,_0x16de77);});});}});}else{User_1[a1_0x27d5('0x7')][a1_0x27d5('0x19')]({'facebook':_0xed810d['id']},(_0x24a156,_0x571782)=>{if(_0x24a156){return _0x4ccdee(_0x24a156);}if(_0x571782){return _0x4ccdee(undefined,_0x571782);}User_1['default'][a1_0x27d5('0x19')]({'email':_0xed810d['_json'][a1_0x27d5('0xd')]},(_0x24a156,_0x546da8)=>{if(_0x24a156){return _0x4ccdee(_0x24a156);}if(_0x546da8){_0x1b0ff5[a1_0x27d5('0x1a')](a1_0x27d5('0x1b'),{'msg':a1_0x27d5('0x2a')});_0x4ccdee(_0x24a156);}else{const _0xa7701d=new User_1['default']();_0xa7701d[a1_0x27d5('0xd')]=_0xed810d[a1_0x27d5('0x24')][a1_0x27d5('0xd')];_0xa7701d[a1_0x27d5('0x1d')]=_0xed810d['id'];_0xa7701d[a1_0x27d5('0x1e')]['push']({'kind':a1_0x27d5('0x1d'),'accessToken':_0x481ce8});_0xa7701d[a1_0x27d5('0x20')]['name']=_0xed810d[a1_0x27d5('0x21')]['givenName']+'\x20'+_0xed810d[a1_0x27d5('0x21')][a1_0x27d5('0x2b')];_0xa7701d[a1_0x27d5('0x20')][a1_0x27d5('0x23')]=_0xed810d[a1_0x27d5('0x24')][a1_0x27d5('0x23')];_0xa7701d[a1_0x27d5('0x20')][a1_0x27d5('0x25')]='https://graph.facebook.com/'+_0xed810d['id']+a1_0x27d5('0x26');_0xa7701d[a1_0x27d5('0x20')][a1_0x27d5('0x2c')]=_0xed810d[a1_0x27d5('0x24')][a1_0x27d5('0x2c')]?_0xed810d[a1_0x27d5('0x24')][a1_0x27d5('0x2c')][a1_0x27d5('0x21')]:'';_0xa7701d['save'](_0x24a156=>{_0x4ccdee(_0x24a156,_0xa7701d);});}});});}}));exports[a1_0x27d5('0x2d')]=(_0x1af5ea,_0x57ac08,_0x14071a)=>{if(_0x1af5ea['isAuthenticated']()){return _0x14071a();}_0x57ac08[a1_0x27d5('0x2e')](a1_0x27d5('0x2f'));};exports['isAuthorized']=(_0x14c2a4,_0x1c16ae,_0x48c0cb)=>{const _0x3a3fb0=_0x14c2a4[a1_0x27d5('0x30')][a1_0x27d5('0x31')]('/')[a1_0x27d5('0x32')](-0x1)[0x0];if(lodash_1[a1_0x27d5('0x7')][a1_0x27d5('0x33')](_0x14c2a4[a1_0x27d5('0x18')][a1_0x27d5('0x1e')],{'kind':_0x3a3fb0})){_0x48c0cb();}else{_0x1c16ae['redirect']('/auth/'+_0x3a3fb0);}};
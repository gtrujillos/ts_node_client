var a1_0x4df1=['givenName','familyName','gender','_json','picture','https://graph.facebook.com/','save','info','Facebook\x20account\x20has\x20been\x20linked.','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','facebook','/picture?type=large','location','isAuthenticated','redirect','/login','isAuthorized','path','split','find','user','/auth/','__importDefault','__esModule','defineProperty','passport-facebook','lodash','default','Strategy','serializeUser','deserializeUser','findById','email','findOne','toLowerCase','Email\x20','comparePassword','Invalid\x20email\x20or\x20password.','env','FACEBOOK_ID','FACEBOOK_SECRET','/auth/facebook/callback','name','link','locale','timezone','flash','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','tokens','push','profile'];(function(_0x26e858,_0x2362f2){var _0xddd2ef=function(_0x14a084){while(--_0x14a084){_0x26e858['push'](_0x26e858['shift']());}};_0xddd2ef(++_0x2362f2);}(a1_0x4df1,0xe6));var a1_0xc759=function(_0xb10d3c,_0x31f34b){_0xb10d3c=_0xb10d3c-0x0;var _0x4c241a=a1_0x4df1[_0xb10d3c];return _0x4c241a;};'use strict';var __importDefault=this&&this[a1_0xc759('0x0')]||function(_0x150ff1){return _0x150ff1&&_0x150ff1[a1_0xc759('0x1')]?_0x150ff1:{'default':_0x150ff1};};Object[a1_0xc759('0x2')](exports,a1_0xc759('0x1'),{'value':!![]});const passport_1=__importDefault(require('passport'));const passport_local_1=__importDefault(require('passport-local'));const passport_facebook_1=__importDefault(require(a1_0xc759('0x3')));const lodash_1=__importDefault(require(a1_0xc759('0x4')));const User_1=__importDefault(require('../models/User'));const LocalStrategy=passport_local_1[a1_0xc759('0x5')][a1_0xc759('0x6')];const FacebookStrategy=passport_facebook_1[a1_0xc759('0x5')][a1_0xc759('0x6')];passport_1['default'][a1_0xc759('0x7')]((_0x5461a4,_0x2207df)=>{_0x2207df(undefined,_0x5461a4['id']);});passport_1[a1_0xc759('0x5')][a1_0xc759('0x8')]((_0x41ab59,_0x18c13c)=>{User_1[a1_0xc759('0x5')][a1_0xc759('0x9')](_0x41ab59,(_0xe076a0,_0x17442c)=>{_0x18c13c(_0xe076a0,_0x17442c);});});passport_1[a1_0xc759('0x5')]['use'](new LocalStrategy({'usernameField':a1_0xc759('0xa')},(_0x598c20,_0x5ef01b,_0x1cfd28)=>{User_1[a1_0xc759('0x5')][a1_0xc759('0xb')]({'email':_0x598c20[a1_0xc759('0xc')]()},(_0x43a037,_0x1a2aea)=>{if(_0x43a037){return _0x1cfd28(_0x43a037);}if(!_0x1a2aea){return _0x1cfd28(undefined,![],{'message':a1_0xc759('0xd')+_0x598c20+'\x20not\x20found.'});}_0x1a2aea[a1_0xc759('0xe')](_0x5ef01b,(_0x43a037,_0x10a919)=>{if(_0x43a037){return _0x1cfd28(_0x43a037);}if(_0x10a919){return _0x1cfd28(undefined,_0x1a2aea);}return _0x1cfd28(undefined,![],{'message':a1_0xc759('0xf')});});});}));passport_1[a1_0xc759('0x5')]['use'](new FacebookStrategy({'clientID':process[a1_0xc759('0x10')][a1_0xc759('0x11')],'clientSecret':process[a1_0xc759('0x10')][a1_0xc759('0x12')],'callbackURL':a1_0xc759('0x13'),'profileFields':[a1_0xc759('0x14'),a1_0xc759('0xa'),a1_0xc759('0x15'),a1_0xc759('0x16'),a1_0xc759('0x17')],'passReqToCallback':!![]},(_0x3b03ac,_0x3be464,_0x4620d0,_0x5f3e16,_0xd02665)=>{if(_0x3b03ac['user']){User_1[a1_0xc759('0x5')][a1_0xc759('0xb')]({'facebook':_0x5f3e16['id']},(_0x152748,_0x4903c9)=>{if(_0x152748){return _0xd02665(_0x152748);}if(_0x4903c9){_0x3b03ac[a1_0xc759('0x18')](a1_0xc759('0x19'),{'msg':a1_0xc759('0x1a')});_0xd02665(_0x152748);}else{User_1[a1_0xc759('0x5')][a1_0xc759('0x9')](_0x3b03ac['user']['id'],(_0x152748,_0xa63895)=>{if(_0x152748){return _0xd02665(_0x152748);}_0xa63895['facebook']=_0x5f3e16['id'];_0xa63895[a1_0xc759('0x1b')][a1_0xc759('0x1c')]({'kind':'facebook','accessToken':_0x3be464});_0xa63895[a1_0xc759('0x1d')][a1_0xc759('0x14')]=_0xa63895['profile'][a1_0xc759('0x14')]||_0x5f3e16[a1_0xc759('0x14')][a1_0xc759('0x1e')]+'\x20'+_0x5f3e16[a1_0xc759('0x14')][a1_0xc759('0x1f')];_0xa63895[a1_0xc759('0x1d')][a1_0xc759('0x20')]=_0xa63895[a1_0xc759('0x1d')][a1_0xc759('0x20')]||_0x5f3e16[a1_0xc759('0x21')]['gender'];_0xa63895[a1_0xc759('0x1d')][a1_0xc759('0x22')]=_0xa63895[a1_0xc759('0x1d')][a1_0xc759('0x22')]||a1_0xc759('0x23')+_0x5f3e16['id']+'/picture?type=large';_0xa63895[a1_0xc759('0x24')](_0x152748=>{_0x3b03ac[a1_0xc759('0x18')](a1_0xc759('0x25'),{'msg':a1_0xc759('0x26')});_0xd02665(_0x152748,_0xa63895);});});}});}else{User_1[a1_0xc759('0x5')]['findOne']({'facebook':_0x5f3e16['id']},(_0x49e3f4,_0xd7cefa)=>{if(_0x49e3f4){return _0xd02665(_0x49e3f4);}if(_0xd7cefa){return _0xd02665(undefined,_0xd7cefa);}User_1[a1_0xc759('0x5')]['findOne']({'email':_0x5f3e16[a1_0xc759('0x21')][a1_0xc759('0xa')]},(_0x49e3f4,_0x3be340)=>{if(_0x49e3f4){return _0xd02665(_0x49e3f4);}if(_0x3be340){_0x3b03ac[a1_0xc759('0x18')](a1_0xc759('0x19'),{'msg':a1_0xc759('0x27')});_0xd02665(_0x49e3f4);}else{const _0x52e4b8=new User_1[(a1_0xc759('0x5'))]();_0x52e4b8[a1_0xc759('0xa')]=_0x5f3e16[a1_0xc759('0x21')][a1_0xc759('0xa')];_0x52e4b8['facebook']=_0x5f3e16['id'];_0x52e4b8[a1_0xc759('0x1b')][a1_0xc759('0x1c')]({'kind':a1_0xc759('0x28'),'accessToken':_0x3be464});_0x52e4b8[a1_0xc759('0x1d')][a1_0xc759('0x14')]=_0x5f3e16['name'][a1_0xc759('0x1e')]+'\x20'+_0x5f3e16[a1_0xc759('0x14')][a1_0xc759('0x1f')];_0x52e4b8[a1_0xc759('0x1d')][a1_0xc759('0x20')]=_0x5f3e16[a1_0xc759('0x21')][a1_0xc759('0x20')];_0x52e4b8[a1_0xc759('0x1d')][a1_0xc759('0x22')]=a1_0xc759('0x23')+_0x5f3e16['id']+a1_0xc759('0x29');_0x52e4b8[a1_0xc759('0x1d')]['location']=_0x5f3e16[a1_0xc759('0x21')][a1_0xc759('0x2a')]?_0x5f3e16[a1_0xc759('0x21')][a1_0xc759('0x2a')][a1_0xc759('0x14')]:'';_0x52e4b8['save'](_0x49e3f4=>{_0xd02665(_0x49e3f4,_0x52e4b8);});}});});}}));exports['isAuthenticated']=(_0xabc355,_0x2fb176,_0x5112e2)=>{if(_0xabc355[a1_0xc759('0x2b')]()){return _0x5112e2();}_0x2fb176[a1_0xc759('0x2c')](a1_0xc759('0x2d'));};exports[a1_0xc759('0x2e')]=(_0x635969,_0xa71f56,_0x15d002)=>{const _0x3a9dce=_0x635969[a1_0xc759('0x2f')][a1_0xc759('0x30')]('/')['slice'](-0x1)[0x0];if(lodash_1[a1_0xc759('0x5')][a1_0xc759('0x31')](_0x635969[a1_0xc759('0x32')][a1_0xc759('0x1b')],{'kind':_0x3a9dce})){_0x15d002();}else{_0xa71f56[a1_0xc759('0x2c')](a1_0xc759('0x33')+_0x3a9dce);}};
var a1_0x28f8=['FACEBOOK_ID','FACEBOOK_SECRET','/auth/facebook/callback','name','locale','timezone','user','flash','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','facebook','tokens','push','profile','givenName','familyName','gender','_json','picture','https://graph.facebook.com/','/picture?type=large','save','info','Facebook\x20account\x20has\x20been\x20linked.','location','isAuthenticated','redirect','/login','isAuthorized','path','split','find','/auth/','__esModule','passport','passport-facebook','lodash','../models/User','default','Strategy','serializeUser','deserializeUser','findById','use','email','findOne','toLowerCase','Email\x20','\x20not\x20found.','comparePassword','env'];(function(_0x237dd3,_0x2d3eaa){var _0x8d0acf=function(_0x169aba){while(--_0x169aba){_0x237dd3['push'](_0x237dd3['shift']());}};_0x8d0acf(++_0x2d3eaa);}(a1_0x28f8,0xed));var a1_0x3e97=function(_0x2ef736,_0x13a13b){_0x2ef736=_0x2ef736-0x0;var _0x39b95f=a1_0x28f8[_0x2ef736];return _0x39b95f;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x2a1791){return _0x2a1791&&_0x2a1791[a1_0x3e97('0x0')]?_0x2a1791:{'default':_0x2a1791};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const passport_1=__importDefault(require(a1_0x3e97('0x1')));const passport_local_1=__importDefault(require('passport-local'));const passport_facebook_1=__importDefault(require(a1_0x3e97('0x2')));const lodash_1=__importDefault(require(a1_0x3e97('0x3')));const User_1=__importDefault(require(a1_0x3e97('0x4')));const LocalStrategy=passport_local_1[a1_0x3e97('0x5')][a1_0x3e97('0x6')];const FacebookStrategy=passport_facebook_1[a1_0x3e97('0x5')][a1_0x3e97('0x6')];passport_1['default'][a1_0x3e97('0x7')]((_0x36b577,_0x429b4e)=>{_0x429b4e(undefined,_0x36b577['id']);});passport_1[a1_0x3e97('0x5')][a1_0x3e97('0x8')]((_0x216857,_0x6a72b3)=>{User_1['default'][a1_0x3e97('0x9')](_0x216857,(_0xb12930,_0x58caeb)=>{_0x6a72b3(_0xb12930,_0x58caeb);});});passport_1[a1_0x3e97('0x5')][a1_0x3e97('0xa')](new LocalStrategy({'usernameField':a1_0x3e97('0xb')},(_0x1c27aa,_0x2dbfdc,_0x3b66f6)=>{User_1['default'][a1_0x3e97('0xc')]({'email':_0x1c27aa[a1_0x3e97('0xd')]()},(_0x48923b,_0x37f552)=>{if(_0x48923b){return _0x3b66f6(_0x48923b);}if(!_0x37f552){return _0x3b66f6(undefined,![],{'message':a1_0x3e97('0xe')+_0x1c27aa+a1_0x3e97('0xf')});}_0x37f552[a1_0x3e97('0x10')](_0x2dbfdc,(_0x48923b,_0x4cd5f4)=>{if(_0x48923b){return _0x3b66f6(_0x48923b);}if(_0x4cd5f4){return _0x3b66f6(undefined,_0x37f552);}return _0x3b66f6(undefined,![],{'message':'Invalid\x20email\x20or\x20password.'});});});}));passport_1[a1_0x3e97('0x5')][a1_0x3e97('0xa')](new FacebookStrategy({'clientID':process[a1_0x3e97('0x11')][a1_0x3e97('0x12')],'clientSecret':process[a1_0x3e97('0x11')][a1_0x3e97('0x13')],'callbackURL':a1_0x3e97('0x14'),'profileFields':[a1_0x3e97('0x15'),'email','link',a1_0x3e97('0x16'),a1_0x3e97('0x17')],'passReqToCallback':!![]},(_0x49c91e,_0x363151,_0x309287,_0x192e7d,_0x30a2de)=>{if(_0x49c91e[a1_0x3e97('0x18')]){User_1[a1_0x3e97('0x5')]['findOne']({'facebook':_0x192e7d['id']},(_0x3aee8d,_0x1592b0)=>{if(_0x3aee8d){return _0x30a2de(_0x3aee8d);}if(_0x1592b0){_0x49c91e[a1_0x3e97('0x19')](a1_0x3e97('0x1a'),{'msg':a1_0x3e97('0x1b')});_0x30a2de(_0x3aee8d);}else{User_1[a1_0x3e97('0x5')][a1_0x3e97('0x9')](_0x49c91e['user']['id'],(_0x3aee8d,_0x399cbc)=>{if(_0x3aee8d){return _0x30a2de(_0x3aee8d);}_0x399cbc[a1_0x3e97('0x1c')]=_0x192e7d['id'];_0x399cbc[a1_0x3e97('0x1d')][a1_0x3e97('0x1e')]({'kind':'facebook','accessToken':_0x363151});_0x399cbc[a1_0x3e97('0x1f')][a1_0x3e97('0x15')]=_0x399cbc[a1_0x3e97('0x1f')][a1_0x3e97('0x15')]||_0x192e7d[a1_0x3e97('0x15')][a1_0x3e97('0x20')]+'\x20'+_0x192e7d[a1_0x3e97('0x15')][a1_0x3e97('0x21')];_0x399cbc[a1_0x3e97('0x1f')][a1_0x3e97('0x22')]=_0x399cbc[a1_0x3e97('0x1f')][a1_0x3e97('0x22')]||_0x192e7d[a1_0x3e97('0x23')]['gender'];_0x399cbc[a1_0x3e97('0x1f')][a1_0x3e97('0x24')]=_0x399cbc['profile'][a1_0x3e97('0x24')]||a1_0x3e97('0x25')+_0x192e7d['id']+a1_0x3e97('0x26');_0x399cbc[a1_0x3e97('0x27')](_0x3aee8d=>{_0x49c91e[a1_0x3e97('0x19')](a1_0x3e97('0x28'),{'msg':a1_0x3e97('0x29')});_0x30a2de(_0x3aee8d,_0x399cbc);});});}});}else{User_1[a1_0x3e97('0x5')][a1_0x3e97('0xc')]({'facebook':_0x192e7d['id']},(_0x51b189,_0x29d382)=>{if(_0x51b189){return _0x30a2de(_0x51b189);}if(_0x29d382){return _0x30a2de(undefined,_0x29d382);}User_1[a1_0x3e97('0x5')][a1_0x3e97('0xc')]({'email':_0x192e7d['_json']['email']},(_0x51b189,_0x440b41)=>{if(_0x51b189){return _0x30a2de(_0x51b189);}if(_0x440b41){_0x49c91e[a1_0x3e97('0x19')]('errors',{'msg':'There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.'});_0x30a2de(_0x51b189);}else{const _0x264834=new User_1[(a1_0x3e97('0x5'))]();_0x264834[a1_0x3e97('0xb')]=_0x192e7d[a1_0x3e97('0x23')][a1_0x3e97('0xb')];_0x264834[a1_0x3e97('0x1c')]=_0x192e7d['id'];_0x264834[a1_0x3e97('0x1d')][a1_0x3e97('0x1e')]({'kind':a1_0x3e97('0x1c'),'accessToken':_0x363151});_0x264834[a1_0x3e97('0x1f')]['name']=_0x192e7d[a1_0x3e97('0x15')][a1_0x3e97('0x20')]+'\x20'+_0x192e7d[a1_0x3e97('0x15')][a1_0x3e97('0x21')];_0x264834['profile']['gender']=_0x192e7d[a1_0x3e97('0x23')]['gender'];_0x264834[a1_0x3e97('0x1f')][a1_0x3e97('0x24')]=a1_0x3e97('0x25')+_0x192e7d['id']+'/picture?type=large';_0x264834[a1_0x3e97('0x1f')][a1_0x3e97('0x2a')]=_0x192e7d[a1_0x3e97('0x23')][a1_0x3e97('0x2a')]?_0x192e7d[a1_0x3e97('0x23')][a1_0x3e97('0x2a')][a1_0x3e97('0x15')]:'';_0x264834[a1_0x3e97('0x27')](_0x51b189=>{_0x30a2de(_0x51b189,_0x264834);});}});});}}));exports[a1_0x3e97('0x2b')]=(_0x28daae,_0x19607b,_0x5e85a2)=>{if(_0x28daae[a1_0x3e97('0x2b')]()){return _0x5e85a2();}_0x19607b[a1_0x3e97('0x2c')](a1_0x3e97('0x2d'));};exports[a1_0x3e97('0x2e')]=(_0x324640,_0x41633d,_0x9fecaf)=>{const _0x46b5f7=_0x324640[a1_0x3e97('0x2f')][a1_0x3e97('0x30')]('/')['slice'](-0x1)[0x0];if(lodash_1[a1_0x3e97('0x5')][a1_0x3e97('0x31')](_0x324640[a1_0x3e97('0x18')][a1_0x3e97('0x1d')],{'kind':_0x46b5f7})){_0x9fecaf();}else{_0x41633d[a1_0x3e97('0x2c')](a1_0x3e97('0x32')+_0x46b5f7);}};
var a1_0x5bef=['tokens','push','profile','familyName','gender','picture','/picture?type=large','save','info','Facebook\x20account\x20has\x20been\x20linked.','flash','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','givenName','_json','https://graph.facebook.com/','location','isAuthenticated','/login','isAuthorized','split','slice','find','redirect','/auth/','__importDefault','defineProperty','__esModule','passport','passport-local','passport-facebook','lodash','default','Strategy','findById','findOne','toLowerCase','\x20not\x20found.','comparePassword','use','env','FACEBOOK_ID','FACEBOOK_SECRET','name','email','locale','timezone','user','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','facebook'];(function(_0x575e6f,_0x274ef1){var _0x5db8b0=function(_0xfaf5cf){while(--_0xfaf5cf){_0x575e6f['push'](_0x575e6f['shift']());}};_0x5db8b0(++_0x274ef1);}(a1_0x5bef,0xae));var a1_0x24b9=function(_0x24a786,_0x24d1c4){_0x24a786=_0x24a786-0x0;var _0x54072e=a1_0x5bef[_0x24a786];return _0x54072e;};'use strict';var __importDefault=this&&this[a1_0x24b9('0x0')]||function(_0xe82bfe){return _0xe82bfe&&_0xe82bfe['__esModule']?_0xe82bfe:{'default':_0xe82bfe};};Object[a1_0x24b9('0x1')](exports,a1_0x24b9('0x2'),{'value':!![]});const passport_1=__importDefault(require(a1_0x24b9('0x3')));const passport_local_1=__importDefault(require(a1_0x24b9('0x4')));const passport_facebook_1=__importDefault(require(a1_0x24b9('0x5')));const lodash_1=__importDefault(require(a1_0x24b9('0x6')));const User_1=__importDefault(require('../models/User'));const LocalStrategy=passport_local_1[a1_0x24b9('0x7')]['Strategy'];const FacebookStrategy=passport_facebook_1[a1_0x24b9('0x7')][a1_0x24b9('0x8')];passport_1['default']['serializeUser']((_0x1342a9,_0x403545)=>{_0x403545(undefined,_0x1342a9['id']);});passport_1[a1_0x24b9('0x7')]['deserializeUser']((_0x1440fa,_0x5ad9af)=>{User_1['default'][a1_0x24b9('0x9')](_0x1440fa,(_0x5143c7,_0x280baa)=>{_0x5ad9af(_0x5143c7,_0x280baa);});});passport_1['default']['use'](new LocalStrategy({'usernameField':'email'},(_0x5cd45c,_0x7c2e17,_0x46cd4d)=>{User_1['default'][a1_0x24b9('0xa')]({'email':_0x5cd45c[a1_0x24b9('0xb')]()},(_0x37549d,_0x24573f)=>{if(_0x37549d){return _0x46cd4d(_0x37549d);}if(!_0x24573f){return _0x46cd4d(undefined,![],{'message':'Email\x20'+_0x5cd45c+a1_0x24b9('0xc')});}_0x24573f[a1_0x24b9('0xd')](_0x7c2e17,(_0x37549d,_0x1c206f)=>{if(_0x37549d){return _0x46cd4d(_0x37549d);}if(_0x1c206f){return _0x46cd4d(undefined,_0x24573f);}return _0x46cd4d(undefined,![],{'message':'Invalid\x20email\x20or\x20password.'});});});}));passport_1[a1_0x24b9('0x7')][a1_0x24b9('0xe')](new FacebookStrategy({'clientID':process[a1_0x24b9('0xf')][a1_0x24b9('0x10')],'clientSecret':process['env'][a1_0x24b9('0x11')],'callbackURL':'/auth/facebook/callback','profileFields':[a1_0x24b9('0x12'),a1_0x24b9('0x13'),'link',a1_0x24b9('0x14'),a1_0x24b9('0x15')],'passReqToCallback':!![]},(_0x2da08d,_0x4799f9,_0x505aea,_0x30f1ac,_0x2f94cb)=>{if(_0x2da08d[a1_0x24b9('0x16')]){User_1[a1_0x24b9('0x7')][a1_0x24b9('0xa')]({'facebook':_0x30f1ac['id']},(_0x50e86a,_0x34112f)=>{if(_0x50e86a){return _0x2f94cb(_0x50e86a);}if(_0x34112f){_0x2da08d['flash'](a1_0x24b9('0x17'),{'msg':a1_0x24b9('0x18')});_0x2f94cb(_0x50e86a);}else{User_1[a1_0x24b9('0x7')]['findById'](_0x2da08d[a1_0x24b9('0x16')]['id'],(_0x50e86a,_0x41a630)=>{if(_0x50e86a){return _0x2f94cb(_0x50e86a);}_0x41a630[a1_0x24b9('0x19')]=_0x30f1ac['id'];_0x41a630[a1_0x24b9('0x1a')][a1_0x24b9('0x1b')]({'kind':a1_0x24b9('0x19'),'accessToken':_0x4799f9});_0x41a630[a1_0x24b9('0x1c')][a1_0x24b9('0x12')]=_0x41a630['profile'][a1_0x24b9('0x12')]||_0x30f1ac['name']['givenName']+'\x20'+_0x30f1ac[a1_0x24b9('0x12')][a1_0x24b9('0x1d')];_0x41a630[a1_0x24b9('0x1c')][a1_0x24b9('0x1e')]=_0x41a630['profile'][a1_0x24b9('0x1e')]||_0x30f1ac['_json']['gender'];_0x41a630[a1_0x24b9('0x1c')][a1_0x24b9('0x1f')]=_0x41a630['profile'][a1_0x24b9('0x1f')]||'https://graph.facebook.com/'+_0x30f1ac['id']+a1_0x24b9('0x20');_0x41a630[a1_0x24b9('0x21')](_0x50e86a=>{_0x2da08d['flash'](a1_0x24b9('0x22'),{'msg':a1_0x24b9('0x23')});_0x2f94cb(_0x50e86a,_0x41a630);});});}});}else{User_1[a1_0x24b9('0x7')][a1_0x24b9('0xa')]({'facebook':_0x30f1ac['id']},(_0x58e3cb,_0x15cf53)=>{if(_0x58e3cb){return _0x2f94cb(_0x58e3cb);}if(_0x15cf53){return _0x2f94cb(undefined,_0x15cf53);}User_1[a1_0x24b9('0x7')][a1_0x24b9('0xa')]({'email':_0x30f1ac['_json'][a1_0x24b9('0x13')]},(_0x58e3cb,_0x187667)=>{if(_0x58e3cb){return _0x2f94cb(_0x58e3cb);}if(_0x187667){_0x2da08d[a1_0x24b9('0x24')]('errors',{'msg':a1_0x24b9('0x25')});_0x2f94cb(_0x58e3cb);}else{const _0x4ce48a=new User_1['default']();_0x4ce48a[a1_0x24b9('0x13')]=_0x30f1ac['_json']['email'];_0x4ce48a[a1_0x24b9('0x19')]=_0x30f1ac['id'];_0x4ce48a[a1_0x24b9('0x1a')][a1_0x24b9('0x1b')]({'kind':a1_0x24b9('0x19'),'accessToken':_0x4799f9});_0x4ce48a['profile'][a1_0x24b9('0x12')]=_0x30f1ac['name'][a1_0x24b9('0x26')]+'\x20'+_0x30f1ac[a1_0x24b9('0x12')][a1_0x24b9('0x1d')];_0x4ce48a[a1_0x24b9('0x1c')][a1_0x24b9('0x1e')]=_0x30f1ac[a1_0x24b9('0x27')][a1_0x24b9('0x1e')];_0x4ce48a[a1_0x24b9('0x1c')]['picture']=a1_0x24b9('0x28')+_0x30f1ac['id']+'/picture?type=large';_0x4ce48a[a1_0x24b9('0x1c')][a1_0x24b9('0x29')]=_0x30f1ac[a1_0x24b9('0x27')][a1_0x24b9('0x29')]?_0x30f1ac[a1_0x24b9('0x27')][a1_0x24b9('0x29')][a1_0x24b9('0x12')]:'';_0x4ce48a[a1_0x24b9('0x21')](_0x58e3cb=>{_0x2f94cb(_0x58e3cb,_0x4ce48a);});}});});}}));exports['isAuthenticated']=(_0x3371c0,_0x4dd1b0,_0x56aa2e)=>{if(_0x3371c0[a1_0x24b9('0x2a')]()){return _0x56aa2e();}_0x4dd1b0['redirect'](a1_0x24b9('0x2b'));};exports[a1_0x24b9('0x2c')]=(_0x69472,_0x23ecd7,_0x222929)=>{const _0x1b7764=_0x69472['path'][a1_0x24b9('0x2d')]('/')[a1_0x24b9('0x2e')](-0x1)[0x0];if(lodash_1[a1_0x24b9('0x7')][a1_0x24b9('0x2f')](_0x69472[a1_0x24b9('0x16')][a1_0x24b9('0x1a')],{'kind':_0x1b7764})){_0x222929();}else{_0x23ecd7[a1_0x24b9('0x30')](a1_0x24b9('0x31')+_0x1b7764);}};
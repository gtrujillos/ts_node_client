var a1_0x331e=['Invalid\x20email\x20or\x20password.','use','env','FACEBOOK_ID','FACEBOOK_SECRET','/auth/facebook/callback','name','link','timezone','user','findOne','flash','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','facebook','tokens','push','profile','gender','picture','https://graph.facebook.com/','/picture?type=large','save','info','Facebook\x20account\x20has\x20been\x20linked.','_json','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','givenName','familyName','location','isAuthenticated','redirect','/login','split','slice','/auth/','__importDefault','__esModule','defineProperty','passport','passport-local','passport-facebook','lodash','../models/User','Strategy','default','serializeUser','deserializeUser','findById','email','Email\x20','\x20not\x20found.','comparePassword'];(function(_0x44109a,_0x1146bd){var _0x90d594=function(_0x400663){while(--_0x400663){_0x44109a['push'](_0x44109a['shift']());}};_0x90d594(++_0x1146bd);}(a1_0x331e,0x8e));var a1_0x108e=function(_0x2891ba,_0x361ed8){_0x2891ba=_0x2891ba-0x0;var _0x5fa9=a1_0x331e[_0x2891ba];return _0x5fa9;};'use strict';var __importDefault=this&&this[a1_0x108e('0x0')]||function(_0x5af2af){return _0x5af2af&&_0x5af2af[a1_0x108e('0x1')]?_0x5af2af:{'default':_0x5af2af};};Object[a1_0x108e('0x2')](exports,a1_0x108e('0x1'),{'value':!![]});const passport_1=__importDefault(require(a1_0x108e('0x3')));const passport_local_1=__importDefault(require(a1_0x108e('0x4')));const passport_facebook_1=__importDefault(require(a1_0x108e('0x5')));const lodash_1=__importDefault(require(a1_0x108e('0x6')));const User_1=__importDefault(require(a1_0x108e('0x7')));const LocalStrategy=passport_local_1['default'][a1_0x108e('0x8')];const FacebookStrategy=passport_facebook_1[a1_0x108e('0x9')][a1_0x108e('0x8')];passport_1['default'][a1_0x108e('0xa')]((_0x275ded,_0x276e0c)=>{_0x276e0c(undefined,_0x275ded['id']);});passport_1[a1_0x108e('0x9')][a1_0x108e('0xb')]((_0x1ff314,_0x26a260)=>{User_1[a1_0x108e('0x9')][a1_0x108e('0xc')](_0x1ff314,(_0x4fcc96,_0x537292)=>{_0x26a260(_0x4fcc96,_0x537292);});});passport_1['default']['use'](new LocalStrategy({'usernameField':a1_0x108e('0xd')},(_0x430ff6,_0x46ffe8,_0x229e83)=>{User_1[a1_0x108e('0x9')]['findOne']({'email':_0x430ff6['toLowerCase']()},(_0x3c12a5,_0x5e1005)=>{if(_0x3c12a5){return _0x229e83(_0x3c12a5);}if(!_0x5e1005){return _0x229e83(undefined,![],{'message':a1_0x108e('0xe')+_0x430ff6+a1_0x108e('0xf')});}_0x5e1005[a1_0x108e('0x10')](_0x46ffe8,(_0x3c12a5,_0x285ed0)=>{if(_0x3c12a5){return _0x229e83(_0x3c12a5);}if(_0x285ed0){return _0x229e83(undefined,_0x5e1005);}return _0x229e83(undefined,![],{'message':a1_0x108e('0x11')});});});}));passport_1[a1_0x108e('0x9')][a1_0x108e('0x12')](new FacebookStrategy({'clientID':process[a1_0x108e('0x13')][a1_0x108e('0x14')],'clientSecret':process[a1_0x108e('0x13')][a1_0x108e('0x15')],'callbackURL':a1_0x108e('0x16'),'profileFields':[a1_0x108e('0x17'),a1_0x108e('0xd'),a1_0x108e('0x18'),'locale',a1_0x108e('0x19')],'passReqToCallback':!![]},(_0x39c983,_0x987b5a,_0x19b60e,_0x16ab4b,_0xf7407a)=>{if(_0x39c983[a1_0x108e('0x1a')]){User_1[a1_0x108e('0x9')][a1_0x108e('0x1b')]({'facebook':_0x16ab4b['id']},(_0x4f9e89,_0x5ade00)=>{if(_0x4f9e89){return _0xf7407a(_0x4f9e89);}if(_0x5ade00){_0x39c983[a1_0x108e('0x1c')](a1_0x108e('0x1d'),{'msg':a1_0x108e('0x1e')});_0xf7407a(_0x4f9e89);}else{User_1[a1_0x108e('0x9')][a1_0x108e('0xc')](_0x39c983[a1_0x108e('0x1a')]['id'],(_0x4f9e89,_0x3e0b19)=>{if(_0x4f9e89){return _0xf7407a(_0x4f9e89);}_0x3e0b19[a1_0x108e('0x1f')]=_0x16ab4b['id'];_0x3e0b19[a1_0x108e('0x20')][a1_0x108e('0x21')]({'kind':'facebook','accessToken':_0x987b5a});_0x3e0b19[a1_0x108e('0x22')][a1_0x108e('0x17')]=_0x3e0b19[a1_0x108e('0x22')]['name']||_0x16ab4b[a1_0x108e('0x17')]['givenName']+'\x20'+_0x16ab4b['name']['familyName'];_0x3e0b19[a1_0x108e('0x22')][a1_0x108e('0x23')]=_0x3e0b19['profile'][a1_0x108e('0x23')]||_0x16ab4b['_json'][a1_0x108e('0x23')];_0x3e0b19[a1_0x108e('0x22')]['picture']=_0x3e0b19[a1_0x108e('0x22')][a1_0x108e('0x24')]||a1_0x108e('0x25')+_0x16ab4b['id']+a1_0x108e('0x26');_0x3e0b19[a1_0x108e('0x27')](_0x4f9e89=>{_0x39c983[a1_0x108e('0x1c')](a1_0x108e('0x28'),{'msg':a1_0x108e('0x29')});_0xf7407a(_0x4f9e89,_0x3e0b19);});});}});}else{User_1[a1_0x108e('0x9')][a1_0x108e('0x1b')]({'facebook':_0x16ab4b['id']},(_0x43f957,_0x10cf53)=>{if(_0x43f957){return _0xf7407a(_0x43f957);}if(_0x10cf53){return _0xf7407a(undefined,_0x10cf53);}User_1[a1_0x108e('0x9')][a1_0x108e('0x1b')]({'email':_0x16ab4b[a1_0x108e('0x2a')][a1_0x108e('0xd')]},(_0x43f957,_0x3492c2)=>{if(_0x43f957){return _0xf7407a(_0x43f957);}if(_0x3492c2){_0x39c983[a1_0x108e('0x1c')](a1_0x108e('0x1d'),{'msg':a1_0x108e('0x2b')});_0xf7407a(_0x43f957);}else{const _0x1bf725=new User_1['default']();_0x1bf725[a1_0x108e('0xd')]=_0x16ab4b[a1_0x108e('0x2a')][a1_0x108e('0xd')];_0x1bf725[a1_0x108e('0x1f')]=_0x16ab4b['id'];_0x1bf725[a1_0x108e('0x20')][a1_0x108e('0x21')]({'kind':'facebook','accessToken':_0x987b5a});_0x1bf725[a1_0x108e('0x22')][a1_0x108e('0x17')]=_0x16ab4b[a1_0x108e('0x17')][a1_0x108e('0x2c')]+'\x20'+_0x16ab4b[a1_0x108e('0x17')][a1_0x108e('0x2d')];_0x1bf725[a1_0x108e('0x22')][a1_0x108e('0x23')]=_0x16ab4b[a1_0x108e('0x2a')]['gender'];_0x1bf725[a1_0x108e('0x22')][a1_0x108e('0x24')]=a1_0x108e('0x25')+_0x16ab4b['id']+a1_0x108e('0x26');_0x1bf725[a1_0x108e('0x22')][a1_0x108e('0x2e')]=_0x16ab4b['_json'][a1_0x108e('0x2e')]?_0x16ab4b[a1_0x108e('0x2a')][a1_0x108e('0x2e')][a1_0x108e('0x17')]:'';_0x1bf725[a1_0x108e('0x27')](_0x43f957=>{_0xf7407a(_0x43f957,_0x1bf725);});}});});}}));exports[a1_0x108e('0x2f')]=(_0x3ad385,_0x19aa9d,_0xdac49a)=>{if(_0x3ad385[a1_0x108e('0x2f')]()){return _0xdac49a();}_0x19aa9d[a1_0x108e('0x30')](a1_0x108e('0x31'));};exports['isAuthorized']=(_0xb49025,_0x374c0d,_0x47e56b)=>{const _0x413c75=_0xb49025['path'][a1_0x108e('0x32')]('/')[a1_0x108e('0x33')](-0x1)[0x0];if(lodash_1[a1_0x108e('0x9')]['find'](_0xb49025[a1_0x108e('0x1a')]['tokens'],{'kind':_0x413c75})){_0x47e56b();}else{_0x374c0d[a1_0x108e('0x30')](a1_0x108e('0x34')+_0x413c75);}};
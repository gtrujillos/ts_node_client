var a1_0x38d1=['__importDefault','__esModule','defineProperty','passport','passport-facebook','lodash','../models/User','default','Strategy','serializeUser','findById','use','findOne','toLowerCase','Email\x20','\x20not\x20found.','comparePassword','Invalid\x20email\x20or\x20password.','env','FACEBOOK_SECRET','/auth/facebook/callback','name','email','link','locale','timezone','flash','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','user','facebook','tokens','profile','givenName','familyName','gender','picture','https://graph.facebook.com/','/picture?type=large','save','info','Facebook\x20account\x20has\x20been\x20linked.','_json','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','push','location','isAuthenticated','redirect','/login','path','split','find','/auth/'];(function(_0x19a34d,_0x27abd6){var _0x10c5af=function(_0x40b7ab){while(--_0x40b7ab){_0x19a34d['push'](_0x19a34d['shift']());}};_0x10c5af(++_0x27abd6);}(a1_0x38d1,0x1dd));var a1_0x22ac=function(_0x4bd9c5,_0x18200f){_0x4bd9c5=_0x4bd9c5-0x0;var _0x36ec18=a1_0x38d1[_0x4bd9c5];return _0x36ec18;};'use strict';var __importDefault=this&&this[a1_0x22ac('0x0')]||function(_0x5bcaf8){return _0x5bcaf8&&_0x5bcaf8[a1_0x22ac('0x1')]?_0x5bcaf8:{'default':_0x5bcaf8};};Object[a1_0x22ac('0x2')](exports,'__esModule',{'value':!![]});const passport_1=__importDefault(require(a1_0x22ac('0x3')));const passport_local_1=__importDefault(require('passport-local'));const passport_facebook_1=__importDefault(require(a1_0x22ac('0x4')));const lodash_1=__importDefault(require(a1_0x22ac('0x5')));const User_1=__importDefault(require(a1_0x22ac('0x6')));const LocalStrategy=passport_local_1[a1_0x22ac('0x7')][a1_0x22ac('0x8')];const FacebookStrategy=passport_facebook_1['default'][a1_0x22ac('0x8')];passport_1[a1_0x22ac('0x7')][a1_0x22ac('0x9')]((_0xcc20ec,_0x4a0425)=>{_0x4a0425(undefined,_0xcc20ec['id']);});passport_1[a1_0x22ac('0x7')]['deserializeUser']((_0x56a093,_0x5af091)=>{User_1[a1_0x22ac('0x7')][a1_0x22ac('0xa')](_0x56a093,(_0x22150c,_0x2a59f1)=>{_0x5af091(_0x22150c,_0x2a59f1);});});passport_1['default'][a1_0x22ac('0xb')](new LocalStrategy({'usernameField':'email'},(_0x4ac0b9,_0x28ee9d,_0x5b381a)=>{User_1[a1_0x22ac('0x7')][a1_0x22ac('0xc')]({'email':_0x4ac0b9[a1_0x22ac('0xd')]()},(_0x504bd2,_0x533a74)=>{if(_0x504bd2){return _0x5b381a(_0x504bd2);}if(!_0x533a74){return _0x5b381a(undefined,![],{'message':a1_0x22ac('0xe')+_0x4ac0b9+a1_0x22ac('0xf')});}_0x533a74[a1_0x22ac('0x10')](_0x28ee9d,(_0x504bd2,_0x3288c6)=>{if(_0x504bd2){return _0x5b381a(_0x504bd2);}if(_0x3288c6){return _0x5b381a(undefined,_0x533a74);}return _0x5b381a(undefined,![],{'message':a1_0x22ac('0x11')});});});}));passport_1['default'][a1_0x22ac('0xb')](new FacebookStrategy({'clientID':process[a1_0x22ac('0x12')]['FACEBOOK_ID'],'clientSecret':process[a1_0x22ac('0x12')][a1_0x22ac('0x13')],'callbackURL':a1_0x22ac('0x14'),'profileFields':[a1_0x22ac('0x15'),a1_0x22ac('0x16'),a1_0x22ac('0x17'),a1_0x22ac('0x18'),a1_0x22ac('0x19')],'passReqToCallback':!![]},(_0x33aa77,_0x21f046,_0x146395,_0x3f45af,_0x16458a)=>{if(_0x33aa77['user']){User_1['default'][a1_0x22ac('0xc')]({'facebook':_0x3f45af['id']},(_0x24c55c,_0x523b6f)=>{if(_0x24c55c){return _0x16458a(_0x24c55c);}if(_0x523b6f){_0x33aa77[a1_0x22ac('0x1a')](a1_0x22ac('0x1b'),{'msg':a1_0x22ac('0x1c')});_0x16458a(_0x24c55c);}else{User_1[a1_0x22ac('0x7')][a1_0x22ac('0xa')](_0x33aa77[a1_0x22ac('0x1d')]['id'],(_0x24c55c,_0x5315e7)=>{if(_0x24c55c){return _0x16458a(_0x24c55c);}_0x5315e7[a1_0x22ac('0x1e')]=_0x3f45af['id'];_0x5315e7[a1_0x22ac('0x1f')]['push']({'kind':a1_0x22ac('0x1e'),'accessToken':_0x21f046});_0x5315e7[a1_0x22ac('0x20')][a1_0x22ac('0x15')]=_0x5315e7[a1_0x22ac('0x20')]['name']||_0x3f45af[a1_0x22ac('0x15')][a1_0x22ac('0x21')]+'\x20'+_0x3f45af[a1_0x22ac('0x15')][a1_0x22ac('0x22')];_0x5315e7[a1_0x22ac('0x20')][a1_0x22ac('0x23')]=_0x5315e7[a1_0x22ac('0x20')][a1_0x22ac('0x23')]||_0x3f45af['_json'][a1_0x22ac('0x23')];_0x5315e7[a1_0x22ac('0x20')]['picture']=_0x5315e7[a1_0x22ac('0x20')][a1_0x22ac('0x24')]||a1_0x22ac('0x25')+_0x3f45af['id']+a1_0x22ac('0x26');_0x5315e7[a1_0x22ac('0x27')](_0x24c55c=>{_0x33aa77[a1_0x22ac('0x1a')](a1_0x22ac('0x28'),{'msg':a1_0x22ac('0x29')});_0x16458a(_0x24c55c,_0x5315e7);});});}});}else{User_1[a1_0x22ac('0x7')][a1_0x22ac('0xc')]({'facebook':_0x3f45af['id']},(_0x5a2d48,_0x2c7b61)=>{if(_0x5a2d48){return _0x16458a(_0x5a2d48);}if(_0x2c7b61){return _0x16458a(undefined,_0x2c7b61);}User_1['default'][a1_0x22ac('0xc')]({'email':_0x3f45af[a1_0x22ac('0x2a')][a1_0x22ac('0x16')]},(_0x5a2d48,_0x2f2bb0)=>{if(_0x5a2d48){return _0x16458a(_0x5a2d48);}if(_0x2f2bb0){_0x33aa77[a1_0x22ac('0x1a')](a1_0x22ac('0x1b'),{'msg':a1_0x22ac('0x2b')});_0x16458a(_0x5a2d48);}else{const _0x5a479f=new User_1[(a1_0x22ac('0x7'))]();_0x5a479f[a1_0x22ac('0x16')]=_0x3f45af[a1_0x22ac('0x2a')][a1_0x22ac('0x16')];_0x5a479f[a1_0x22ac('0x1e')]=_0x3f45af['id'];_0x5a479f[a1_0x22ac('0x1f')][a1_0x22ac('0x2c')]({'kind':a1_0x22ac('0x1e'),'accessToken':_0x21f046});_0x5a479f[a1_0x22ac('0x20')]['name']=_0x3f45af[a1_0x22ac('0x15')][a1_0x22ac('0x21')]+'\x20'+_0x3f45af[a1_0x22ac('0x15')]['familyName'];_0x5a479f[a1_0x22ac('0x20')][a1_0x22ac('0x23')]=_0x3f45af[a1_0x22ac('0x2a')][a1_0x22ac('0x23')];_0x5a479f[a1_0x22ac('0x20')][a1_0x22ac('0x24')]=a1_0x22ac('0x25')+_0x3f45af['id']+a1_0x22ac('0x26');_0x5a479f[a1_0x22ac('0x20')]['location']=_0x3f45af[a1_0x22ac('0x2a')][a1_0x22ac('0x2d')]?_0x3f45af[a1_0x22ac('0x2a')][a1_0x22ac('0x2d')]['name']:'';_0x5a479f['save'](_0x5a2d48=>{_0x16458a(_0x5a2d48,_0x5a479f);});}});});}}));exports[a1_0x22ac('0x2e')]=(_0x367d9a,_0x162b13,_0x54587f)=>{if(_0x367d9a[a1_0x22ac('0x2e')]()){return _0x54587f();}_0x162b13[a1_0x22ac('0x2f')](a1_0x22ac('0x30'));};exports['isAuthorized']=(_0x2e7837,_0x424e9e,_0x4759df)=>{const _0x320270=_0x2e7837[a1_0x22ac('0x31')][a1_0x22ac('0x32')]('/')['slice'](-0x1)[0x0];if(lodash_1['default'][a1_0x22ac('0x33')](_0x2e7837[a1_0x22ac('0x1d')][a1_0x22ac('0x1f')],{'kind':_0x320270})){_0x4759df();}else{_0x424e9e[a1_0x22ac('0x2f')](a1_0x22ac('0x34')+_0x320270);}};
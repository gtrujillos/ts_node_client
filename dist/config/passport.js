var a1_0x1d50=['__esModule','passport','passport-local','passport-facebook','lodash','../models/User','default','Strategy','serializeUser','deserializeUser','findById','use','email','findOne','Email\x20','comparePassword','Invalid\x20email\x20or\x20password.','env','FACEBOOK_ID','FACEBOOK_SECRET','link','timezone','user','flash','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','facebook','tokens','push','profile','name','givenName','gender','picture','/picture?type=large','save','info','Facebook\x20account\x20has\x20been\x20linked.','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','familyName','_json','location','isAuthenticated','redirect','/login','isAuthorized','path','split','slice','find','/auth/','__importDefault'];(function(_0x8cb07,_0x529122){var _0xc1d01b=function(_0x39db58){while(--_0x39db58){_0x8cb07['push'](_0x8cb07['shift']());}};_0xc1d01b(++_0x529122);}(a1_0x1d50,0x19f));var a1_0x5b1a=function(_0x470a53,_0x15c868){_0x470a53=_0x470a53-0x0;var _0x10ab62=a1_0x1d50[_0x470a53];return _0x10ab62;};'use strict';var __importDefault=this&&this[a1_0x5b1a('0x0')]||function(_0x4bce00){return _0x4bce00&&_0x4bce00[a1_0x5b1a('0x1')]?_0x4bce00:{'default':_0x4bce00};};Object['defineProperty'](exports,a1_0x5b1a('0x1'),{'value':!![]});const passport_1=__importDefault(require(a1_0x5b1a('0x2')));const passport_local_1=__importDefault(require(a1_0x5b1a('0x3')));const passport_facebook_1=__importDefault(require(a1_0x5b1a('0x4')));const lodash_1=__importDefault(require(a1_0x5b1a('0x5')));const User_1=__importDefault(require(a1_0x5b1a('0x6')));const LocalStrategy=passport_local_1[a1_0x5b1a('0x7')][a1_0x5b1a('0x8')];const FacebookStrategy=passport_facebook_1['default'][a1_0x5b1a('0x8')];passport_1['default'][a1_0x5b1a('0x9')]((_0x168465,_0x4ab837)=>{_0x4ab837(undefined,_0x168465['id']);});passport_1[a1_0x5b1a('0x7')][a1_0x5b1a('0xa')]((_0x2ff1f6,_0x14dd43)=>{User_1[a1_0x5b1a('0x7')][a1_0x5b1a('0xb')](_0x2ff1f6,(_0x101afb,_0x5970b6)=>{_0x14dd43(_0x101afb,_0x5970b6);});});passport_1[a1_0x5b1a('0x7')][a1_0x5b1a('0xc')](new LocalStrategy({'usernameField':a1_0x5b1a('0xd')},(_0x4997c1,_0x21da8d,_0x19cf43)=>{User_1[a1_0x5b1a('0x7')][a1_0x5b1a('0xe')]({'email':_0x4997c1['toLowerCase']()},(_0x55fff4,_0x25d953)=>{if(_0x55fff4){return _0x19cf43(_0x55fff4);}if(!_0x25d953){return _0x19cf43(undefined,![],{'message':a1_0x5b1a('0xf')+_0x4997c1+'\x20not\x20found.'});}_0x25d953[a1_0x5b1a('0x10')](_0x21da8d,(_0x55fff4,_0x18b37d)=>{if(_0x55fff4){return _0x19cf43(_0x55fff4);}if(_0x18b37d){return _0x19cf43(undefined,_0x25d953);}return _0x19cf43(undefined,![],{'message':a1_0x5b1a('0x11')});});});}));passport_1[a1_0x5b1a('0x7')][a1_0x5b1a('0xc')](new FacebookStrategy({'clientID':process[a1_0x5b1a('0x12')][a1_0x5b1a('0x13')],'clientSecret':process['env'][a1_0x5b1a('0x14')],'callbackURL':'/auth/facebook/callback','profileFields':['name','email',a1_0x5b1a('0x15'),'locale',a1_0x5b1a('0x16')],'passReqToCallback':!![]},(_0x5a97cf,_0x2b0449,_0x132039,_0x2a34a1,_0x5d4b6a)=>{if(_0x5a97cf[a1_0x5b1a('0x17')]){User_1['default'][a1_0x5b1a('0xe')]({'facebook':_0x2a34a1['id']},(_0x4250b1,_0x318ff6)=>{if(_0x4250b1){return _0x5d4b6a(_0x4250b1);}if(_0x318ff6){_0x5a97cf[a1_0x5b1a('0x18')](a1_0x5b1a('0x19'),{'msg':a1_0x5b1a('0x1a')});_0x5d4b6a(_0x4250b1);}else{User_1[a1_0x5b1a('0x7')][a1_0x5b1a('0xb')](_0x5a97cf[a1_0x5b1a('0x17')]['id'],(_0x4250b1,_0x5b8b22)=>{if(_0x4250b1){return _0x5d4b6a(_0x4250b1);}_0x5b8b22[a1_0x5b1a('0x1b')]=_0x2a34a1['id'];_0x5b8b22[a1_0x5b1a('0x1c')][a1_0x5b1a('0x1d')]({'kind':a1_0x5b1a('0x1b'),'accessToken':_0x2b0449});_0x5b8b22[a1_0x5b1a('0x1e')][a1_0x5b1a('0x1f')]=_0x5b8b22['profile'][a1_0x5b1a('0x1f')]||_0x2a34a1[a1_0x5b1a('0x1f')][a1_0x5b1a('0x20')]+'\x20'+_0x2a34a1['name']['familyName'];_0x5b8b22[a1_0x5b1a('0x1e')]['gender']=_0x5b8b22[a1_0x5b1a('0x1e')][a1_0x5b1a('0x21')]||_0x2a34a1['_json']['gender'];_0x5b8b22['profile'][a1_0x5b1a('0x22')]=_0x5b8b22[a1_0x5b1a('0x1e')][a1_0x5b1a('0x22')]||'https://graph.facebook.com/'+_0x2a34a1['id']+a1_0x5b1a('0x23');_0x5b8b22[a1_0x5b1a('0x24')](_0x4250b1=>{_0x5a97cf[a1_0x5b1a('0x18')](a1_0x5b1a('0x25'),{'msg':a1_0x5b1a('0x26')});_0x5d4b6a(_0x4250b1,_0x5b8b22);});});}});}else{User_1[a1_0x5b1a('0x7')][a1_0x5b1a('0xe')]({'facebook':_0x2a34a1['id']},(_0x110abd,_0x55ec75)=>{if(_0x110abd){return _0x5d4b6a(_0x110abd);}if(_0x55ec75){return _0x5d4b6a(undefined,_0x55ec75);}User_1[a1_0x5b1a('0x7')][a1_0x5b1a('0xe')]({'email':_0x2a34a1['_json'][a1_0x5b1a('0xd')]},(_0x110abd,_0x5c3ddb)=>{if(_0x110abd){return _0x5d4b6a(_0x110abd);}if(_0x5c3ddb){_0x5a97cf[a1_0x5b1a('0x18')](a1_0x5b1a('0x19'),{'msg':a1_0x5b1a('0x27')});_0x5d4b6a(_0x110abd);}else{const _0x241629=new User_1[(a1_0x5b1a('0x7'))]();_0x241629['email']=_0x2a34a1['_json']['email'];_0x241629[a1_0x5b1a('0x1b')]=_0x2a34a1['id'];_0x241629[a1_0x5b1a('0x1c')][a1_0x5b1a('0x1d')]({'kind':a1_0x5b1a('0x1b'),'accessToken':_0x2b0449});_0x241629[a1_0x5b1a('0x1e')][a1_0x5b1a('0x1f')]=_0x2a34a1['name'][a1_0x5b1a('0x20')]+'\x20'+_0x2a34a1[a1_0x5b1a('0x1f')][a1_0x5b1a('0x28')];_0x241629['profile'][a1_0x5b1a('0x21')]=_0x2a34a1['_json']['gender'];_0x241629[a1_0x5b1a('0x1e')]['picture']='https://graph.facebook.com/'+_0x2a34a1['id']+'/picture?type=large';_0x241629[a1_0x5b1a('0x1e')]['location']=_0x2a34a1[a1_0x5b1a('0x29')][a1_0x5b1a('0x2a')]?_0x2a34a1[a1_0x5b1a('0x29')]['location']['name']:'';_0x241629[a1_0x5b1a('0x24')](_0x110abd=>{_0x5d4b6a(_0x110abd,_0x241629);});}});});}}));exports[a1_0x5b1a('0x2b')]=(_0x1f4f94,_0x4d0880,_0x52d003)=>{if(_0x1f4f94[a1_0x5b1a('0x2b')]()){return _0x52d003();}_0x4d0880[a1_0x5b1a('0x2c')](a1_0x5b1a('0x2d'));};exports[a1_0x5b1a('0x2e')]=(_0x1fdaff,_0x13b3ea,_0x497336)=>{const _0x588480=_0x1fdaff[a1_0x5b1a('0x2f')][a1_0x5b1a('0x30')]('/')[a1_0x5b1a('0x31')](-0x1)[0x0];if(lodash_1[a1_0x5b1a('0x7')][a1_0x5b1a('0x32')](_0x1fdaff[a1_0x5b1a('0x17')][a1_0x5b1a('0x1c')],{'kind':_0x588480})){_0x497336();}else{_0x13b3ea[a1_0x5b1a('0x2c')](a1_0x5b1a('0x33')+_0x588480);}};
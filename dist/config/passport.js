var a1_0x1317=['../models/User','default','Strategy','serializeUser','findById','email','toLowerCase','Email\x20','\x20not\x20found.','comparePassword','Invalid\x20email\x20or\x20password.','use','env','FACEBOOK_SECRET','/auth/facebook/callback','name','locale','timezone','user','findOne','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','facebook','tokens','push','profile','familyName','gender','_json','picture','/picture?type=large','save','flash','info','Facebook\x20account\x20has\x20been\x20linked.','errors','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','givenName','location','isAuthenticated','/login','isAuthorized','path','split','redirect','/auth/','__importDefault','__esModule','defineProperty','passport','passport-local','lodash'];(function(_0x5b3330,_0x1982b4){var _0xa310b4=function(_0x5ac96b){while(--_0x5ac96b){_0x5b3330['push'](_0x5b3330['shift']());}};_0xa310b4(++_0x1982b4);}(a1_0x1317,0x1c5));var a1_0xfe59=function(_0x6fb613,_0x1e4176){_0x6fb613=_0x6fb613-0x0;var _0x512a46=a1_0x1317[_0x6fb613];return _0x512a46;};'use strict';var __importDefault=this&&this[a1_0xfe59('0x0')]||function(_0xadbf8){return _0xadbf8&&_0xadbf8[a1_0xfe59('0x1')]?_0xadbf8:{'default':_0xadbf8};};Object[a1_0xfe59('0x2')](exports,a1_0xfe59('0x1'),{'value':!![]});const passport_1=__importDefault(require(a1_0xfe59('0x3')));const passport_local_1=__importDefault(require(a1_0xfe59('0x4')));const passport_facebook_1=__importDefault(require('passport-facebook'));const lodash_1=__importDefault(require(a1_0xfe59('0x5')));const User_1=__importDefault(require(a1_0xfe59('0x6')));const LocalStrategy=passport_local_1[a1_0xfe59('0x7')][a1_0xfe59('0x8')];const FacebookStrategy=passport_facebook_1[a1_0xfe59('0x7')]['Strategy'];passport_1['default'][a1_0xfe59('0x9')]((_0x181668,_0x572dde)=>{_0x572dde(undefined,_0x181668['id']);});passport_1['default']['deserializeUser']((_0x3640ef,_0x1ef169)=>{User_1['default'][a1_0xfe59('0xa')](_0x3640ef,(_0x3814eb,_0x512225)=>{_0x1ef169(_0x3814eb,_0x512225);});});passport_1[a1_0xfe59('0x7')]['use'](new LocalStrategy({'usernameField':a1_0xfe59('0xb')},(_0x5657c7,_0x56819f,_0x1a3196)=>{User_1[a1_0xfe59('0x7')]['findOne']({'email':_0x5657c7[a1_0xfe59('0xc')]()},(_0x422385,_0x1b6dd5)=>{if(_0x422385){return _0x1a3196(_0x422385);}if(!_0x1b6dd5){return _0x1a3196(undefined,![],{'message':a1_0xfe59('0xd')+_0x5657c7+a1_0xfe59('0xe')});}_0x1b6dd5[a1_0xfe59('0xf')](_0x56819f,(_0x422385,_0x2f42d9)=>{if(_0x422385){return _0x1a3196(_0x422385);}if(_0x2f42d9){return _0x1a3196(undefined,_0x1b6dd5);}return _0x1a3196(undefined,![],{'message':a1_0xfe59('0x10')});});});}));passport_1[a1_0xfe59('0x7')][a1_0xfe59('0x11')](new FacebookStrategy({'clientID':process[a1_0xfe59('0x12')]['FACEBOOK_ID'],'clientSecret':process[a1_0xfe59('0x12')][a1_0xfe59('0x13')],'callbackURL':a1_0xfe59('0x14'),'profileFields':[a1_0xfe59('0x15'),a1_0xfe59('0xb'),'link',a1_0xfe59('0x16'),a1_0xfe59('0x17')],'passReqToCallback':!![]},(_0x459a33,_0x2da9ad,_0x6adddb,_0x2c1e58,_0x2268e8)=>{if(_0x459a33[a1_0xfe59('0x18')]){User_1['default'][a1_0xfe59('0x19')]({'facebook':_0x2c1e58['id']},(_0x351c2e,_0x35fe46)=>{if(_0x351c2e){return _0x2268e8(_0x351c2e);}if(_0x35fe46){_0x459a33['flash']('errors',{'msg':a1_0xfe59('0x1a')});_0x2268e8(_0x351c2e);}else{User_1[a1_0xfe59('0x7')][a1_0xfe59('0xa')](_0x459a33[a1_0xfe59('0x18')]['id'],(_0x351c2e,_0x44b73e)=>{if(_0x351c2e){return _0x2268e8(_0x351c2e);}_0x44b73e[a1_0xfe59('0x1b')]=_0x2c1e58['id'];_0x44b73e[a1_0xfe59('0x1c')][a1_0xfe59('0x1d')]({'kind':a1_0xfe59('0x1b'),'accessToken':_0x2da9ad});_0x44b73e[a1_0xfe59('0x1e')][a1_0xfe59('0x15')]=_0x44b73e['profile']['name']||_0x2c1e58[a1_0xfe59('0x15')]['givenName']+'\x20'+_0x2c1e58[a1_0xfe59('0x15')][a1_0xfe59('0x1f')];_0x44b73e['profile']['gender']=_0x44b73e[a1_0xfe59('0x1e')][a1_0xfe59('0x20')]||_0x2c1e58[a1_0xfe59('0x21')][a1_0xfe59('0x20')];_0x44b73e[a1_0xfe59('0x1e')]['picture']=_0x44b73e['profile'][a1_0xfe59('0x22')]||'https://graph.facebook.com/'+_0x2c1e58['id']+a1_0xfe59('0x23');_0x44b73e[a1_0xfe59('0x24')](_0x351c2e=>{_0x459a33[a1_0xfe59('0x25')](a1_0xfe59('0x26'),{'msg':a1_0xfe59('0x27')});_0x2268e8(_0x351c2e,_0x44b73e);});});}});}else{User_1[a1_0xfe59('0x7')][a1_0xfe59('0x19')]({'facebook':_0x2c1e58['id']},(_0x1536a6,_0x5e7da7)=>{if(_0x1536a6){return _0x2268e8(_0x1536a6);}if(_0x5e7da7){return _0x2268e8(undefined,_0x5e7da7);}User_1['default']['findOne']({'email':_0x2c1e58[a1_0xfe59('0x21')][a1_0xfe59('0xb')]},(_0x1536a6,_0x400e45)=>{if(_0x1536a6){return _0x2268e8(_0x1536a6);}if(_0x400e45){_0x459a33[a1_0xfe59('0x25')](a1_0xfe59('0x28'),{'msg':a1_0xfe59('0x29')});_0x2268e8(_0x1536a6);}else{const _0x4f3dc7=new User_1[(a1_0xfe59('0x7'))]();_0x4f3dc7[a1_0xfe59('0xb')]=_0x2c1e58[a1_0xfe59('0x21')][a1_0xfe59('0xb')];_0x4f3dc7['facebook']=_0x2c1e58['id'];_0x4f3dc7[a1_0xfe59('0x1c')][a1_0xfe59('0x1d')]({'kind':a1_0xfe59('0x1b'),'accessToken':_0x2da9ad});_0x4f3dc7[a1_0xfe59('0x1e')]['name']=_0x2c1e58[a1_0xfe59('0x15')][a1_0xfe59('0x2a')]+'\x20'+_0x2c1e58['name']['familyName'];_0x4f3dc7[a1_0xfe59('0x1e')][a1_0xfe59('0x20')]=_0x2c1e58['_json'][a1_0xfe59('0x20')];_0x4f3dc7[a1_0xfe59('0x1e')]['picture']='https://graph.facebook.com/'+_0x2c1e58['id']+a1_0xfe59('0x23');_0x4f3dc7[a1_0xfe59('0x1e')][a1_0xfe59('0x2b')]=_0x2c1e58[a1_0xfe59('0x21')][a1_0xfe59('0x2b')]?_0x2c1e58[a1_0xfe59('0x21')]['location'][a1_0xfe59('0x15')]:'';_0x4f3dc7['save'](_0x1536a6=>{_0x2268e8(_0x1536a6,_0x4f3dc7);});}});});}}));exports[a1_0xfe59('0x2c')]=(_0x6a89d7,_0x40b6d1,_0x46b607)=>{if(_0x6a89d7[a1_0xfe59('0x2c')]()){return _0x46b607();}_0x40b6d1['redirect'](a1_0xfe59('0x2d'));};exports[a1_0xfe59('0x2e')]=(_0x50e88e,_0x3bf711,_0x1c1f48)=>{const _0x5421b4=_0x50e88e[a1_0xfe59('0x2f')][a1_0xfe59('0x30')]('/')['slice'](-0x1)[0x0];if(lodash_1[a1_0xfe59('0x7')]['find'](_0x50e88e[a1_0xfe59('0x18')]['tokens'],{'kind':_0x5421b4})){_0x1c1f48();}else{_0x3bf711[a1_0xfe59('0x31')](a1_0xfe59('0x32')+_0x5421b4);}};
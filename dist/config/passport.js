var a1_0x6bfe=['familyName','location','isAuthenticated','/login','isAuthorized','path','split','slice','redirect','/auth/','__importDefault','defineProperty','__esModule','passport','passport-local','passport-facebook','lodash','../models/User','default','Strategy','serializeUser','findById','use','email','Email\x20','\x20not\x20found.','comparePassword','Invalid\x20email\x20or\x20password.','FACEBOOK_ID','/auth/facebook/callback','name','link','locale','timezone','user','flash','errors','There\x20is\x20already\x20a\x20Facebook\x20account\x20that\x20belongs\x20to\x20you.\x20Sign\x20in\x20with\x20that\x20account\x20or\x20delete\x20it,\x20then\x20link\x20it\x20with\x20your\x20current\x20account.','facebook','tokens','givenName','profile','gender','picture','https://graph.facebook.com/','/picture?type=large','save','info','Facebook\x20account\x20has\x20been\x20linked.','findOne','_json','There\x20is\x20already\x20an\x20account\x20using\x20this\x20email\x20address.\x20Sign\x20in\x20to\x20that\x20account\x20and\x20link\x20it\x20with\x20Facebook\x20manually\x20from\x20Account\x20Settings.','push'];(function(_0x1940cb,_0x1d612b){var _0x164571=function(_0xa5d9af){while(--_0xa5d9af){_0x1940cb['push'](_0x1940cb['shift']());}};_0x164571(++_0x1d612b);}(a1_0x6bfe,0x113));var a1_0x4a44=function(_0x567f46,_0x5543d3){_0x567f46=_0x567f46-0x0;var _0x31ead0=a1_0x6bfe[_0x567f46];return _0x31ead0;};'use strict';var __importDefault=this&&this[a1_0x4a44('0x0')]||function(_0x3ffa36){return _0x3ffa36&&_0x3ffa36['__esModule']?_0x3ffa36:{'default':_0x3ffa36};};Object[a1_0x4a44('0x1')](exports,a1_0x4a44('0x2'),{'value':!![]});const passport_1=__importDefault(require(a1_0x4a44('0x3')));const passport_local_1=__importDefault(require(a1_0x4a44('0x4')));const passport_facebook_1=__importDefault(require(a1_0x4a44('0x5')));const lodash_1=__importDefault(require(a1_0x4a44('0x6')));const User_1=__importDefault(require(a1_0x4a44('0x7')));const LocalStrategy=passport_local_1[a1_0x4a44('0x8')][a1_0x4a44('0x9')];const FacebookStrategy=passport_facebook_1['default'][a1_0x4a44('0x9')];passport_1[a1_0x4a44('0x8')][a1_0x4a44('0xa')]((_0x4d0ade,_0x3cb822)=>{_0x3cb822(undefined,_0x4d0ade['id']);});passport_1[a1_0x4a44('0x8')]['deserializeUser']((_0x118569,_0x4a846c)=>{User_1[a1_0x4a44('0x8')][a1_0x4a44('0xb')](_0x118569,(_0x4ba13a,_0x37de6a)=>{_0x4a846c(_0x4ba13a,_0x37de6a);});});passport_1[a1_0x4a44('0x8')][a1_0x4a44('0xc')](new LocalStrategy({'usernameField':a1_0x4a44('0xd')},(_0x3862db,_0x350132,_0x27c860)=>{User_1[a1_0x4a44('0x8')]['findOne']({'email':_0x3862db['toLowerCase']()},(_0x3bacfd,_0xdc3872)=>{if(_0x3bacfd){return _0x27c860(_0x3bacfd);}if(!_0xdc3872){return _0x27c860(undefined,![],{'message':a1_0x4a44('0xe')+_0x3862db+a1_0x4a44('0xf')});}_0xdc3872[a1_0x4a44('0x10')](_0x350132,(_0x3bacfd,_0xcbc090)=>{if(_0x3bacfd){return _0x27c860(_0x3bacfd);}if(_0xcbc090){return _0x27c860(undefined,_0xdc3872);}return _0x27c860(undefined,![],{'message':a1_0x4a44('0x11')});});});}));passport_1[a1_0x4a44('0x8')][a1_0x4a44('0xc')](new FacebookStrategy({'clientID':process['env'][a1_0x4a44('0x12')],'clientSecret':process['env']['FACEBOOK_SECRET'],'callbackURL':a1_0x4a44('0x13'),'profileFields':[a1_0x4a44('0x14'),a1_0x4a44('0xd'),a1_0x4a44('0x15'),a1_0x4a44('0x16'),a1_0x4a44('0x17')],'passReqToCallback':!![]},(_0x278ca9,_0xb5e568,_0x4b1071,_0x28cf6d,_0x5c95ab)=>{if(_0x278ca9[a1_0x4a44('0x18')]){User_1[a1_0x4a44('0x8')]['findOne']({'facebook':_0x28cf6d['id']},(_0x48607e,_0x35e932)=>{if(_0x48607e){return _0x5c95ab(_0x48607e);}if(_0x35e932){_0x278ca9[a1_0x4a44('0x19')](a1_0x4a44('0x1a'),{'msg':a1_0x4a44('0x1b')});_0x5c95ab(_0x48607e);}else{User_1[a1_0x4a44('0x8')][a1_0x4a44('0xb')](_0x278ca9[a1_0x4a44('0x18')]['id'],(_0x48607e,_0x38004a)=>{if(_0x48607e){return _0x5c95ab(_0x48607e);}_0x38004a[a1_0x4a44('0x1c')]=_0x28cf6d['id'];_0x38004a[a1_0x4a44('0x1d')]['push']({'kind':'facebook','accessToken':_0xb5e568});_0x38004a['profile'][a1_0x4a44('0x14')]=_0x38004a['profile'][a1_0x4a44('0x14')]||_0x28cf6d[a1_0x4a44('0x14')][a1_0x4a44('0x1e')]+'\x20'+_0x28cf6d[a1_0x4a44('0x14')]['familyName'];_0x38004a['profile']['gender']=_0x38004a[a1_0x4a44('0x1f')][a1_0x4a44('0x20')]||_0x28cf6d['_json']['gender'];_0x38004a[a1_0x4a44('0x1f')]['picture']=_0x38004a[a1_0x4a44('0x1f')][a1_0x4a44('0x21')]||a1_0x4a44('0x22')+_0x28cf6d['id']+a1_0x4a44('0x23');_0x38004a[a1_0x4a44('0x24')](_0x48607e=>{_0x278ca9['flash'](a1_0x4a44('0x25'),{'msg':a1_0x4a44('0x26')});_0x5c95ab(_0x48607e,_0x38004a);});});}});}else{User_1[a1_0x4a44('0x8')][a1_0x4a44('0x27')]({'facebook':_0x28cf6d['id']},(_0x12754b,_0x3d8839)=>{if(_0x12754b){return _0x5c95ab(_0x12754b);}if(_0x3d8839){return _0x5c95ab(undefined,_0x3d8839);}User_1['default']['findOne']({'email':_0x28cf6d[a1_0x4a44('0x28')][a1_0x4a44('0xd')]},(_0x12754b,_0x39c52f)=>{if(_0x12754b){return _0x5c95ab(_0x12754b);}if(_0x39c52f){_0x278ca9[a1_0x4a44('0x19')](a1_0x4a44('0x1a'),{'msg':a1_0x4a44('0x29')});_0x5c95ab(_0x12754b);}else{const _0x4035ae=new User_1[(a1_0x4a44('0x8'))]();_0x4035ae[a1_0x4a44('0xd')]=_0x28cf6d[a1_0x4a44('0x28')][a1_0x4a44('0xd')];_0x4035ae['facebook']=_0x28cf6d['id'];_0x4035ae[a1_0x4a44('0x1d')][a1_0x4a44('0x2a')]({'kind':'facebook','accessToken':_0xb5e568});_0x4035ae[a1_0x4a44('0x1f')]['name']=_0x28cf6d[a1_0x4a44('0x14')][a1_0x4a44('0x1e')]+'\x20'+_0x28cf6d[a1_0x4a44('0x14')][a1_0x4a44('0x2b')];_0x4035ae['profile'][a1_0x4a44('0x20')]=_0x28cf6d['_json']['gender'];_0x4035ae[a1_0x4a44('0x1f')][a1_0x4a44('0x21')]=a1_0x4a44('0x22')+_0x28cf6d['id']+a1_0x4a44('0x23');_0x4035ae[a1_0x4a44('0x1f')][a1_0x4a44('0x2c')]=_0x28cf6d['_json'][a1_0x4a44('0x2c')]?_0x28cf6d[a1_0x4a44('0x28')][a1_0x4a44('0x2c')]['name']:'';_0x4035ae[a1_0x4a44('0x24')](_0x12754b=>{_0x5c95ab(_0x12754b,_0x4035ae);});}});});}}));exports[a1_0x4a44('0x2d')]=(_0x565641,_0x5e8781,_0x82d525)=>{if(_0x565641[a1_0x4a44('0x2d')]()){return _0x82d525();}_0x5e8781['redirect'](a1_0x4a44('0x2e'));};exports[a1_0x4a44('0x2f')]=(_0x350a9b,_0x359dea,_0x49b14e)=>{const _0x5f24e3=_0x350a9b[a1_0x4a44('0x30')][a1_0x4a44('0x31')]('/')[a1_0x4a44('0x32')](-0x1)[0x0];if(lodash_1['default']['find'](_0x350a9b['user'][a1_0x4a44('0x1d')],{'kind':_0x5f24e3})){_0x49b14e();}else{_0x359dea[a1_0x4a44('0x33')](a1_0x4a44('0x34')+_0x5f24e3);}};
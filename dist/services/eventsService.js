var a15_0x2178=['hour','minute','-00001','StationContext','settings','driverDocument','routeCode','routeName','nit','plate','day','second','locationParts','hdop','longitude','latitude','doorStatus','CountingInfo','Out','zlib','eventFileFolder','writeFile','error','.gz','createGzip','createReadStream','createWriteStream','pipe','existsSync','unlink','successfully\x20deleted\x20','successfully\x20created\x20','EventsService','defineProperty','__esModule','../infrastructure/stationSettings','request','sensorsService','countingWebSocketService','gpsService','bind','createEvent','startDate','DateUtils','eventDate','eventDateParts','getDateParts','createJson','createFile','log','1-71767930-','year','month'];(function(_0x3c2c78,_0xd771ff){var _0x3d423e=function(_0x169b91){while(--_0x169b91){_0x3c2c78['push'](_0x3c2c78['shift']());}};_0x3d423e(++_0xd771ff);}(a15_0x2178,0x1c9));var a15_0x1992=function(_0x156acd,_0x354298){_0x156acd=_0x156acd-0x0;var _0x389843=a15_0x2178[_0x156acd];return _0x389843;};'use strict';Object[a15_0x1992('0x0')](exports,a15_0x1992('0x1'),{'value':!![]});const stationSettings_1=require(a15_0x1992('0x2'));const dateUtils_1=require('../infrastructure/utils/dateUtils');const fs=require('fs');const request=require(a15_0x1992('0x3'));class EventsService{constructor(_0x4bb8c6,_0x3d7cc6,_0x278c98){this['eventDateParts']={'day':'','month':'','year':'','hour':'','minute':'','second':''};this['startDateParts']={'day':'','month':'','year':'','hour':'','minute':'','second':''};this['gpsService']=_0x4bb8c6;this[a15_0x1992('0x4')]=_0x3d7cc6;this[a15_0x1992('0x5')]=_0x278c98;this[a15_0x1992('0x6')]['createEvent']=this['createEvent'][a15_0x1992('0x7')](this);this[a15_0x1992('0x4')]['createEvent']=this['createEvent'][a15_0x1992('0x7')](this);this['countingWebSocketService'][a15_0x1992('0x8')]=this[a15_0x1992('0x8')][a15_0x1992('0x7')](this);this[a15_0x1992('0x9')]=new Date();this['startDateParts']=dateUtils_1[a15_0x1992('0xa')]['getDateParts'](this[a15_0x1992('0x9')]);}[a15_0x1992('0x8')](_0x41010f){try{this[a15_0x1992('0xb')]=new Date();this[a15_0x1992('0xc')]=dateUtils_1[a15_0x1992('0xa')][a15_0x1992('0xd')](this['eventDate']);const _0x262606=this[a15_0x1992('0xe')](_0x41010f);const _0x31291a=this[a15_0x1992('0xf')](_0x262606);}catch(_0x5ec26b){console[a15_0x1992('0x10')](_0x5ec26b);}}[a15_0x1992('0xe')](_0x254d13){const _0xb6501e={'idViaje':a15_0x1992('0x11')+this[a15_0x1992('0xc')][a15_0x1992('0x12')]+this[a15_0x1992('0xc')][a15_0x1992('0x13')]+this[a15_0x1992('0xc')]['day']+'-'+this[a15_0x1992('0xc')][a15_0x1992('0x14')]+this['eventDateParts'][a15_0x1992('0x15')]+this[a15_0x1992('0xc')]['second']+a15_0x1992('0x16'),'cedula':stationSettings_1[a15_0x1992('0x17')][a15_0x1992('0x18')][a15_0x1992('0x19')],'codigoRuta':stationSettings_1[a15_0x1992('0x17')][a15_0x1992('0x18')][a15_0x1992('0x1a')],'ruta':stationSettings_1[a15_0x1992('0x17')][a15_0x1992('0x18')][a15_0x1992('0x1b')],'nit':stationSettings_1['StationContext'][a15_0x1992('0x18')][a15_0x1992('0x1c')],'placa':stationSettings_1['StationContext'][a15_0x1992('0x18')][a15_0x1992('0x1d')],'inicio_viaje':this[a15_0x1992('0xc')][a15_0x1992('0x1e')]+'/'+this['eventDateParts']['month']+'/'+this['eventDateParts'][a15_0x1992('0x12')]+'\x20'+this[a15_0x1992('0xc')][a15_0x1992('0x14')]+':'+this[a15_0x1992('0xc')]['minute']+':'+this[a15_0x1992('0xc')][a15_0x1992('0x1f')],'fin_viaje':'','estado':'0','eventos':[{'archivo_enviado':![],'fecha':this[a15_0x1992('0xc')]['year']+this[a15_0x1992('0xc')]['month']+this['eventDateParts'][a15_0x1992('0x1e')],'hora':this[a15_0x1992('0xc')]['hour']+this[a15_0x1992('0xc')][a15_0x1992('0x15')]+this[a15_0x1992('0xc')][a15_0x1992('0x1f')],'dop':this['gpsService'][a15_0x1992('0x20')][a15_0x1992('0x21')],'longitud':this[a15_0x1992('0x6')][a15_0x1992('0x20')][a15_0x1992('0x22')],'latitud':this[a15_0x1992('0x6')][a15_0x1992('0x20')][a15_0x1992('0x23')],'velocidad':this[a15_0x1992('0x6')][a15_0x1992('0x20')]['speed'],'puerta':[{'estado':this[a15_0x1992('0x4')][a15_0x1992('0x24')],'idPuerta':0x0,'ingresos':_0x254d13!=null?_0x254d13[a15_0x1992('0x25')][0x0]['In']:0x0,'salidas':_0x254d13!=null?_0x254d13['CountingInfo'][0x0][a15_0x1992('0x26')]:0x0},{'estado':0x0,'idPuerta':0x1,'ingresos':0x0,'salidas':0x0}]}]};return _0xb6501e;}[a15_0x1992('0xf')](_0x2580eb){const _0x4596cb=require('fs');const _0x5edf41=require(a15_0x1992('0x27'));const _0x17de8e=stationSettings_1[a15_0x1992('0x17')]['settings'][a15_0x1992('0x1c')]+stationSettings_1[a15_0x1992('0x17')]['settings'][a15_0x1992('0x1d')]+this[a15_0x1992('0xc')]['day']+this['eventDateParts']['month']+this[a15_0x1992('0xc')][a15_0x1992('0x12')]+this[a15_0x1992('0xc')][a15_0x1992('0x14')]+this['eventDateParts'][a15_0x1992('0x15')]+this['eventDateParts']['second'];const _0x382c88=stationSettings_1[a15_0x1992('0x17')]['settings'][a15_0x1992('0x28')]+_0x17de8e;const _0xec67b=JSON['stringify'](_0x2580eb);_0x4596cb[a15_0x1992('0x29')](_0x382c88,_0xec67b,_0x3b53b5=>{if(_0x3b53b5)return console[a15_0x1992('0x2a')](_0x3b53b5);const _0x172dbb=_0x382c88+a15_0x1992('0x2b');const _0x329c19=_0x5edf41[a15_0x1992('0x2c')]();const _0x2fddf4=_0x4596cb[a15_0x1992('0x2d')](_0x382c88);const _0x89f8d0=_0x4596cb[a15_0x1992('0x2e')](_0x172dbb);_0x2fddf4['pipe'](_0x329c19)[a15_0x1992('0x2f')](_0x89f8d0)['on']('finish',_0x3b53b5=>{if(_0x3b53b5)return console[a15_0x1992('0x2a')](_0x3b53b5);else{if(_0x4596cb[a15_0x1992('0x30')](_0x382c88)){_0x4596cb[a15_0x1992('0x31')](_0x382c88,_0x3b53b5=>{if(_0x3b53b5)throw _0x3b53b5;console['log'](a15_0x1992('0x32')+_0x382c88);});}console['log'](a15_0x1992('0x33')+_0x172dbb);return _0x172dbb;}});});}}exports[a15_0x1992('0x34')]=EventsService;
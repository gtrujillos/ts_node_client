var a15_0x2f4d=['stringify','writeFile','error','.gz','createGzip','createWriteStream','pipe','finish','unlink','successfully\x20deleted\x20','successfully\x20created\x20','defineProperty','../infrastructure/stationSettings','../infrastructure/utils/dateUtils','request','gpsService','sensorsService','countingWebSocketService','createEvent','bind','startDate','startDateParts','DateUtils','getDateParts','eventDate','eventDateParts','createJson','createFile','log','1-71767930-','year','month','day','hour','minute','second','-00001','settings','driverDocument','StationContext','routeName','nit','plate','hdop','longitude','latitude','locationParts','speed','doorStatus','CountingInfo','zlib','eventFileFolder'];(function(_0x5f2b9d,_0xf3409f){var _0xb21497=function(_0x209969){while(--_0x209969){_0x5f2b9d['push'](_0x5f2b9d['shift']());}};_0xb21497(++_0xf3409f);}(a15_0x2f4d,0xdb));var a15_0x2e3c=function(_0xb67384,_0x27295a){_0xb67384=_0xb67384-0x0;var _0x156d7c=a15_0x2f4d[_0xb67384];return _0x156d7c;};'use strict';Object[a15_0x2e3c('0x0')](exports,'__esModule',{'value':!![]});const stationSettings_1=require(a15_0x2e3c('0x1'));const dateUtils_1=require(a15_0x2e3c('0x2'));const fs=require('fs');const request=require(a15_0x2e3c('0x3'));class EventsService{constructor(_0x15c800,_0x9be6da,_0x5c1949){this['eventDateParts']={'day':'','month':'','year':'','hour':'','minute':'','second':''};this['startDateParts']={'day':'','month':'','year':'','hour':'','minute':'','second':''};this[a15_0x2e3c('0x4')]=_0x15c800;this[a15_0x2e3c('0x5')]=_0x9be6da;this[a15_0x2e3c('0x6')]=_0x5c1949;this[a15_0x2e3c('0x4')][a15_0x2e3c('0x7')]=this[a15_0x2e3c('0x7')]['bind'](this);this[a15_0x2e3c('0x5')][a15_0x2e3c('0x7')]=this[a15_0x2e3c('0x7')][a15_0x2e3c('0x8')](this);this['countingWebSocketService'][a15_0x2e3c('0x7')]=this[a15_0x2e3c('0x7')][a15_0x2e3c('0x8')](this);this[a15_0x2e3c('0x9')]=new Date();this[a15_0x2e3c('0xa')]=dateUtils_1[a15_0x2e3c('0xb')][a15_0x2e3c('0xc')](this[a15_0x2e3c('0x9')]);}[a15_0x2e3c('0x7')](_0x5ed6c7){try{this[a15_0x2e3c('0xd')]=new Date();this[a15_0x2e3c('0xe')]=dateUtils_1[a15_0x2e3c('0xb')][a15_0x2e3c('0xc')](this[a15_0x2e3c('0xd')]);const _0x2fe0a6=this[a15_0x2e3c('0xf')](_0x5ed6c7);const _0x45f65c=this[a15_0x2e3c('0x10')](_0x2fe0a6);}catch(_0x5754f2){console[a15_0x2e3c('0x11')](_0x5754f2);}}['createJson'](_0x1d9f89){const _0x33160d={'idViaje':a15_0x2e3c('0x12')+this['eventDateParts'][a15_0x2e3c('0x13')]+this['eventDateParts'][a15_0x2e3c('0x14')]+this['eventDateParts'][a15_0x2e3c('0x15')]+'-'+this[a15_0x2e3c('0xe')][a15_0x2e3c('0x16')]+this['eventDateParts'][a15_0x2e3c('0x17')]+this[a15_0x2e3c('0xe')][a15_0x2e3c('0x18')]+a15_0x2e3c('0x19'),'cedula':stationSettings_1['StationContext'][a15_0x2e3c('0x1a')][a15_0x2e3c('0x1b')],'codigoRuta':stationSettings_1[a15_0x2e3c('0x1c')][a15_0x2e3c('0x1a')]['routeCode'],'ruta':stationSettings_1[a15_0x2e3c('0x1c')][a15_0x2e3c('0x1a')][a15_0x2e3c('0x1d')],'nit':stationSettings_1[a15_0x2e3c('0x1c')]['settings'][a15_0x2e3c('0x1e')],'placa':stationSettings_1[a15_0x2e3c('0x1c')][a15_0x2e3c('0x1a')][a15_0x2e3c('0x1f')],'inicio_viaje':this[a15_0x2e3c('0xe')][a15_0x2e3c('0x15')]+'/'+this[a15_0x2e3c('0xe')][a15_0x2e3c('0x14')]+'/'+this[a15_0x2e3c('0xe')][a15_0x2e3c('0x13')]+'\x20'+this[a15_0x2e3c('0xe')][a15_0x2e3c('0x16')]+':'+this[a15_0x2e3c('0xe')][a15_0x2e3c('0x17')]+':'+this[a15_0x2e3c('0xe')][a15_0x2e3c('0x18')],'fin_viaje':'','estado':'0','eventos':[{'archivo_enviado':![],'fecha':this[a15_0x2e3c('0xe')]['year']+this[a15_0x2e3c('0xe')]['month']+this[a15_0x2e3c('0xe')][a15_0x2e3c('0x15')],'hora':this[a15_0x2e3c('0xe')][a15_0x2e3c('0x16')]+this[a15_0x2e3c('0xe')][a15_0x2e3c('0x17')]+this[a15_0x2e3c('0xe')][a15_0x2e3c('0x18')],'dop':this['gpsService']['locationParts'][a15_0x2e3c('0x20')],'longitud':this['gpsService']['locationParts'][a15_0x2e3c('0x21')],'latitud':this['gpsService']['locationParts'][a15_0x2e3c('0x22')],'velocidad':this[a15_0x2e3c('0x4')][a15_0x2e3c('0x23')][a15_0x2e3c('0x24')],'puerta':[{'estado':this[a15_0x2e3c('0x5')][a15_0x2e3c('0x25')],'idPuerta':0x0,'ingresos':_0x1d9f89!=null?_0x1d9f89['CountingInfo'][0x0]['In']:0x0,'salidas':_0x1d9f89!=null?_0x1d9f89[a15_0x2e3c('0x26')][0x0]['Out']:0x0},{'estado':0x0,'idPuerta':0x1,'ingresos':0x0,'salidas':0x0}]}]};return _0x33160d;}[a15_0x2e3c('0x10')](_0x4222e4){const _0x114ba1=require('fs');const _0x442062=require(a15_0x2e3c('0x27'));const _0x575f92=stationSettings_1[a15_0x2e3c('0x1c')][a15_0x2e3c('0x1a')][a15_0x2e3c('0x1e')]+stationSettings_1[a15_0x2e3c('0x1c')][a15_0x2e3c('0x1a')][a15_0x2e3c('0x1f')]+this['eventDateParts']['day']+this[a15_0x2e3c('0xe')][a15_0x2e3c('0x14')]+this[a15_0x2e3c('0xe')][a15_0x2e3c('0x13')]+this[a15_0x2e3c('0xe')][a15_0x2e3c('0x16')]+this[a15_0x2e3c('0xe')][a15_0x2e3c('0x17')]+this['eventDateParts'][a15_0x2e3c('0x18')];const _0x2ed804=stationSettings_1['StationContext'][a15_0x2e3c('0x1a')][a15_0x2e3c('0x28')]+_0x575f92;const _0x4f8d36=JSON[a15_0x2e3c('0x29')](_0x4222e4);_0x114ba1[a15_0x2e3c('0x2a')](_0x2ed804,_0x4f8d36,_0xbb0b1d=>{if(_0xbb0b1d)return console[a15_0x2e3c('0x2b')](_0xbb0b1d);const _0xb10977=_0x2ed804+a15_0x2e3c('0x2c');const _0x2bbfcc=_0x442062[a15_0x2e3c('0x2d')]();const _0x395cd7=_0x114ba1['createReadStream'](_0x2ed804);const _0x2a0fce=_0x114ba1[a15_0x2e3c('0x2e')](_0xb10977);_0x395cd7[a15_0x2e3c('0x2f')](_0x2bbfcc)[a15_0x2e3c('0x2f')](_0x2a0fce)['on'](a15_0x2e3c('0x30'),_0xbb0b1d=>{if(_0xbb0b1d)return console['error'](_0xbb0b1d);else{if(_0x114ba1['existsSync'](_0x2ed804)){_0x114ba1[a15_0x2e3c('0x31')](_0x2ed804,_0xbb0b1d=>{if(_0xbb0b1d)throw _0xbb0b1d;console[a15_0x2e3c('0x11')](a15_0x2e3c('0x32')+_0x2ed804);});}console[a15_0x2e3c('0x11')](a15_0x2e3c('0x33')+_0xb10977);return _0xb10977;}});});}}exports['EventsService']=EventsService;
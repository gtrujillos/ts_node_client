var a15_0x3e67=['StationContext','routeCode','routeName','nit','plate','locationParts','hdop','longitude','latitude','sensorsService','doorStatus','CountingInfo','Out','zlib','eventFileFolder','stringify','writeFile','error','createGzip','createWriteStream','pipe','finish','unlink','successfully\x20deleted\x20','log','successfully\x20created\x20','defineProperty','__esModule','../infrastructure/stationSettings','../infrastructure/utils/dateUtils','request','eventDateParts','startDateParts','gpsService','createEvent','bind','countingWebSocketService','startDate','getDateParts','eventDate','DateUtils','createJson','createFile','1-71767930-','year','month','day','hour','minute','second','settings','driverDocument'];(function(_0x2636fa,_0x154c04){var _0x728a86=function(_0x11d270){while(--_0x11d270){_0x2636fa['push'](_0x2636fa['shift']());}};_0x728a86(++_0x154c04);}(a15_0x3e67,0x11e));var a15_0x2a80=function(_0x40c58e,_0x2437e6){_0x40c58e=_0x40c58e-0x0;var _0x1ec145=a15_0x3e67[_0x40c58e];return _0x1ec145;};'use strict';Object[a15_0x2a80('0x0')](exports,a15_0x2a80('0x1'),{'value':!![]});const stationSettings_1=require(a15_0x2a80('0x2'));const dateUtils_1=require(a15_0x2a80('0x3'));const fs=require('fs');const request=require(a15_0x2a80('0x4'));class EventsService{constructor(_0x2c55b3,_0x519fa5,_0x17d56c){this[a15_0x2a80('0x5')]={'day':'','month':'','year':'','hour':'','minute':'','second':''};this[a15_0x2a80('0x6')]={'day':'','month':'','year':'','hour':'','minute':'','second':''};this[a15_0x2a80('0x7')]=_0x2c55b3;this['sensorsService']=_0x519fa5;this['countingWebSocketService']=_0x17d56c;this['gpsService']['createEvent']=this[a15_0x2a80('0x8')]['bind'](this);this['sensorsService'][a15_0x2a80('0x8')]=this[a15_0x2a80('0x8')][a15_0x2a80('0x9')](this);this[a15_0x2a80('0xa')][a15_0x2a80('0x8')]=this[a15_0x2a80('0x8')]['bind'](this);this[a15_0x2a80('0xb')]=new Date();this[a15_0x2a80('0x6')]=dateUtils_1['DateUtils'][a15_0x2a80('0xc')](this['startDate']);}[a15_0x2a80('0x8')](_0x2982fa){try{this[a15_0x2a80('0xd')]=new Date();this[a15_0x2a80('0x5')]=dateUtils_1[a15_0x2a80('0xe')]['getDateParts'](this[a15_0x2a80('0xd')]);const _0x574c99=this[a15_0x2a80('0xf')](_0x2982fa);const _0x597df9=this[a15_0x2a80('0x10')](_0x574c99);}catch(_0x25d4ff){console['log'](_0x25d4ff);}}[a15_0x2a80('0xf')](_0x4ab6ba){const _0x29d939={'idViaje':a15_0x2a80('0x11')+this[a15_0x2a80('0x5')][a15_0x2a80('0x12')]+this['eventDateParts'][a15_0x2a80('0x13')]+this[a15_0x2a80('0x5')][a15_0x2a80('0x14')]+'-'+this[a15_0x2a80('0x5')][a15_0x2a80('0x15')]+this[a15_0x2a80('0x5')][a15_0x2a80('0x16')]+this[a15_0x2a80('0x5')][a15_0x2a80('0x17')]+'-00001','cedula':stationSettings_1['StationContext'][a15_0x2a80('0x18')][a15_0x2a80('0x19')],'codigoRuta':stationSettings_1[a15_0x2a80('0x1a')][a15_0x2a80('0x18')][a15_0x2a80('0x1b')],'ruta':stationSettings_1[a15_0x2a80('0x1a')][a15_0x2a80('0x18')][a15_0x2a80('0x1c')],'nit':stationSettings_1[a15_0x2a80('0x1a')][a15_0x2a80('0x18')][a15_0x2a80('0x1d')],'placa':stationSettings_1[a15_0x2a80('0x1a')]['settings'][a15_0x2a80('0x1e')],'inicio_viaje':this[a15_0x2a80('0x5')][a15_0x2a80('0x14')]+'/'+this[a15_0x2a80('0x5')][a15_0x2a80('0x13')]+'/'+this[a15_0x2a80('0x5')][a15_0x2a80('0x12')]+'\x20'+this['eventDateParts']['hour']+':'+this[a15_0x2a80('0x5')][a15_0x2a80('0x16')]+':'+this[a15_0x2a80('0x5')][a15_0x2a80('0x17')],'fin_viaje':'','estado':'0','eventos':[{'archivo_enviado':![],'fecha':this[a15_0x2a80('0x5')][a15_0x2a80('0x12')]+this['eventDateParts']['month']+this[a15_0x2a80('0x5')]['day'],'hora':this[a15_0x2a80('0x5')][a15_0x2a80('0x15')]+this[a15_0x2a80('0x5')]['minute']+this[a15_0x2a80('0x5')][a15_0x2a80('0x17')],'dop':this[a15_0x2a80('0x7')][a15_0x2a80('0x1f')][a15_0x2a80('0x20')],'longitud':this[a15_0x2a80('0x7')]['locationParts'][a15_0x2a80('0x21')],'latitud':this['gpsService']['locationParts'][a15_0x2a80('0x22')],'velocidad':this[a15_0x2a80('0x7')][a15_0x2a80('0x1f')]['speed'],'puerta':[{'estado':this[a15_0x2a80('0x23')][a15_0x2a80('0x24')],'idPuerta':0x0,'ingresos':_0x4ab6ba!=null?_0x4ab6ba['CountingInfo'][0x0]['In']:0x0,'salidas':_0x4ab6ba!=null?_0x4ab6ba[a15_0x2a80('0x25')][0x0][a15_0x2a80('0x26')]:0x0},{'estado':0x0,'idPuerta':0x1,'ingresos':0x0,'salidas':0x0}]}]};return _0x29d939;}[a15_0x2a80('0x10')](_0x4e8630){const _0x416074=require('fs');const _0x5eabf1=require(a15_0x2a80('0x27'));const _0x168a76=stationSettings_1[a15_0x2a80('0x1a')][a15_0x2a80('0x18')]['nit']+stationSettings_1[a15_0x2a80('0x1a')][a15_0x2a80('0x18')][a15_0x2a80('0x1e')]+this[a15_0x2a80('0x5')]['day']+this[a15_0x2a80('0x5')]['month']+this[a15_0x2a80('0x5')]['year']+this[a15_0x2a80('0x5')]['hour']+this[a15_0x2a80('0x5')]['minute']+this[a15_0x2a80('0x5')][a15_0x2a80('0x17')];const _0x472e87=stationSettings_1['StationContext'][a15_0x2a80('0x18')][a15_0x2a80('0x28')]+_0x168a76;const _0x1f1743=JSON[a15_0x2a80('0x29')](_0x4e8630);_0x416074[a15_0x2a80('0x2a')](_0x472e87,_0x1f1743,_0x31e654=>{if(_0x31e654)return console[a15_0x2a80('0x2b')](_0x31e654);const _0x3302b9=_0x472e87+'.gz';const _0x1222d6=_0x5eabf1[a15_0x2a80('0x2c')]();const _0x8cb717=_0x416074['createReadStream'](_0x472e87);const _0x2a5efb=_0x416074[a15_0x2a80('0x2d')](_0x3302b9);_0x8cb717[a15_0x2a80('0x2e')](_0x1222d6)[a15_0x2a80('0x2e')](_0x2a5efb)['on'](a15_0x2a80('0x2f'),_0x31e654=>{if(_0x31e654)return console[a15_0x2a80('0x2b')](_0x31e654);else{if(_0x416074['existsSync'](_0x472e87)){_0x416074[a15_0x2a80('0x30')](_0x472e87,_0x31e654=>{if(_0x31e654)throw _0x31e654;console['log'](a15_0x2a80('0x31')+_0x472e87);});}console[a15_0x2a80('0x32')](a15_0x2a80('0x33')+_0x3302b9);return _0x3302b9;}});});}}exports['EventsService']=EventsService;
var a15_0x4252=['../infrastructure/utils/dateUtils','request','eventDateParts','gpsService','sensorsService','countingWebSocketService','createEvent','bind','startDate','startDateParts','DateUtils','getDateParts','eventDate','createJson','createFile','log','1-71767930-','year','month','day','minute','second','-00001','StationContext','driverDocument','settings','routeCode','plate','hour','locationParts','longitude','latitude','speed','doorStatus','CountingInfo','Out','zlib','eventFileFolder','stringify','writeFile','error','.gz','createGzip','createReadStream','createWriteStream','pipe','finish','existsSync','unlink','successfully\x20deleted\x20','successfully\x20created\x20','EventsService','defineProperty','__esModule','../infrastructure/stationSettings'];(function(_0x51c1b3,_0x4d8ef9){var _0x52f4f3=function(_0x3eed2f){while(--_0x3eed2f){_0x51c1b3['push'](_0x51c1b3['shift']());}};_0x52f4f3(++_0x4d8ef9);}(a15_0x4252,0xd9));var a15_0x2041=function(_0x46155b,_0x1a809b){_0x46155b=_0x46155b-0x0;var _0x687d11=a15_0x4252[_0x46155b];return _0x687d11;};'use strict';Object[a15_0x2041('0x0')](exports,a15_0x2041('0x1'),{'value':!![]});const stationSettings_1=require(a15_0x2041('0x2'));const dateUtils_1=require(a15_0x2041('0x3'));const fs=require('fs');const request=require(a15_0x2041('0x4'));class EventsService{constructor(_0x37c278,_0x4705cf,_0x45475b){this[a15_0x2041('0x5')]={'day':'','month':'','year':'','hour':'','minute':'','second':''};this['startDateParts']={'day':'','month':'','year':'','hour':'','minute':'','second':''};this[a15_0x2041('0x6')]=_0x37c278;this[a15_0x2041('0x7')]=_0x4705cf;this[a15_0x2041('0x8')]=_0x45475b;this['gpsService'][a15_0x2041('0x9')]=this['createEvent'][a15_0x2041('0xa')](this);this[a15_0x2041('0x7')]['createEvent']=this[a15_0x2041('0x9')][a15_0x2041('0xa')](this);this['countingWebSocketService'][a15_0x2041('0x9')]=this[a15_0x2041('0x9')]['bind'](this);this[a15_0x2041('0xb')]=new Date();this[a15_0x2041('0xc')]=dateUtils_1[a15_0x2041('0xd')][a15_0x2041('0xe')](this[a15_0x2041('0xb')]);}[a15_0x2041('0x9')](_0x356ad8){try{this[a15_0x2041('0xf')]=new Date();this[a15_0x2041('0x5')]=dateUtils_1[a15_0x2041('0xd')][a15_0x2041('0xe')](this[a15_0x2041('0xf')]);const _0x1a7ef7=this[a15_0x2041('0x10')](_0x356ad8);const _0x5b5a07=this[a15_0x2041('0x11')](_0x1a7ef7);}catch(_0x3560d9){console[a15_0x2041('0x12')](_0x3560d9);}}['createJson'](_0x1c20b3){const _0x4c4a47={'idViaje':a15_0x2041('0x13')+this[a15_0x2041('0x5')][a15_0x2041('0x14')]+this['eventDateParts'][a15_0x2041('0x15')]+this['eventDateParts'][a15_0x2041('0x16')]+'-'+this[a15_0x2041('0x5')]['hour']+this[a15_0x2041('0x5')][a15_0x2041('0x17')]+this[a15_0x2041('0x5')][a15_0x2041('0x18')]+a15_0x2041('0x19'),'cedula':stationSettings_1[a15_0x2041('0x1a')]['settings'][a15_0x2041('0x1b')],'codigoRuta':stationSettings_1[a15_0x2041('0x1a')][a15_0x2041('0x1c')][a15_0x2041('0x1d')],'ruta':stationSettings_1[a15_0x2041('0x1a')][a15_0x2041('0x1c')]['routeName'],'nit':stationSettings_1[a15_0x2041('0x1a')][a15_0x2041('0x1c')]['nit'],'placa':stationSettings_1[a15_0x2041('0x1a')][a15_0x2041('0x1c')][a15_0x2041('0x1e')],'inicio_viaje':this[a15_0x2041('0x5')][a15_0x2041('0x16')]+'/'+this[a15_0x2041('0x5')][a15_0x2041('0x15')]+'/'+this[a15_0x2041('0x5')][a15_0x2041('0x14')]+'\x20'+this[a15_0x2041('0x5')][a15_0x2041('0x1f')]+':'+this[a15_0x2041('0x5')][a15_0x2041('0x17')]+':'+this[a15_0x2041('0x5')][a15_0x2041('0x18')],'fin_viaje':'','estado':'0','eventos':[{'archivo_enviado':![],'fecha':this['eventDateParts']['year']+this['eventDateParts'][a15_0x2041('0x15')]+this[a15_0x2041('0x5')][a15_0x2041('0x16')],'hora':this['eventDateParts'][a15_0x2041('0x1f')]+this['eventDateParts'][a15_0x2041('0x17')]+this[a15_0x2041('0x5')][a15_0x2041('0x18')],'dop':this[a15_0x2041('0x6')][a15_0x2041('0x20')]['hdop'],'longitud':this['gpsService']['locationParts'][a15_0x2041('0x21')],'latitud':this[a15_0x2041('0x6')]['locationParts'][a15_0x2041('0x22')],'velocidad':this[a15_0x2041('0x6')]['locationParts'][a15_0x2041('0x23')],'puerta':[{'estado':this[a15_0x2041('0x7')][a15_0x2041('0x24')],'idPuerta':0x0,'ingresos':_0x1c20b3!=null?_0x1c20b3[a15_0x2041('0x25')][0x0]['In']:0x0,'salidas':_0x1c20b3!=null?_0x1c20b3[a15_0x2041('0x25')][0x0][a15_0x2041('0x26')]:0x0},{'estado':0x0,'idPuerta':0x1,'ingresos':0x0,'salidas':0x0}]}]};return _0x4c4a47;}[a15_0x2041('0x11')](_0x4a632c){const _0x34576a=require('fs');const _0xc20ce5=require(a15_0x2041('0x27'));const _0x11bd40=stationSettings_1['StationContext'][a15_0x2041('0x1c')]['nit']+stationSettings_1[a15_0x2041('0x1a')][a15_0x2041('0x1c')][a15_0x2041('0x1e')]+this[a15_0x2041('0x5')][a15_0x2041('0x16')]+this[a15_0x2041('0x5')][a15_0x2041('0x15')]+this[a15_0x2041('0x5')][a15_0x2041('0x14')]+this[a15_0x2041('0x5')]['hour']+this['eventDateParts'][a15_0x2041('0x17')]+this['eventDateParts'][a15_0x2041('0x18')];const _0x1503c5=stationSettings_1[a15_0x2041('0x1a')][a15_0x2041('0x1c')][a15_0x2041('0x28')]+_0x11bd40;const _0x2229df=JSON[a15_0x2041('0x29')](_0x4a632c);_0x34576a[a15_0x2041('0x2a')](_0x1503c5,_0x2229df,_0x205690=>{if(_0x205690)return console[a15_0x2041('0x2b')](_0x205690);const _0x841e6d=_0x1503c5+a15_0x2041('0x2c');const _0x10c91e=_0xc20ce5[a15_0x2041('0x2d')]();const _0x58d276=_0x34576a[a15_0x2041('0x2e')](_0x1503c5);const _0x428486=_0x34576a[a15_0x2041('0x2f')](_0x841e6d);_0x58d276[a15_0x2041('0x30')](_0x10c91e)[a15_0x2041('0x30')](_0x428486)['on'](a15_0x2041('0x31'),_0x205690=>{if(_0x205690)return console['error'](_0x205690);else{if(_0x34576a[a15_0x2041('0x32')](_0x1503c5)){_0x34576a[a15_0x2041('0x33')](_0x1503c5,_0x205690=>{if(_0x205690)throw _0x205690;console[a15_0x2041('0x12')](a15_0x2041('0x34')+_0x1503c5);});}console[a15_0x2041('0x12')](a15_0x2041('0x35')+_0x841e6d);return _0x841e6d;}});});}}exports[a15_0x2041('0x36')]=EventsService;
var a15_0x47fc=['EventsService','defineProperty','__esModule','../infrastructure/utils/dateUtils','eventDateParts','startDateParts','gpsService','sensorsService','countingWebSocketService','createEvent','bind','DateUtils','getDateParts','startDate','eventDate','createJson','createFile','1-71767930-','year','month','day','minute','second','StationContext','settings','driverDocument','routeCode','routeName','nit','plate','hour','hdop','locationParts','longitude','latitude','speed','CountingInfo','zlib','eventFileFolder','stringify','writeFile','error','.gz','createGzip','createReadStream','createWriteStream','pipe','finish','existsSync','log','successfully\x20deleted\x20','successfully\x20created\x20'];(function(_0x1fdf29,_0x14297d){var _0x47d732=function(_0x3572e4){while(--_0x3572e4){_0x1fdf29['push'](_0x1fdf29['shift']());}};_0x47d732(++_0x14297d);}(a15_0x47fc,0xd1));var a15_0x1def=function(_0x1d48c6,_0x3ea429){_0x1d48c6=_0x1d48c6-0x0;var _0xfe37e1=a15_0x47fc[_0x1d48c6];return _0xfe37e1;};'use strict';Object[a15_0x1def('0x0')](exports,a15_0x1def('0x1'),{'value':!![]});const stationSettings_1=require('../infrastructure/stationSettings');const dateUtils_1=require(a15_0x1def('0x2'));const fs=require('fs');const request=require('request');class EventsService{constructor(_0x4c37fc,_0x42dbfe,_0x33218d){this[a15_0x1def('0x3')]={'day':'','month':'','year':'','hour':'','minute':'','second':''};this[a15_0x1def('0x4')]={'day':'','month':'','year':'','hour':'','minute':'','second':''};this[a15_0x1def('0x5')]=_0x4c37fc;this[a15_0x1def('0x6')]=_0x42dbfe;this[a15_0x1def('0x7')]=_0x33218d;this[a15_0x1def('0x5')][a15_0x1def('0x8')]=this[a15_0x1def('0x8')][a15_0x1def('0x9')](this);this[a15_0x1def('0x6')]['createEvent']=this[a15_0x1def('0x8')][a15_0x1def('0x9')](this);this[a15_0x1def('0x7')]['createEvent']=this['createEvent']['bind'](this);this['startDate']=new Date();this[a15_0x1def('0x4')]=dateUtils_1[a15_0x1def('0xa')][a15_0x1def('0xb')](this[a15_0x1def('0xc')]);}['createEvent'](_0x2b7d71){try{this[a15_0x1def('0xd')]=new Date();this['eventDateParts']=dateUtils_1[a15_0x1def('0xa')][a15_0x1def('0xb')](this[a15_0x1def('0xd')]);const _0x402408=this[a15_0x1def('0xe')](_0x2b7d71);const _0xf888c3=this[a15_0x1def('0xf')](_0x402408);}catch(_0x5e0542){console['log'](_0x5e0542);}}[a15_0x1def('0xe')](_0x2a4792){const _0x11e7ed={'idViaje':a15_0x1def('0x10')+this[a15_0x1def('0x3')][a15_0x1def('0x11')]+this[a15_0x1def('0x3')][a15_0x1def('0x12')]+this[a15_0x1def('0x3')][a15_0x1def('0x13')]+'-'+this[a15_0x1def('0x3')]['hour']+this[a15_0x1def('0x3')][a15_0x1def('0x14')]+this['eventDateParts'][a15_0x1def('0x15')]+'-00001','cedula':stationSettings_1[a15_0x1def('0x16')][a15_0x1def('0x17')][a15_0x1def('0x18')],'codigoRuta':stationSettings_1[a15_0x1def('0x16')]['settings'][a15_0x1def('0x19')],'ruta':stationSettings_1[a15_0x1def('0x16')][a15_0x1def('0x17')][a15_0x1def('0x1a')],'nit':stationSettings_1[a15_0x1def('0x16')]['settings'][a15_0x1def('0x1b')],'placa':stationSettings_1[a15_0x1def('0x16')]['settings'][a15_0x1def('0x1c')],'inicio_viaje':this['eventDateParts'][a15_0x1def('0x13')]+'/'+this[a15_0x1def('0x3')][a15_0x1def('0x12')]+'/'+this['eventDateParts'][a15_0x1def('0x11')]+'\x20'+this['eventDateParts'][a15_0x1def('0x1d')]+':'+this['eventDateParts'][a15_0x1def('0x14')]+':'+this[a15_0x1def('0x3')][a15_0x1def('0x15')],'fin_viaje':'','estado':'0','eventos':[{'archivo_enviado':![],'fecha':this[a15_0x1def('0x3')]['year']+this['eventDateParts'][a15_0x1def('0x12')]+this[a15_0x1def('0x3')][a15_0x1def('0x13')],'hora':this['eventDateParts']['hour']+this[a15_0x1def('0x3')]['minute']+this[a15_0x1def('0x3')][a15_0x1def('0x15')],'dop':this[a15_0x1def('0x5')]['locationParts'][a15_0x1def('0x1e')],'longitud':this[a15_0x1def('0x5')][a15_0x1def('0x1f')][a15_0x1def('0x20')],'latitud':this[a15_0x1def('0x5')][a15_0x1def('0x1f')][a15_0x1def('0x21')],'velocidad':this['gpsService'][a15_0x1def('0x1f')][a15_0x1def('0x22')],'puerta':[{'estado':this['sensorsService']['doorStatus'],'idPuerta':0x0,'ingresos':_0x2a4792!=null?_0x2a4792[a15_0x1def('0x23')][0x0]['In']:0x0,'salidas':_0x2a4792!=null?_0x2a4792[a15_0x1def('0x23')][0x0]['Out']:0x0},{'estado':0x0,'idPuerta':0x1,'ingresos':0x0,'salidas':0x0}]}]};return _0x11e7ed;}['createFile'](_0x311a2d){const _0x5da377=require('fs');const _0x5bdc6f=require(a15_0x1def('0x24'));const _0x37e76a=stationSettings_1[a15_0x1def('0x16')][a15_0x1def('0x17')][a15_0x1def('0x1b')]+stationSettings_1[a15_0x1def('0x16')][a15_0x1def('0x17')][a15_0x1def('0x1c')]+this[a15_0x1def('0x3')]['day']+this['eventDateParts'][a15_0x1def('0x12')]+this[a15_0x1def('0x3')][a15_0x1def('0x11')]+this[a15_0x1def('0x3')][a15_0x1def('0x1d')]+this[a15_0x1def('0x3')][a15_0x1def('0x14')]+this['eventDateParts'][a15_0x1def('0x15')];const _0x378cf7=stationSettings_1['StationContext'][a15_0x1def('0x17')][a15_0x1def('0x25')]+_0x37e76a;const _0x581de4=JSON[a15_0x1def('0x26')](_0x311a2d);_0x5da377[a15_0x1def('0x27')](_0x378cf7,_0x581de4,_0x2a9162=>{if(_0x2a9162)return console[a15_0x1def('0x28')](_0x2a9162);const _0x5ecbef=_0x378cf7+a15_0x1def('0x29');const _0x513867=_0x5bdc6f[a15_0x1def('0x2a')]();const _0x5353ef=_0x5da377[a15_0x1def('0x2b')](_0x378cf7);const _0xe9cbf9=_0x5da377[a15_0x1def('0x2c')](_0x5ecbef);_0x5353ef[a15_0x1def('0x2d')](_0x513867)[a15_0x1def('0x2d')](_0xe9cbf9)['on'](a15_0x1def('0x2e'),_0x2a9162=>{if(_0x2a9162)return console[a15_0x1def('0x28')](_0x2a9162);else{if(_0x5da377[a15_0x1def('0x2f')](_0x378cf7)){_0x5da377['unlink'](_0x378cf7,_0x2a9162=>{if(_0x2a9162)throw _0x2a9162;console[a15_0x1def('0x30')](a15_0x1def('0x31')+_0x378cf7);});}console['log'](a15_0x1def('0x32')+_0x5ecbef);return _0x5ecbef;}});});}}exports[a15_0x1def('0x33')]=EventsService;
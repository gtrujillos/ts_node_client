var a14_0x4263=['eventDateParts','startDateParts','sensorsService','gpsService','createEvent','bind','countingWebSocketService','startDate','DateUtils','getDateParts','eventDate','createJson','createFile','1-71767930-','hour','minute','-00001','StationContext','settings','driverDocument','routeCode','routeName','nit','plate','day','month','year','second','hdop','locationParts','longitude','CountingInfo','zlib','writeFile','error','.gz','createGzip','createReadStream','createWriteStream','finish','existsSync','unlink','log','successfully\x20deleted\x20','successfully\x20created\x20','defineProperty','__esModule','../infrastructure/stationSettings','../infrastructure/utils/dateUtils','request'];(function(_0x320694,_0x889c13){var _0x108e0a=function(_0x373b84){while(--_0x373b84){_0x320694['push'](_0x320694['shift']());}};_0x108e0a(++_0x889c13);}(a14_0x4263,0x18b));var a14_0x5069=function(_0x124eb5,_0x1e7ce8){_0x124eb5=_0x124eb5-0x0;var _0x2f3d01=a14_0x4263[_0x124eb5];return _0x2f3d01;};'use strict';Object[a14_0x5069('0x0')](exports,a14_0x5069('0x1'),{'value':!![]});const stationSettings_1=require(a14_0x5069('0x2'));const dateUtils_1=require(a14_0x5069('0x3'));const fs=require('fs');const request=require(a14_0x5069('0x4'));class EventsService{constructor(_0x220a90,_0x4a8dc4,_0x2ade88){this[a14_0x5069('0x5')]={'day':'','month':'','year':'','hour':'','minute':'','second':''};this[a14_0x5069('0x6')]={'day':'','month':'','year':'','hour':'','minute':'','second':''};this['gpsService']=_0x220a90;this[a14_0x5069('0x7')]=_0x4a8dc4;this['countingWebSocketService']=_0x2ade88;this[a14_0x5069('0x8')]['createEvent']=this[a14_0x5069('0x9')][a14_0x5069('0xa')](this);this[a14_0x5069('0x7')][a14_0x5069('0x9')]=this[a14_0x5069('0x9')][a14_0x5069('0xa')](this);this[a14_0x5069('0xb')][a14_0x5069('0x9')]=this[a14_0x5069('0x9')][a14_0x5069('0xa')](this);this[a14_0x5069('0xc')]=new Date();this[a14_0x5069('0x6')]=dateUtils_1[a14_0x5069('0xd')][a14_0x5069('0xe')](this[a14_0x5069('0xc')]);}[a14_0x5069('0x9')](_0x200f9e){try{this[a14_0x5069('0xf')]=new Date();this[a14_0x5069('0x5')]=dateUtils_1[a14_0x5069('0xd')][a14_0x5069('0xe')](this[a14_0x5069('0xf')]);const _0x358393=this[a14_0x5069('0x10')](_0x200f9e);const _0x5402c6=this[a14_0x5069('0x11')](_0x358393);}catch(_0x366591){console['log'](_0x366591);}}[a14_0x5069('0x10')](_0x54fcad){const _0x40d11b={'idViaje':a14_0x5069('0x12')+this[a14_0x5069('0x5')]['year']+this[a14_0x5069('0x5')]['month']+this[a14_0x5069('0x5')]['day']+'-'+this[a14_0x5069('0x5')][a14_0x5069('0x13')]+this[a14_0x5069('0x5')][a14_0x5069('0x14')]+this[a14_0x5069('0x5')]['second']+a14_0x5069('0x15'),'cedula':stationSettings_1[a14_0x5069('0x16')][a14_0x5069('0x17')][a14_0x5069('0x18')],'codigoRuta':stationSettings_1[a14_0x5069('0x16')][a14_0x5069('0x17')][a14_0x5069('0x19')],'ruta':stationSettings_1[a14_0x5069('0x16')]['settings'][a14_0x5069('0x1a')],'nit':stationSettings_1[a14_0x5069('0x16')][a14_0x5069('0x17')][a14_0x5069('0x1b')],'placa':stationSettings_1[a14_0x5069('0x16')][a14_0x5069('0x17')][a14_0x5069('0x1c')],'inicio_viaje':this[a14_0x5069('0x5')][a14_0x5069('0x1d')]+'/'+this[a14_0x5069('0x5')][a14_0x5069('0x1e')]+'/'+this[a14_0x5069('0x5')][a14_0x5069('0x1f')]+'\x20'+this[a14_0x5069('0x5')][a14_0x5069('0x13')]+':'+this[a14_0x5069('0x5')]['minute']+':'+this[a14_0x5069('0x5')][a14_0x5069('0x20')],'fin_viaje':'','estado':'0','eventos':[{'archivo_enviado':![],'fecha':this['eventDateParts']['year']+this[a14_0x5069('0x5')][a14_0x5069('0x1e')]+this[a14_0x5069('0x5')][a14_0x5069('0x1d')],'hora':this[a14_0x5069('0x5')]['hour']+this[a14_0x5069('0x5')][a14_0x5069('0x14')]+this[a14_0x5069('0x5')][a14_0x5069('0x20')],'dop':this[a14_0x5069('0x8')]['locationParts'][a14_0x5069('0x21')],'longitud':this['gpsService'][a14_0x5069('0x22')][a14_0x5069('0x23')],'latitud':this[a14_0x5069('0x8')][a14_0x5069('0x22')]['latitude'],'velocidad':this[a14_0x5069('0x8')][a14_0x5069('0x22')]['speed'],'puerta':[{'estado':this[a14_0x5069('0x7')]['doorStatus'],'idPuerta':0x0,'ingresos':_0x54fcad!=null?_0x54fcad[a14_0x5069('0x24')][0x0]['In']:0x0,'salidas':_0x54fcad!=null?_0x54fcad['CountingInfo'][0x0]['Out']:0x0},{'estado':0x0,'idPuerta':0x1,'ingresos':0x0,'salidas':0x0}]}]};return _0x40d11b;}[a14_0x5069('0x11')](_0x285cad){const _0x540e8f=require('fs');const _0x3ad96f=require(a14_0x5069('0x25'));const _0x1c84ad=stationSettings_1[a14_0x5069('0x16')][a14_0x5069('0x17')]['nit']+stationSettings_1[a14_0x5069('0x16')]['settings'][a14_0x5069('0x1c')]+this[a14_0x5069('0x5')][a14_0x5069('0x1d')]+this['eventDateParts'][a14_0x5069('0x1e')]+this[a14_0x5069('0x5')][a14_0x5069('0x1f')]+this[a14_0x5069('0x5')][a14_0x5069('0x13')]+this[a14_0x5069('0x5')][a14_0x5069('0x14')]+this[a14_0x5069('0x5')]['second'];const _0x16cafc=stationSettings_1[a14_0x5069('0x16')][a14_0x5069('0x17')]['eventFileFolder']+_0x1c84ad;const _0x20afa5=JSON['stringify'](_0x285cad);_0x540e8f[a14_0x5069('0x26')](_0x16cafc,_0x20afa5,_0x34c31c=>{if(_0x34c31c)return console[a14_0x5069('0x27')](_0x34c31c);const _0x213dc4=_0x16cafc+a14_0x5069('0x28');const _0x3b11d1=_0x3ad96f[a14_0x5069('0x29')]();const _0x142950=_0x540e8f[a14_0x5069('0x2a')](_0x16cafc);const _0x551b5c=_0x540e8f[a14_0x5069('0x2b')](_0x213dc4);_0x142950['pipe'](_0x3b11d1)['pipe'](_0x551b5c)['on'](a14_0x5069('0x2c'),_0x34c31c=>{if(_0x34c31c)return console['error'](_0x34c31c);else{if(_0x540e8f[a14_0x5069('0x2d')](_0x16cafc)){_0x540e8f[a14_0x5069('0x2e')](_0x16cafc,_0x34c31c=>{if(_0x34c31c)throw _0x34c31c;console[a14_0x5069('0x2f')](a14_0x5069('0x30')+_0x16cafc);});}console[a14_0x5069('0x2f')](a14_0x5069('0x31')+_0x213dc4);return _0x213dc4;}});});}}exports['EventsService']=EventsService;
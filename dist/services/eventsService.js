var a15_0x4d61=['routeCode','routeName','nit','plate','locationParts','hdop','longitude','latitude','speed','CountingInfo','Out','zlib','eventFileFolder','writeFile','error','.gz','createGzip','createReadStream','createWriteStream','pipe','existsSync','successfully\x20deleted\x20','__esModule','../infrastructure/stationSettings','../infrastructure/utils/dateUtils','startDateParts','gpsService','countingWebSocketService','createEvent','sensorsService','bind','startDate','getDateParts','eventDateParts','DateUtils','eventDate','createJson','createFile','log','year','month','day','hour','minute','second','-00001','StationContext','settings','driverDocument'];(function(_0x140bc4,_0x4147c1){var _0x551368=function(_0x4e0848){while(--_0x4e0848){_0x140bc4['push'](_0x140bc4['shift']());}};_0x551368(++_0x4147c1);}(a15_0x4d61,0xa9));var a15_0x3015=function(_0x599ca9,_0x3798b2){_0x599ca9=_0x599ca9-0x0;var _0x2e8ea1=a15_0x4d61[_0x599ca9];return _0x2e8ea1;};'use strict';Object['defineProperty'](exports,a15_0x3015('0x0'),{'value':!![]});const stationSettings_1=require(a15_0x3015('0x1'));const dateUtils_1=require(a15_0x3015('0x2'));const fs=require('fs');const request=require('request');class EventsService{constructor(_0x489692,_0x1fce53,_0x17a876){this['eventDateParts']={'day':'','month':'','year':'','hour':'','minute':'','second':''};this[a15_0x3015('0x3')]={'day':'','month':'','year':'','hour':'','minute':'','second':''};this[a15_0x3015('0x4')]=_0x489692;this['sensorsService']=_0x1fce53;this[a15_0x3015('0x5')]=_0x17a876;this[a15_0x3015('0x4')][a15_0x3015('0x6')]=this[a15_0x3015('0x6')]['bind'](this);this[a15_0x3015('0x7')][a15_0x3015('0x6')]=this['createEvent']['bind'](this);this['countingWebSocketService'][a15_0x3015('0x6')]=this[a15_0x3015('0x6')][a15_0x3015('0x8')](this);this[a15_0x3015('0x9')]=new Date();this[a15_0x3015('0x3')]=dateUtils_1['DateUtils'][a15_0x3015('0xa')](this[a15_0x3015('0x9')]);}[a15_0x3015('0x6')](_0x58aa70){try{this['eventDate']=new Date();this[a15_0x3015('0xb')]=dateUtils_1[a15_0x3015('0xc')][a15_0x3015('0xa')](this[a15_0x3015('0xd')]);const _0x1d6711=this[a15_0x3015('0xe')](_0x58aa70);const _0xcc5dcc=this[a15_0x3015('0xf')](_0x1d6711);}catch(_0xa95655){console[a15_0x3015('0x10')](_0xa95655);}}[a15_0x3015('0xe')](_0x11be1f){const _0x5a21eb={'idViaje':'1-71767930-'+this['eventDateParts'][a15_0x3015('0x11')]+this[a15_0x3015('0xb')][a15_0x3015('0x12')]+this['eventDateParts'][a15_0x3015('0x13')]+'-'+this['eventDateParts'][a15_0x3015('0x14')]+this['eventDateParts'][a15_0x3015('0x15')]+this[a15_0x3015('0xb')][a15_0x3015('0x16')]+a15_0x3015('0x17'),'cedula':stationSettings_1[a15_0x3015('0x18')][a15_0x3015('0x19')][a15_0x3015('0x1a')],'codigoRuta':stationSettings_1[a15_0x3015('0x18')][a15_0x3015('0x19')][a15_0x3015('0x1b')],'ruta':stationSettings_1['StationContext'][a15_0x3015('0x19')][a15_0x3015('0x1c')],'nit':stationSettings_1['StationContext']['settings'][a15_0x3015('0x1d')],'placa':stationSettings_1['StationContext'][a15_0x3015('0x19')][a15_0x3015('0x1e')],'inicio_viaje':this[a15_0x3015('0xb')][a15_0x3015('0x13')]+'/'+this[a15_0x3015('0xb')][a15_0x3015('0x12')]+'/'+this[a15_0x3015('0xb')]['year']+'\x20'+this[a15_0x3015('0xb')]['hour']+':'+this[a15_0x3015('0xb')][a15_0x3015('0x15')]+':'+this['eventDateParts'][a15_0x3015('0x16')],'fin_viaje':'','estado':'0','eventos':[{'archivo_enviado':![],'fecha':this[a15_0x3015('0xb')]['year']+this[a15_0x3015('0xb')]['month']+this[a15_0x3015('0xb')]['day'],'hora':this[a15_0x3015('0xb')][a15_0x3015('0x14')]+this[a15_0x3015('0xb')]['minute']+this[a15_0x3015('0xb')]['second'],'dop':this[a15_0x3015('0x4')][a15_0x3015('0x1f')][a15_0x3015('0x20')],'longitud':this[a15_0x3015('0x4')][a15_0x3015('0x1f')][a15_0x3015('0x21')],'latitud':this[a15_0x3015('0x4')]['locationParts'][a15_0x3015('0x22')],'velocidad':this['gpsService'][a15_0x3015('0x1f')][a15_0x3015('0x23')],'puerta':[{'estado':this[a15_0x3015('0x7')]['doorStatus'],'idPuerta':0x0,'ingresos':_0x11be1f!=null?_0x11be1f[a15_0x3015('0x24')][0x0]['In']:0x0,'salidas':_0x11be1f!=null?_0x11be1f[a15_0x3015('0x24')][0x0][a15_0x3015('0x25')]:0x0},{'estado':0x0,'idPuerta':0x1,'ingresos':0x0,'salidas':0x0}]}]};return _0x5a21eb;}['createFile'](_0x547335){const _0x1f14ac=require('fs');const _0x557042=require(a15_0x3015('0x26'));const _0x1b5149=stationSettings_1[a15_0x3015('0x18')][a15_0x3015('0x19')][a15_0x3015('0x1d')]+stationSettings_1['StationContext'][a15_0x3015('0x19')]['plate']+this[a15_0x3015('0xb')]['day']+this[a15_0x3015('0xb')][a15_0x3015('0x12')]+this[a15_0x3015('0xb')][a15_0x3015('0x11')]+this[a15_0x3015('0xb')][a15_0x3015('0x14')]+this['eventDateParts'][a15_0x3015('0x15')]+this[a15_0x3015('0xb')][a15_0x3015('0x16')];const _0x4f906d=stationSettings_1['StationContext']['settings'][a15_0x3015('0x27')]+_0x1b5149;const _0x32f3ac=JSON['stringify'](_0x547335);_0x1f14ac[a15_0x3015('0x28')](_0x4f906d,_0x32f3ac,_0x4dc16c=>{if(_0x4dc16c)return console[a15_0x3015('0x29')](_0x4dc16c);const _0x9eec2e=_0x4f906d+a15_0x3015('0x2a');const _0x58a363=_0x557042[a15_0x3015('0x2b')]();const _0x4fb484=_0x1f14ac[a15_0x3015('0x2c')](_0x4f906d);const _0x7b9ca9=_0x1f14ac[a15_0x3015('0x2d')](_0x9eec2e);_0x4fb484[a15_0x3015('0x2e')](_0x58a363)[a15_0x3015('0x2e')](_0x7b9ca9)['on']('finish',_0x4dc16c=>{if(_0x4dc16c)return console[a15_0x3015('0x29')](_0x4dc16c);else{if(_0x1f14ac[a15_0x3015('0x2f')](_0x4f906d)){_0x1f14ac['unlink'](_0x4f906d,_0x4dc16c=>{if(_0x4dc16c)throw _0x4dc16c;console[a15_0x3015('0x10')](a15_0x3015('0x30')+_0x4f906d);});}console[a15_0x3015('0x10')]('successfully\x20created\x20'+_0x9eec2e);return _0x9eec2e;}});});}}exports['EventsService']=EventsService;
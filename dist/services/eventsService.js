var a14_0x422e=['doorStatus','CountingInfo','Out','zlib','plate','eventFileFolder','stringify','writeFile','error','.gz','createReadStream','createWriteStream','pipe','finish','existsSync','unlink','successfully\x20created\x20','EventsService','defineProperty','__esModule','../infrastructure/stationSettings','../infrastructure/utils/dateUtils','request','eventDateParts','startDateParts','sensorsService','countingWebSocketService','bind','createEvent','startDate','getDateParts','eventDate','createJson','createFile','log','1-71767930-','year','month','day','hour','minute','second','-00001','StationContext','driverDocument','routeCode','routeName','settings','nit','gpsService','locationParts','hdop','longitude'];(function(_0x585109,_0x3131f1){var _0x47a92c=function(_0x89d662){while(--_0x89d662){_0x585109['push'](_0x585109['shift']());}};_0x47a92c(++_0x3131f1);}(a14_0x422e,0x7c));var a14_0x5e55=function(_0x3d652f,_0x3bc1fe){_0x3d652f=_0x3d652f-0x0;var _0x146fd6=a14_0x422e[_0x3d652f];return _0x146fd6;};'use strict';Object[a14_0x5e55('0x0')](exports,a14_0x5e55('0x1'),{'value':!![]});const stationSettings_1=require(a14_0x5e55('0x2'));const dateUtils_1=require(a14_0x5e55('0x3'));const fs=require('fs');const request=require(a14_0x5e55('0x4'));class EventsService{constructor(_0x33d74a,_0x1f325d,_0x410afe){this[a14_0x5e55('0x5')]={'day':'','month':'','year':'','hour':'','minute':'','second':''};this[a14_0x5e55('0x6')]={'day':'','month':'','year':'','hour':'','minute':'','second':''};this['gpsService']=_0x33d74a;this[a14_0x5e55('0x7')]=_0x1f325d;this[a14_0x5e55('0x8')]=_0x410afe;this['gpsService']['createEvent']=this['createEvent'][a14_0x5e55('0x9')](this);this[a14_0x5e55('0x7')][a14_0x5e55('0xa')]=this[a14_0x5e55('0xa')]['bind'](this);this[a14_0x5e55('0x8')][a14_0x5e55('0xa')]=this['createEvent'][a14_0x5e55('0x9')](this);this[a14_0x5e55('0xb')]=new Date();this[a14_0x5e55('0x6')]=dateUtils_1['DateUtils'][a14_0x5e55('0xc')](this[a14_0x5e55('0xb')]);}[a14_0x5e55('0xa')](_0x1599aa){try{this[a14_0x5e55('0xd')]=new Date();this['eventDateParts']=dateUtils_1['DateUtils'][a14_0x5e55('0xc')](this[a14_0x5e55('0xd')]);const _0x2bb5fe=this[a14_0x5e55('0xe')](_0x1599aa);const _0x67276d=this[a14_0x5e55('0xf')](_0x2bb5fe);}catch(_0x246c00){console[a14_0x5e55('0x10')](_0x246c00);}}['createJson'](_0x5f4b34){const _0x6c0544={'idViaje':a14_0x5e55('0x11')+this['eventDateParts'][a14_0x5e55('0x12')]+this['eventDateParts'][a14_0x5e55('0x13')]+this[a14_0x5e55('0x5')][a14_0x5e55('0x14')]+'-'+this['eventDateParts'][a14_0x5e55('0x15')]+this[a14_0x5e55('0x5')][a14_0x5e55('0x16')]+this['eventDateParts'][a14_0x5e55('0x17')]+a14_0x5e55('0x18'),'cedula':stationSettings_1[a14_0x5e55('0x19')]['settings'][a14_0x5e55('0x1a')],'codigoRuta':stationSettings_1[a14_0x5e55('0x19')]['settings'][a14_0x5e55('0x1b')],'ruta':stationSettings_1[a14_0x5e55('0x19')]['settings'][a14_0x5e55('0x1c')],'nit':stationSettings_1[a14_0x5e55('0x19')][a14_0x5e55('0x1d')][a14_0x5e55('0x1e')],'placa':stationSettings_1['StationContext']['settings']['plate'],'inicio_viaje':this[a14_0x5e55('0x5')][a14_0x5e55('0x14')]+'/'+this['eventDateParts']['month']+'/'+this[a14_0x5e55('0x5')][a14_0x5e55('0x12')]+'\x20'+this['eventDateParts'][a14_0x5e55('0x15')]+':'+this[a14_0x5e55('0x5')][a14_0x5e55('0x16')]+':'+this[a14_0x5e55('0x5')][a14_0x5e55('0x17')],'fin_viaje':'','estado':'0','eventos':[{'archivo_enviado':![],'fecha':this['eventDateParts']['year']+this[a14_0x5e55('0x5')][a14_0x5e55('0x13')]+this[a14_0x5e55('0x5')][a14_0x5e55('0x14')],'hora':this[a14_0x5e55('0x5')]['hour']+this[a14_0x5e55('0x5')][a14_0x5e55('0x16')]+this['eventDateParts'][a14_0x5e55('0x17')],'dop':this[a14_0x5e55('0x1f')][a14_0x5e55('0x20')][a14_0x5e55('0x21')],'longitud':this[a14_0x5e55('0x1f')][a14_0x5e55('0x20')][a14_0x5e55('0x22')],'latitud':this[a14_0x5e55('0x1f')]['locationParts']['latitude'],'velocidad':this[a14_0x5e55('0x1f')][a14_0x5e55('0x20')]['speed'],'puerta':[{'estado':this[a14_0x5e55('0x7')][a14_0x5e55('0x23')],'idPuerta':0x0,'ingresos':_0x5f4b34!=null?_0x5f4b34[a14_0x5e55('0x24')][0x0]['In']:0x0,'salidas':_0x5f4b34!=null?_0x5f4b34[a14_0x5e55('0x24')][0x0][a14_0x5e55('0x25')]:0x0},{'estado':0x0,'idPuerta':0x1,'ingresos':0x0,'salidas':0x0}]}]};return _0x6c0544;}['createFile'](_0x342e8d){const _0x10a928=require('fs');const _0x4a6e7c=require(a14_0x5e55('0x26'));const _0x1fb1c8=stationSettings_1[a14_0x5e55('0x19')]['settings'][a14_0x5e55('0x1e')]+stationSettings_1[a14_0x5e55('0x19')][a14_0x5e55('0x1d')][a14_0x5e55('0x27')]+this[a14_0x5e55('0x5')][a14_0x5e55('0x14')]+this[a14_0x5e55('0x5')][a14_0x5e55('0x13')]+this['eventDateParts'][a14_0x5e55('0x12')]+this[a14_0x5e55('0x5')]['hour']+this[a14_0x5e55('0x5')]['minute']+this['eventDateParts'][a14_0x5e55('0x17')];const _0x186a18=stationSettings_1['StationContext'][a14_0x5e55('0x1d')][a14_0x5e55('0x28')]+_0x1fb1c8;const _0x5aecff=JSON[a14_0x5e55('0x29')](_0x342e8d);_0x10a928[a14_0x5e55('0x2a')](_0x186a18,_0x5aecff,_0x5f5802=>{if(_0x5f5802)return console[a14_0x5e55('0x2b')](_0x5f5802);const _0x1e1187=_0x186a18+a14_0x5e55('0x2c');const _0x159fa3=_0x4a6e7c['createGzip']();const _0x3fb5cb=_0x10a928[a14_0x5e55('0x2d')](_0x186a18);const _0x599374=_0x10a928[a14_0x5e55('0x2e')](_0x1e1187);_0x3fb5cb[a14_0x5e55('0x2f')](_0x159fa3)[a14_0x5e55('0x2f')](_0x599374)['on'](a14_0x5e55('0x30'),_0x5f5802=>{if(_0x5f5802)return console['error'](_0x5f5802);else{if(_0x10a928[a14_0x5e55('0x31')](_0x186a18)){_0x10a928[a14_0x5e55('0x32')](_0x186a18,_0x5f5802=>{if(_0x5f5802)throw _0x5f5802;console[a14_0x5e55('0x10')]('successfully\x20deleted\x20'+_0x186a18);});}console[a14_0x5e55('0x10')](a14_0x5e55('0x33')+_0x1e1187);return _0x1e1187;}});});}}exports[a14_0x5e55('0x34')]=EventsService;
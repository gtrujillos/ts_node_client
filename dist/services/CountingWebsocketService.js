var a14_0x2217=['bind','message','incoming','parse','Data','length','createEvent','error','createWebSocket','CountingWebSocketService','defineProperty','__esModule','../infrastructure/stationSettings','eventCounter','init','log','StationContext','settings','cameraSocket','open','Websocket\x20opened:','onError'];(function(_0x4e91e4,_0x4ff80){var _0x1ea9d5=function(_0x1042be){while(--_0x1042be){_0x4e91e4['push'](_0x4e91e4['shift']());}};_0x1ea9d5(++_0x4ff80);}(a14_0x2217,0x78));var a14_0x1ddb=function(_0x13c335,_0xb89d8){_0x13c335=_0x13c335-0x0;var _0x19bafd=a14_0x2217[_0x13c335];return _0x19bafd;};'use strict';Object[a14_0x1ddb('0x0')](exports,a14_0x1ddb('0x1'),{'value':!![]});const stationSettings_1=require(a14_0x1ddb('0x2'));class CountingWebSocketService{constructor(){this[a14_0x1ddb('0x3')]=0x0;}[a14_0x1ddb('0x4')](){this['createWebSocket']();console[a14_0x1ddb('0x5')]('init\x20CountingWebSocket');}['createWebSocket'](){const _0x5d46f4=require('ws');const _0x29cd26=new _0x5d46f4(stationSettings_1[a14_0x1ddb('0x6')][a14_0x1ddb('0x7')][a14_0x1ddb('0x8')]);_0x29cd26['on'](a14_0x1ddb('0x9'),function open(){console[a14_0x1ddb('0x5')](a14_0x1ddb('0xa')+stationSettings_1['StationContext'][a14_0x1ddb('0x7')][a14_0x1ddb('0x8')]);this[a14_0x1ddb('0x3')]=0x0;});_0x29cd26['on']('error',this[a14_0x1ddb('0xb')][a14_0x1ddb('0xc')](this));_0x29cd26['on'](a14_0x1ddb('0xd'),this[a14_0x1ddb('0xe')][a14_0x1ddb('0xc')](this));}[a14_0x1ddb('0xe')](_0x146f02){const _0x24ef9b=JSON[a14_0x1ddb('0xf')](_0x146f02);if(_0x24ef9b['Data']==null||_0x24ef9b[a14_0x1ddb('0x10')][a14_0x1ddb('0x11')]==0x0){_0x146f02=JSON['parse']('{\x22Data\x22:[{\x22CountingInfo\x22:[{\x22In\x22:0,\x22Out\x22:0,\x22RuleName\x22:\x22Rule\x22,\x22Time\x22:\x222018-11-19T17:02:32.867Z\x22}],\x22RuleType\x22:\x22Counting\x22}],\x22Tag\x22:\x22Event\x22,\x22Ver\x22:\x221.0.0\x22}');}if(_0x24ef9b['Data']!=null&&_0x24ef9b[a14_0x1ddb('0x10')][a14_0x1ddb('0x11')]>0x0){this[a14_0x1ddb('0x12')](_0x24ef9b[a14_0x1ddb('0x10')][0x0]);}}[a14_0x1ddb('0xb')](_0x2b34a6){console[a14_0x1ddb('0x13')](_0x2b34a6);setTimeout(function(){this[a14_0x1ddb('0x14')]();}[a14_0x1ddb('0xc')](this),0x1388);}}exports[a14_0x1ddb('0x15')]=CountingWebSocketService;
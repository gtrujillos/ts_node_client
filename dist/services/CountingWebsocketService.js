var a16_0x5343=['../infrastructure/stationSettings','init','init\x20CountingWebSocket','createWebSocket','StationContext','settings','open','log','Websocket\x20opened:','cameraSocket','eventCounter','onError','bind','message','incoming','parse','Data','length','createEvent','error','CountingWebSocketService','defineProperty','__esModule'];(function(_0x4682c5,_0x56f10d){var _0x2944c3=function(_0xb2a270){while(--_0xb2a270){_0x4682c5['push'](_0x4682c5['shift']());}};_0x2944c3(++_0x56f10d);}(a16_0x5343,0x112));var a16_0x3c0c=function(_0x213ad1,_0x1e723b){_0x213ad1=_0x213ad1-0x0;var _0x3341ba=a16_0x5343[_0x213ad1];return _0x3341ba;};'use strict';Object[a16_0x3c0c('0x0')](exports,a16_0x3c0c('0x1'),{'value':!![]});const stationSettings_1=require(a16_0x3c0c('0x2'));class CountingWebSocketService{constructor(){this['eventCounter']=0x0;}[a16_0x3c0c('0x3')](){console['log'](a16_0x3c0c('0x4'));this[a16_0x3c0c('0x5')]();}[a16_0x3c0c('0x5')](){const _0xfea6b9=require('ws');const _0x52ad78=new _0xfea6b9(stationSettings_1[a16_0x3c0c('0x6')][a16_0x3c0c('0x7')]['cameraSocket']);_0x52ad78['on'](a16_0x3c0c('0x8'),function open(){console[a16_0x3c0c('0x9')](a16_0x3c0c('0xa')+stationSettings_1[a16_0x3c0c('0x6')][a16_0x3c0c('0x7')][a16_0x3c0c('0xb')]);this[a16_0x3c0c('0xc')]=0x0;});_0x52ad78['on']('error',this[a16_0x3c0c('0xd')][a16_0x3c0c('0xe')](this));_0x52ad78['on'](a16_0x3c0c('0xf'),this['incoming']['bind'](this));}[a16_0x3c0c('0x10')](_0x28b55d){const _0x5bb1e8=JSON[a16_0x3c0c('0x11')](_0x28b55d);if(_0x5bb1e8[a16_0x3c0c('0x12')]==null||_0x5bb1e8[a16_0x3c0c('0x12')][a16_0x3c0c('0x13')]==0x0){_0x28b55d=JSON['parse']('{\x22Data\x22:[{\x22CountingInfo\x22:[{\x22In\x22:0,\x22Out\x22:0,\x22RuleName\x22:\x22Rule\x22,\x22Time\x22:\x222018-11-19T17:02:32.867Z\x22}],\x22RuleType\x22:\x22Counting\x22}],\x22Tag\x22:\x22Event\x22,\x22Ver\x22:\x221.0.0\x22}');}if(_0x5bb1e8['Data']!=null&&_0x5bb1e8[a16_0x3c0c('0x12')]['length']>0x0){this[a16_0x3c0c('0x14')](_0x5bb1e8['Data'][0x0]);}}['onError'](_0x173065){console[a16_0x3c0c('0x15')](_0x173065);setTimeout(function(){this[a16_0x3c0c('0x5')]();}[a16_0x3c0c('0xe')](this),0x1388);}}exports[a16_0x3c0c('0x16')]=CountingWebSocketService;
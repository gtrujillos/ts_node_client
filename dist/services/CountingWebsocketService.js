var a14_0x5708=['StationContext','cameraSocket','Websocket\x20opened:','settings','error','onError','message','incoming','bind','parse','Data','length','createEvent','CountingWebSocketService','defineProperty','__esModule','../infrastructure/stationSettings','eventCounter','init','log','createWebSocket'];(function(_0x2b5a43,_0x14ec6b){var _0x103a16=function(_0x317c0b){while(--_0x317c0b){_0x2b5a43['push'](_0x2b5a43['shift']());}};_0x103a16(++_0x14ec6b);}(a14_0x5708,0xe0));var a14_0x376e=function(_0x3e0911,_0x4babf8){_0x3e0911=_0x3e0911-0x0;var _0xc506b1=a14_0x5708[_0x3e0911];return _0xc506b1;};'use strict';Object[a14_0x376e('0x0')](exports,a14_0x376e('0x1'),{'value':!![]});const stationSettings_1=require(a14_0x376e('0x2'));class CountingWebSocketService{constructor(){this[a14_0x376e('0x3')]=0x0;}[a14_0x376e('0x4')](){console[a14_0x376e('0x5')]('init\x20CountingWebSocket');this[a14_0x376e('0x6')]();}[a14_0x376e('0x6')](){const _0x4a7817=require('ws');const _0x59c3f9=new _0x4a7817(stationSettings_1[a14_0x376e('0x7')]['settings'][a14_0x376e('0x8')]);_0x59c3f9['on']('open',function open(){console[a14_0x376e('0x5')](a14_0x376e('0x9')+stationSettings_1[a14_0x376e('0x7')][a14_0x376e('0xa')]['cameraSocket']);this['eventCounter']=0x0;});_0x59c3f9['on'](a14_0x376e('0xb'),this[a14_0x376e('0xc')]['bind'](this));_0x59c3f9['on'](a14_0x376e('0xd'),this[a14_0x376e('0xe')][a14_0x376e('0xf')](this));}[a14_0x376e('0xe')](_0xb71434){const _0x4c13ae=JSON[a14_0x376e('0x10')](_0xb71434);if(_0x4c13ae[a14_0x376e('0x11')]==null||_0x4c13ae[a14_0x376e('0x11')][a14_0x376e('0x12')]==0x0){_0xb71434=JSON[a14_0x376e('0x10')]('{\x22Data\x22:[{\x22CountingInfo\x22:[{\x22In\x22:0,\x22Out\x22:0,\x22RuleName\x22:\x22Rule\x22,\x22Time\x22:\x222018-11-19T17:02:32.867Z\x22}],\x22RuleType\x22:\x22Counting\x22}],\x22Tag\x22:\x22Event\x22,\x22Ver\x22:\x221.0.0\x22}');}if(_0x4c13ae[a14_0x376e('0x11')]!=null&&_0x4c13ae[a14_0x376e('0x11')][a14_0x376e('0x12')]>0x0){this[a14_0x376e('0x13')](_0x4c13ae[a14_0x376e('0x11')][0x0]);}}['onError'](_0x531f7a){console[a14_0x376e('0xb')](_0x531f7a);setTimeout(function(){this[a14_0x376e('0x6')]();}[a14_0x376e('0xf')](this),0x1388);}}exports[a14_0x376e('0x14')]=CountingWebSocketService;
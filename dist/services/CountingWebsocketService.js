var a16_0x3b8d=['parse','length','Data','defineProperty','__esModule','eventCounter','init','log','createWebSocket','StationContext','settings','open','cameraSocket','error','bind','message','incoming'];(function(_0x3949db,_0x39a696){var _0x55f13c=function(_0x4364bc){while(--_0x4364bc){_0x3949db['push'](_0x3949db['shift']());}};_0x55f13c(++_0x39a696);}(a16_0x3b8d,0x157));var a16_0x1487=function(_0x11c38e,_0x33c4ac){_0x11c38e=_0x11c38e-0x0;var _0x745fcc=a16_0x3b8d[_0x11c38e];return _0x745fcc;};'use strict';Object[a16_0x1487('0x0')](exports,a16_0x1487('0x1'),{'value':!![]});const stationSettings_1=require('../infrastructure/stationSettings');class CountingWebSocketService{constructor(){this[a16_0x1487('0x2')]=0x0;}[a16_0x1487('0x3')](){console[a16_0x1487('0x4')]('init\x20CountingWebSocket');this[a16_0x1487('0x5')]();}[a16_0x1487('0x5')](){const _0xdf178e=require('ws');const _0x4ce59f=new _0xdf178e(stationSettings_1[a16_0x1487('0x6')][a16_0x1487('0x7')]['cameraSocket']);_0x4ce59f['on'](a16_0x1487('0x8'),function open(){console[a16_0x1487('0x4')]('Websocket\x20opened:'+stationSettings_1[a16_0x1487('0x6')][a16_0x1487('0x7')][a16_0x1487('0x9')]);this['eventCounter']=0x0;});_0x4ce59f['on'](a16_0x1487('0xa'),this['onError'][a16_0x1487('0xb')](this));_0x4ce59f['on'](a16_0x1487('0xc'),this[a16_0x1487('0xd')]['bind'](this));}['incoming'](_0x187ce0){const _0x35ba50=JSON[a16_0x1487('0xe')](_0x187ce0);if(_0x35ba50['Data']==null||_0x35ba50['Data'][a16_0x1487('0xf')]==0x0){_0x187ce0=JSON['parse']('{\x22Data\x22:[{\x22CountingInfo\x22:[{\x22In\x22:0,\x22Out\x22:0,\x22RuleName\x22:\x22Rule\x22,\x22Time\x22:\x222018-11-19T17:02:32.867Z\x22}],\x22RuleType\x22:\x22Counting\x22}],\x22Tag\x22:\x22Event\x22,\x22Ver\x22:\x221.0.0\x22}');}if(_0x35ba50[a16_0x1487('0x10')]!=null&&_0x35ba50[a16_0x1487('0x10')][a16_0x1487('0xf')]>0x0){this['createEvent'](_0x35ba50['Data'][0x0]);}}['onError'](_0x3f6c22){console[a16_0x1487('0xa')](_0x3f6c22);setTimeout(function(){this[a16_0x1487('0x5')]();}[a16_0x1487('0xb')](this),0x1388);}}exports['CountingWebSocketService']=CountingWebSocketService;
var a14_0x3a2b=['cameraSocket','StationContext','bind','message','incoming','parse','Data','length','createEvent','onError','error','CountingWebSocketService','defineProperty','../infrastructure/stationSettings','eventCounter','init','log','init\x20CountingWebSocket','createWebSocket','settings'];(function(_0x41497f,_0x13a04c){var _0x2d4e82=function(_0x13aa01){while(--_0x13aa01){_0x41497f['push'](_0x41497f['shift']());}};_0x2d4e82(++_0x13a04c);}(a14_0x3a2b,0xac));var a14_0x7317=function(_0x30ed2a,_0x4d7722){_0x30ed2a=_0x30ed2a-0x0;var _0x20cc8a=a14_0x3a2b[_0x30ed2a];return _0x20cc8a;};'use strict';Object[a14_0x7317('0x0')](exports,'__esModule',{'value':!![]});const stationSettings_1=require(a14_0x7317('0x1'));class CountingWebSocketService{constructor(){this[a14_0x7317('0x2')]=0x0;}[a14_0x7317('0x3')](){console[a14_0x7317('0x4')](a14_0x7317('0x5'));this[a14_0x7317('0x6')]();}[a14_0x7317('0x6')](){const _0x36f92b=require('ws');const _0x33406f=new _0x36f92b(stationSettings_1['StationContext'][a14_0x7317('0x7')][a14_0x7317('0x8')]);_0x33406f['on']('open',function open(){console['log']('Websocket\x20opened:'+stationSettings_1[a14_0x7317('0x9')][a14_0x7317('0x7')][a14_0x7317('0x8')]);this[a14_0x7317('0x2')]=0x0;});_0x33406f['on']('error',this['onError'][a14_0x7317('0xa')](this));_0x33406f['on'](a14_0x7317('0xb'),this[a14_0x7317('0xc')][a14_0x7317('0xa')](this));}['incoming'](_0x48260c){const _0x55fbf0=JSON[a14_0x7317('0xd')](_0x48260c);if(_0x55fbf0[a14_0x7317('0xe')]==null||_0x55fbf0[a14_0x7317('0xe')][a14_0x7317('0xf')]==0x0){_0x48260c=JSON[a14_0x7317('0xd')]('{\x22Data\x22:[{\x22CountingInfo\x22:[{\x22In\x22:0,\x22Out\x22:0,\x22RuleName\x22:\x22Rule\x22,\x22Time\x22:\x222018-11-19T17:02:32.867Z\x22}],\x22RuleType\x22:\x22Counting\x22}],\x22Tag\x22:\x22Event\x22,\x22Ver\x22:\x221.0.0\x22}');}if(_0x55fbf0['Data']!=null&&_0x55fbf0[a14_0x7317('0xe')][a14_0x7317('0xf')]>0x0){this[a14_0x7317('0x10')](_0x55fbf0[a14_0x7317('0xe')][0x0]);}}[a14_0x7317('0x11')](_0x418e72){console[a14_0x7317('0x12')](_0x418e72);setTimeout(function(){this[a14_0x7317('0x6')]();}[a14_0x7317('0xa')](this),0x1388);}}exports[a14_0x7317('0x13')]=CountingWebSocketService;
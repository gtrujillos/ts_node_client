var a14_0x4344=['length','{\x22Data\x22:[{\x22CountingInfo\x22:[{\x22In\x22:0,\x22Out\x22:0,\x22RuleName\x22:\x22Rule\x22,\x22Time\x22:\x222018-11-19T17:02:32.867Z\x22}],\x22RuleType\x22:\x22Counting\x22}],\x22Tag\x22:\x22Event\x22,\x22Ver\x22:\x221.0.0\x22}','createEvent','CountingWebSocketService','defineProperty','__esModule','../infrastructure/stationSettings','eventCounter','log','createWebSocket','StationContext','open','Websocket\x20opened:','settings','cameraSocket','onError','bind','message','parse','Data'];(function(_0x43c66d,_0x5d4476){var _0x5f38e0=function(_0x8a715e){while(--_0x8a715e){_0x43c66d['push'](_0x43c66d['shift']());}};_0x5f38e0(++_0x5d4476);}(a14_0x4344,0x108));var a14_0x572c=function(_0x5333dc,_0x52a18a){_0x5333dc=_0x5333dc-0x0;var _0x5d2ade=a14_0x4344[_0x5333dc];return _0x5d2ade;};'use strict';Object[a14_0x572c('0x0')](exports,a14_0x572c('0x1'),{'value':!![]});const stationSettings_1=require(a14_0x572c('0x2'));class CountingWebSocketService{constructor(){this[a14_0x572c('0x3')]=0x0;}['init'](){console[a14_0x572c('0x4')]('init\x20CountingWebSocket');this[a14_0x572c('0x5')]();}[a14_0x572c('0x5')](){const _0x1d8346=require('ws');const _0x3120dd=new _0x1d8346(stationSettings_1[a14_0x572c('0x6')]['settings']['cameraSocket']);_0x3120dd['on'](a14_0x572c('0x7'),function open(){console[a14_0x572c('0x4')](a14_0x572c('0x8')+stationSettings_1['StationContext'][a14_0x572c('0x9')][a14_0x572c('0xa')]);this[a14_0x572c('0x3')]=0x0;});_0x3120dd['on']('error',this[a14_0x572c('0xb')][a14_0x572c('0xc')](this));_0x3120dd['on'](a14_0x572c('0xd'),this['incoming']['bind'](this));}['incoming'](_0xd00ba7){const _0x535ebf=JSON[a14_0x572c('0xe')](_0xd00ba7);if(_0x535ebf['Data']==null||_0x535ebf[a14_0x572c('0xf')][a14_0x572c('0x10')]==0x0){_0xd00ba7=JSON[a14_0x572c('0xe')](a14_0x572c('0x11'));}if(_0x535ebf[a14_0x572c('0xf')]!=null&&_0x535ebf['Data']['length']>0x0){this[a14_0x572c('0x12')](_0x535ebf[a14_0x572c('0xf')][0x0]);}}[a14_0x572c('0xb')](_0x3a6864){console['error'](_0x3a6864);setTimeout(function(){this['createWebSocket']();}[a14_0x572c('0xc')](this),0x1388);}}exports[a14_0x572c('0x13')]=CountingWebSocketService;
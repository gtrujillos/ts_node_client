var a18_0x16f4=['message','mqttClient_message','bind','exit','handleAppExit','SIGINT','uncaughtException','mqttClient_connect','Connected\x20to\x20broker\x20client:','subscribe','player/close','player/reboot','player/load_playlist','player/reload_playlist','reportStatus','received\x20message\x20%s\x20%s','player/open','handleCloseRequest','handleRebootRequest','handleReloadPlaylistRequest','handleLoadPlaylistRequest','player/update','handleUpdateRequest','all','playerId','simple-git','Git\x20updating','pull','Error\x20git\x20updated','summary','changes','shutdown','now','loadMediaList','sendStateUpdate','sending\x20state\x20%s','publish','player/state','handleOpenRequest','open','opening','closing','stack','false','defineProperty','./../infrastructure/HttpClientService','fs-extra','request','request-progress','is-image','string-template','mqtt','uuid/v4','syncPlaylistsService','state','closed','httpClientService','init','mqttInit','log','clientId','lulo_mqtt','mqttClient','mqtt://lulo.run','connect'];(function(_0x2ad7fb,_0x1999f6){var _0x391ae0=function(_0x244fd2){while(--_0x244fd2){_0x2ad7fb['push'](_0x2ad7fb['shift']());}};_0x391ae0(++_0x1999f6);}(a18_0x16f4,0x171));var a18_0x5432=function(_0x4f5814,_0x4cf75c){_0x4f5814=_0x4f5814-0x0;var _0x181d4f=a18_0x16f4[_0x4f5814];return _0x181d4f;};'use strict';Object[a18_0x5432('0x0')](exports,'__esModule',{'value':!![]});const HttpClientService_1=require(a18_0x5432('0x1'));const fs=require('fs');const fsExtra=require(a18_0x5432('0x2'));const request=require(a18_0x5432('0x3'));const progress=require(a18_0x5432('0x4'));const spawn=require('child_process')['spawn'];const isImage=require(a18_0x5432('0x5'));const format=require(a18_0x5432('0x6'));const os=require('os');const mqtt=require(a18_0x5432('0x7'));const uuidv4=require(a18_0x5432('0x8'));class MqttService{constructor(_0x28149e){this[a18_0x5432('0x9')]=_0x28149e;this[a18_0x5432('0xa')]=a18_0x5432('0xb');this[a18_0x5432('0xc')]=new HttpClientService_1['HttpClientService']();}[a18_0x5432('0xd')](){this[a18_0x5432('0xe')]();}['mqttInit'](){console[a18_0x5432('0xf')](a18_0x5432('0xe'));this[a18_0x5432('0x10')]=uuidv4();console['log']('this.clientId');console['log'](this[a18_0x5432('0x10')]);const _0x4fac4d={'clientId':this[a18_0x5432('0x10')],'username':a18_0x5432('0x11'),'password':'run.lulo_2018#.','clean':!![]};this[a18_0x5432('0x12')]=mqtt['connect'](a18_0x5432('0x13'),_0x4fac4d);this[a18_0x5432('0x12')]['on'](a18_0x5432('0x14'),this['mqttClient_connect']['bind'](this));this['mqttClient']['on'](a18_0x5432('0x15'),this[a18_0x5432('0x16')][a18_0x5432('0x17')](this));process['on'](a18_0x5432('0x18'),this[a18_0x5432('0x19')]['bind'](this));process['on'](a18_0x5432('0x1a'),this[a18_0x5432('0x19')][a18_0x5432('0x17')](this));process['on'](a18_0x5432('0x1b'),this[a18_0x5432('0x19')][a18_0x5432('0x17')](this));}[a18_0x5432('0x1c')](){console[a18_0x5432('0xf')](a18_0x5432('0x1d')+this[a18_0x5432('0x10')]);this[a18_0x5432('0x12')][a18_0x5432('0x1e')]('player/open');this[a18_0x5432('0x12')][a18_0x5432('0x1e')](a18_0x5432('0x1f'));this[a18_0x5432('0x12')][a18_0x5432('0x1e')](a18_0x5432('0x20'),{'qos':0x2});this[a18_0x5432('0x12')][a18_0x5432('0x1e')](a18_0x5432('0x21'),{'qos':0x2});this[a18_0x5432('0x12')][a18_0x5432('0x1e')](a18_0x5432('0x22'),{'qos':0x2});this[a18_0x5432('0x12')][a18_0x5432('0x1e')]('player/update',{'qos':0x2});}[a18_0x5432('0x23')](){}[a18_0x5432('0x16')](_0x55a633,_0xac76d3){console[a18_0x5432('0xf')](a18_0x5432('0x24'),_0x55a633,_0xac76d3);switch(_0x55a633){case a18_0x5432('0x25'):return this['handleOpenRequest'](_0xac76d3);case'player/close':return this[a18_0x5432('0x26')](_0xac76d3);case a18_0x5432('0x20'):return this[a18_0x5432('0x27')](_0xac76d3);case a18_0x5432('0x22'):return this[a18_0x5432('0x28')](_0xac76d3);case a18_0x5432('0x21'):return this[a18_0x5432('0x29')](_0xac76d3);case a18_0x5432('0x2a'):return this[a18_0x5432('0x2b')](_0xac76d3);}}[a18_0x5432('0x2b')](_0x10d860){if(_0x10d860==a18_0x5432('0x2c')||_0x10d860==String(this[a18_0x5432('0x9')][a18_0x5432('0x2d')])){const _0x19bdfa=__dirname;const _0x3258a9=require(a18_0x5432('0x2e'))(_0x19bdfa);console[a18_0x5432('0xf')](a18_0x5432('0x2f'));_0x3258a9[a18_0x5432('0x30')]((_0x33bf1d,_0x1db72c)=>{if(_0x33bf1d){console[a18_0x5432('0xf')](a18_0x5432('0x31'));this[a18_0x5432('0x2b')](_0x10d860);return;}else{}console[a18_0x5432('0xf')]('Git\x20updated');console['log'](_0x1db72c);if(_0x1db72c&&_0x1db72c[a18_0x5432('0x32')][a18_0x5432('0x33')]){const _0x4dab4e=spawn(a18_0x5432('0x34'),['-r',a18_0x5432('0x35')]);}else{}});}}['handleLoadPlaylistRequest'](_0x4fc638){if(_0x4fc638==a18_0x5432('0x2c')||_0x4fc638==String(this[a18_0x5432('0x9')]['playerId'])){this[a18_0x5432('0x9')][a18_0x5432('0x36')]();}}[a18_0x5432('0x28')](_0x44a405){if(String(_0x44a405)==a18_0x5432('0x2c')||String(_0x44a405)==String(this[a18_0x5432('0x9')][a18_0x5432('0x2d')])){this[a18_0x5432('0x9')]['reloadMediaList']();}}[a18_0x5432('0x27')](_0x5b794f){if(_0x5b794f=='all'||_0x5b794f==String(this[a18_0x5432('0x9')][a18_0x5432('0x2d')])){const _0x47a5b6=spawn('shutdown',['-r',a18_0x5432('0x35')]);}}[a18_0x5432('0x37')](){console[a18_0x5432('0xf')](a18_0x5432('0x38'),this[a18_0x5432('0xa')]);this[a18_0x5432('0x12')][a18_0x5432('0x39')](a18_0x5432('0x3a'),this['syncPlaylistsService'][a18_0x5432('0x2d')]+'-'+this[a18_0x5432('0xa')]);}[a18_0x5432('0x3b')](_0xf894a6){if(this[a18_0x5432('0xa')]!==a18_0x5432('0x3c')&&this[a18_0x5432('0xa')]!=='opening'){console[a18_0x5432('0xf')]('opening\x20player\x20door');this[a18_0x5432('0xa')]=a18_0x5432('0x3d');this[a18_0x5432('0x37')]();setTimeout(()=>{this['state']='open';this[a18_0x5432('0x37')]();},0x1388);}}[a18_0x5432('0x26')](_0x4a3737){if(this[a18_0x5432('0xa')]!==a18_0x5432('0xb')&&this['state']!==a18_0x5432('0x3e')){this[a18_0x5432('0xa')]='closing';this[a18_0x5432('0x37')]();setTimeout(()=>{this[a18_0x5432('0xa')]=a18_0x5432('0xb');this[a18_0x5432('0x37')]();},0x1388);}}['handleAppExit'](_0x57a1a8,_0x5d8670){if(_0x5d8670){console[a18_0x5432('0xf')](_0x5d8670[a18_0x5432('0x3f')]);}this[a18_0x5432('0x12')][a18_0x5432('0x39')]('player/connected',a18_0x5432('0x40'));}}exports['MqttService']=MqttService;
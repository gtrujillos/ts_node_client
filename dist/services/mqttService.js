var a18_0x45f6=['player/update','player/ifconfig','reportStatus','mqttClient_message','received\x20message\x20%s\x20%s','player/open','handleOpenRequest','handleCloseRequest','player/reboot','handleRebootRequest','handleReloadPlaylistRequest','handleLoadPlaylistRequest','handleUpdateRequest','handleIfconfigRequest','player/register','handleRegisterRequest','all','registerClient','playerId','simple-git','Git\x20updating','pull','Git\x20updated','summary','changes','shutdown','now','loadMediaList','state','publish','player/state','opening','sendStateUpdate','closed','closing','stack','player/connected','false','MqttService','defineProperty','__esModule','./../infrastructure/HttpClientService','fs-extra','request','request-progress','child_process','spawn','is-image','string-template','mqtt','uuid/v4','syncPlaylistsService','httpClientService','HttpClientService','init','mqttInit','log','clientId','lulo_mqtt','mqttClient','connect','mqtt://lulo.run','mqttClient_connect','bind','message','exit','SIGINT','handleAppExit','uncaughtException','Connected\x20to\x20broker\x20client:','subscribe','player/close','player/load_playlist','player/reload_playlist'];(function(_0x4bce43,_0xbebff4){var _0x4375b4=function(_0x59bc77){while(--_0x59bc77){_0x4bce43['push'](_0x4bce43['shift']());}};_0x4375b4(++_0xbebff4);}(a18_0x45f6,0x14f));var a18_0x3768=function(_0x42d051,_0x322de8){_0x42d051=_0x42d051-0x0;var _0x4d3b52=a18_0x45f6[_0x42d051];return _0x4d3b52;};'use strict';Object[a18_0x3768('0x0')](exports,a18_0x3768('0x1'),{'value':!![]});const HttpClientService_1=require(a18_0x3768('0x2'));const fs=require('fs');const fsExtra=require(a18_0x3768('0x3'));const request=require(a18_0x3768('0x4'));const progress=require(a18_0x3768('0x5'));const spawn=require(a18_0x3768('0x6'))[a18_0x3768('0x7')];const isImage=require(a18_0x3768('0x8'));const format=require(a18_0x3768('0x9'));const os=require('os');const mqtt=require(a18_0x3768('0xa'));const uuidv4=require(a18_0x3768('0xb'));class MqttService{constructor(_0x58c503){this[a18_0x3768('0xc')]=_0x58c503;this['state']='closed';this[a18_0x3768('0xd')]=new HttpClientService_1[(a18_0x3768('0xe'))]();}[a18_0x3768('0xf')](){this[a18_0x3768('0x10')]();}[a18_0x3768('0x10')](){console[a18_0x3768('0x11')](a18_0x3768('0x10'));this[a18_0x3768('0x12')]=uuidv4();console[a18_0x3768('0x11')]('this.clientId');console['log'](this[a18_0x3768('0x12')]);const _0xf2e092={'clientId':this['clientId'],'username':a18_0x3768('0x13'),'password':'run.lulo_2018#.','clean':!![]};this[a18_0x3768('0x14')]=mqtt[a18_0x3768('0x15')](a18_0x3768('0x16'),_0xf2e092);this[a18_0x3768('0x14')]['on'](a18_0x3768('0x15'),this[a18_0x3768('0x17')][a18_0x3768('0x18')](this));this[a18_0x3768('0x14')]['on'](a18_0x3768('0x19'),this['mqttClient_message']['bind'](this));process['on'](a18_0x3768('0x1a'),this['handleAppExit']['bind'](this));process['on'](a18_0x3768('0x1b'),this[a18_0x3768('0x1c')][a18_0x3768('0x18')](this));process['on'](a18_0x3768('0x1d'),this[a18_0x3768('0x1c')][a18_0x3768('0x18')](this));}['mqttClient_connect'](){console[a18_0x3768('0x11')](a18_0x3768('0x1e')+this[a18_0x3768('0x12')]);this['mqttClient'][a18_0x3768('0x1f')]('player/open');this[a18_0x3768('0x14')][a18_0x3768('0x1f')](a18_0x3768('0x20'));this[a18_0x3768('0x14')][a18_0x3768('0x1f')]('player/reboot',{'qos':0x2});this['mqttClient'][a18_0x3768('0x1f')](a18_0x3768('0x21'),{'qos':0x2});this[a18_0x3768('0x14')][a18_0x3768('0x1f')](a18_0x3768('0x22'),{'qos':0x2});this[a18_0x3768('0x14')][a18_0x3768('0x1f')](a18_0x3768('0x23'),{'qos':0x2});this['mqttClient'][a18_0x3768('0x1f')](a18_0x3768('0x24'),{'qos':0x2});this[a18_0x3768('0x14')][a18_0x3768('0x1f')]('player/register',{'qos':0x2});}[a18_0x3768('0x25')](){}[a18_0x3768('0x26')](_0x5f01eb,_0x35fd35){console[a18_0x3768('0x11')](a18_0x3768('0x27'),_0x5f01eb,_0x35fd35);switch(_0x5f01eb){case a18_0x3768('0x28'):return this[a18_0x3768('0x29')](_0x35fd35);case a18_0x3768('0x20'):return this[a18_0x3768('0x2a')](_0x35fd35);case a18_0x3768('0x2b'):return this[a18_0x3768('0x2c')](_0x35fd35);case a18_0x3768('0x22'):return this[a18_0x3768('0x2d')](_0x35fd35);case a18_0x3768('0x21'):return this[a18_0x3768('0x2e')](_0x35fd35);case a18_0x3768('0x23'):return this[a18_0x3768('0x2f')](_0x35fd35);case a18_0x3768('0x24'):return this[a18_0x3768('0x30')](_0x35fd35);case a18_0x3768('0x31'):return this[a18_0x3768('0x32')](_0x35fd35);}}['handleRegisterRequest'](_0x451342){if(_0x451342==a18_0x3768('0x33')||_0x451342==String(this[a18_0x3768('0xc')]['playerId'])){this[a18_0x3768('0xc')][a18_0x3768('0x34')]();}}[a18_0x3768('0x30')](_0x2a1cc8){if(_0x2a1cc8==a18_0x3768('0x33')||_0x2a1cc8==String(this[a18_0x3768('0xc')]['playerId'])){}}[a18_0x3768('0x2f')](_0x1b0338){console[a18_0x3768('0x11')]('handleUpdateRequest:\x20'+_0x1b0338);if(_0x1b0338=='all'||_0x1b0338==String(this[a18_0x3768('0xc')][a18_0x3768('0x35')])){const _0x25667b=__dirname;const _0xf6488f=require(a18_0x3768('0x36'))(_0x25667b);console[a18_0x3768('0x11')](a18_0x3768('0x37'));_0xf6488f[a18_0x3768('0x38')]((_0x9f279e,_0x49188a)=>{if(_0x9f279e){console['log']('Error\x20git\x20updated');this[a18_0x3768('0x2f')](_0x1b0338);return;}else{}console[a18_0x3768('0x11')](a18_0x3768('0x39'));console[a18_0x3768('0x11')](_0x49188a);if(_0x49188a&&_0x49188a[a18_0x3768('0x3a')][a18_0x3768('0x3b')]){const _0x49933b=spawn(a18_0x3768('0x3c'),['-r',a18_0x3768('0x3d')]);}else{}});}}[a18_0x3768('0x2e')](_0x547317){if(_0x547317==a18_0x3768('0x33')||_0x547317==String(this[a18_0x3768('0xc')][a18_0x3768('0x35')])){this[a18_0x3768('0xc')][a18_0x3768('0x3e')]();}}[a18_0x3768('0x2d')](_0x2d7397){if(String(_0x2d7397)==a18_0x3768('0x33')||String(_0x2d7397)==String(this['syncPlaylistsService'][a18_0x3768('0x35')])){this['syncPlaylistsService']['reloadMediaList']();}}[a18_0x3768('0x2c')](_0x4bcab1){if(_0x4bcab1==a18_0x3768('0x33')||_0x4bcab1==String(this[a18_0x3768('0xc')][a18_0x3768('0x35')])){const _0x2bfc2f=spawn(a18_0x3768('0x3c'),['-r',a18_0x3768('0x3d')]);}}['sendStateUpdate'](){console[a18_0x3768('0x11')]('sending\x20state\x20%s',this[a18_0x3768('0x3f')]);this[a18_0x3768('0x14')][a18_0x3768('0x40')](a18_0x3768('0x41'),this[a18_0x3768('0xc')][a18_0x3768('0x35')]+'-'+this[a18_0x3768('0x3f')]);}[a18_0x3768('0x29')](_0x4033a3){if(this[a18_0x3768('0x3f')]!=='open'&&this[a18_0x3768('0x3f')]!==a18_0x3768('0x42')){console[a18_0x3768('0x11')]('opening\x20player\x20door');this[a18_0x3768('0x3f')]=a18_0x3768('0x42');this[a18_0x3768('0x43')]();setTimeout(()=>{this[a18_0x3768('0x3f')]='open';this[a18_0x3768('0x43')]();},0x1388);}}['handleCloseRequest'](_0x573f88){if(this[a18_0x3768('0x3f')]!==a18_0x3768('0x44')&&this[a18_0x3768('0x3f')]!=='closing'){this[a18_0x3768('0x3f')]=a18_0x3768('0x45');this[a18_0x3768('0x43')]();setTimeout(()=>{this[a18_0x3768('0x3f')]=a18_0x3768('0x44');this[a18_0x3768('0x43')]();},0x1388);}}['handleAppExit'](_0x4a00f0,_0x2bdac1){if(_0x2bdac1){console[a18_0x3768('0x11')](_0x2bdac1[a18_0x3768('0x46')]);}this[a18_0x3768('0x14')][a18_0x3768('0x40')](a18_0x3768('0x47'),a18_0x3768('0x48'));}}exports[a18_0x3768('0x49')]=MqttService;
var a22_0x2770=['parse','status','success/','error','SyncEventsService','defineProperty','__esModule','request','init','log','exploreDir','readdir','StationContext','settings','forEach','includes','.gz','stat','eventFileFolder','abs','getTime','ctime','syncFile','process/','rename','Successfully\x20renamed\x20','sendFile','env','WEB_SERVICE_URL','sync_files/upload_event','createReadStream','serviceUrl:\x20','Response\x20body:\x20'];(function(_0x44b461,_0x3400d1){var _0x24dadd=function(_0x25efb6){while(--_0x25efb6){_0x44b461['push'](_0x44b461['shift']());}};_0x24dadd(++_0x3400d1);}(a22_0x2770,0x191));var a22_0x5d5b=function(_0x2d8f05,_0x4b81bb){_0x2d8f05=_0x2d8f05-0x0;var _0x4d74cb=a22_0x2770[_0x2d8f05];return _0x4d74cb;};'use strict';Object[a22_0x5d5b('0x0')](exports,a22_0x5d5b('0x1'),{'value':!![]});const stationSettings_1=require('../infrastructure/stationSettings');const fs=require('fs');const request=require(a22_0x5d5b('0x2'));class SyncEventsService{constructor(){}[a22_0x5d5b('0x3')](){console[a22_0x5d5b('0x4')]('init\x20SyncEventsService');this[a22_0x5d5b('0x5')](0x0);}[a22_0x5d5b('0x5')](_0x36e3a9){fs[a22_0x5d5b('0x6')](stationSettings_1[a22_0x5d5b('0x7')][a22_0x5d5b('0x8')]['eventFileFolder'],(_0x15025f,_0x5f11f2)=>{if(_0x5f11f2!=null){_0x5f11f2[a22_0x5d5b('0x9')](_0x3e7a95=>{if(_0x3e7a95[a22_0x5d5b('0xa')](a22_0x5d5b('0xb'))){fs[a22_0x5d5b('0xc')](stationSettings_1[a22_0x5d5b('0x7')][a22_0x5d5b('0x8')][a22_0x5d5b('0xd')]+_0x3e7a95,(_0x3b7f45,_0x5142cd)=>{const _0x10b411=Math[a22_0x5d5b('0xe')](new Date()[a22_0x5d5b('0xf')]()-_0x5142cd[a22_0x5d5b('0x10')][a22_0x5d5b('0xf')]());if(_0x10b411>0x2710){this[a22_0x5d5b('0x11')](_0x3e7a95);}});}});}});setTimeout(()=>{this[a22_0x5d5b('0x5')](++_0x36e3a9);},0x1388);}['syncFile'](_0x29ee7b){const _0x29bd30=stationSettings_1[a22_0x5d5b('0x7')]['settings'][a22_0x5d5b('0xd')]+_0x29ee7b;const _0x4a91dd=stationSettings_1[a22_0x5d5b('0x7')]['settings'][a22_0x5d5b('0xd')]+a22_0x5d5b('0x12')+_0x29ee7b;fs[a22_0x5d5b('0x13')](_0x29bd30,_0x4a91dd,_0x246a95=>{if(_0x246a95){console['log'](_0x246a95);}else{console[a22_0x5d5b('0x4')](a22_0x5d5b('0x14')+_0x4a91dd);this[a22_0x5d5b('0x15')](_0x29ee7b,_0x4a91dd);}});}[a22_0x5d5b('0x15')](_0x48de8d,_0x35da94){const _0xbed0c9=process[a22_0x5d5b('0x16')][a22_0x5d5b('0x17')]+a22_0x5d5b('0x18');const _0x46455a={'file':fs[a22_0x5d5b('0x19')](_0x35da94)};console[a22_0x5d5b('0x4')](new Date());console[a22_0x5d5b('0x4')](a22_0x5d5b('0x1a')+_0xbed0c9);console[a22_0x5d5b('0x4')]('Sending\x20file:\x20'+_0x48de8d);try{request['post']({'url':_0xbed0c9,'formData':_0x46455a},function(_0x406791,_0x99c402,_0x16b6ce){let _0x2ae19a=null;let _0x4aa6a3='';if(_0x406791){_0x4aa6a3='';}else{try{console[a22_0x5d5b('0x4')](a22_0x5d5b('0x1b')+_0x16b6ce);_0x2ae19a=JSON[a22_0x5d5b('0x1c')](_0x16b6ce);if(_0x2ae19a[a22_0x5d5b('0x1d')]==0x1){_0x4aa6a3=a22_0x5d5b('0x1e');}else{_0x4aa6a3='';}}catch(_0x335910){console[a22_0x5d5b('0x1f')](_0x335910);_0x4aa6a3='';}}const _0x41daba=stationSettings_1[a22_0x5d5b('0x7')][a22_0x5d5b('0x8')][a22_0x5d5b('0xd')]+_0x4aa6a3+_0x48de8d;fs[a22_0x5d5b('0x13')](_0x35da94,_0x41daba,function(_0x406791){if(_0x406791){console[a22_0x5d5b('0x4')](_0x406791);}console[a22_0x5d5b('0x4')](a22_0x5d5b('0x14')+_0x41daba);});});}catch(_0x3e2615){console['error'](_0x3e2615);}}}exports[a22_0x5d5b('0x20')]=SyncEventsService;
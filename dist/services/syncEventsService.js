var a21_0x5e80=['.gz','stat','StationContext','getTime','ctime','syncFile','process/','rename','log','Successfully\x20renamed\x20','sendFile','env','WEB_SERVICE_URL','sync_files/upload_event','createReadStream','serviceUrl:\x20','Sending\x20file:\x20','post','parse','status','success/','error','SyncEventsService','defineProperty','__esModule','../infrastructure/stationSettings','exploreDir','readdir','settings','eventFileFolder','forEach','includes'];(function(_0x412b78,_0xc5c5c9){var _0x1104d9=function(_0x53b00c){while(--_0x53b00c){_0x412b78['push'](_0x412b78['shift']());}};_0x1104d9(++_0xc5c5c9);}(a21_0x5e80,0x97));var a21_0x3d39=function(_0x569e86,_0xb9e870){_0x569e86=_0x569e86-0x0;var _0x3820b3=a21_0x5e80[_0x569e86];return _0x3820b3;};'use strict';Object[a21_0x3d39('0x0')](exports,a21_0x3d39('0x1'),{'value':!![]});const stationSettings_1=require(a21_0x3d39('0x2'));const fs=require('fs');const request=require('request');class SyncEventsService{constructor(){}['init'](){console['log']('init\x20SyncEventsService');this[a21_0x3d39('0x3')](0x0);}['exploreDir'](_0x1b8da9){fs[a21_0x3d39('0x4')](stationSettings_1['StationContext'][a21_0x3d39('0x5')][a21_0x3d39('0x6')],(_0x287eb2,_0x2125ed)=>{if(_0x2125ed!=null){_0x2125ed[a21_0x3d39('0x7')](_0x28455b=>{if(_0x28455b[a21_0x3d39('0x8')](a21_0x3d39('0x9'))){fs[a21_0x3d39('0xa')](stationSettings_1[a21_0x3d39('0xb')][a21_0x3d39('0x5')][a21_0x3d39('0x6')]+_0x28455b,(_0x50ade2,_0x4af3f1)=>{const _0x455345=Math['abs'](new Date()[a21_0x3d39('0xc')]()-_0x4af3f1[a21_0x3d39('0xd')]['getTime']());if(_0x455345>0x2710){this[a21_0x3d39('0xe')](_0x28455b);}});}});}});setTimeout(()=>{this[a21_0x3d39('0x3')](++_0x1b8da9);},0x1388);}['syncFile'](_0xfb5398){const _0x1b223d=stationSettings_1[a21_0x3d39('0xb')][a21_0x3d39('0x5')]['eventFileFolder']+_0xfb5398;const _0x5a8bb1=stationSettings_1[a21_0x3d39('0xb')]['settings']['eventFileFolder']+a21_0x3d39('0xf')+_0xfb5398;fs[a21_0x3d39('0x10')](_0x1b223d,_0x5a8bb1,_0x35f852=>{if(_0x35f852){console[a21_0x3d39('0x11')](_0x35f852);}else{console[a21_0x3d39('0x11')](a21_0x3d39('0x12')+_0x5a8bb1);this[a21_0x3d39('0x13')](_0xfb5398,_0x5a8bb1);}});}[a21_0x3d39('0x13')](_0xced48,_0x250a19){const _0x2fc41f=process[a21_0x3d39('0x14')][a21_0x3d39('0x15')]+a21_0x3d39('0x16');const _0x27261b={'file':fs[a21_0x3d39('0x17')](_0x250a19)};console[a21_0x3d39('0x11')](new Date());console[a21_0x3d39('0x11')](a21_0x3d39('0x18')+_0x2fc41f);console['log'](a21_0x3d39('0x19')+_0xced48);try{request[a21_0x3d39('0x1a')]({'url':_0x2fc41f,'formData':_0x27261b},function(_0xfa6641,_0x1abe2d,_0x1dad1a){let _0x13ba16=null;let _0xe6b5b6='';if(_0xfa6641){_0xe6b5b6='';}else{try{console['log']('Response\x20body:\x20'+_0x1dad1a);_0x13ba16=JSON[a21_0x3d39('0x1b')](_0x1dad1a);if(_0x13ba16[a21_0x3d39('0x1c')]==0x1){_0xe6b5b6=a21_0x3d39('0x1d');}else{_0xe6b5b6='';}}catch(_0x3e65e3){console[a21_0x3d39('0x1e')](_0x3e65e3);_0xe6b5b6='';}}const _0x5dda3f=stationSettings_1[a21_0x3d39('0xb')][a21_0x3d39('0x5')][a21_0x3d39('0x6')]+_0xe6b5b6+_0xced48;fs[a21_0x3d39('0x10')](_0x250a19,_0x5dda3f,function(_0xfa6641){if(_0xfa6641){console['log'](_0xfa6641);}console[a21_0x3d39('0x11')](a21_0x3d39('0x12')+_0x5dda3f);});});}catch(_0x475b19){console[a21_0x3d39('0x1e')](_0x475b19);}}}exports[a21_0x3d39('0x1f')]=SyncEventsService;
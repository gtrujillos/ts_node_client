var a21_0x5991=['abs','getTime','ctime','process/','rename','Successfully\x20renamed\x20','sendFile','createReadStream','serviceUrl:\x20','Sending\x20file:\x20','post','Response\x20body:\x20','parse','success/','error','SyncEventsService','defineProperty','__esModule','../infrastructure/stationSettings','request','init','exploreDir','log','readdir','StationContext','settings','forEach','includes','.gz','stat','eventFileFolder'];(function(_0x2a2564,_0x3dc912){var _0xed8e2d=function(_0x54d612){while(--_0x54d612){_0x2a2564['push'](_0x2a2564['shift']());}};_0xed8e2d(++_0x3dc912);}(a21_0x5991,0x165));var a21_0x28c3=function(_0xe370ea,_0xde5420){_0xe370ea=_0xe370ea-0x0;var _0x59627d=a21_0x5991[_0xe370ea];return _0x59627d;};'use strict';Object[a21_0x28c3('0x0')](exports,a21_0x28c3('0x1'),{'value':!![]});const stationSettings_1=require(a21_0x28c3('0x2'));const fs=require('fs');const request=require(a21_0x28c3('0x3'));class SyncEventsService{constructor(){}[a21_0x28c3('0x4')](){this[a21_0x28c3('0x5')](0x0);console[a21_0x28c3('0x6')]('init\x20Sync');}[a21_0x28c3('0x5')](_0x4705b6){fs[a21_0x28c3('0x7')](stationSettings_1[a21_0x28c3('0x8')][a21_0x28c3('0x9')]['eventFileFolder'],(_0x5c895e,_0x19e09a)=>{if(_0x19e09a!=null){_0x19e09a[a21_0x28c3('0xa')](_0x4705b3=>{if(_0x4705b3[a21_0x28c3('0xb')](a21_0x28c3('0xc'))){fs[a21_0x28c3('0xd')](stationSettings_1[a21_0x28c3('0x8')][a21_0x28c3('0x9')][a21_0x28c3('0xe')]+_0x4705b3,(_0x35fe71,_0x20f77d)=>{const _0x329b6c=Math[a21_0x28c3('0xf')](new Date()[a21_0x28c3('0x10')]()-_0x20f77d[a21_0x28c3('0x11')][a21_0x28c3('0x10')]());if(_0x329b6c>0x2710){this['syncFile'](_0x4705b3);}});}});}});setTimeout(()=>{this[a21_0x28c3('0x5')](++_0x4705b6);},0x1388);}['syncFile'](_0x4442b1){const _0x11beb0=stationSettings_1[a21_0x28c3('0x8')][a21_0x28c3('0x9')][a21_0x28c3('0xe')]+_0x4442b1;const _0x1e9488=stationSettings_1[a21_0x28c3('0x8')][a21_0x28c3('0x9')][a21_0x28c3('0xe')]+a21_0x28c3('0x12')+_0x4442b1;fs[a21_0x28c3('0x13')](_0x11beb0,_0x1e9488,_0xa40597=>{if(_0xa40597){console[a21_0x28c3('0x6')](_0xa40597);}else{console[a21_0x28c3('0x6')](a21_0x28c3('0x14')+_0x1e9488);this[a21_0x28c3('0x15')](_0x4442b1,_0x1e9488);}});}[a21_0x28c3('0x15')](_0xf6510f,_0x260094){const _0x506c7c='http://restapi.passcontrol.co/sync_files/upload_event';const _0x1e88d4={'file':fs[a21_0x28c3('0x16')](_0x260094)};console[a21_0x28c3('0x6')](new Date());console[a21_0x28c3('0x6')](a21_0x28c3('0x17')+_0x506c7c);console[a21_0x28c3('0x6')](a21_0x28c3('0x18')+_0xf6510f);try{request[a21_0x28c3('0x19')]({'url':_0x506c7c,'formData':_0x1e88d4},function(_0x43188a,_0x337de7,_0xa37b3a){let _0x500270=null;let _0x4ba768='';if(_0x43188a){_0x4ba768='';}else{try{console[a21_0x28c3('0x6')](a21_0x28c3('0x1a')+_0xa37b3a);_0x500270=JSON[a21_0x28c3('0x1b')](_0xa37b3a);if(_0x500270['status']==0x1){_0x4ba768=a21_0x28c3('0x1c');}else{_0x4ba768='';}}catch(_0x31b0b1){console[a21_0x28c3('0x1d')](_0x31b0b1);_0x4ba768='';}}const _0x25f0f2=stationSettings_1[a21_0x28c3('0x8')][a21_0x28c3('0x9')]['eventFileFolder']+_0x4ba768+_0xf6510f;fs['rename'](_0x260094,_0x25f0f2,function(_0x43188a){if(_0x43188a){console[a21_0x28c3('0x6')](_0x43188a);}console[a21_0x28c3('0x6')](a21_0x28c3('0x14')+_0x25f0f2);});});}catch(_0x1b046a){console[a21_0x28c3('0x1d')](_0x1b046a);}}}exports[a21_0x28c3('0x1e')]=SyncEventsService;
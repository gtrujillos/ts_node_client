var a21_0x4a67=['syncFile','process/','rename','sendFile','env','WEB_SERVICE_URL','sync_files/upload_event','createReadStream','serviceUrl:\x20','post','parse','status','success/','error','Successfully\x20renamed\x20','defineProperty','__esModule','../infrastructure/stationSettings','request','init','log','init\x20SyncEventsService','exploreDir','readdir','eventFileFolder','includes','stat','StationContext','settings','abs','getTime','ctime'];(function(_0x5bfda2,_0xdad8de){var _0x1b7edd=function(_0x44320e){while(--_0x44320e){_0x5bfda2['push'](_0x5bfda2['shift']());}};_0x1b7edd(++_0xdad8de);}(a21_0x4a67,0x10f));var a21_0x314c=function(_0x4e7258,_0x524cfd){_0x4e7258=_0x4e7258-0x0;var _0x53c3fe=a21_0x4a67[_0x4e7258];return _0x53c3fe;};'use strict';Object[a21_0x314c('0x0')](exports,a21_0x314c('0x1'),{'value':!![]});const stationSettings_1=require(a21_0x314c('0x2'));const fs=require('fs');const request=require(a21_0x314c('0x3'));class SyncEventsService{constructor(){}[a21_0x314c('0x4')](){console[a21_0x314c('0x5')](a21_0x314c('0x6'));this['exploreDir'](0x0);}[a21_0x314c('0x7')](_0x21114f){fs[a21_0x314c('0x8')](stationSettings_1['StationContext']['settings'][a21_0x314c('0x9')],(_0x1e103d,_0xcd892f)=>{if(_0xcd892f!=null){_0xcd892f['forEach'](_0x486390=>{if(_0x486390[a21_0x314c('0xa')]('.gz')){fs[a21_0x314c('0xb')](stationSettings_1[a21_0x314c('0xc')][a21_0x314c('0xd')][a21_0x314c('0x9')]+_0x486390,(_0x3f7ba1,_0x13367a)=>{const _0x2e0f63=Math[a21_0x314c('0xe')](new Date()[a21_0x314c('0xf')]()-_0x13367a[a21_0x314c('0x10')][a21_0x314c('0xf')]());if(_0x2e0f63>0x2710){this['syncFile'](_0x486390);}});}});}});setTimeout(()=>{this['exploreDir'](++_0x21114f);},0x1388);}[a21_0x314c('0x11')](_0x549908){const _0x27081c=stationSettings_1[a21_0x314c('0xc')][a21_0x314c('0xd')]['eventFileFolder']+_0x549908;const _0x849049=stationSettings_1['StationContext'][a21_0x314c('0xd')]['eventFileFolder']+a21_0x314c('0x12')+_0x549908;fs[a21_0x314c('0x13')](_0x27081c,_0x849049,_0x4b9376=>{if(_0x4b9376){console['log'](_0x4b9376);}else{console['log']('Successfully\x20renamed\x20'+_0x849049);this['sendFile'](_0x549908,_0x849049);}});}[a21_0x314c('0x14')](_0x538b30,_0x592e47){const _0x21a3af=process[a21_0x314c('0x15')][a21_0x314c('0x16')]+a21_0x314c('0x17');const _0x226209={'file':fs[a21_0x314c('0x18')](_0x592e47)};console[a21_0x314c('0x5')](new Date());console[a21_0x314c('0x5')](a21_0x314c('0x19')+_0x21a3af);console[a21_0x314c('0x5')]('Sending\x20file:\x20'+_0x538b30);try{request[a21_0x314c('0x1a')]({'url':_0x21a3af,'formData':_0x226209},function(_0x2ee127,_0x4893ff,_0x3f9ef6){let _0x8906e1=null;let _0x4aeb9f='';if(_0x2ee127){_0x4aeb9f='';}else{try{console[a21_0x314c('0x5')]('Response\x20body:\x20'+_0x3f9ef6);_0x8906e1=JSON[a21_0x314c('0x1b')](_0x3f9ef6);if(_0x8906e1[a21_0x314c('0x1c')]==0x1){_0x4aeb9f=a21_0x314c('0x1d');}else{_0x4aeb9f='';}}catch(_0x3b4034){console[a21_0x314c('0x1e')](_0x3b4034);_0x4aeb9f='';}}const _0x449039=stationSettings_1['StationContext'][a21_0x314c('0xd')]['eventFileFolder']+_0x4aeb9f+_0x538b30;fs['rename'](_0x592e47,_0x449039,function(_0x2ee127){if(_0x2ee127){console['log'](_0x2ee127);}console[a21_0x314c('0x5')](a21_0x314c('0x1f')+_0x449039);});});}catch(_0x5d4c4e){console[a21_0x314c('0x1e')](_0x5d4c4e);}}}exports['SyncEventsService']=SyncEventsService;
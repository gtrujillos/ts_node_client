var a21_0x47dc=['success/','error','SyncEventsService','defineProperty','__esModule','../infrastructure/stationSettings','request','init','init\x20SyncEventsService','exploreDir','readdir','StationContext','settings','.gz','eventFileFolder','abs','getTime','ctime','syncFile','process/','rename','log','Successfully\x20renamed\x20','sendFile','WEB_SERVICE_URL','sync_files/upload_event','createReadStream','post','Response\x20body:\x20','parse','status'];(function(_0x43748b,_0x14b0d8){var _0x32a8c9=function(_0x5874bc){while(--_0x5874bc){_0x43748b['push'](_0x43748b['shift']());}};_0x32a8c9(++_0x14b0d8);}(a21_0x47dc,0x177));var a21_0x1627=function(_0x52a51b,_0x3e9c7d){_0x52a51b=_0x52a51b-0x0;var _0x147aae=a21_0x47dc[_0x52a51b];return _0x147aae;};'use strict';Object[a21_0x1627('0x0')](exports,a21_0x1627('0x1'),{'value':!![]});const stationSettings_1=require(a21_0x1627('0x2'));const fs=require('fs');const request=require(a21_0x1627('0x3'));class SyncEventsService{constructor(){}[a21_0x1627('0x4')](){console['log'](a21_0x1627('0x5'));this[a21_0x1627('0x6')](0x0);}[a21_0x1627('0x6')](_0x317158){fs[a21_0x1627('0x7')](stationSettings_1[a21_0x1627('0x8')][a21_0x1627('0x9')]['eventFileFolder'],(_0x4e88a9,_0xfba415)=>{if(_0xfba415!=null){_0xfba415['forEach'](_0x2a8a71=>{if(_0x2a8a71['includes'](a21_0x1627('0xa'))){fs['stat'](stationSettings_1[a21_0x1627('0x8')][a21_0x1627('0x9')][a21_0x1627('0xb')]+_0x2a8a71,(_0x3a88e2,_0x1ca10b)=>{const _0x57058f=Math[a21_0x1627('0xc')](new Date()[a21_0x1627('0xd')]()-_0x1ca10b[a21_0x1627('0xe')][a21_0x1627('0xd')]());if(_0x57058f>0x2710){this[a21_0x1627('0xf')](_0x2a8a71);}});}});}});setTimeout(()=>{this[a21_0x1627('0x6')](++_0x317158);},0x1388);}[a21_0x1627('0xf')](_0x113839){const _0x33b786=stationSettings_1[a21_0x1627('0x8')][a21_0x1627('0x9')][a21_0x1627('0xb')]+_0x113839;const _0x4a9b14=stationSettings_1['StationContext'][a21_0x1627('0x9')]['eventFileFolder']+a21_0x1627('0x10')+_0x113839;fs[a21_0x1627('0x11')](_0x33b786,_0x4a9b14,_0x45b9fb=>{if(_0x45b9fb){console[a21_0x1627('0x12')](_0x45b9fb);}else{console[a21_0x1627('0x12')](a21_0x1627('0x13')+_0x4a9b14);this[a21_0x1627('0x14')](_0x113839,_0x4a9b14);}});}[a21_0x1627('0x14')](_0x544622,_0x4be8b4){const _0x2a1d0f=process['env'][a21_0x1627('0x15')]+a21_0x1627('0x16');const _0x11896d={'file':fs[a21_0x1627('0x17')](_0x4be8b4)};console['log'](new Date());console[a21_0x1627('0x12')]('serviceUrl:\x20'+_0x2a1d0f);console[a21_0x1627('0x12')]('Sending\x20file:\x20'+_0x544622);try{request[a21_0x1627('0x18')]({'url':_0x2a1d0f,'formData':_0x11896d},function(_0xd1dd52,_0x2188b2,_0x388371){let _0x498956=null;let _0x4fd169='';if(_0xd1dd52){_0x4fd169='';}else{try{console['log'](a21_0x1627('0x19')+_0x388371);_0x498956=JSON[a21_0x1627('0x1a')](_0x388371);if(_0x498956[a21_0x1627('0x1b')]==0x1){_0x4fd169=a21_0x1627('0x1c');}else{_0x4fd169='';}}catch(_0x46c331){console[a21_0x1627('0x1d')](_0x46c331);_0x4fd169='';}}const _0x56445a=stationSettings_1['StationContext'][a21_0x1627('0x9')][a21_0x1627('0xb')]+_0x4fd169+_0x544622;fs[a21_0x1627('0x11')](_0x4be8b4,_0x56445a,function(_0xd1dd52){if(_0xd1dd52){console[a21_0x1627('0x12')](_0xd1dd52);}console[a21_0x1627('0x12')](a21_0x1627('0x13')+_0x56445a);});});}catch(_0xa43fb1){console['error'](_0xa43fb1);}}}exports[a21_0x1627('0x1e')]=SyncEventsService;
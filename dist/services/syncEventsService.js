var a21_0x3ca2=['forEach','includes','.gz','abs','getTime','ctime','syncFile','process/','rename','Successfully\x20renamed\x20','sendFile','env','sync_files/upload_event','serviceUrl:\x20','Sending\x20file:\x20','post','Response\x20body:\x20','parse','status','success/','error','SyncEventsService','defineProperty','__esModule','request','init','log','init\x20SyncEventsService','exploreDir','StationContext','settings','eventFileFolder'];(function(_0x4e291b,_0x5b35ba){var _0x35280e=function(_0x5d7b2b){while(--_0x5d7b2b){_0x4e291b['push'](_0x4e291b['shift']());}};_0x35280e(++_0x5b35ba);}(a21_0x3ca2,0xf6));var a21_0x5ba1=function(_0x24f747,_0x27193a){_0x24f747=_0x24f747-0x0;var _0x484512=a21_0x3ca2[_0x24f747];return _0x484512;};'use strict';Object[a21_0x5ba1('0x0')](exports,a21_0x5ba1('0x1'),{'value':!![]});const stationSettings_1=require('../infrastructure/stationSettings');const fs=require('fs');const request=require(a21_0x5ba1('0x2'));class SyncEventsService{constructor(){}[a21_0x5ba1('0x3')](){console[a21_0x5ba1('0x4')](a21_0x5ba1('0x5'));this[a21_0x5ba1('0x6')](0x0);}[a21_0x5ba1('0x6')](_0x31d52e){fs['readdir'](stationSettings_1[a21_0x5ba1('0x7')][a21_0x5ba1('0x8')][a21_0x5ba1('0x9')],(_0x47e5c0,_0x5802a6)=>{if(_0x5802a6!=null){_0x5802a6[a21_0x5ba1('0xa')](_0x1530b1=>{if(_0x1530b1[a21_0x5ba1('0xb')](a21_0x5ba1('0xc'))){fs['stat'](stationSettings_1[a21_0x5ba1('0x7')][a21_0x5ba1('0x8')]['eventFileFolder']+_0x1530b1,(_0x3aa26b,_0x2982c3)=>{const _0x13ea8c=Math[a21_0x5ba1('0xd')](new Date()[a21_0x5ba1('0xe')]()-_0x2982c3[a21_0x5ba1('0xf')][a21_0x5ba1('0xe')]());if(_0x13ea8c>0x2710){this[a21_0x5ba1('0x10')](_0x1530b1);}});}});}});setTimeout(()=>{this[a21_0x5ba1('0x6')](++_0x31d52e);},0x1388);}['syncFile'](_0x54a555){const _0x567f79=stationSettings_1['StationContext'][a21_0x5ba1('0x8')][a21_0x5ba1('0x9')]+_0x54a555;const _0x193537=stationSettings_1[a21_0x5ba1('0x7')][a21_0x5ba1('0x8')][a21_0x5ba1('0x9')]+a21_0x5ba1('0x11')+_0x54a555;fs[a21_0x5ba1('0x12')](_0x567f79,_0x193537,_0x47d842=>{if(_0x47d842){console['log'](_0x47d842);}else{console[a21_0x5ba1('0x4')](a21_0x5ba1('0x13')+_0x193537);this[a21_0x5ba1('0x14')](_0x54a555,_0x193537);}});}[a21_0x5ba1('0x14')](_0x12c39a,_0x556aa4){const _0x2f78c1=process[a21_0x5ba1('0x15')]['WEB_SERVICE_URL']+a21_0x5ba1('0x16');const _0x5db010={'file':fs['createReadStream'](_0x556aa4)};console['log'](new Date());console['log'](a21_0x5ba1('0x17')+_0x2f78c1);console['log'](a21_0x5ba1('0x18')+_0x12c39a);try{request[a21_0x5ba1('0x19')]({'url':_0x2f78c1,'formData':_0x5db010},function(_0x39c6ce,_0x3afd19,_0x5f45c4){let _0x2d4df1=null;let _0x3ccf15='';if(_0x39c6ce){_0x3ccf15='';}else{try{console[a21_0x5ba1('0x4')](a21_0x5ba1('0x1a')+_0x5f45c4);_0x2d4df1=JSON[a21_0x5ba1('0x1b')](_0x5f45c4);if(_0x2d4df1[a21_0x5ba1('0x1c')]==0x1){_0x3ccf15=a21_0x5ba1('0x1d');}else{_0x3ccf15='';}}catch(_0x46a6ab){console['error'](_0x46a6ab);_0x3ccf15='';}}const _0x4cf8ec=stationSettings_1[a21_0x5ba1('0x7')][a21_0x5ba1('0x8')]['eventFileFolder']+_0x3ccf15+_0x12c39a;fs['rename'](_0x556aa4,_0x4cf8ec,function(_0x39c6ce){if(_0x39c6ce){console['log'](_0x39c6ce);}console[a21_0x5ba1('0x4')]('Successfully\x20renamed\x20'+_0x4cf8ec);});});}catch(_0x4c486a){console[a21_0x5ba1('0x1e')](_0x4c486a);}}}exports[a21_0x5ba1('0x1f')]=SyncEventsService;
var a21_0xdd79=['__esModule','../infrastructure/stationSettings','request','exploreDir','StationContext','settings','eventFileFolder','includes','stat','ctime','getTime','syncFile','process/','rename','log','Successfully\x20renamed\x20','sendFile','env','WEB_SERVICE_URL','sync_files/upload_event','createReadStream','parse','success/','error','SyncEventsService','defineProperty'];(function(_0x5dbae2,_0x4faf67){var _0x12f7d4=function(_0x3af8ec){while(--_0x3af8ec){_0x5dbae2['push'](_0x5dbae2['shift']());}};_0x12f7d4(++_0x4faf67);}(a21_0xdd79,0x185));var a21_0x1bca=function(_0x17d098,_0x3eb12b){_0x17d098=_0x17d098-0x0;var _0x3b797a=a21_0xdd79[_0x17d098];return _0x3b797a;};'use strict';Object[a21_0x1bca('0x0')](exports,a21_0x1bca('0x1'),{'value':!![]});const stationSettings_1=require(a21_0x1bca('0x2'));const fs=require('fs');const request=require(a21_0x1bca('0x3'));class SyncEventsService{constructor(){}['init'](){console['log']('init\x20SyncEventsService');this['exploreDir'](0x0);}[a21_0x1bca('0x4')](_0x2ec80e){fs['readdir'](stationSettings_1[a21_0x1bca('0x5')][a21_0x1bca('0x6')][a21_0x1bca('0x7')],(_0x49cbdc,_0x2a5905)=>{if(_0x2a5905!=null){_0x2a5905['forEach'](_0x253e96=>{if(_0x253e96[a21_0x1bca('0x8')]('.gz')){fs[a21_0x1bca('0x9')](stationSettings_1[a21_0x1bca('0x5')][a21_0x1bca('0x6')][a21_0x1bca('0x7')]+_0x253e96,(_0x480cca,_0x26b22c)=>{const _0x21ed6b=Math['abs'](new Date()['getTime']()-_0x26b22c[a21_0x1bca('0xa')][a21_0x1bca('0xb')]());if(_0x21ed6b>0x2710){this['syncFile'](_0x253e96);}});}});}});setTimeout(()=>{this['exploreDir'](++_0x2ec80e);},0x1388);}[a21_0x1bca('0xc')](_0x2712e0){const _0x29da1f=stationSettings_1[a21_0x1bca('0x5')][a21_0x1bca('0x6')][a21_0x1bca('0x7')]+_0x2712e0;const _0x4dc7f1=stationSettings_1[a21_0x1bca('0x5')][a21_0x1bca('0x6')][a21_0x1bca('0x7')]+a21_0x1bca('0xd')+_0x2712e0;fs[a21_0x1bca('0xe')](_0x29da1f,_0x4dc7f1,_0x3c5330=>{if(_0x3c5330){console['log'](_0x3c5330);}else{console[a21_0x1bca('0xf')](a21_0x1bca('0x10')+_0x4dc7f1);this[a21_0x1bca('0x11')](_0x2712e0,_0x4dc7f1);}});}[a21_0x1bca('0x11')](_0x21bcbd,_0x32945d){const _0x441c70=process[a21_0x1bca('0x12')][a21_0x1bca('0x13')]+a21_0x1bca('0x14');const _0x5a5c07={'file':fs[a21_0x1bca('0x15')](_0x32945d)};console[a21_0x1bca('0xf')](new Date());console[a21_0x1bca('0xf')]('serviceUrl:\x20'+_0x441c70);console[a21_0x1bca('0xf')]('Sending\x20file:\x20'+_0x21bcbd);try{request['post']({'url':_0x441c70,'formData':_0x5a5c07},function(_0x1f6f4e,_0x27dcad,_0x40ae4c){let _0x4785a5=null;let _0x4d1aae='';if(_0x1f6f4e){_0x4d1aae='';}else{try{console[a21_0x1bca('0xf')]('Response\x20body:\x20'+_0x40ae4c);_0x4785a5=JSON[a21_0x1bca('0x16')](_0x40ae4c);if(_0x4785a5['status']==0x1){_0x4d1aae=a21_0x1bca('0x17');}else{_0x4d1aae='';}}catch(_0x1cbd1c){console[a21_0x1bca('0x18')](_0x1cbd1c);_0x4d1aae='';}}const _0x183a95=stationSettings_1['StationContext']['settings']['eventFileFolder']+_0x4d1aae+_0x21bcbd;fs['rename'](_0x32945d,_0x183a95,function(_0x1f6f4e){if(_0x1f6f4e){console['log'](_0x1f6f4e);}console[a21_0x1bca('0xf')](a21_0x1bca('0x10')+_0x183a95);});});}catch(_0x415154){console[a21_0x1bca('0x18')](_0x415154);}}}exports[a21_0x1bca('0x19')]=SyncEventsService;
var a25_0x2b7a=['getTime','syncFile','exploreDir','process/','rename','Successfully\x20renamed\x20','sendFile','env','WEB_SERVICE_URL','sync_files/upload_event','createReadStream','parse','status','success/','error','SyncEventsService','defineProperty','__esModule','../infrastructure/stationSettings','request','log','init\x20SyncEventsService','readdir','StationContext','settings','eventFileFolder','forEach','includes','.gz','stat'];(function(_0x3d6a35,_0xd71816){var _0x2d3779=function(_0x2c4929){while(--_0x2c4929){_0x3d6a35['push'](_0x3d6a35['shift']());}};_0x2d3779(++_0xd71816);}(a25_0x2b7a,0x13c));var a25_0x370d=function(_0x3b9bf4,_0x15f554){_0x3b9bf4=_0x3b9bf4-0x0;var _0x5c170c=a25_0x2b7a[_0x3b9bf4];return _0x5c170c;};'use strict';Object[a25_0x370d('0x0')](exports,a25_0x370d('0x1'),{'value':!![]});const stationSettings_1=require(a25_0x370d('0x2'));const fs=require('fs');const request=require(a25_0x370d('0x3'));class SyncEventsService{constructor(){}['init'](){console[a25_0x370d('0x4')](a25_0x370d('0x5'));this['exploreDir'](0x0);}['exploreDir'](_0x3c2abd){fs[a25_0x370d('0x6')](stationSettings_1[a25_0x370d('0x7')][a25_0x370d('0x8')][a25_0x370d('0x9')],(_0x3a3ebd,_0x2bed83)=>{if(_0x2bed83!=null){_0x2bed83[a25_0x370d('0xa')](_0x6b67c0=>{if(_0x6b67c0[a25_0x370d('0xb')](a25_0x370d('0xc'))){fs[a25_0x370d('0xd')](stationSettings_1['StationContext'][a25_0x370d('0x8')]['eventFileFolder']+_0x6b67c0,(_0x25ecd8,_0x44460c)=>{const _0x14208e=Math['abs'](new Date()[a25_0x370d('0xe')]()-_0x44460c['ctime'][a25_0x370d('0xe')]());if(_0x14208e>0x2710){this[a25_0x370d('0xf')](_0x6b67c0);}});}});}});setTimeout(()=>{this[a25_0x370d('0x10')](++_0x3c2abd);},0x1388);}[a25_0x370d('0xf')](_0x37a23d){const _0x53c3e1=stationSettings_1[a25_0x370d('0x7')][a25_0x370d('0x8')][a25_0x370d('0x9')]+_0x37a23d;const _0x1e6909=stationSettings_1[a25_0x370d('0x7')][a25_0x370d('0x8')][a25_0x370d('0x9')]+a25_0x370d('0x11')+_0x37a23d;fs[a25_0x370d('0x12')](_0x53c3e1,_0x1e6909,_0x379358=>{if(_0x379358){console['log'](_0x379358);}else{console['log'](a25_0x370d('0x13')+_0x1e6909);this[a25_0x370d('0x14')](_0x37a23d,_0x1e6909);}});}['sendFile'](_0x425878,_0x4caef3){const _0x2d2d9b=process[a25_0x370d('0x15')][a25_0x370d('0x16')]+a25_0x370d('0x17');const _0x1ed3a3={'file':fs[a25_0x370d('0x18')](_0x4caef3)};console['log'](new Date());console[a25_0x370d('0x4')]('serviceUrl:\x20'+_0x2d2d9b);console['log']('Sending\x20file:\x20'+_0x425878);try{request['post']({'url':_0x2d2d9b,'formData':_0x1ed3a3},function(_0x5d402d,_0x58e960,_0xdf5ced){let _0x1f4c11=null;let _0x2be78e='';if(_0x5d402d){_0x2be78e='';}else{try{console['log']('Response\x20body:\x20'+_0xdf5ced);_0x1f4c11=JSON[a25_0x370d('0x19')](_0xdf5ced);if(_0x1f4c11[a25_0x370d('0x1a')]==0x1){_0x2be78e=a25_0x370d('0x1b');}else{_0x2be78e='';}}catch(_0x3db834){console[a25_0x370d('0x1c')](_0x3db834);_0x2be78e='';}}const _0x25957a=stationSettings_1[a25_0x370d('0x7')]['settings'][a25_0x370d('0x9')]+_0x2be78e+_0x425878;fs['rename'](_0x4caef3,_0x25957a,function(_0x5d402d){if(_0x5d402d){console[a25_0x370d('0x4')](_0x5d402d);}console[a25_0x370d('0x4')](a25_0x370d('0x13')+_0x25957a);});});}catch(_0x43cdfc){console[a25_0x370d('0x1c')](_0x43cdfc);}}}exports[a25_0x370d('0x1d')]=SyncEventsService;
var a21_0x2244=['StationContext','settings','eventFileFolder','forEach','includes','stat','getTime','syncFile','process/','rename','Successfully\x20renamed\x20','sendFile','env','WEB_SERVICE_URL','sync_files/upload_event','createReadStream','serviceUrl:\x20','Sending\x20file:\x20','post','parse','status','error','SyncEventsService','defineProperty','__esModule','../infrastructure/stationSettings','request','init','log','init\x20SyncEventsService','exploreDir'];(function(_0x45281b,_0x2cd9e5){var _0xdc0775=function(_0x43e06f){while(--_0x43e06f){_0x45281b['push'](_0x45281b['shift']());}};_0xdc0775(++_0x2cd9e5);}(a21_0x2244,0x10f));var a21_0x3d60=function(_0x12af15,_0x2c45df){_0x12af15=_0x12af15-0x0;var _0x16b118=a21_0x2244[_0x12af15];return _0x16b118;};'use strict';Object[a21_0x3d60('0x0')](exports,a21_0x3d60('0x1'),{'value':!![]});const stationSettings_1=require(a21_0x3d60('0x2'));const fs=require('fs');const request=require(a21_0x3d60('0x3'));class SyncEventsService{constructor(){}[a21_0x3d60('0x4')](){console[a21_0x3d60('0x5')](a21_0x3d60('0x6'));this[a21_0x3d60('0x7')](0x0);}[a21_0x3d60('0x7')](_0x36d369){fs['readdir'](stationSettings_1[a21_0x3d60('0x8')][a21_0x3d60('0x9')][a21_0x3d60('0xa')],(_0x4ed828,_0x3074ac)=>{if(_0x3074ac!=null){_0x3074ac[a21_0x3d60('0xb')](_0x49a2e2=>{if(_0x49a2e2[a21_0x3d60('0xc')]('.gz')){fs[a21_0x3d60('0xd')](stationSettings_1[a21_0x3d60('0x8')]['settings']['eventFileFolder']+_0x49a2e2,(_0x17699b,_0x346ddc)=>{const _0x168acd=Math['abs'](new Date()[a21_0x3d60('0xe')]()-_0x346ddc['ctime']['getTime']());if(_0x168acd>0x2710){this[a21_0x3d60('0xf')](_0x49a2e2);}});}});}});setTimeout(()=>{this['exploreDir'](++_0x36d369);},0x1388);}['syncFile'](_0x30fd34){const _0x4f56aa=stationSettings_1[a21_0x3d60('0x8')]['settings'][a21_0x3d60('0xa')]+_0x30fd34;const _0x525531=stationSettings_1[a21_0x3d60('0x8')][a21_0x3d60('0x9')]['eventFileFolder']+a21_0x3d60('0x10')+_0x30fd34;fs[a21_0x3d60('0x11')](_0x4f56aa,_0x525531,_0xa819e9=>{if(_0xa819e9){console['log'](_0xa819e9);}else{console[a21_0x3d60('0x5')](a21_0x3d60('0x12')+_0x525531);this[a21_0x3d60('0x13')](_0x30fd34,_0x525531);}});}[a21_0x3d60('0x13')](_0x248ad9,_0x31710c){const _0x18c7a8=process[a21_0x3d60('0x14')][a21_0x3d60('0x15')]+a21_0x3d60('0x16');const _0x375166={'file':fs[a21_0x3d60('0x17')](_0x31710c)};console[a21_0x3d60('0x5')](new Date());console[a21_0x3d60('0x5')](a21_0x3d60('0x18')+_0x18c7a8);console[a21_0x3d60('0x5')](a21_0x3d60('0x19')+_0x248ad9);try{request[a21_0x3d60('0x1a')]({'url':_0x18c7a8,'formData':_0x375166},function(_0x186c22,_0x231382,_0x5b127f){let _0x494389=null;let _0x663ab7='';if(_0x186c22){_0x663ab7='';}else{try{console[a21_0x3d60('0x5')]('Response\x20body:\x20'+_0x5b127f);_0x494389=JSON[a21_0x3d60('0x1b')](_0x5b127f);if(_0x494389[a21_0x3d60('0x1c')]==0x1){_0x663ab7='success/';}else{_0x663ab7='';}}catch(_0x38b459){console['error'](_0x38b459);_0x663ab7='';}}const _0x55cc8c=stationSettings_1[a21_0x3d60('0x8')][a21_0x3d60('0x9')][a21_0x3d60('0xa')]+_0x663ab7+_0x248ad9;fs['rename'](_0x31710c,_0x55cc8c,function(_0x186c22){if(_0x186c22){console['log'](_0x186c22);}console['log'](a21_0x3d60('0x12')+_0x55cc8c);});});}catch(_0x275c70){console[a21_0x3d60('0x1d')](_0x275c70);}}}exports[a21_0x3d60('0x1e')]=SyncEventsService;
var a21_0x2846=['post','Response\x20body:\x20','parse','status','error','SyncEventsService','defineProperty','__esModule','../infrastructure/stationSettings','request','init','log','readdir','eventFileFolder','forEach','includes','stat','StationContext','settings','abs','getTime','ctime','syncFile','exploreDir','process/','rename','Successfully\x20renamed\x20','sendFile','env','WEB_SERVICE_URL','sync_files/upload_event','serviceUrl:\x20','Sending\x20file:\x20'];(function(_0x458d88,_0x5798e7){var _0x482657=function(_0xa5709a){while(--_0xa5709a){_0x458d88['push'](_0x458d88['shift']());}};_0x482657(++_0x5798e7);}(a21_0x2846,0x192));var a21_0x84d0=function(_0x17adb8,_0x4cc7e9){_0x17adb8=_0x17adb8-0x0;var _0x3e2559=a21_0x2846[_0x17adb8];return _0x3e2559;};'use strict';Object[a21_0x84d0('0x0')](exports,a21_0x84d0('0x1'),{'value':!![]});const stationSettings_1=require(a21_0x84d0('0x2'));const fs=require('fs');const request=require(a21_0x84d0('0x3'));class SyncEventsService{constructor(){}[a21_0x84d0('0x4')](){console[a21_0x84d0('0x5')]('init\x20SyncEventsService');this['exploreDir'](0x0);}['exploreDir'](_0x49454d){fs[a21_0x84d0('0x6')](stationSettings_1['StationContext']['settings'][a21_0x84d0('0x7')],(_0x196cec,_0x266285)=>{if(_0x266285!=null){_0x266285[a21_0x84d0('0x8')](_0x23bbaa=>{if(_0x23bbaa[a21_0x84d0('0x9')]('.gz')){fs[a21_0x84d0('0xa')](stationSettings_1[a21_0x84d0('0xb')][a21_0x84d0('0xc')][a21_0x84d0('0x7')]+_0x23bbaa,(_0x583d16,_0x34314e)=>{const _0x57ee56=Math[a21_0x84d0('0xd')](new Date()[a21_0x84d0('0xe')]()-_0x34314e[a21_0x84d0('0xf')][a21_0x84d0('0xe')]());if(_0x57ee56>0x2710){this[a21_0x84d0('0x10')](_0x23bbaa);}});}});}});setTimeout(()=>{this[a21_0x84d0('0x11')](++_0x49454d);},0x1388);}[a21_0x84d0('0x10')](_0x21d944){const _0x24e0b0=stationSettings_1[a21_0x84d0('0xb')][a21_0x84d0('0xc')][a21_0x84d0('0x7')]+_0x21d944;const _0x2a852a=stationSettings_1['StationContext'][a21_0x84d0('0xc')][a21_0x84d0('0x7')]+a21_0x84d0('0x12')+_0x21d944;fs[a21_0x84d0('0x13')](_0x24e0b0,_0x2a852a,_0x1965cf=>{if(_0x1965cf){console[a21_0x84d0('0x5')](_0x1965cf);}else{console[a21_0x84d0('0x5')](a21_0x84d0('0x14')+_0x2a852a);this[a21_0x84d0('0x15')](_0x21d944,_0x2a852a);}});}['sendFile'](_0xb2df35,_0x509033){const _0x5e3c66=process[a21_0x84d0('0x16')][a21_0x84d0('0x17')]+a21_0x84d0('0x18');const _0x5d3468={'file':fs['createReadStream'](_0x509033)};console[a21_0x84d0('0x5')](new Date());console['log'](a21_0x84d0('0x19')+_0x5e3c66);console[a21_0x84d0('0x5')](a21_0x84d0('0x1a')+_0xb2df35);try{request[a21_0x84d0('0x1b')]({'url':_0x5e3c66,'formData':_0x5d3468},function(_0x491695,_0xd17693,_0x203dd4){let _0x4a68c7=null;let _0x42b3bd='';if(_0x491695){_0x42b3bd='';}else{try{console[a21_0x84d0('0x5')](a21_0x84d0('0x1c')+_0x203dd4);_0x4a68c7=JSON[a21_0x84d0('0x1d')](_0x203dd4);if(_0x4a68c7[a21_0x84d0('0x1e')]==0x1){_0x42b3bd='success/';}else{_0x42b3bd='';}}catch(_0x7b0b70){console[a21_0x84d0('0x1f')](_0x7b0b70);_0x42b3bd='';}}const _0x59e9b1=stationSettings_1[a21_0x84d0('0xb')][a21_0x84d0('0xc')][a21_0x84d0('0x7')]+_0x42b3bd+_0xb2df35;fs['rename'](_0x509033,_0x59e9b1,function(_0x491695){if(_0x491695){console[a21_0x84d0('0x5')](_0x491695);}console['log'](a21_0x84d0('0x14')+_0x59e9b1);});});}catch(_0x30b6d0){console[a21_0x84d0('0x1f')](_0x30b6d0);}}}exports[a21_0x84d0('0x20')]=SyncEventsService;
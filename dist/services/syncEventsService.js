var a21_0x4b2e=['Response\x20body:\x20','parse','error','SyncEventsService','defineProperty','__esModule','request','log','init\x20SyncEventsService','exploreDir','readdir','settings','eventFileFolder','forEach','includes','stat','StationContext','getTime','syncFile','process/','rename','Successfully\x20renamed\x20','sendFile','env','WEB_SERVICE_URL','sync_files/upload_event','Sending\x20file:\x20'];(function(_0x4ab3a6,_0x1da77b){var _0x111c6b=function(_0x3020b2){while(--_0x3020b2){_0x4ab3a6['push'](_0x4ab3a6['shift']());}};_0x111c6b(++_0x1da77b);}(a21_0x4b2e,0x148));var a21_0x2ca7=function(_0x5cd891,_0x537009){_0x5cd891=_0x5cd891-0x0;var _0x2d252a=a21_0x4b2e[_0x5cd891];return _0x2d252a;};'use strict';Object[a21_0x2ca7('0x0')](exports,a21_0x2ca7('0x1'),{'value':!![]});const stationSettings_1=require('../infrastructure/stationSettings');const fs=require('fs');const request=require(a21_0x2ca7('0x2'));class SyncEventsService{constructor(){}['init'](){console[a21_0x2ca7('0x3')](a21_0x2ca7('0x4'));this[a21_0x2ca7('0x5')](0x0);}['exploreDir'](_0x4ea767){fs[a21_0x2ca7('0x6')](stationSettings_1['StationContext'][a21_0x2ca7('0x7')][a21_0x2ca7('0x8')],(_0x5f1b3e,_0x563492)=>{if(_0x563492!=null){_0x563492[a21_0x2ca7('0x9')](_0x13b50a=>{if(_0x13b50a[a21_0x2ca7('0xa')]('.gz')){fs[a21_0x2ca7('0xb')](stationSettings_1[a21_0x2ca7('0xc')][a21_0x2ca7('0x7')]['eventFileFolder']+_0x13b50a,(_0x3f3525,_0x2367b3)=>{const _0x5618fa=Math['abs'](new Date()['getTime']()-_0x2367b3['ctime'][a21_0x2ca7('0xd')]());if(_0x5618fa>0x2710){this[a21_0x2ca7('0xe')](_0x13b50a);}});}});}});setTimeout(()=>{this[a21_0x2ca7('0x5')](++_0x4ea767);},0x1388);}[a21_0x2ca7('0xe')](_0x4e98ce){const _0x1a8dd0=stationSettings_1[a21_0x2ca7('0xc')][a21_0x2ca7('0x7')]['eventFileFolder']+_0x4e98ce;const _0x2622f3=stationSettings_1[a21_0x2ca7('0xc')][a21_0x2ca7('0x7')]['eventFileFolder']+a21_0x2ca7('0xf')+_0x4e98ce;fs[a21_0x2ca7('0x10')](_0x1a8dd0,_0x2622f3,_0x542230=>{if(_0x542230){console['log'](_0x542230);}else{console['log'](a21_0x2ca7('0x11')+_0x2622f3);this[a21_0x2ca7('0x12')](_0x4e98ce,_0x2622f3);}});}[a21_0x2ca7('0x12')](_0x375db1,_0x329fcf){const _0x4a6fc=process[a21_0x2ca7('0x13')][a21_0x2ca7('0x14')]+a21_0x2ca7('0x15');const _0x1d68fd={'file':fs['createReadStream'](_0x329fcf)};console[a21_0x2ca7('0x3')](new Date());console['log']('serviceUrl:\x20'+_0x4a6fc);console[a21_0x2ca7('0x3')](a21_0x2ca7('0x16')+_0x375db1);try{request['post']({'url':_0x4a6fc,'formData':_0x1d68fd},function(_0x39e417,_0x4f9dae,_0x62ebfe){let _0x1e5a11=null;let _0x431266='';if(_0x39e417){_0x431266='';}else{try{console[a21_0x2ca7('0x3')](a21_0x2ca7('0x17')+_0x62ebfe);_0x1e5a11=JSON[a21_0x2ca7('0x18')](_0x62ebfe);if(_0x1e5a11['status']==0x1){_0x431266='success/';}else{_0x431266='';}}catch(_0x412f0b){console['error'](_0x412f0b);_0x431266='';}}const _0x48493c=stationSettings_1[a21_0x2ca7('0xc')][a21_0x2ca7('0x7')]['eventFileFolder']+_0x431266+_0x375db1;fs[a21_0x2ca7('0x10')](_0x329fcf,_0x48493c,function(_0x39e417){if(_0x39e417){console[a21_0x2ca7('0x3')](_0x39e417);}console['log']('Successfully\x20renamed\x20'+_0x48493c);});});}catch(_0x11f5f3){console[a21_0x2ca7('0x19')](_0x11f5f3);}}}exports[a21_0x2ca7('0x1a')]=SyncEventsService;
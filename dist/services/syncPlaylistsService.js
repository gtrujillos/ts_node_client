var a22_0x314e=['Error\x20Downloading:\x20','message','downloadHTTPFileCallback','duration','createImageVideo','video','downloadRequestFile','progress','Error\x20downloading\x20file','pipe','createWriteStream','1/2','-pattern_type','libx264','-pix_fmt','yuv420p','-vf','scale=1920:1080','Converting\x20','stderr','stderr:\x20','close','http://www.youtube.com/watch?v=','--format=18','info','Download\x20started','filename:\x20','_filename','\x20already\x20downloaded.','finished\x20youtube\x20downloading!','Finishing','#EXTCPlayListM3U::M3U','#EXTINF:0,luloPlayList','media_type','lastIndexOf','/home/osmc/luloclient/media/files/','Refreshing..','Playlist\x20incomplete,\x20retry.','No\x20playlist\x20changes.','Playlist.Clear','Playlist.Cleared','jsonrpcClient','Playlist.Add','//home/osmc/luloclient/media/files/lulo_playlist.m3u','Playlist.Added','Player.Open','Playlist.Opened','2.0','http://localhost/jsonrpc','SyncPlaylistsService','next','throw','done','value','defineProperty','__esModule','node-mediainfo','url','http','fs-extra','request','request-progress','child_process','exec','is-image','string-template','youtube-dl','uuid/v4','config.json','context.json','url-exists','mt-files-downloader','mediaFolder','tempFolder','filesFolder','files/','playListFile','lulo_playlist.m3u','currentFile','playlistChanged','downloadFiles','failDownloadFiles','newPlayList','httpClientService','HttpClientService','init','config','parse','readFileSync','context','playerId','baseURL','env','deploy/','playListServiceURL','api/player_playlist.php?player_id={0}','kodi','http://192.168.0.102','lulo','.lulo123.','loadMediaList','getStatus','bind','registerClient','playlist','getItems','then','stringify','deviceUuid','post','http://restapi.lulo.run/player_devices/register','log','register\x20response:\x20','catch','writeFileSync','player','getCurrentlyPlayingVideo','item','label','reportStatus','playingItem:\x20','http://restapi.lulo.run/player_devices/report_status','reportStatusResponse:\x20','checkFolders','ensureDir','loadMediaList:\x20','hasPlayListChanged','Total:\x20','length','download','reloadMediaList','existsSync','emptyDirSync','removeSync','m3uFile','reboot','sudo\x20/sbin/shutdown\x20-r\x20now','toString','\x20of\x20','finishProcess','path','substring','split','slice','join','youtube_single','.mp4','**********+','checkVideo','copySync','Downloading:\x20','downloadYouTube','downloader','videoFile:\x20','media','track','@type','downloading:\x20','includes','push','Error:\x20','start:\x20','error','error:\x20','end','Downloaded:\x20','mediaType:\x20','stopped','destroyed','retry','downloadHTTPFile','Attempting\x20to\x20download\x20','Max\x20redirects\x20reached','WARNING\x20downloadFile\x20callback\x20is\x20undefined\x20for\x20','\x20to\x20','globalAgent','host','get','\x20Progress:\x20unknown\x09','\x20Progress:\x20','statusCode','headers','content-length','Have\x20already\x20downloaded\x20','size','And\x20the\x20file\x20size\x20matches\x20(','Redownloading','But\x20the\x20file\x20size\x20does\x20not\x20match\x20so\x20re-downloading\x20Old(',')\x20vs\x20New(','data','err:\x20','finish','location','Redirect\x20','Redirect\x20limit\x20encountered\x20for\x20','302','File\x20Not\x20Found\x20','Problem\x20downloading\x20','\x20STATUS:\x20'];(function(_0x482b30,_0x1ec357){var _0x3d1486=function(_0x5edcb7){while(--_0x5edcb7){_0x482b30['push'](_0x482b30['shift']());}};_0x3d1486(++_0x1ec357);}(a22_0x314e,0x1c0));var a22_0xb708=function(_0x2f3e31,_0x3a89c9){_0x2f3e31=_0x2f3e31-0x0;var _0x2c6db2=a22_0x314e[_0x2f3e31];return _0x2c6db2;};'use strict';var __awaiter=this&&this['__awaiter']||function(_0x3ebae6,_0x2aa162,_0xbc4b31,_0x17e825){function _0x7d3335(_0x580915){return _0x580915 instanceof _0xbc4b31?_0x580915:new _0xbc4b31(function(_0x195559){_0x195559(_0x580915);});}return new(_0xbc4b31||(_0xbc4b31=Promise))(function(_0x3df5cd,_0x2c4df0){function _0x4548da(_0x1a5aca){try{_0x3f5804(_0x17e825[a22_0xb708('0x0')](_0x1a5aca));}catch(_0x545d7d){_0x2c4df0(_0x545d7d);}}function _0x40e269(_0x518dc6){try{_0x3f5804(_0x17e825[a22_0xb708('0x1')](_0x518dc6));}catch(_0x54a37f){_0x2c4df0(_0x54a37f);}}function _0x3f5804(_0x556d68){_0x556d68[a22_0xb708('0x2')]?_0x3df5cd(_0x556d68[a22_0xb708('0x3')]):_0x7d3335(_0x556d68[a22_0xb708('0x3')])['then'](_0x4548da,_0x40e269);}_0x3f5804((_0x17e825=_0x17e825['apply'](_0x3ebae6,_0x2aa162||[]))[a22_0xb708('0x0')]());});};Object[a22_0xb708('0x4')](exports,a22_0xb708('0x5'),{'value':!![]});const HttpClientService_1=require('../infrastructure/HttpClientService');const mediainfo=require(a22_0xb708('0x6'));const fs=require('fs');const url=require(a22_0xb708('0x7'));const http=require(a22_0xb708('0x8'));const fsExtra=require(a22_0xb708('0x9'));const request=require(a22_0xb708('0xa'));const progress=require(a22_0xb708('0xb'));const spawn=require(a22_0xb708('0xc'))['spawn'];const exec=require(a22_0xb708('0xc'))[a22_0xb708('0xd')];const isImage=require(a22_0xb708('0xe'));const format=require(a22_0xb708('0xf'));const os=require('os');const youtubedl=require(a22_0xb708('0x10'));const uuidv4=require(a22_0xb708('0x11'));const configFile=a22_0xb708('0x12');const contextFile=a22_0xb708('0x13');const urlExists=require(a22_0xb708('0x14'));const kodi_rpc=require('node-kodi');const Downloader=require(a22_0xb708('0x15'));class SyncPlaylistsService{constructor(){this[a22_0xb708('0x16')]='media/';this[a22_0xb708('0x17')]=this['mediaFolder']+'temp/';this[a22_0xb708('0x18')]=this[a22_0xb708('0x16')]+a22_0xb708('0x19');this[a22_0xb708('0x1a')]=this[a22_0xb708('0x16')]+'playlist.txt';this['m3uFile']=this[a22_0xb708('0x18')]+a22_0xb708('0x1b');this[a22_0xb708('0x1c')]=0x0;this[a22_0xb708('0x1d')]=![];this[a22_0xb708('0x1e')]=[];this[a22_0xb708('0x1f')]=[];this[a22_0xb708('0x20')]={};this[a22_0xb708('0x21')]=new HttpClientService_1[(a22_0xb708('0x22'))]();}[a22_0xb708('0x23')](){this[a22_0xb708('0x24')]=JSON[a22_0xb708('0x25')](fs[a22_0xb708('0x26')](configFile));this[a22_0xb708('0x27')]=JSON[a22_0xb708('0x25')](fs[a22_0xb708('0x26')](contextFile));this[a22_0xb708('0x28')]=this['config'][a22_0xb708('0x28')];this[a22_0xb708('0x29')]=process[a22_0xb708('0x2a')]['WEB_SERVICE_URL']+a22_0xb708('0x2b');this[a22_0xb708('0x2c')]=this[a22_0xb708('0x29')]+a22_0xb708('0x2d');this[a22_0xb708('0x2e')]=new kodi_rpc({'url':a22_0xb708('0x2f'),'user':a22_0xb708('0x30'),'password':a22_0xb708('0x31')});this['checkDependencies']();this['registerClient']();this['checkFolders']();this[a22_0xb708('0x32')]();setInterval(function(){this[a22_0xb708('0x33')]();}[a22_0xb708('0x34')](this),0x2710);setInterval(function(){this['registerClient']();}['bind'](this),0x493e0);}['checkDependencies'](){}[a22_0xb708('0x35')](){this[a22_0xb708('0x2e')][a22_0xb708('0x36')][a22_0xb708('0x37')](0x1)[a22_0xb708('0x38')](function(_0x48fad1){const _0x6a1e71=JSON[a22_0xb708('0x39')](_0x48fad1);const _0x4c46b8={'player_id':this['playerId'],'device_uuid':this['config'][a22_0xb708('0x3a')],'network_info':JSON[a22_0xb708('0x39')](os['networkInterfaces']()),'firmware_info':JSON[a22_0xb708('0x39')](this['context']),'playlist':_0x6a1e71,'playing_item':'','status':0x0};this[a22_0xb708('0x21')][a22_0xb708('0x3b')](a22_0xb708('0x3c'),_0x4c46b8,![])['then'](function(_0x3960b8){console[a22_0xb708('0x3d')](a22_0xb708('0x3e')+Date());})[a22_0xb708('0x3f')](function(_0x33f9a1){});console['log'](_0x4c46b8);}[a22_0xb708('0x34')](this));const _0x51c010=this[a22_0xb708('0x24')][a22_0xb708('0x3a')];if(!_0x51c010||_0x51c010==''){this[a22_0xb708('0x24')][a22_0xb708('0x3a')]=uuidv4();this[a22_0xb708('0x24')]={'deviceUuid':this[a22_0xb708('0x24')][a22_0xb708('0x3a')],'playerId':this['config']['playerId']};fs[a22_0xb708('0x40')](configFile,JSON[a22_0xb708('0x39')](this['config']));}}[a22_0xb708('0x33')](){console[a22_0xb708('0x3d')](a22_0xb708('0x33'));this['kodi'][a22_0xb708('0x41')][a22_0xb708('0x42')]()[a22_0xb708('0x38')](function(_0xf1225){const _0x31043a=_0xf1225[a22_0xb708('0x43')][a22_0xb708('0x44')];this[a22_0xb708('0x45')](_0x31043a);}[a22_0xb708('0x34')](this))[a22_0xb708('0x3f')](function(_0xd5a64d){console[a22_0xb708('0x3d')](_0xd5a64d);this[a22_0xb708('0x45')](_0xd5a64d);}[a22_0xb708('0x34')](this));}[a22_0xb708('0x45')](_0x279f46){console['log'](a22_0xb708('0x46')+_0x279f46);const _0x156dca={'player_id':this[a22_0xb708('0x28')],'device_uuid':this[a22_0xb708('0x24')][a22_0xb708('0x3a')],'status':_0x279f46!=''&&_0x279f46!=null?0x1:0x0,'playing_item':_0x279f46};this[a22_0xb708('0x21')][a22_0xb708('0x3b')](a22_0xb708('0x47'),_0x156dca,![])[a22_0xb708('0x38')](function(_0x18011c){console['log'](a22_0xb708('0x48')+Date());})[a22_0xb708('0x3f')](function(_0x213a8c){});}[a22_0xb708('0x49')](){fsExtra['ensureDir'](this[a22_0xb708('0x16')],_0x35b31a=>{});fsExtra[a22_0xb708('0x4a')](this['tempFolder'],_0x4a2888=>{});fsExtra[a22_0xb708('0x4a')](this['filesFolder'],_0x35382c=>{});}[a22_0xb708('0x32')](){const _0x4de331=format(this[a22_0xb708('0x2c')],this[a22_0xb708('0x28')]);console[a22_0xb708('0x3d')](_0x4de331);request({'url':_0x4de331,'json':!![]},function(_0x5e7b6b,_0x38d32f,_0x435de5){console[a22_0xb708('0x3d')](a22_0xb708('0x4b'));console[a22_0xb708('0x3d')](_0x435de5);this['newPlayList']=_0x435de5;this['playlistChanged']=this[a22_0xb708('0x4c')]();fsExtra['emptyDirSync'](this[a22_0xb708('0x17')]);this['downloadFiles']=[];this['failDownloadFiles']=[];this[a22_0xb708('0x1c')]=0x0;for(const _0x48252a in _0x435de5){this[a22_0xb708('0x1e')]['push'](_0x435de5[_0x48252a]);}console[a22_0xb708('0x3d')](a22_0xb708('0x4d')+this[a22_0xb708('0x1e')][a22_0xb708('0x4e')]);if(this['downloadFiles'][a22_0xb708('0x4e')]>0x0){this[a22_0xb708('0x4f')]();}}[a22_0xb708('0x34')](this));}[a22_0xb708('0x50')](){if(fsExtra[a22_0xb708('0x51')](this[a22_0xb708('0x17')])){fsExtra['emptyDirSync'](this['tempFolder']);}if(fsExtra['existsSync'](this[a22_0xb708('0x18')])){fsExtra[a22_0xb708('0x52')](this[a22_0xb708('0x18')]);}if(!fsExtra[a22_0xb708('0x51')](this[a22_0xb708('0x1a')])){fsExtra[a22_0xb708('0x53')](this['playListFile']);}if(!fsExtra[a22_0xb708('0x51')](this[a22_0xb708('0x54')])){fsExtra['removeSync'](this['m3uFile']);}this[a22_0xb708('0x32')]();}[a22_0xb708('0x55')](){exec(a22_0xb708('0x56'),function(_0x378a29){console[a22_0xb708('0x3d')](_0x378a29);});}[a22_0xb708('0x4c')](){const _0x590154=JSON[a22_0xb708('0x39')](this['newPlayList']);try{if(!fsExtra[a22_0xb708('0x51')](this[a22_0xb708('0x1a')])){return!![];}else{const _0x2ea2b2=fsExtra[a22_0xb708('0x26')](this['playListFile'])[a22_0xb708('0x57')]();if(_0x2ea2b2!=_0x590154){return!![];}}}catch(_0x1010b3){console[a22_0xb708('0x3d')](_0x1010b3);}return![];}[a22_0xb708('0x4f')](){console[a22_0xb708('0x3d')]('this.currentFile:\x20'+this[a22_0xb708('0x1c')]+a22_0xb708('0x58')+this[a22_0xb708('0x1e')][a22_0xb708('0x4e')]);if(this[a22_0xb708('0x1c')]>=this['downloadFiles'][a22_0xb708('0x4e')]){this[a22_0xb708('0x59')]();return;}const _0x46d4ee=String(this[a22_0xb708('0x1e')][this[a22_0xb708('0x1c')]][a22_0xb708('0x5a')]);const _0x210768=this['downloadFiles'][this[a22_0xb708('0x1c')]]['media_type'];let _0x16730c=_0x46d4ee[a22_0xb708('0x5b')](_0x46d4ee['lastIndexOf']('/')+0x1);const _0x36f1be=_0x16730c[a22_0xb708('0x5c')]('.')[a22_0xb708('0x5d')](0x0,-0x1)[a22_0xb708('0x5e')]('.');let _0x412d1b=this[a22_0xb708('0x29')]+_0x46d4ee;const _0x337d06=_0x412d1b['split']('.')[a22_0xb708('0x5d')](0x0,-0x1)[a22_0xb708('0x5e')]('.');if(_0x210768==a22_0xb708('0x5f')){_0x16730c=_0x16730c+a22_0xb708('0x60');}else if(_0x210768=='image'){_0x16730c=_0x36f1be+'.mp4';_0x412d1b=_0x337d06+'.mp4';}console[a22_0xb708('0x3d')](a22_0xb708('0x61'));console[a22_0xb708('0x3d')](_0x46d4ee);console['log'](_0x210768);console['log'](_0x16730c);console[a22_0xb708('0x3d')](_0x412d1b);console[a22_0xb708('0x3d')](_0x36f1be);console['log'](_0x337d06);console[a22_0xb708('0x3d')](a22_0xb708('0x61'));if(fsExtra[a22_0xb708('0x51')](this['tempFolder']+_0x16730c)){this[a22_0xb708('0x62')](this[a22_0xb708('0x17')]+_0x16730c)['then'](function(_0x25c933){if(_0x25c933){this[a22_0xb708('0x1c')]++;}else{this[a22_0xb708('0x1d')]=!![];}this[a22_0xb708('0x4f')]();}[a22_0xb708('0x34')](this));}else if(fsExtra[a22_0xb708('0x51')](this[a22_0xb708('0x18')]+_0x16730c)){this[a22_0xb708('0x62')](this[a22_0xb708('0x18')]+_0x16730c)['then'](function(_0x29d0af){if(_0x29d0af){fsExtra[a22_0xb708('0x63')](this['filesFolder']+_0x16730c,this[a22_0xb708('0x17')]+_0x16730c);this[a22_0xb708('0x1c')]++;}else{this[a22_0xb708('0x1d')]=!![];}this['download']();}[a22_0xb708('0x34')](this));}else{console['log'](a22_0xb708('0x64')+_0x412d1b);this[a22_0xb708('0x1d')]=!![];if(_0x210768=='youtube_single'){this[a22_0xb708('0x65')](_0x46d4ee);}else{this[a22_0xb708('0x66')](_0x412d1b,_0x16730c,_0x210768);}}}['checkVideo'](_0x2dcb35){return __awaiter(this,void 0x0,void 0x0,function*(){console[a22_0xb708('0x3d')](a22_0xb708('0x67')+_0x2dcb35);const _0x3b1adb=yield mediainfo(_0x2dcb35)['catch'](_0x101896=>{console[a22_0xb708('0x3d')](_0x101896);fsExtra[a22_0xb708('0x53')](_0x2dcb35);return![];});const _0x7f705c=_0x3b1adb[a22_0xb708('0x68')][a22_0xb708('0x69')][a22_0xb708('0x4e')]>0x1&&_0x3b1adb[a22_0xb708('0x68')][a22_0xb708('0x69')][0x1][a22_0xb708('0x6a')]=='Video';if(!_0x7f705c){fsExtra[a22_0xb708('0x53')](_0x2dcb35);}console['log']('mediainfo\x20check:'+_0x7f705c);return _0x7f705c;});}[a22_0xb708('0x66')](_0x7cbe6c,_0x1eb4b1,_0x3dfd33){const _0x5cd4ae=new Downloader();console[a22_0xb708('0x3d')](_0x7cbe6c);console[a22_0xb708('0x3d')](_0x1eb4b1);console[a22_0xb708('0x3d')](_0x3dfd33);const _0x3d4b2d=_0x5cd4ae[a22_0xb708('0x4f')](_0x7cbe6c,this[a22_0xb708('0x17')]+_0x1eb4b1);urlExists(_0x7cbe6c,function(_0x4e485c,_0x1ebd58){if(_0x1ebd58){if(this['failDownloadFiles']['includes'](this[a22_0xb708('0x1c')])){const _0x4ef741=this[a22_0xb708('0x1f')]['indexOf'](this[a22_0xb708('0x1c')]);if(_0x4ef741>-0x1){this[a22_0xb708('0x1f')]['splice'](_0x4ef741,0x1);}}console[a22_0xb708('0x3d')](a22_0xb708('0x6b')+_0x7cbe6c);_0x3d4b2d['start']();}else{if(!this[a22_0xb708('0x1f')][a22_0xb708('0x6c')](this[a22_0xb708('0x1c')])){this[a22_0xb708('0x1f')][a22_0xb708('0x6d')](this[a22_0xb708('0x1c')]);}console[a22_0xb708('0x3d')](a22_0xb708('0x6e')+_0x7cbe6c);this[a22_0xb708('0x1c')]++;this[a22_0xb708('0x4f')]();}}['bind'](this));_0x3d4b2d['on']('start',function(_0x3d4b2d){console[a22_0xb708('0x3d')](a22_0xb708('0x6f')+_0x7cbe6c);});_0x3d4b2d['on'](a22_0xb708('0x70'),function(_0x3d4b2d){console[a22_0xb708('0x3d')](a22_0xb708('0x71'));this['download']();}[a22_0xb708('0x34')](this));_0x3d4b2d['on'](a22_0xb708('0x72'),function(_0x3d4b2d){console[a22_0xb708('0x3d')](a22_0xb708('0x72'));console[a22_0xb708('0x3d')](a22_0xb708('0x73')+_0x1eb4b1);console[a22_0xb708('0x3d')](a22_0xb708('0x74')+_0x3dfd33);this[a22_0xb708('0x62')](this[a22_0xb708('0x17')]+_0x1eb4b1)[a22_0xb708('0x38')](function(_0x3b6bc6){if(_0x3b6bc6){this[a22_0xb708('0x1c')]++;}this['download']();}[a22_0xb708('0x34')](this));}[a22_0xb708('0x34')](this));_0x3d4b2d['on'](a22_0xb708('0x75'),function(_0x3d4b2d){console[a22_0xb708('0x3d')](a22_0xb708('0x75'));});_0x3d4b2d['on'](a22_0xb708('0x76'),function(_0x3d4b2d){console[a22_0xb708('0x3d')](a22_0xb708('0x76'));});_0x3d4b2d['on'](a22_0xb708('0x77'),function(_0x3d4b2d){console[a22_0xb708('0x3d')](a22_0xb708('0x77'));});}[a22_0xb708('0x78')](_0x3cabde,_0x435cc9,_0x5ca9cd,_0x4b2b79){console['log'](a22_0xb708('0x78'));console[a22_0xb708('0x3d')](_0x3cabde);const _0x24c6fe=!![];let _0x518a97=0x0;const _0x37714b='';console[a22_0xb708('0x3d')](a22_0xb708('0x79')+_0x3cabde+'\x20to\x20'+_0x435cc9);if(_0x518a97){if(_0x518a97>0x5){_0x4b2b79(a22_0xb708('0x7a'),_0x3cabde,_0x5ca9cd,null);return;}}else{_0x518a97=0x0;}const _0x2b27ef=this[a22_0xb708('0x17')]+_0x435cc9;let _0x34a06c;if(_0x4b2b79===undefined){console['log'](a22_0xb708('0x7b')+_0x3cabde+a22_0xb708('0x7c')+_0x2b27ef);_0x4b2b79=function(_0xa52b93,_0x259f6e){console['log']('downloadFile\x20callback\x20result\x20undefined:\x20',_0xa52b93,_0x259f6e);};}http[a22_0xb708('0x7d')]['maxSockets']=0x64;const _0x1ecb55={'host':url[a22_0xb708('0x25')](_0x3cabde)[a22_0xb708('0x7e')],'port':0x50,'path':url[a22_0xb708('0x25')](_0x3cabde)['pathname'],'agent':![]};const _0x2f37aa=http[a22_0xb708('0x7f')](_0x1ecb55,function(_0x2e9cbc){let _0x2c9acb=0x0;let _0x374312=0x0;function _0x443cfc(){if(_0x2c9acb===undefined){console[a22_0xb708('0x3d')](_0x435cc9+a22_0xb708('0x80')+_0x374312+'/'+'?');}const _0x44d8c4=_0x374312/_0x2c9acb*0x64;console[a22_0xb708('0x3d')](_0x435cc9+a22_0xb708('0x81')+_0x44d8c4+'%\x09'+_0x374312+'/'+_0x2c9acb);}console[a22_0xb708('0x3d')](_0x435cc9+'\x20'+_0x2e9cbc[a22_0xb708('0x82')]);switch(_0x2e9cbc[a22_0xb708('0x82')]){case 0xc8:_0x2c9acb=_0x2e9cbc[a22_0xb708('0x83')][a22_0xb708('0x84')]||_0x37714b;fs['stat'](_0x2b27ef,function(_0x3f4d00,_0x31b9c5){if(!_0x3f4d00){console[a22_0xb708('0x3d')](a22_0xb708('0x85')+_0x2b27ef);if(_0x31b9c5[a22_0xb708('0x86')]==_0x2c9acb){console[a22_0xb708('0x3d')](a22_0xb708('0x87')+_0x2c9acb+')');console['log'](a22_0xb708('0x88'));}else{console[a22_0xb708('0x3d')](a22_0xb708('0x89')+_0x31b9c5[a22_0xb708('0x86')]+a22_0xb708('0x8a')+_0x2c9acb+')');}}_0x34a06c=fs['createWriteStream'](_0x2b27ef);_0x2e9cbc['pipe'](_0x34a06c);_0x2e9cbc['on'](a22_0xb708('0x8b'),function(_0x110f2b){_0x374312+=_0x110f2b[a22_0xb708('0x4e')];_0x443cfc();});_0x2f37aa['on'](a22_0xb708('0x70'),function(_0x3f4d00){console[a22_0xb708('0x3d')](a22_0xb708('0x8c'));console[a22_0xb708('0x3d')](_0x3f4d00);});_0x34a06c['on'](a22_0xb708('0x8d'),function(){console[a22_0xb708('0x3d')]('Downloaded\x20'+_0x3cabde+a22_0xb708('0x7c')+_0x435cc9);_0x4b2b79(null,_0x435cc9,_0x5ca9cd,_0x435cc9);}[a22_0xb708('0x34')](this));});break;case 0x12e:const _0x24c201=_0x2e9cbc[a22_0xb708('0x83')][a22_0xb708('0x8e')];console[a22_0xb708('0x3d')](a22_0xb708('0x8f')+_0x3cabde+'\x20to\x20'+_0x24c201);if(_0x518a97<0x5){this[a22_0xb708('0x78')](_0x24c201,_0x435cc9,_0x4b2b79,_0x518a97++);}else{console['error'](a22_0xb708('0x90')+_0x3cabde+'.');_0x4b2b79(a22_0xb708('0x91'),null,null,null);}return;case 0x194:console['log'](a22_0xb708('0x92')+_0x3cabde);default:console[a22_0xb708('0x3d')](a22_0xb708('0x93')+_0x3cabde+a22_0xb708('0x94')+_0x2e9cbc[a22_0xb708('0x82')]);_0x2f37aa['abort']();_0x4b2b79(_0x2e9cbc[a22_0xb708('0x82')],null,null,null);return;}})['on']('error',function(_0x5d3b2e){console[a22_0xb708('0x3d')](a22_0xb708('0x95')+_0x3cabde+'\x20'+_0x5d3b2e[a22_0xb708('0x96')]);_0x4b2b79(_0x5d3b2e,null,null,null);});}[a22_0xb708('0x97')](_0x4bb87b,_0xbe93ee,_0x5cedd4,_0x25233a){console[a22_0xb708('0x3d')](a22_0xb708('0x97'));console[a22_0xb708('0x3d')](_0x4bb87b);console[a22_0xb708('0x3d')](_0xbe93ee);console[a22_0xb708('0x3d')](_0x5cedd4);console[a22_0xb708('0x3d')](_0x25233a);if(_0x5cedd4=='image'){const _0x4c1efb=this[a22_0xb708('0x1e')][this['currentFile']][a22_0xb708('0x98')]!=null?this[a22_0xb708('0x1e')][this[a22_0xb708('0x1c')]][a22_0xb708('0x98')]:0x1e;this[a22_0xb708('0x99')](_0x25233a,_0x4c1efb);}else if(_0x5cedd4==a22_0xb708('0x9a')){if(_0x4bb87b==null&&_0xbe93ee!=''){this[a22_0xb708('0x1c')]++;}this[a22_0xb708('0x4f')]();}console[a22_0xb708('0x3d')](this[a22_0xb708('0x1c')]);}[a22_0xb708('0x9b')](_0x197b92,_0x5c8c30,_0x3b1ee6){progress(request(_0x197b92),{})['on'](a22_0xb708('0x9c'),function(_0x1e2f9f){console[a22_0xb708('0x3d')](_0x1e2f9f);})['on'](a22_0xb708('0x70'),function(_0x45a690){console[a22_0xb708('0x3d')](a22_0xb708('0x9d'));this[a22_0xb708('0x4f')]();})['on']('end',function(){console[a22_0xb708('0x3d')](a22_0xb708('0x73')+_0x5c8c30);console['log'](a22_0xb708('0x74')+_0x3b1ee6);if(_0x3b1ee6=='image'){const _0x4e0883=this[a22_0xb708('0x1e')][this['currentFile']]['duration']!=null?this[a22_0xb708('0x1e')][this[a22_0xb708('0x1c')]][a22_0xb708('0x98')]:0x1e;this['createImageVideo'](_0x5c8c30,_0x4e0883);}else if(_0x3b1ee6==a22_0xb708('0x9a')){this[a22_0xb708('0x1c')]++;this[a22_0xb708('0x4f')]();}}[a22_0xb708('0x34')](this))[a22_0xb708('0x9e')](fs[a22_0xb708('0x9f')](this[a22_0xb708('0x17')]+_0x5c8c30));}[a22_0xb708('0x99')](_0x4ba087,_0x47fb99=0x1e){const _0x2a31f8=this[a22_0xb708('0x17')]+_0x4ba087;console[a22_0xb708('0x3d')](_0x2a31f8);console['log'](_0x4ba087);const _0x408eb4=_0x4ba087[a22_0xb708('0x5c')]('.')['slice'](0x0,-0x1)[a22_0xb708('0x5e')]('.');const _0x50e4b1='ffmpeg';const _0x1bf727=['-y','-r',a22_0xb708('0xa0'),'-loop','1',a22_0xb708('0xa1'),'glob','-i',_0x2a31f8,'-t',String(_0x47fb99),'-c:v',a22_0xb708('0xa2'),a22_0xb708('0xa3'),a22_0xb708('0xa4'),'-r','25',a22_0xb708('0xa5'),a22_0xb708('0xa6'),this[a22_0xb708('0x17')]+_0x408eb4+a22_0xb708('0x60')];const _0x21bed7=spawn(_0x50e4b1,_0x1bf727);_0x21bed7['stdout']['on'](a22_0xb708('0x8b'),function(_0x1e2bb7){console[a22_0xb708('0x3d')](a22_0xb708('0xa7')+_0x2a31f8);});_0x21bed7[a22_0xb708('0xa8')]['on'](a22_0xb708('0x8b'),function(_0xf16368){console[a22_0xb708('0x3d')](a22_0xb708('0xa9')+_0xf16368);}[a22_0xb708('0x34')](this));_0x21bed7['on'](a22_0xb708('0xaa'),function(){console[a22_0xb708('0x3d')]('finished\x20mp4\x20convert');this['currentFile']++;this[a22_0xb708('0x4f')]();}[a22_0xb708('0x34')](this));}[a22_0xb708('0x65')](_0x40f2fb){const _0xb5e531=this[a22_0xb708('0x17')]+'/'+_0x40f2fb+a22_0xb708('0x60');const _0x11795e=youtubedl(a22_0xb708('0xab')+_0x40f2fb,[a22_0xb708('0xac')],{'cwd':__dirname});_0x11795e['on'](a22_0xb708('0xad'),function(_0x336f40){console['log'](a22_0xb708('0xae'));console['log'](a22_0xb708('0xaf')+_0x336f40[a22_0xb708('0xb0')]);console[a22_0xb708('0x3d')]('size:\x20'+_0x336f40['size']);});_0x11795e['on']('complete',function complete(_0x110ad6){'use strict';console[a22_0xb708('0x3d')](a22_0xb708('0xaf')+_0x110ad6[a22_0xb708('0xb0')]+a22_0xb708('0xb1'));});_0x11795e['on'](a22_0xb708('0x72'),function(){console[a22_0xb708('0x3d')](a22_0xb708('0xb2'));this[a22_0xb708('0x62')](_0xb5e531)[a22_0xb708('0x38')](function(_0x175a7b){if(_0x175a7b){this['currentFile']++;}this[a22_0xb708('0x4f')]();}[a22_0xb708('0x34')](this));}[a22_0xb708('0x34')](this));_0x11795e[a22_0xb708('0x9e')](fs['createWriteStream'](_0xb5e531));}[a22_0xb708('0x59')](){console[a22_0xb708('0x3d')](a22_0xb708('0xb3'));if(this[a22_0xb708('0x1d')]){if(this[a22_0xb708('0x1f')][a22_0xb708('0x4e')]==0x0){fs[a22_0xb708('0x40')](this[a22_0xb708('0x1a')],JSON[a22_0xb708('0x39')](this[a22_0xb708('0x20')]));let _0x309a08=a22_0xb708('0xb4')+'\x0d\x0a'+a22_0xb708('0xb5')+'\x0d\x0a';for(const _0x3037bb in this[a22_0xb708('0x1e')]){const _0x1f1390=this[a22_0xb708('0x1e')][_0x3037bb][a22_0xb708('0x5a')];const _0x1ba63b=this[a22_0xb708('0x1e')][_0x3037bb][a22_0xb708('0xb6')];const _0x1d50f5=_0x1f1390[a22_0xb708('0x5b')](_0x1f1390[a22_0xb708('0xb7')]('/')+0x1);let _0x210eb5=_0x1d50f5[a22_0xb708('0x5c')]('.')[a22_0xb708('0x5d')](0x0,-0x1)[a22_0xb708('0x5e')]('.');if(_0x1ba63b=='youtube_single'){_0x210eb5=_0x1f1390;}_0x309a08+=a22_0xb708('0xb8')+_0x210eb5+'.mp4'+'\x0d\x0a';}fsExtra['emptyDirSync'](this['filesFolder']);fsExtra[a22_0xb708('0x63')](this[a22_0xb708('0x17')],this['filesFolder']);fsExtra['writeFileSync'](this[a22_0xb708('0x54')],_0x309a08);fsExtra[a22_0xb708('0x52')](this[a22_0xb708('0x17')]);console['log'](a22_0xb708('0xb9'));this['refreshPlaylist']();}else{console['log'](a22_0xb708('0xba'));this['currentFile']=0x0;setTimeout(function(){this['download']();}[a22_0xb708('0x34')](this),0x1388);}}else{console[a22_0xb708('0x3d')](a22_0xb708('0xbb'));}}['refreshPlaylist'](){this['jsonrpcClient'](a22_0xb708('0xbc'),{'playlistid':0x1},function(_0x700653){console[a22_0xb708('0x3d')](a22_0xb708('0xbd'));console[a22_0xb708('0x3d')](_0x700653);this[a22_0xb708('0xbe')](a22_0xb708('0xbf'),{'item':{'file':a22_0xb708('0xc0')},'playlistid':0x1},function(_0x700653){console['log'](a22_0xb708('0xc1'));console['log'](_0x700653);this[a22_0xb708('0xbe')](a22_0xb708('0xc2'),{'item':{'playlistid':0x1,'position':0x0}},function(_0x700653){console[a22_0xb708('0x3d')](a22_0xb708('0xc3'));console['log'](_0x700653);}[a22_0xb708('0x34')](this));}[a22_0xb708('0x34')](this));}[a22_0xb708('0x34')](this));}[a22_0xb708('0xbe')](_0x5a0f38,_0x137ba6,_0x1d7938){const _0x5e067f={'jsonrpc':a22_0xb708('0xc4'),'method':_0x5a0f38,'params':_0x137ba6,'id':0x1};this[a22_0xb708('0x21')][a22_0xb708('0x3b')](a22_0xb708('0xc5'),_0x5e067f,![],{'user':a22_0xb708('0x30'),'pass':a22_0xb708('0x31')})[a22_0xb708('0x38')](function(_0x151ab0){_0x1d7938(_0x151ab0);})[a22_0xb708('0x3f')](function(_0x3cbdf0){});}}exports[a22_0xb708('0xc6')]=SyncPlaylistsService;
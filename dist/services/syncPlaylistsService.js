var a22_0x468e=['pipe','data','error','err:\x20','finish','location','Redirect\x20','Redirect\x20limit\x20encountered\x20for\x20','302','File\x20Not\x20Found\x20','Problem\x20downloading\x20','\x20STATUS:\x20','abort','Error\x20Downloading:\x20','message','downloadHTTPFileCallback','duration','downloadRequestFile','progress','Error\x20downloading\x20file','Downloaded:\x20','createImageVideo','video','split','1/2','-loop','-c:v','libx264','-pix_fmt','yuv420p','scale=1920:1080','stdout','stderr','stderr:\x20','close','info','Download\x20started','filename:\x20','_filename','size:\x20','complete','\x20already\x20downloaded.','finished\x20youtube\x20downloading!','finishProcess','Finishing','#EXTCPlayListM3U::M3U','substring','/home/osmc/luloclient/media/files/','Rebooting..','shutdown','now','Playlist\x20incomplete,\x20retry.','No\x20playlist\x20changes.','SyncPlaylistsService','next','throw','done','then','__esModule','node-mediainfo','url','http','fs-extra','request','request-progress','child_process','is-image','string-template','youtube-dl','uuid/v4','config.json','context.json','url-exists','node-kodi','mt-files-downloader','mediaFolder','media/','tempFolder','temp/','filesFolder','playListFile','m3uFile','lulo_playlist.m3u','currentFile','playlistChanged','downloadFiles','failDownloadFiles','newPlayList','httpClientService','HttpClientService','init','parse','readFileSync','playerId','config','baseURL','env','WEB_SERVICE_URL','deploy/','kodi','.lulo123.','checkDependencies','checkFolders','loadMediaList','getStatus','bind','registerClient','stringify','networkInterfaces','context','post','http://restapi.lulo.run/player_devices/register','log','register\x20response:\x20','deviceUuid','writeFileSync','player','getCurrentlyPlayingVideo','item','reportStatus','catch','playingItem:\x20','http://restapi.lulo.run/player_devices/report_status','reportStatusResponse:\x20','ensureDir','playListServiceURL','loadMediaList:\x20','emptyDirSync','length','removeSync','existsSync','reboot','System','Shutdown','hasPlayListChanged','download','this.currentFile:\x20','\x20of\x20','path','media_type','lastIndexOf','slice','join','.mp4','image','**********+','checkVideo','copySync','Downloading:\x20','youtube_single','downloadYouTube','media','track','@type','mediainfo\x20check:','downloader','includes','indexOf','splice','downloading:\x20','start','push','start:\x20','error:\x20','end','mediaType:\x20','stopped','destroyed','retry','downloadHTTPFile','Attempting\x20to\x20download\x20','\x20to\x20','Max\x20redirects\x20reached','downloadFile\x20callback\x20result\x20undefined:\x20','maxSockets','pathname','get','\x20Progress:\x20','statusCode','headers','content-length','stat','Have\x20already\x20downloaded\x20','size','And\x20the\x20file\x20size\x20matches\x20(','Redownloading',')\x20vs\x20New(','createWriteStream'];(function(_0x3d4234,_0x27d74){var _0xa97584=function(_0xbbcf63){while(--_0xbbcf63){_0x3d4234['push'](_0x3d4234['shift']());}};_0xa97584(++_0x27d74);}(a22_0x468e,0xf2));var a22_0x5ded=function(_0x5f2bec,_0x59e19c){_0x5f2bec=_0x5f2bec-0x0;var _0x4c1af5=a22_0x468e[_0x5f2bec];return _0x4c1af5;};'use strict';var __awaiter=this&&this['__awaiter']||function(_0x39e42e,_0x31ef96,_0x3ea2b7,_0xf827fd){function _0x3b00bb(_0x20bd38){return _0x20bd38 instanceof _0x3ea2b7?_0x20bd38:new _0x3ea2b7(function(_0x195b93){_0x195b93(_0x20bd38);});}return new(_0x3ea2b7||(_0x3ea2b7=Promise))(function(_0x24133e,_0x502e74){function _0xe66a68(_0x3adb3b){try{_0x5aae14(_0xf827fd[a22_0x5ded('0x0')](_0x3adb3b));}catch(_0x122fc4){_0x502e74(_0x122fc4);}}function _0x47ceb4(_0x50e99e){try{_0x5aae14(_0xf827fd[a22_0x5ded('0x1')](_0x50e99e));}catch(_0xf9fb47){_0x502e74(_0xf9fb47);}}function _0x5aae14(_0x2f479d){_0x2f479d[a22_0x5ded('0x2')]?_0x24133e(_0x2f479d['value']):_0x3b00bb(_0x2f479d['value'])[a22_0x5ded('0x3')](_0xe66a68,_0x47ceb4);}_0x5aae14((_0xf827fd=_0xf827fd['apply'](_0x39e42e,_0x31ef96||[]))['next']());});};Object['defineProperty'](exports,a22_0x5ded('0x4'),{'value':!![]});const HttpClientService_1=require('../infrastructure/HttpClientService');const mediainfo=require(a22_0x5ded('0x5'));const fs=require('fs');const url=require(a22_0x5ded('0x6'));const http=require(a22_0x5ded('0x7'));const fsExtra=require(a22_0x5ded('0x8'));const request=require(a22_0x5ded('0x9'));const progress=require(a22_0x5ded('0xa'));const spawn=require(a22_0x5ded('0xb'))['spawn'];const isImage=require(a22_0x5ded('0xc'));const format=require(a22_0x5ded('0xd'));const os=require('os');const youtubedl=require(a22_0x5ded('0xe'));const uuidv4=require(a22_0x5ded('0xf'));const configFile=a22_0x5ded('0x10');const contextFile=a22_0x5ded('0x11');const urlExists=require(a22_0x5ded('0x12'));const kodi_rpc=require(a22_0x5ded('0x13'));const Downloader=require(a22_0x5ded('0x14'));class SyncPlaylistsService{constructor(){this[a22_0x5ded('0x15')]=a22_0x5ded('0x16');this[a22_0x5ded('0x17')]=this[a22_0x5ded('0x15')]+a22_0x5ded('0x18');this[a22_0x5ded('0x19')]=this[a22_0x5ded('0x15')]+'files/';this[a22_0x5ded('0x1a')]=this[a22_0x5ded('0x15')]+'playlist.txt';this[a22_0x5ded('0x1b')]=this[a22_0x5ded('0x19')]+a22_0x5ded('0x1c');this[a22_0x5ded('0x1d')]=0x0;this[a22_0x5ded('0x1e')]=![];this[a22_0x5ded('0x1f')]=[];this[a22_0x5ded('0x20')]=[];this[a22_0x5ded('0x21')]={};this[a22_0x5ded('0x22')]=new HttpClientService_1[(a22_0x5ded('0x23'))]();}[a22_0x5ded('0x24')](){this['config']=JSON[a22_0x5ded('0x25')](fs[a22_0x5ded('0x26')](configFile));this['context']=JSON[a22_0x5ded('0x25')](fs[a22_0x5ded('0x26')](contextFile));this[a22_0x5ded('0x27')]=this[a22_0x5ded('0x28')]['playerId'];this[a22_0x5ded('0x29')]=process[a22_0x5ded('0x2a')][a22_0x5ded('0x2b')]+a22_0x5ded('0x2c');this['playListServiceURL']=this[a22_0x5ded('0x29')]+'api/player_playlist.php?player_id={0}';this[a22_0x5ded('0x2d')]=new kodi_rpc({'url':'http://localhost','user':'lulo','password':a22_0x5ded('0x2e')});this[a22_0x5ded('0x2f')]();this['registerClient']();this[a22_0x5ded('0x30')]();this[a22_0x5ded('0x31')]();setInterval(function(){this[a22_0x5ded('0x32')]();}[a22_0x5ded('0x33')](this),0x2710);setInterval(function(){this['registerClient']();}[a22_0x5ded('0x33')](this),0x493e0);}[a22_0x5ded('0x2f')](){}[a22_0x5ded('0x34')](){this[a22_0x5ded('0x2d')]['playlist']['getItems'](0x1)[a22_0x5ded('0x3')](function(_0x5af137){const _0x267459=JSON[a22_0x5ded('0x35')](_0x5af137);const _0x93cf88={'player_id':this[a22_0x5ded('0x27')],'device_uuid':this[a22_0x5ded('0x28')]['deviceUuid'],'network_info':JSON['stringify'](os[a22_0x5ded('0x36')]()),'firmware_info':JSON[a22_0x5ded('0x35')](this[a22_0x5ded('0x37')]),'playlist':_0x267459,'playing_item':'','status':0x0};this['httpClientService'][a22_0x5ded('0x38')](a22_0x5ded('0x39'),_0x93cf88,![])[a22_0x5ded('0x3')](function(_0x4ab80f){console[a22_0x5ded('0x3a')](a22_0x5ded('0x3b')+Date());})['catch'](function(_0x4cf78d){});console[a22_0x5ded('0x3a')](_0x93cf88);}[a22_0x5ded('0x33')](this));const _0x1d6c1a=this['config']['deviceUuid'];if(!_0x1d6c1a||_0x1d6c1a==''){this[a22_0x5ded('0x28')][a22_0x5ded('0x3c')]=uuidv4();this['config']={'deviceUuid':this[a22_0x5ded('0x28')][a22_0x5ded('0x3c')],'playerId':this[a22_0x5ded('0x28')][a22_0x5ded('0x27')]};fs[a22_0x5ded('0x3d')](configFile,JSON[a22_0x5ded('0x35')](this['config']));}}['getStatus'](){console[a22_0x5ded('0x3a')]('getStatus');this[a22_0x5ded('0x2d')][a22_0x5ded('0x3e')][a22_0x5ded('0x3f')]()[a22_0x5ded('0x3')](function(_0x427eac){const _0x26213c=_0x427eac[a22_0x5ded('0x40')]['label'];this[a22_0x5ded('0x41')](_0x26213c);}['bind'](this))[a22_0x5ded('0x42')](function(_0x2dcd50){console[a22_0x5ded('0x3a')](_0x2dcd50);this[a22_0x5ded('0x41')](_0x2dcd50);}['bind'](this));}[a22_0x5ded('0x41')](_0xf0420d){console[a22_0x5ded('0x3a')](a22_0x5ded('0x43')+_0xf0420d);const _0x23051a={'player_id':this['playerId'],'device_uuid':this[a22_0x5ded('0x28')]['deviceUuid'],'status':_0xf0420d!=''&&_0xf0420d!=null?0x1:0x0,'playing_item':_0xf0420d};this[a22_0x5ded('0x22')]['post'](a22_0x5ded('0x44'),_0x23051a,![])[a22_0x5ded('0x3')](function(_0x184375){console[a22_0x5ded('0x3a')](a22_0x5ded('0x45')+Date());})[a22_0x5ded('0x42')](function(_0x5b27ec){});}[a22_0x5ded('0x30')](){fsExtra[a22_0x5ded('0x46')](this['mediaFolder'],_0x2ebe63=>{});fsExtra[a22_0x5ded('0x46')](this['tempFolder'],_0x3fe563=>{});fsExtra[a22_0x5ded('0x46')](this[a22_0x5ded('0x19')],_0x5f4cdd=>{});}['loadMediaList'](){const _0x32792e=format(this[a22_0x5ded('0x47')],this['playerId']);console[a22_0x5ded('0x3a')](_0x32792e);request({'url':_0x32792e,'json':!![]},function(_0x34695f,_0x479770,_0x94d0e0){console[a22_0x5ded('0x3a')](a22_0x5ded('0x48'));console[a22_0x5ded('0x3a')](_0x94d0e0);this[a22_0x5ded('0x21')]=_0x94d0e0;this[a22_0x5ded('0x1e')]=this['hasPlayListChanged']();fsExtra[a22_0x5ded('0x49')](this[a22_0x5ded('0x17')]);this[a22_0x5ded('0x1f')]=[];this['failDownloadFiles']=[];this[a22_0x5ded('0x1d')]=0x0;for(const _0x120e41 in _0x94d0e0){this[a22_0x5ded('0x1f')]['push'](_0x94d0e0[_0x120e41]);}console[a22_0x5ded('0x3a')]('Total:\x20'+this[a22_0x5ded('0x1f')][a22_0x5ded('0x4a')]);if(this['downloadFiles'][a22_0x5ded('0x4a')]>0x0){this['download']();}}['bind'](this));}['reloadMediaList'](){if(fsExtra['existsSync'](this[a22_0x5ded('0x17')])){fsExtra[a22_0x5ded('0x49')](this['tempFolder']);}if(fsExtra['existsSync'](this[a22_0x5ded('0x19')])){fsExtra[a22_0x5ded('0x49')](this[a22_0x5ded('0x19')]);}if(!fsExtra['existsSync'](this[a22_0x5ded('0x1a')])){fsExtra[a22_0x5ded('0x4b')](this[a22_0x5ded('0x1a')]);}if(!fsExtra[a22_0x5ded('0x4c')](this[a22_0x5ded('0x1b')])){fsExtra[a22_0x5ded('0x4b')](this['m3uFile']);}this[a22_0x5ded('0x31')]();}[a22_0x5ded('0x4d')](){this[a22_0x5ded('0x2d')][a22_0x5ded('0x4e')][a22_0x5ded('0x4f')]();}[a22_0x5ded('0x50')](){const _0x1d7d63=JSON[a22_0x5ded('0x35')](this[a22_0x5ded('0x21')]);try{if(!fsExtra['existsSync'](this[a22_0x5ded('0x1a')])){return!![];}else{const _0x2bb46c=fsExtra['readFileSync'](this[a22_0x5ded('0x1a')])['toString']();if(_0x2bb46c!=_0x1d7d63){return!![];}}}catch(_0x472360){console[a22_0x5ded('0x3a')](_0x472360);}return![];}[a22_0x5ded('0x51')](){console[a22_0x5ded('0x3a')](a22_0x5ded('0x52')+this[a22_0x5ded('0x1d')]+a22_0x5ded('0x53')+this[a22_0x5ded('0x1f')][a22_0x5ded('0x4a')]);if(this['currentFile']>=this[a22_0x5ded('0x1f')][a22_0x5ded('0x4a')]){this['finishProcess']();return;}const _0x338a21=String(this[a22_0x5ded('0x1f')][this[a22_0x5ded('0x1d')]][a22_0x5ded('0x54')]);const _0x310b3f=this[a22_0x5ded('0x1f')][this[a22_0x5ded('0x1d')]][a22_0x5ded('0x55')];let _0x50e926=_0x338a21['substring'](_0x338a21[a22_0x5ded('0x56')]('/')+0x1);const _0x284180=_0x50e926['split']('.')[a22_0x5ded('0x57')](0x0,-0x1)['join']('.');let _0x57dd50=this[a22_0x5ded('0x29')]+_0x338a21;const _0x3b93bb=_0x57dd50['split']('.')['slice'](0x0,-0x1)[a22_0x5ded('0x58')]('.');if(_0x310b3f=='youtube_single'){_0x50e926=_0x50e926+a22_0x5ded('0x59');}else if(_0x310b3f==a22_0x5ded('0x5a')){_0x50e926=_0x284180+a22_0x5ded('0x59');_0x57dd50=_0x3b93bb+'.mp4';}console[a22_0x5ded('0x3a')](a22_0x5ded('0x5b'));console[a22_0x5ded('0x3a')](_0x338a21);console[a22_0x5ded('0x3a')](_0x310b3f);console['log'](_0x50e926);console[a22_0x5ded('0x3a')](_0x57dd50);console[a22_0x5ded('0x3a')](_0x284180);console['log'](_0x3b93bb);console[a22_0x5ded('0x3a')](a22_0x5ded('0x5b'));if(fsExtra[a22_0x5ded('0x4c')](this[a22_0x5ded('0x17')]+_0x50e926)){this[a22_0x5ded('0x5c')](this[a22_0x5ded('0x17')]+_0x50e926)[a22_0x5ded('0x3')](function(_0x36522a){if(_0x36522a){this[a22_0x5ded('0x1d')]++;}else{this[a22_0x5ded('0x1e')]=!![];}this['download']();}[a22_0x5ded('0x33')](this));}else if(fsExtra['existsSync'](this['filesFolder']+_0x50e926)){this[a22_0x5ded('0x5c')](this[a22_0x5ded('0x19')]+_0x50e926)[a22_0x5ded('0x3')](function(_0xadc77a){if(_0xadc77a){fsExtra[a22_0x5ded('0x5d')](this[a22_0x5ded('0x19')]+_0x50e926,this[a22_0x5ded('0x17')]+_0x50e926);this['currentFile']++;}else{this[a22_0x5ded('0x1e')]=!![];}this[a22_0x5ded('0x51')]();}['bind'](this));}else{console[a22_0x5ded('0x3a')](a22_0x5ded('0x5e')+_0x57dd50);this[a22_0x5ded('0x1e')]=!![];if(_0x310b3f==a22_0x5ded('0x5f')){this[a22_0x5ded('0x60')](_0x338a21);}else{this['downloader'](_0x57dd50,_0x50e926,_0x310b3f);}}}[a22_0x5ded('0x5c')](_0x137aec){return __awaiter(this,void 0x0,void 0x0,function*(){console['log']('videoFile:\x20'+_0x137aec);const _0xec17fb=yield mediainfo(_0x137aec)[a22_0x5ded('0x42')](_0x36d8f4=>{console['log'](_0x36d8f4);fsExtra['removeSync'](_0x137aec);return![];});const _0x3674ee=_0xec17fb[a22_0x5ded('0x61')][a22_0x5ded('0x62')][a22_0x5ded('0x4a')]>0x1&&_0xec17fb['media'][a22_0x5ded('0x62')][0x1][a22_0x5ded('0x63')]=='Video';if(!_0x3674ee){fsExtra[a22_0x5ded('0x4b')](_0x137aec);}console[a22_0x5ded('0x3a')](a22_0x5ded('0x64')+_0x3674ee);return _0x3674ee;});}[a22_0x5ded('0x65')](_0x7e371a,_0x43d16e,_0x4ddd26){const _0x1f8094=new Downloader();console[a22_0x5ded('0x3a')](_0x7e371a);console[a22_0x5ded('0x3a')](_0x43d16e);console[a22_0x5ded('0x3a')](_0x4ddd26);const _0x41a4ec=_0x1f8094[a22_0x5ded('0x51')](_0x7e371a,this[a22_0x5ded('0x17')]+_0x43d16e);urlExists(_0x7e371a,function(_0x3b8045,_0x5c00fe){if(_0x5c00fe){if(this[a22_0x5ded('0x20')][a22_0x5ded('0x66')](this[a22_0x5ded('0x1d')])){const _0x2288fd=this[a22_0x5ded('0x20')][a22_0x5ded('0x67')](this['currentFile']);if(_0x2288fd>-0x1){this[a22_0x5ded('0x20')][a22_0x5ded('0x68')](_0x2288fd,0x1);}}console[a22_0x5ded('0x3a')](a22_0x5ded('0x69')+_0x7e371a);_0x41a4ec[a22_0x5ded('0x6a')]();}else{if(!this[a22_0x5ded('0x20')][a22_0x5ded('0x66')](this[a22_0x5ded('0x1d')])){this[a22_0x5ded('0x20')][a22_0x5ded('0x6b')](this['currentFile']);}console[a22_0x5ded('0x3a')]('Error:\x20'+_0x7e371a);this['currentFile']++;this[a22_0x5ded('0x51')]();}}[a22_0x5ded('0x33')](this));_0x41a4ec['on'](a22_0x5ded('0x6a'),function(_0x41a4ec){console[a22_0x5ded('0x3a')](a22_0x5ded('0x6c')+_0x7e371a);});_0x41a4ec['on']('error',function(_0x41a4ec){console[a22_0x5ded('0x3a')](a22_0x5ded('0x6d'));this[a22_0x5ded('0x51')]();}[a22_0x5ded('0x33')](this));_0x41a4ec['on'](a22_0x5ded('0x6e'),function(_0x41a4ec){console['log'](a22_0x5ded('0x6e'));console[a22_0x5ded('0x3a')]('Downloaded:\x20'+_0x43d16e);console['log'](a22_0x5ded('0x6f')+_0x4ddd26);this[a22_0x5ded('0x5c')](this[a22_0x5ded('0x17')]+_0x43d16e)['then'](function(_0x22379d){if(_0x22379d){this[a22_0x5ded('0x1d')]++;}this[a22_0x5ded('0x51')]();}[a22_0x5ded('0x33')](this));}[a22_0x5ded('0x33')](this));_0x41a4ec['on'](a22_0x5ded('0x70'),function(_0x41a4ec){console[a22_0x5ded('0x3a')](a22_0x5ded('0x70'));});_0x41a4ec['on'](a22_0x5ded('0x71'),function(_0x41a4ec){console['log'](a22_0x5ded('0x71'));});_0x41a4ec['on'](a22_0x5ded('0x72'),function(_0x41a4ec){console[a22_0x5ded('0x3a')](a22_0x5ded('0x72'));});}['downloadHTTPFile'](_0x22a36f,_0x573035,_0x2e9e7b,_0x5345c2){console[a22_0x5ded('0x3a')](a22_0x5ded('0x73'));console[a22_0x5ded('0x3a')](_0x22a36f);const _0x15c69f=!![];let _0x202c96=0x0;const _0x468687='';console[a22_0x5ded('0x3a')](a22_0x5ded('0x74')+_0x22a36f+a22_0x5ded('0x75')+_0x573035);if(_0x202c96){if(_0x202c96>0x5){_0x5345c2(a22_0x5ded('0x76'),_0x22a36f,_0x2e9e7b,null);return;}}else{_0x202c96=0x0;}const _0x25faae=this['tempFolder']+_0x573035;let _0x236c7b;if(_0x5345c2===undefined){console[a22_0x5ded('0x3a')]('WARNING\x20downloadFile\x20callback\x20is\x20undefined\x20for\x20'+_0x22a36f+a22_0x5ded('0x75')+_0x25faae);_0x5345c2=function(_0x312685,_0x5edb72){console[a22_0x5ded('0x3a')](a22_0x5ded('0x77'),_0x312685,_0x5edb72);};}http['globalAgent'][a22_0x5ded('0x78')]=0x64;const _0x3cd716={'host':url['parse'](_0x22a36f)['host'],'port':0x50,'path':url[a22_0x5ded('0x25')](_0x22a36f)[a22_0x5ded('0x79')],'agent':![]};const _0x5ed2a1=http[a22_0x5ded('0x7a')](_0x3cd716,function(_0x2fd248){let _0x50ae09=0x0;let _0x579d67=0x0;function _0x224b9f(){if(_0x50ae09===undefined){console[a22_0x5ded('0x3a')](_0x573035+'\x20Progress:\x20unknown\x09'+_0x579d67+'/'+'?');}const _0x3a900b=_0x579d67/_0x50ae09*0x64;console[a22_0x5ded('0x3a')](_0x573035+a22_0x5ded('0x7b')+_0x3a900b+'%\x09'+_0x579d67+'/'+_0x50ae09);}console[a22_0x5ded('0x3a')](_0x573035+'\x20'+_0x2fd248[a22_0x5ded('0x7c')]);switch(_0x2fd248[a22_0x5ded('0x7c')]){case 0xc8:_0x50ae09=_0x2fd248[a22_0x5ded('0x7d')][a22_0x5ded('0x7e')]||_0x468687;fs[a22_0x5ded('0x7f')](_0x25faae,function(_0x588139,_0x6717f0){if(!_0x588139){console[a22_0x5ded('0x3a')](a22_0x5ded('0x80')+_0x25faae);if(_0x6717f0[a22_0x5ded('0x81')]==_0x50ae09){console[a22_0x5ded('0x3a')](a22_0x5ded('0x82')+_0x50ae09+')');console[a22_0x5ded('0x3a')](a22_0x5ded('0x83'));}else{console['log']('But\x20the\x20file\x20size\x20does\x20not\x20match\x20so\x20re-downloading\x20Old('+_0x6717f0[a22_0x5ded('0x81')]+a22_0x5ded('0x84')+_0x50ae09+')');}}_0x236c7b=fs[a22_0x5ded('0x85')](_0x25faae);_0x2fd248[a22_0x5ded('0x86')](_0x236c7b);_0x2fd248['on'](a22_0x5ded('0x87'),function(_0x5e62c3){_0x579d67+=_0x5e62c3[a22_0x5ded('0x4a')];_0x224b9f();});_0x5ed2a1['on'](a22_0x5ded('0x88'),function(_0x588139){console[a22_0x5ded('0x3a')](a22_0x5ded('0x89'));console['log'](_0x588139);});_0x236c7b['on'](a22_0x5ded('0x8a'),function(){console[a22_0x5ded('0x3a')]('Downloaded\x20'+_0x22a36f+'\x20to\x20'+_0x573035);_0x5345c2(null,_0x573035,_0x2e9e7b,_0x573035);}['bind'](this));});break;case 0x12e:const _0x3e5633=_0x2fd248[a22_0x5ded('0x7d')][a22_0x5ded('0x8b')];console[a22_0x5ded('0x3a')](a22_0x5ded('0x8c')+_0x22a36f+'\x20to\x20'+_0x3e5633);if(_0x202c96<0x5){this[a22_0x5ded('0x73')](_0x3e5633,_0x573035,_0x5345c2,_0x202c96++);}else{console[a22_0x5ded('0x88')](a22_0x5ded('0x8d')+_0x22a36f+'.');_0x5345c2(a22_0x5ded('0x8e'),null,null,null);}return;case 0x194:console[a22_0x5ded('0x3a')](a22_0x5ded('0x8f')+_0x22a36f);default:console['log'](a22_0x5ded('0x90')+_0x22a36f+a22_0x5ded('0x91')+_0x2fd248[a22_0x5ded('0x7c')]);_0x5ed2a1[a22_0x5ded('0x92')]();_0x5345c2(_0x2fd248[a22_0x5ded('0x7c')],null,null,null);return;}})['on'](a22_0x5ded('0x88'),function(_0x320611){console[a22_0x5ded('0x3a')](a22_0x5ded('0x93')+_0x22a36f+'\x20'+_0x320611[a22_0x5ded('0x94')]);_0x5345c2(_0x320611,null,null,null);});}[a22_0x5ded('0x95')](_0x596bb7,_0xc32a00,_0x3dd649,_0x59b587){console[a22_0x5ded('0x3a')](a22_0x5ded('0x95'));console[a22_0x5ded('0x3a')](_0x596bb7);console[a22_0x5ded('0x3a')](_0xc32a00);console[a22_0x5ded('0x3a')](_0x3dd649);console[a22_0x5ded('0x3a')](_0x59b587);if(_0x3dd649==a22_0x5ded('0x5a')){const _0x3928b4=this[a22_0x5ded('0x1f')][this[a22_0x5ded('0x1d')]][a22_0x5ded('0x96')]!=null?this[a22_0x5ded('0x1f')][this[a22_0x5ded('0x1d')]][a22_0x5ded('0x96')]:0x1e;this['createImageVideo'](_0x59b587,_0x3928b4);}else if(_0x3dd649=='video'){if(_0x596bb7==null&&_0xc32a00!=''){this[a22_0x5ded('0x1d')]++;}this[a22_0x5ded('0x51')]();}console[a22_0x5ded('0x3a')](this[a22_0x5ded('0x1d')]);}[a22_0x5ded('0x97')](_0x26cd9f,_0x5192c9,_0x38a2a8){progress(request(_0x26cd9f),{})['on'](a22_0x5ded('0x98'),function(_0x4704ab){console[a22_0x5ded('0x3a')](_0x4704ab);})['on'](a22_0x5ded('0x88'),function(_0x4def0e){console[a22_0x5ded('0x3a')](a22_0x5ded('0x99'));this[a22_0x5ded('0x51')]();})['on']('end',function(){console[a22_0x5ded('0x3a')](a22_0x5ded('0x9a')+_0x5192c9);console['log']('mediaType:\x20'+_0x38a2a8);if(_0x38a2a8==a22_0x5ded('0x5a')){const _0x102871=this[a22_0x5ded('0x1f')][this[a22_0x5ded('0x1d')]][a22_0x5ded('0x96')]!=null?this[a22_0x5ded('0x1f')][this[a22_0x5ded('0x1d')]][a22_0x5ded('0x96')]:0x1e;this[a22_0x5ded('0x9b')](_0x5192c9,_0x102871);}else if(_0x38a2a8==a22_0x5ded('0x9c')){this[a22_0x5ded('0x1d')]++;this[a22_0x5ded('0x51')]();}}['bind'](this))[a22_0x5ded('0x86')](fs['createWriteStream'](this['tempFolder']+_0x5192c9));}[a22_0x5ded('0x9b')](_0x35af34,_0x4b6178=0x1e){const _0x4a5622=this[a22_0x5ded('0x17')]+_0x35af34;console[a22_0x5ded('0x3a')](_0x4a5622);console[a22_0x5ded('0x3a')](_0x35af34);const _0x50275b=_0x35af34[a22_0x5ded('0x9d')]('.')[a22_0x5ded('0x57')](0x0,-0x1)[a22_0x5ded('0x58')]('.');const _0x15e06b='ffmpeg';const _0x38f7b4=['-y','-r',a22_0x5ded('0x9e'),a22_0x5ded('0x9f'),'1','-pattern_type','glob','-i',_0x4a5622,'-t',String(_0x4b6178),a22_0x5ded('0xa0'),a22_0x5ded('0xa1'),a22_0x5ded('0xa2'),a22_0x5ded('0xa3'),'-r','25','-vf',a22_0x5ded('0xa4'),this[a22_0x5ded('0x17')]+_0x50275b+a22_0x5ded('0x59')];const _0x36f0c2=spawn(_0x15e06b,_0x38f7b4);_0x36f0c2[a22_0x5ded('0xa5')]['on']('data',function(_0xac67b3){console['log']('Converting\x20'+_0x4a5622);});_0x36f0c2[a22_0x5ded('0xa6')]['on']('data',function(_0x498381){console[a22_0x5ded('0x3a')](a22_0x5ded('0xa7')+_0x498381);}[a22_0x5ded('0x33')](this));_0x36f0c2['on'](a22_0x5ded('0xa8'),function(){console['log']('finished\x20mp4\x20convert');this[a22_0x5ded('0x1d')]++;this[a22_0x5ded('0x51')]();}[a22_0x5ded('0x33')](this));}['downloadYouTube'](_0x4513b0){const _0x17da51=this['tempFolder']+'/'+_0x4513b0+a22_0x5ded('0x59');const _0x5df0a2=youtubedl('http://www.youtube.com/watch?v='+_0x4513b0,['--format=18'],{'cwd':__dirname});_0x5df0a2['on'](a22_0x5ded('0xa9'),function(_0x4403b1){console[a22_0x5ded('0x3a')](a22_0x5ded('0xaa'));console['log'](a22_0x5ded('0xab')+_0x4403b1[a22_0x5ded('0xac')]);console['log'](a22_0x5ded('0xad')+_0x4403b1[a22_0x5ded('0x81')]);});_0x5df0a2['on'](a22_0x5ded('0xae'),function complete(_0xd60394){'use strict';console[a22_0x5ded('0x3a')](a22_0x5ded('0xab')+_0xd60394[a22_0x5ded('0xac')]+a22_0x5ded('0xaf'));});_0x5df0a2['on'](a22_0x5ded('0x6e'),function(){console[a22_0x5ded('0x3a')](a22_0x5ded('0xb0'));this[a22_0x5ded('0x5c')](_0x17da51)[a22_0x5ded('0x3')](function(_0x1c5325){if(_0x1c5325){this['currentFile']++;}this[a22_0x5ded('0x51')]();}[a22_0x5ded('0x33')](this));}[a22_0x5ded('0x33')](this));_0x5df0a2['pipe'](fs[a22_0x5ded('0x85')](_0x17da51));}[a22_0x5ded('0xb1')](){console[a22_0x5ded('0x3a')](a22_0x5ded('0xb2'));if(this[a22_0x5ded('0x1e')]){if(this['failDownloadFiles'][a22_0x5ded('0x4a')]==0x0){fs['writeFileSync'](this['playListFile'],JSON[a22_0x5ded('0x35')](this['newPlayList']));let _0x1d617a=a22_0x5ded('0xb3')+'\x0d\x0a'+'#EXTINF:0,luloPlayList'+'\x0d\x0a';for(const _0x4be64b in this[a22_0x5ded('0x1f')]){const _0x1cd9b6=this['downloadFiles'][_0x4be64b][a22_0x5ded('0x54')];const _0x4f09c1=this[a22_0x5ded('0x1f')][_0x4be64b][a22_0x5ded('0x55')];const _0x3dfcb8=_0x1cd9b6[a22_0x5ded('0xb4')](_0x1cd9b6[a22_0x5ded('0x56')]('/')+0x1);let _0xdc9128=_0x3dfcb8['split']('.')[a22_0x5ded('0x57')](0x0,-0x1)[a22_0x5ded('0x58')]('.');if(_0x4f09c1==a22_0x5ded('0x5f')){_0xdc9128=_0x1cd9b6;}_0x1d617a+=a22_0x5ded('0xb5')+_0xdc9128+a22_0x5ded('0x59')+'\x0d\x0a';}fsExtra[a22_0x5ded('0x49')](this[a22_0x5ded('0x19')]);fsExtra['copySync'](this[a22_0x5ded('0x17')],this[a22_0x5ded('0x19')]);fsExtra[a22_0x5ded('0x3d')](this['m3uFile'],_0x1d617a);fsExtra[a22_0x5ded('0x49')](this['tempFolder']);console['log'](a22_0x5ded('0xb6'));const _0xbd7cb1=spawn(a22_0x5ded('0xb7'),['-r',a22_0x5ded('0xb8')]);}else{console[a22_0x5ded('0x3a')](a22_0x5ded('0xb9'));this[a22_0x5ded('0x1d')]=0x0;setTimeout(function(){this['download']();}['bind'](this),0x1388);}}else{console[a22_0x5ded('0x3a')](a22_0x5ded('0xba'));}}}exports[a22_0x5ded('0xbb')]=SyncPlaylistsService;
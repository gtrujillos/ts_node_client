var a25_0x245e=['2.0','jsonrpcClient\x20options','/jsonrpc','SyncPlaylistsService','__awaiter','next','value','apply','__esModule','../infrastructure/HttpClientService','./playerService','../infrastructure/utils/dateUtils','node-mediainfo','url','fs-extra','request','request-progress','child_process','spawn','exec','is-image','youtube-dl','uuid/v4','package.json','url-exists','node-kodi','mt-files-downloader','mediaFolder','media/','temp/','filesFolder','playListFile','playlist.txt','m3uFile','lulo_playlist.m3u','currentFile','downloadFiles','failDownloadFiles','newPlayList','kodiHost','kodiUser','lulo','kodiPassword','forceReload','httpClientService','HttpClientService','playerService','init','parse','context','readFileSync','config','baseURL','env','WEB_SERVICE_URL','deploy/','playListServiceURL','api/player_playlist.php?player_id={0}','playerServiceURL','api/player.php?player_id={0}','registerClient','checkFolders','loadMediaList','updateSettings','getStatus','bind','checkSchedule','checkDependencies','then','stringify','playerId','deviceUuid','post','register\x20response:\x20','catch','log','kodi','player','item','label','reportStatus','reportStatus\x20playingItem:\x20','http://restapi.lulo.run/player_devices/report_status','reportStatusResponse','ensureDir','tempFolder','loadMediaList:\x20','hasPlayListChanged','emptyDirSync','length','download','existsSync','removeSync','this.currentFile:\x20','\x20of\x20','finishProcess','path','media_type','substring','lastIndexOf','split','slice','join','youtube_single','.mp4','image','**********+','checkVideo','copySync','playlistChanged','downloadYouTube','downloader','m3uFileUpdate','refreshPlayer','videoFile:\x20','media','track','@type','Video','mediainfo\x20check:','includes','splice','start','Error:\x20','start:\x20','error:\x20','end','Downloaded:\x20','stopped','destroyed','retry','downloadHTTPFile','Attempting\x20to\x20download\x20','WARNING\x20downloadFile\x20callback\x20is\x20undefined\x20for\x20','downloadFile\x20callback\x20result\x20undefined:\x20','globalAgent','maxSockets','host','pathname','get','\x20Progress:\x20unknown\x09','statusCode','headers','content-length','size','And\x20the\x20file\x20size\x20matches\x20(','Redownloading',')\x20vs\x20New(','createWriteStream','pipe','data','error','err:\x20','finish','\x20to\x20','location','Redirect\x20limit\x20encountered\x20for\x20','302','File\x20Not\x20Found\x20','Problem\x20downloading\x20','\x20STATUS:\x20','abort','Error\x20Downloading:\x20','message','downloadHTTPFileCallback','duration','video','downloadRequestFile','progress','mediaType:\x20','createImageVideo','ffmpeg','-pattern_type','glob','-c:v','libx264','-pix_fmt','yuv420p','scale=1920:1080','stdout','stderr:\x20','close','http://www.youtube.com/watch?v=','outFileName:\x20','--no-check-certificate','info','Download\x20started','filename:\x20','complete','\x20already\x20downloaded.','finished\x20youtube\x20downloading!','Finishing','this.playListFile:\x20','emptyDir','copy','No\x20playlist\x20changes.','#EXTCPlayListM3U::M3U','#EXTINF:0,luloPlayList','DateUtils','Parse','start_date','end_date','toString','trim','writeFileSync','kodiCommandClient','PlayMedia(//home/osmc/luloclient/media/files/lulo_playlist.m3u)','reboot','Rebooting','sudo\x20/sbin/reboot\x20-f','rss','setRss','enableClock','turnOffTV','turnOnTV','CECActivateSource()','/home/osmc/.kodi/userdata/RssFeeds.xml','xmlContent:\x20','xml2js','parseString','err:\x20%j','result:\x20%j','none','rssfeeds','set','feed','Builder','buildObject','xml:\x20%j','RefreshRSS()','jsonrpcClient','Settings.SetSettingValue','setRss:'];(function(_0x5916d2,_0x386303){var _0x17706c=function(_0x4ad99b){while(--_0x4ad99b){_0x5916d2['push'](_0x5916d2['shift']());}};_0x17706c(++_0x386303);}(a25_0x245e,0xed));var a25_0x407a=function(_0xd0084f,_0x5e67e6){_0xd0084f=_0xd0084f-0x0;var _0xd147b9=a25_0x245e[_0xd0084f];return _0xd147b9;};'use strict';var __awaiter=this&&this[a25_0x407a('0x0')]||function(_0x50c48e,_0x549621,_0x414d3d,_0x42b9c0){function _0x1f077d(_0x408c72){return _0x408c72 instanceof _0x414d3d?_0x408c72:new _0x414d3d(function(_0x3b05d9){_0x3b05d9(_0x408c72);});}return new(_0x414d3d||(_0x414d3d=Promise))(function(_0x4f0cf7,_0x1cbdf1){function _0x90af5(_0x3097f9){try{_0x23eaa0(_0x42b9c0[a25_0x407a('0x1')](_0x3097f9));}catch(_0x2b05a5){_0x1cbdf1(_0x2b05a5);}}function _0x1a4e51(_0x4390a0){try{_0x23eaa0(_0x42b9c0['throw'](_0x4390a0));}catch(_0x365c56){_0x1cbdf1(_0x365c56);}}function _0x23eaa0(_0x1e7fdf){_0x1e7fdf['done']?_0x4f0cf7(_0x1e7fdf[a25_0x407a('0x2')]):_0x1f077d(_0x1e7fdf[a25_0x407a('0x2')])['then'](_0x90af5,_0x1a4e51);}_0x23eaa0((_0x42b9c0=_0x42b9c0[a25_0x407a('0x3')](_0x50c48e,_0x549621||[]))[a25_0x407a('0x1')]());});};Object['defineProperty'](exports,a25_0x407a('0x4'),{'value':!![]});const HttpClientService_1=require(a25_0x407a('0x5'));const playerService_1=require(a25_0x407a('0x6'));const dateUtils_1=require(a25_0x407a('0x7'));const mediainfo=require(a25_0x407a('0x8'));const fs=require('fs');const url=require(a25_0x407a('0x9'));const http=require('http');const fsExtra=require(a25_0x407a('0xa'));const request=require(a25_0x407a('0xb'));const progress=require(a25_0x407a('0xc'));const spawn=require(a25_0x407a('0xd'))[a25_0x407a('0xe')];const exec=require(a25_0x407a('0xd'))[a25_0x407a('0xf')];const isImage=require(a25_0x407a('0x10'));const format=require('string-template');const os=require('os');const youtubedl=require(a25_0x407a('0x11'));const uuidv4=require(a25_0x407a('0x12'));const configFile='config.json';const contextFile=a25_0x407a('0x13');const urlExists=require(a25_0x407a('0x14'));const kodi_rpc=require(a25_0x407a('0x15'));const Downloader=require(a25_0x407a('0x16'));class SyncPlaylistsService{constructor(){this[a25_0x407a('0x17')]=a25_0x407a('0x18');this['tempFolder']=this[a25_0x407a('0x17')]+a25_0x407a('0x19');this[a25_0x407a('0x1a')]=this[a25_0x407a('0x17')]+'files/';this[a25_0x407a('0x1b')]=this['mediaFolder']+a25_0x407a('0x1c');this[a25_0x407a('0x1d')]=this[a25_0x407a('0x1a')]+a25_0x407a('0x1e');this[a25_0x407a('0x1f')]=0x0;this['playlistChanged']=![];this[a25_0x407a('0x20')]=[];this[a25_0x407a('0x21')]=[];this[a25_0x407a('0x22')]={};this[a25_0x407a('0x23')]='http://192.168.0.109';this[a25_0x407a('0x24')]=a25_0x407a('0x25');this[a25_0x407a('0x26')]='.lulo123.';this[a25_0x407a('0x27')]=![];this[a25_0x407a('0x28')]=new HttpClientService_1[(a25_0x407a('0x29'))]();this[a25_0x407a('0x2a')]=new playerService_1['PlayerService']();}[a25_0x407a('0x2b')](){this['config']=JSON[a25_0x407a('0x2c')](fs['readFileSync'](configFile));this[a25_0x407a('0x2d')]=JSON[a25_0x407a('0x2c')](fs[a25_0x407a('0x2e')](contextFile));this['playerId']=this[a25_0x407a('0x2f')]['playerId'];this[a25_0x407a('0x30')]=process[a25_0x407a('0x31')][a25_0x407a('0x32')]+a25_0x407a('0x33');this[a25_0x407a('0x34')]=this[a25_0x407a('0x30')]+a25_0x407a('0x35');this[a25_0x407a('0x36')]=this[a25_0x407a('0x30')]+a25_0x407a('0x37');this['kodi']=new kodi_rpc({'url':this[a25_0x407a('0x23')],'user':this[a25_0x407a('0x24')],'password':this[a25_0x407a('0x26')]});this['checkDependencies']();this[a25_0x407a('0x38')]();this[a25_0x407a('0x39')]();this[a25_0x407a('0x3a')]();this[a25_0x407a('0x3b')]();setInterval(function(){this[a25_0x407a('0x3c')]();}[a25_0x407a('0x3d')](this),0x2710);setInterval(function(){this['registerClient']();}[a25_0x407a('0x3d')](this),0x493e0);setInterval(function(){this[a25_0x407a('0x3e')]();}[a25_0x407a('0x3d')](this),0x2710);}[a25_0x407a('0x3f')](){}[a25_0x407a('0x38')](){this['kodi']['playlist']['getItems'](0x1)[a25_0x407a('0x40')](function(_0x574ba3){const _0x3f2464=JSON[a25_0x407a('0x41')](_0x574ba3);const _0xae4f22={'player_id':this[a25_0x407a('0x42')],'device_uuid':this['config'][a25_0x407a('0x43')],'network_info':JSON[a25_0x407a('0x41')](os['networkInterfaces']()),'firmware_info':JSON[a25_0x407a('0x41')](this[a25_0x407a('0x2d')]['version']),'playlist':_0x3f2464,'playing_item':'','status':0x0};this['httpClientService'][a25_0x407a('0x44')]('http://restapi.lulo.run/player_devices/register',_0xae4f22,![])[a25_0x407a('0x40')](function(_0x98e81b){console['log'](a25_0x407a('0x45')+Date());})[a25_0x407a('0x46')](function(_0x3b2862){});console[a25_0x407a('0x47')](_0xae4f22);}[a25_0x407a('0x3d')](this));const _0x1e205d=this[a25_0x407a('0x2f')][a25_0x407a('0x43')];if(!_0x1e205d||_0x1e205d==''){this[a25_0x407a('0x2f')]['deviceUuid']=uuidv4();this[a25_0x407a('0x2f')]={'deviceUuid':this[a25_0x407a('0x2f')][a25_0x407a('0x43')],'playerId':this[a25_0x407a('0x2f')][a25_0x407a('0x42')]};fs['writeFileSync'](configFile,JSON['stringify'](this[a25_0x407a('0x2f')]));}}['getStatus'](){console[a25_0x407a('0x47')](a25_0x407a('0x3c'));this[a25_0x407a('0x48')][a25_0x407a('0x49')]['getCurrentlyPlayingVideo']()[a25_0x407a('0x40')](function(_0x4f4ec8){const _0x65771d=_0x4f4ec8[a25_0x407a('0x4a')][a25_0x407a('0x4b')];this[a25_0x407a('0x4c')](_0x65771d);}[a25_0x407a('0x3d')](this))['catch'](function(_0xadedb4){console[a25_0x407a('0x47')](_0xadedb4);this[a25_0x407a('0x4c')](JSON[a25_0x407a('0x41')](_0xadedb4));}['bind'](this));}[a25_0x407a('0x4c')](_0x2f0bd9){console['log'](a25_0x407a('0x4d')+_0x2f0bd9);const _0x52df2e={'player_id':this[a25_0x407a('0x42')],'device_uuid':this[a25_0x407a('0x2f')][a25_0x407a('0x43')],'status':_0x2f0bd9!=''&&_0x2f0bd9!=null?0x1:0x0,'playing_item':_0x2f0bd9};this[a25_0x407a('0x28')][a25_0x407a('0x44')](a25_0x407a('0x4e'),_0x52df2e,![])[a25_0x407a('0x40')](function(_0x30cf05){console['log'](a25_0x407a('0x4f'));})[a25_0x407a('0x46')](function(_0x32f72c){});}['checkFolders'](){fsExtra[a25_0x407a('0x50')](this[a25_0x407a('0x17')],_0x4ae4a7=>{});fsExtra[a25_0x407a('0x50')](this[a25_0x407a('0x51')],_0x2c598c=>{});fsExtra['ensureDir'](this[a25_0x407a('0x1a')],_0x3af80a=>{});}['loadMediaList'](){const _0x35ccef=format(this[a25_0x407a('0x34')],this[a25_0x407a('0x42')]);console[a25_0x407a('0x47')](_0x35ccef);request({'url':_0x35ccef,'json':!![]},function(_0x4c8dad,_0x2eecaf,_0x9bc56a){console[a25_0x407a('0x47')](a25_0x407a('0x52'));this[a25_0x407a('0x22')]=_0x9bc56a;this['playlistChanged']=this[a25_0x407a('0x53')]();fsExtra[a25_0x407a('0x54')](this[a25_0x407a('0x51')]);this[a25_0x407a('0x20')]=[];this['failDownloadFiles']=[];this[a25_0x407a('0x1f')]=0x0;for(const _0x253358 in _0x9bc56a){this['downloadFiles']['push'](_0x9bc56a[_0x253358]);}console[a25_0x407a('0x47')]('Total\x20to\x20download:\x20'+this['downloadFiles'][a25_0x407a('0x55')]);if(this['downloadFiles'][a25_0x407a('0x55')]>0x0){this[a25_0x407a('0x56')]();}}[a25_0x407a('0x3d')](this));}['reloadMediaList'](){this[a25_0x407a('0x27')]=!![];if(fsExtra[a25_0x407a('0x57')](this[a25_0x407a('0x51')])){fsExtra[a25_0x407a('0x54')](this[a25_0x407a('0x51')]);}if(fsExtra[a25_0x407a('0x57')](this[a25_0x407a('0x1a')])){fsExtra[a25_0x407a('0x54')](this['filesFolder']);}if(!fsExtra['existsSync'](this[a25_0x407a('0x1b')])){fsExtra[a25_0x407a('0x58')](this[a25_0x407a('0x1b')]);}if(!fsExtra['existsSync'](this['m3uFile'])){fsExtra[a25_0x407a('0x58')](this[a25_0x407a('0x1d')]);}this[a25_0x407a('0x3a')]();}[a25_0x407a('0x53')](){const _0x21f8b8=JSON[a25_0x407a('0x41')](this[a25_0x407a('0x22')]);try{if(!fsExtra[a25_0x407a('0x57')](this[a25_0x407a('0x1b')])){return!![];}else{const _0x4574d3=fsExtra[a25_0x407a('0x2e')](this[a25_0x407a('0x1b')])['toString']();if(_0x4574d3!=_0x21f8b8){return!![];}}}catch(_0x1c9a28){console[a25_0x407a('0x47')](_0x1c9a28);}return![];}[a25_0x407a('0x56')](){console[a25_0x407a('0x47')](a25_0x407a('0x59')+this['currentFile']+a25_0x407a('0x5a')+this['downloadFiles'][a25_0x407a('0x55')]);if(this[a25_0x407a('0x1f')]>=this[a25_0x407a('0x20')][a25_0x407a('0x55')]){this[a25_0x407a('0x5b')]();return;}const _0x3dd8e0=String(this['downloadFiles'][this[a25_0x407a('0x1f')]][a25_0x407a('0x5c')]);const _0xc49d9f=this[a25_0x407a('0x20')][this[a25_0x407a('0x1f')]][a25_0x407a('0x5d')];let _0x540b22=_0x3dd8e0[a25_0x407a('0x5e')](_0x3dd8e0[a25_0x407a('0x5f')]('/')+0x1);const _0x1628b4=_0x540b22[a25_0x407a('0x60')]('.')[a25_0x407a('0x61')](0x0,-0x1)[a25_0x407a('0x62')]('.');let _0x1ffd5b=this['baseURL']+_0x3dd8e0;const _0xd673f8=_0x1ffd5b[a25_0x407a('0x60')]('.')['slice'](0x0,-0x1)[a25_0x407a('0x62')]('.');if(_0xc49d9f==a25_0x407a('0x63')){_0x540b22=_0x540b22+a25_0x407a('0x64');}else if(_0xc49d9f==a25_0x407a('0x65')){_0x540b22=_0x1628b4+a25_0x407a('0x64');_0x1ffd5b=_0xd673f8+a25_0x407a('0x64');}console['log'](a25_0x407a('0x66'));console['log'](_0x3dd8e0);console[a25_0x407a('0x47')](_0xc49d9f);console[a25_0x407a('0x47')](_0x540b22);console['log'](_0x1ffd5b);console[a25_0x407a('0x47')](_0x1628b4);console['log'](_0xd673f8);console[a25_0x407a('0x47')]('**********+');if(fsExtra[a25_0x407a('0x57')](this[a25_0x407a('0x51')]+_0x540b22)){this['checkVideo'](this[a25_0x407a('0x51')]+_0x540b22)['then'](function(_0x191bc6){if(_0x191bc6){this[a25_0x407a('0x1f')]++;}else{this['playlistChanged']=!![];}this[a25_0x407a('0x56')]();}[a25_0x407a('0x3d')](this));}else if(fsExtra[a25_0x407a('0x57')](this[a25_0x407a('0x1a')]+_0x540b22)){this[a25_0x407a('0x67')](this['filesFolder']+_0x540b22)[a25_0x407a('0x40')](function(_0x2f62b0){if(_0x2f62b0){fsExtra[a25_0x407a('0x68')](this[a25_0x407a('0x1a')]+_0x540b22,this[a25_0x407a('0x51')]+_0x540b22);this['currentFile']++;}else{this['playlistChanged']=!![];}this[a25_0x407a('0x56')]();}[a25_0x407a('0x3d')](this));}else{console['log']('Downloading:\x20'+_0x1ffd5b);this[a25_0x407a('0x69')]=!![];if(_0xc49d9f==a25_0x407a('0x63')){this[a25_0x407a('0x6a')](_0x3dd8e0);}else{this[a25_0x407a('0x6b')](_0x1ffd5b,_0x540b22,_0xc49d9f);}}}['checkSchedule'](){const _0x20973d=this[a25_0x407a('0x6c')]();console[a25_0x407a('0x47')](a25_0x407a('0x6c'),_0x20973d);if(_0x20973d){setTimeout(function(){this[a25_0x407a('0x6d')]();}[a25_0x407a('0x3d')](this),0x2710);}}[a25_0x407a('0x67')](_0xa80507){return __awaiter(this,void 0x0,void 0x0,function*(){console[a25_0x407a('0x47')](a25_0x407a('0x6e')+_0xa80507);const _0x30b0d0=yield mediainfo(_0xa80507)[a25_0x407a('0x46')](_0x8dbb4a=>{console[a25_0x407a('0x47')](_0x8dbb4a);fsExtra[a25_0x407a('0x58')](_0xa80507);return![];});const _0x54ead5=_0x30b0d0[a25_0x407a('0x6f')][a25_0x407a('0x70')][a25_0x407a('0x55')]>0x1&&_0x30b0d0[a25_0x407a('0x6f')][a25_0x407a('0x70')][0x1][a25_0x407a('0x71')]==a25_0x407a('0x72');if(!_0x54ead5){fsExtra[a25_0x407a('0x58')](_0xa80507);}console['log'](a25_0x407a('0x73')+_0x54ead5);return _0x54ead5;});}[a25_0x407a('0x6b')](_0x14adcb,_0xba111d,_0x55fceb){const _0x97ae3=new Downloader();console[a25_0x407a('0x47')](_0x14adcb);console['log'](_0xba111d);console['log'](_0x55fceb);const _0x4f97b7=_0x97ae3[a25_0x407a('0x56')](_0x14adcb,this[a25_0x407a('0x51')]+_0xba111d);urlExists(_0x14adcb,function(_0x246ef1,_0x2c6a97){if(_0x2c6a97){if(this[a25_0x407a('0x21')][a25_0x407a('0x74')](this['currentFile'])){const _0x11bafd=this[a25_0x407a('0x21')]['indexOf'](this['currentFile']);if(_0x11bafd>-0x1){this[a25_0x407a('0x21')][a25_0x407a('0x75')](_0x11bafd,0x1);}}console[a25_0x407a('0x47')]('downloading:\x20'+_0x14adcb);_0x4f97b7[a25_0x407a('0x76')]();}else{if(!this[a25_0x407a('0x21')][a25_0x407a('0x74')](this['currentFile'])){this['failDownloadFiles']['push'](this['currentFile']);}console['log'](a25_0x407a('0x77')+_0x14adcb);this[a25_0x407a('0x1f')]++;this[a25_0x407a('0x56')]();}}[a25_0x407a('0x3d')](this));_0x4f97b7['on']('start',function(_0x4f97b7){console['log'](a25_0x407a('0x78')+_0x14adcb);});_0x4f97b7['on']('error',function(_0x4f97b7){console[a25_0x407a('0x47')](a25_0x407a('0x79'));this[a25_0x407a('0x56')]();}[a25_0x407a('0x3d')](this));_0x4f97b7['on'](a25_0x407a('0x7a'),function(_0x4f97b7){console['log'](a25_0x407a('0x7a'));console[a25_0x407a('0x47')](a25_0x407a('0x7b')+_0xba111d);console['log']('mediaType:\x20'+_0x55fceb);this[a25_0x407a('0x67')](this[a25_0x407a('0x51')]+_0xba111d)['then'](function(_0x42b972){if(_0x42b972){this[a25_0x407a('0x1f')]++;}this['download']();}[a25_0x407a('0x3d')](this));}[a25_0x407a('0x3d')](this));_0x4f97b7['on']('stopped',function(_0x4f97b7){console[a25_0x407a('0x47')](a25_0x407a('0x7c'));});_0x4f97b7['on'](a25_0x407a('0x7d'),function(_0x4f97b7){console[a25_0x407a('0x47')]('destroyed');});_0x4f97b7['on']('retry',function(_0x4f97b7){console['log'](a25_0x407a('0x7e'));});}['downloadHTTPFile'](_0x5233c5,_0x436652,_0x16c609,_0x78da90){console[a25_0x407a('0x47')](a25_0x407a('0x7f'));console[a25_0x407a('0x47')](_0x5233c5);const _0x44eb26=!![];let _0x3d8dfb=0x0;const _0x50ebcd='';console[a25_0x407a('0x47')](a25_0x407a('0x80')+_0x5233c5+'\x20to\x20'+_0x436652);if(_0x3d8dfb){if(_0x3d8dfb>0x5){_0x78da90('Max\x20redirects\x20reached',_0x5233c5,_0x16c609,null);return;}}else{_0x3d8dfb=0x0;}const _0x37ed0e=this[a25_0x407a('0x51')]+_0x436652;let _0x938dcf;if(_0x78da90===undefined){console[a25_0x407a('0x47')](a25_0x407a('0x81')+_0x5233c5+'\x20to\x20'+_0x37ed0e);_0x78da90=function(_0x216781,_0xcb7986){console['log'](a25_0x407a('0x82'),_0x216781,_0xcb7986);};}http[a25_0x407a('0x83')][a25_0x407a('0x84')]=0x64;const _0x534d34={'host':url[a25_0x407a('0x2c')](_0x5233c5)[a25_0x407a('0x85')],'port':0x50,'path':url[a25_0x407a('0x2c')](_0x5233c5)[a25_0x407a('0x86')],'agent':![]};const _0x1ca1bb=http[a25_0x407a('0x87')](_0x534d34,function(_0x17f88a){let _0x46b320=0x0;let _0x188edb=0x0;function _0x54f379(){if(_0x46b320===undefined){console[a25_0x407a('0x47')](_0x436652+a25_0x407a('0x88')+_0x188edb+'/'+'?');}const _0x1dcccf=_0x188edb/_0x46b320*0x64;console['log'](_0x436652+'\x20Progress:\x20'+_0x1dcccf+'%\x09'+_0x188edb+'/'+_0x46b320);}console['log'](_0x436652+'\x20'+_0x17f88a[a25_0x407a('0x89')]);switch(_0x17f88a['statusCode']){case 0xc8:_0x46b320=_0x17f88a[a25_0x407a('0x8a')][a25_0x407a('0x8b')]||_0x50ebcd;fs['stat'](_0x37ed0e,function(_0x23ec74,_0x559692){if(!_0x23ec74){console[a25_0x407a('0x47')]('Have\x20already\x20downloaded\x20'+_0x37ed0e);if(_0x559692[a25_0x407a('0x8c')]==_0x46b320){console[a25_0x407a('0x47')](a25_0x407a('0x8d')+_0x46b320+')');console[a25_0x407a('0x47')](a25_0x407a('0x8e'));}else{console[a25_0x407a('0x47')]('But\x20the\x20file\x20size\x20does\x20not\x20match\x20so\x20re-downloading\x20Old('+_0x559692[a25_0x407a('0x8c')]+a25_0x407a('0x8f')+_0x46b320+')');}}_0x938dcf=fs[a25_0x407a('0x90')](_0x37ed0e);_0x17f88a[a25_0x407a('0x91')](_0x938dcf);_0x17f88a['on'](a25_0x407a('0x92'),function(_0x328d4d){_0x188edb+=_0x328d4d[a25_0x407a('0x55')];_0x54f379();});_0x1ca1bb['on'](a25_0x407a('0x93'),function(_0x23ec74){console['log'](a25_0x407a('0x94'));console[a25_0x407a('0x47')](_0x23ec74);});_0x938dcf['on'](a25_0x407a('0x95'),function(){console[a25_0x407a('0x47')]('Downloaded\x20'+_0x5233c5+a25_0x407a('0x96')+_0x436652);_0x78da90(null,_0x436652,_0x16c609,_0x436652);}[a25_0x407a('0x3d')](this));});break;case 0x12e:const _0xc2be0f=_0x17f88a['headers'][a25_0x407a('0x97')];console['log']('Redirect\x20'+_0x5233c5+'\x20to\x20'+_0xc2be0f);if(_0x3d8dfb<0x5){this[a25_0x407a('0x7f')](_0xc2be0f,_0x436652,_0x78da90,_0x3d8dfb++);}else{console['error'](a25_0x407a('0x98')+_0x5233c5+'.');_0x78da90(a25_0x407a('0x99'),null,null,null);}return;case 0x194:console[a25_0x407a('0x47')](a25_0x407a('0x9a')+_0x5233c5);default:console['log'](a25_0x407a('0x9b')+_0x5233c5+a25_0x407a('0x9c')+_0x17f88a[a25_0x407a('0x89')]);_0x1ca1bb[a25_0x407a('0x9d')]();_0x78da90(_0x17f88a[a25_0x407a('0x89')],null,null,null);return;}})['on']('error',function(_0x2055d2){console[a25_0x407a('0x47')](a25_0x407a('0x9e')+_0x5233c5+'\x20'+_0x2055d2[a25_0x407a('0x9f')]);_0x78da90(_0x2055d2,null,null,null);});}['downloadHTTPFileCallback'](_0x589b1d,_0x2bf22b,_0x4216da,_0x24e27e){console[a25_0x407a('0x47')](a25_0x407a('0xa0'));console['log'](_0x589b1d);console[a25_0x407a('0x47')](_0x2bf22b);console[a25_0x407a('0x47')](_0x4216da);console[a25_0x407a('0x47')](_0x24e27e);if(_0x4216da=='image'){const _0xa8881f=this[a25_0x407a('0x20')][this[a25_0x407a('0x1f')]][a25_0x407a('0xa1')]!=null?this[a25_0x407a('0x20')][this['currentFile']]['duration']:0x1e;this['createImageVideo'](_0x24e27e,_0xa8881f);}else if(_0x4216da==a25_0x407a('0xa2')){if(_0x589b1d==null&&_0x2bf22b!=''){this[a25_0x407a('0x1f')]++;}this[a25_0x407a('0x56')]();}console[a25_0x407a('0x47')](this[a25_0x407a('0x1f')]);}[a25_0x407a('0xa3')](_0x1a2838,_0x1ca369,_0x382a1c){progress(request(_0x1a2838),{})['on'](a25_0x407a('0xa4'),function(_0x31ae7d){console[a25_0x407a('0x47')](_0x31ae7d);})['on']('error',function(_0x567d19){console[a25_0x407a('0x47')]('Error\x20downloading\x20file');this[a25_0x407a('0x56')]();})['on'](a25_0x407a('0x7a'),function(){console[a25_0x407a('0x47')](a25_0x407a('0x7b')+_0x1ca369);console[a25_0x407a('0x47')](a25_0x407a('0xa5')+_0x382a1c);if(_0x382a1c==a25_0x407a('0x65')){const _0xf5f1d3=this[a25_0x407a('0x20')][this['currentFile']][a25_0x407a('0xa1')]!=null?this[a25_0x407a('0x20')][this['currentFile']]['duration']:0x1e;this[a25_0x407a('0xa6')](_0x1ca369,_0xf5f1d3);}else if(_0x382a1c==a25_0x407a('0xa2')){this[a25_0x407a('0x1f')]++;this[a25_0x407a('0x56')]();}}[a25_0x407a('0x3d')](this))[a25_0x407a('0x91')](fs['createWriteStream'](this[a25_0x407a('0x51')]+_0x1ca369));}[a25_0x407a('0xa6')](_0x1c740b,_0x124728=0x1e){const _0x4d423a=this[a25_0x407a('0x51')]+_0x1c740b;console[a25_0x407a('0x47')](_0x4d423a);console[a25_0x407a('0x47')](_0x1c740b);const _0x57b679=_0x1c740b[a25_0x407a('0x60')]('.')[a25_0x407a('0x61')](0x0,-0x1)[a25_0x407a('0x62')]('.');const _0x51a546=a25_0x407a('0xa7');const _0x123ffd=['-y','-r','1/2','-loop','1',a25_0x407a('0xa8'),a25_0x407a('0xa9'),'-i',_0x4d423a,'-t',String(_0x124728),a25_0x407a('0xaa'),a25_0x407a('0xab'),a25_0x407a('0xac'),a25_0x407a('0xad'),'-r','25','-vf',a25_0x407a('0xae'),this[a25_0x407a('0x51')]+_0x57b679+a25_0x407a('0x64')];const _0xdfa562=spawn(_0x51a546,_0x123ffd);_0xdfa562[a25_0x407a('0xaf')]['on'](a25_0x407a('0x92'),function(_0x478e0c){console[a25_0x407a('0x47')]('Converting\x20'+_0x4d423a);});_0xdfa562['stderr']['on'](a25_0x407a('0x92'),function(_0x19b426){console['log'](a25_0x407a('0xb0')+_0x19b426);}[a25_0x407a('0x3d')](this));_0xdfa562['on'](a25_0x407a('0xb1'),function(){console[a25_0x407a('0x47')]('finished\x20mp4\x20convert');this[a25_0x407a('0x1f')]++;this[a25_0x407a('0x56')]();}[a25_0x407a('0x3d')](this));}[a25_0x407a('0x6a')](_0x3442ad){const _0x18fa1a=this['tempFolder']+'/'+_0x3442ad+'.mp4';const _0x5b4875=a25_0x407a('0xb2')+_0x3442ad;console[a25_0x407a('0x47')]('youtubeURL:\x20'+_0x5b4875);console[a25_0x407a('0x47')](a25_0x407a('0xb3')+_0x18fa1a);const _0x3718b3=youtubedl(_0x5b4875,['--format=18',a25_0x407a('0xb4')],{'cwd':__dirname});_0x3718b3['on'](a25_0x407a('0xb5'),function(_0x4bc153){console['log'](a25_0x407a('0xb6'));console[a25_0x407a('0x47')](a25_0x407a('0xb7')+_0x4bc153['_filename']);console[a25_0x407a('0x47')]('size:\x20'+_0x4bc153['size']);});_0x3718b3['on'](a25_0x407a('0xb8'),function complete(_0x52484a){'use strict';console['log'](a25_0x407a('0xb7')+_0x52484a['_filename']+a25_0x407a('0xb9'));});_0x3718b3['on'](a25_0x407a('0x7a'),function(){console[a25_0x407a('0x47')](a25_0x407a('0xba'));this['checkVideo'](_0x18fa1a)[a25_0x407a('0x40')](function(_0x1f1b2f){if(_0x1f1b2f){this['currentFile']++;}this[a25_0x407a('0x56')]();}[a25_0x407a('0x3d')](this));}[a25_0x407a('0x3d')](this));_0x3718b3[a25_0x407a('0x91')](fs[a25_0x407a('0x90')](_0x18fa1a));}['finishProcess'](){console[a25_0x407a('0x47')](a25_0x407a('0xbb'));if(this['playlistChanged']){if(this[a25_0x407a('0x21')][a25_0x407a('0x55')]==0x0){console[a25_0x407a('0x47')](a25_0x407a('0xbc')+this[a25_0x407a('0x1b')]);fs['writeFileSync'](this[a25_0x407a('0x1b')],JSON['stringify'](this['newPlayList']));const _0x42c158=this[a25_0x407a('0x6c')]();fsExtra[a25_0x407a('0xbd')](this['filesFolder'])['then'](()=>{fsExtra[a25_0x407a('0xbe')](this[a25_0x407a('0x51')],this[a25_0x407a('0x1a')])[a25_0x407a('0x40')](()=>{fsExtra[a25_0x407a('0xbd')](this[a25_0x407a('0x51')])[a25_0x407a('0x40')](()=>{console[a25_0x407a('0x47')]('Refreshing..');this['refreshPlayer']();})[a25_0x407a('0x46')](_0x484775=>console['error'](_0x484775));})[a25_0x407a('0x46')](_0x3bd66d=>console[a25_0x407a('0x93')](_0x3bd66d));})[a25_0x407a('0x46')](_0x1bd81f=>console[a25_0x407a('0x93')](_0x1bd81f));}else{console[a25_0x407a('0x47')]('Playlist\x20incomplete,\x20retry.');this[a25_0x407a('0x1f')]=0x0;setTimeout(function(){this[a25_0x407a('0x56')]();}[a25_0x407a('0x3d')](this),0x1388);}}else{console[a25_0x407a('0x47')](a25_0x407a('0xbf'));}}[a25_0x407a('0x6c')](){let _0x3be176=a25_0x407a('0xc0')+'\x0d\x0a'+a25_0x407a('0xc1')+'\x0d\x0a';const _0x3115d0=new Date();for(const _0x398b88 in this[a25_0x407a('0x20')]){const _0x11ed4f=this[a25_0x407a('0x20')][_0x398b88][a25_0x407a('0x5c')];const _0x38ec08=this[a25_0x407a('0x20')][_0x398b88][a25_0x407a('0x5d')];const _0x1a314e=dateUtils_1[a25_0x407a('0xc2')][a25_0x407a('0xc3')](this[a25_0x407a('0x20')][_0x398b88][a25_0x407a('0xc4')]);const _0x33401d=dateUtils_1[a25_0x407a('0xc2')]['Parse'](this[a25_0x407a('0x20')][_0x398b88][a25_0x407a('0xc5')]);const _0x1d8a8f=_0x11ed4f[a25_0x407a('0x5e')](_0x11ed4f['lastIndexOf']('/')+0x1);let _0x5d8153=_0x1d8a8f['split']('.')[a25_0x407a('0x61')](0x0,-0x1)['join']('.');if(_0x38ec08==a25_0x407a('0x63')){_0x5d8153=_0x11ed4f;}if((_0x1a314e==null||_0x1a314e<_0x3115d0)&&(_0x33401d==null||_0x33401d>_0x3115d0)){_0x3be176+='/home/osmc/luloclient/media/files/'+_0x5d8153+a25_0x407a('0x64')+'\x0d\x0a';}}let _0x37b017='';if(fsExtra[a25_0x407a('0x57')](this[a25_0x407a('0x1d')])){_0x37b017=fsExtra[a25_0x407a('0x2e')](this[a25_0x407a('0x1d')]);_0x37b017=_0x37b017[a25_0x407a('0xc6')]()[a25_0x407a('0xc7')]();}_0x3be176=_0x3be176['toString']()[a25_0x407a('0xc7')]();if(_0x37b017!=_0x3be176){fsExtra[a25_0x407a('0xc8')](this[a25_0x407a('0x1d')],_0x3be176);return!![];}return![];}[a25_0x407a('0x6d')](){console['log'](a25_0x407a('0x1d'),this[a25_0x407a('0x1d')]);this[a25_0x407a('0xc9')](a25_0x407a('0xca'));}[a25_0x407a('0xcb')](){console[a25_0x407a('0x47')](a25_0x407a('0xcc'));exec(a25_0x407a('0xcd'),function(_0x29ee21){console[a25_0x407a('0x47')](_0x29ee21);});}[a25_0x407a('0x3b')](){const _0x3adb21=format(this['playerServiceURL'],this[a25_0x407a('0x42')]);console[a25_0x407a('0x47')](_0x3adb21);request({'url':_0x3adb21,'json':!![]},function(_0x6353c8,_0xff8cd9,_0x417a47){if(_0x417a47[a25_0x407a('0x55')]>0x0){const _0x6e2643=_0x417a47[0x0];const _0x49701e=_0x6e2643[a25_0x407a('0xce')];const _0x16368d=_0x6e2643['header_active']==0x1;this[a25_0x407a('0xcf')](_0x49701e);this[a25_0x407a('0xd0')](_0x16368d);this['registerClient']();}console[a25_0x407a('0x47')](_0x417a47);}['bind'](this));}[a25_0x407a('0xd1')](){this[a25_0x407a('0xc9')]('CECStandby()');}[a25_0x407a('0xd2')](){this[a25_0x407a('0xc9')](a25_0x407a('0xd3'));}[a25_0x407a('0xcf')](_0x1fefc3){const _0x44098d=_0x1fefc3!=null&&_0x1fefc3!='';const _0x2d60f5=a25_0x407a('0xd4');if(fsExtra[a25_0x407a('0x57')](_0x2d60f5)){const _0x2c6ac9=fsExtra[a25_0x407a('0x2e')](_0x2d60f5);console[a25_0x407a('0x47')](a25_0x407a('0xd5')+_0x2c6ac9);const _0x164330=require(a25_0x407a('0xd6'));const _0x166ace=_0x164330[a25_0x407a('0xd7')];_0x166ace(_0x2c6ac9,function(_0x4e9e04,_0x51764e){console['log'](a25_0x407a('0xd8'),_0x4e9e04);console['log'](a25_0x407a('0xd9'),_0x51764e);if(!_0x1fefc3||_0x1fefc3==null||_0x1fefc3==''){_0x1fefc3=a25_0x407a('0xda');}_0x51764e[a25_0x407a('0xdb')][a25_0x407a('0xdc')][0x0][a25_0x407a('0xdd')][0x0]['_']=_0x1fefc3;const _0x41fbf1=new _0x164330[(a25_0x407a('0xde'))]();const _0xf93269=_0x41fbf1[a25_0x407a('0xdf')](_0x51764e);console[a25_0x407a('0x47')](a25_0x407a('0xe0'),_0xf93269);fsExtra['writeFileSync'](_0x2d60f5,_0xf93269);});this['kodiCommandClient'](a25_0x407a('0xe1'));this[a25_0x407a('0xe2')](a25_0x407a('0xe3'),{'setting':'lookandfeel.enablerssfeeds','value':_0x44098d},function(_0x1d913e){console[a25_0x407a('0x47')](a25_0x407a('0xe4'));console[a25_0x407a('0x47')](_0x1d913e);}[a25_0x407a('0x3d')](this));}}[a25_0x407a('0xd0')](_0x4ff7e3){this[a25_0x407a('0xe2')](a25_0x407a('0xe3'),{'setting':'videoplayer.usedisplayasclock','value':_0x4ff7e3},function(_0xcb0bf9){console['log']('enableClock:\x20');console[a25_0x407a('0x47')](_0xcb0bf9);}[a25_0x407a('0x3d')](this));}[a25_0x407a('0xc9')](_0x1ead4c){exec('kodi-send\x20--action=\x22'+_0x1ead4c+'\x22',function(_0x342279){console[a25_0x407a('0x47')](_0x342279);});}[a25_0x407a('0xe2')](_0x3e0c94,_0x8f9e3f,_0x5ddf37){const _0x57ab50={'jsonrpc':a25_0x407a('0xe5'),'method':_0x3e0c94,'params':_0x8f9e3f,'id':0x1};const _0x2cbaa1={'user':this[a25_0x407a('0x24')],'pass':this[a25_0x407a('0x26')]};console[a25_0x407a('0x47')]('jsonrpcClient\x20data',_0x57ab50);console[a25_0x407a('0x47')](a25_0x407a('0xe6'),_0x2cbaa1);this[a25_0x407a('0x28')][a25_0x407a('0x44')](this[a25_0x407a('0x23')]+a25_0x407a('0xe7'),_0x57ab50,![],_0x2cbaa1)[a25_0x407a('0x40')](function(_0x105009){_0x5ddf37(_0x105009);})[a25_0x407a('0x46')](function(_0x5b744a){});}}exports[a25_0x407a('0xe8')]=SyncPlaylistsService;
var a22_0x3d9e=['post','http://restapi.lulo.run/player_devices/report_status','reportStatusResponse:\x20','ensureDir','playListServiceURL','loadMediaList:\x20','newPlayList','hasPlayListChanged','emptyDirSync','Total:\x20','length','download','reloadMediaList','existsSync','removeSync','System','Shutdown','this.currentFile:\x20','path','substring','lastIndexOf','join','split','slice','youtube_single','image','.mp4','**********+','checkVideo','Downloading:\x20','videoFile:\x20','media','track','@type','Video','mediainfo\x20check:','downloader','failDownloadFiles','includes','splice','downloading:\x20','start','push','Error:\x20','start:\x20','error:\x20','end','Downloaded:\x20','mediaType:\x20','stopped','destroyed','retry','downloadHTTPFile','\x20to\x20','WARNING\x20downloadFile\x20callback\x20is\x20undefined\x20for\x20','downloadFile\x20callback\x20result\x20undefined:\x20','maxSockets','host','pathname','get','\x20Progress:\x20','statusCode','headers','content-length','stat','Have\x20already\x20downloaded\x20','size','And\x20the\x20file\x20size\x20matches\x20(','Redownloading','But\x20the\x20file\x20size\x20does\x20not\x20match\x20so\x20re-downloading\x20Old(','createWriteStream','pipe','error','err:\x20','finish','Downloaded\x20','location','Redirect\x20','302','File\x20Not\x20Found\x20','\x20STATUS:\x20','abort','Error\x20Downloading:\x20','message','downloadHTTPFileCallback','duration','createImageVideo','video','downloadRequestFile','progress','ffmpeg','1/2','-loop','-pattern_type','glob','-c:v','libx264','-pix_fmt','yuv420p','stdout','data','Converting\x20','stderr:\x20','close','finished\x20mp4\x20convert','--format=18','info','Download\x20started','filename:\x20','size:\x20','complete','\x20already\x20downloaded.','finishProcess','Finishing','#EXTCPlayListM3U::M3U','#EXTINF:0,luloPlayList','media_type','/home/osmc/luloclient/media/files/','shutdown','now','No\x20playlist\x20changes.','SyncPlaylistsService','__awaiter','throw','done','value','then','apply','next','defineProperty','__esModule','../infrastructure/HttpClientService','node-mediainfo','url','http','fs-extra','request','request-progress','spawn','is-image','string-template','youtube-dl','config.json','context.json','url-exists','node-kodi','mt-files-downloader','mediaFolder','tempFolder','temp/','filesFolder','files/','playListFile','playlist.txt','m3uFile','currentFile','playlistChanged','downloadFiles','httpClientService','init','parse','readFileSync','context','playerId','baseURL','env','WEB_SERVICE_URL','deploy/','api/player_playlist.php?player_id={0}','kodi','http://localhost','lulo','.lulo123.','registerClient','checkFolders','loadMediaList','getStatus','bind','checkDependencies','config','deviceUuid','stringify','networkInterfaces','http://restapi.lulo.run/player_devices/register','log','register\x20response:\x20','catch','writeFileSync','getCurrentlyPlayingVideo','label','reportStatus','playingItem:\x20'];(function(_0x481822,_0x2f8439){var _0x1a11bf=function(_0x219858){while(--_0x219858){_0x481822['push'](_0x481822['shift']());}};_0x1a11bf(++_0x2f8439);}(a22_0x3d9e,0x13a));var a22_0x4fea=function(_0x4d8650,_0x1c601e){_0x4d8650=_0x4d8650-0x0;var _0x22239c=a22_0x3d9e[_0x4d8650];return _0x22239c;};'use strict';var __awaiter=this&&this[a22_0x4fea('0x0')]||function(_0x453e80,_0x5b239a,_0x29c1a9,_0x8941be){function _0x553ce4(_0x3a83f2){return _0x3a83f2 instanceof _0x29c1a9?_0x3a83f2:new _0x29c1a9(function(_0x377314){_0x377314(_0x3a83f2);});}return new(_0x29c1a9||(_0x29c1a9=Promise))(function(_0xb63ea2,_0x1bceb1){function _0x238cf1(_0x300b77){try{_0x2c59b5(_0x8941be['next'](_0x300b77));}catch(_0x34e7ed){_0x1bceb1(_0x34e7ed);}}function _0x48450d(_0x4a13ab){try{_0x2c59b5(_0x8941be[a22_0x4fea('0x1')](_0x4a13ab));}catch(_0x5c63bc){_0x1bceb1(_0x5c63bc);}}function _0x2c59b5(_0x50d05b){_0x50d05b[a22_0x4fea('0x2')]?_0xb63ea2(_0x50d05b[a22_0x4fea('0x3')]):_0x553ce4(_0x50d05b[a22_0x4fea('0x3')])[a22_0x4fea('0x4')](_0x238cf1,_0x48450d);}_0x2c59b5((_0x8941be=_0x8941be[a22_0x4fea('0x5')](_0x453e80,_0x5b239a||[]))[a22_0x4fea('0x6')]());});};Object[a22_0x4fea('0x7')](exports,a22_0x4fea('0x8'),{'value':!![]});const HttpClientService_1=require(a22_0x4fea('0x9'));const mediainfo=require(a22_0x4fea('0xa'));const fs=require('fs');const url=require(a22_0x4fea('0xb'));const http=require(a22_0x4fea('0xc'));const fsExtra=require(a22_0x4fea('0xd'));const request=require(a22_0x4fea('0xe'));const progress=require(a22_0x4fea('0xf'));const spawn=require('child_process')[a22_0x4fea('0x10')];const isImage=require(a22_0x4fea('0x11'));const format=require(a22_0x4fea('0x12'));const os=require('os');const youtubedl=require(a22_0x4fea('0x13'));const uuidv4=require('uuid/v4');const configFile=a22_0x4fea('0x14');const contextFile=a22_0x4fea('0x15');const urlExists=require(a22_0x4fea('0x16'));const kodi_rpc=require(a22_0x4fea('0x17'));const Downloader=require(a22_0x4fea('0x18'));class SyncPlaylistsService{constructor(){this[a22_0x4fea('0x19')]='media/';this[a22_0x4fea('0x1a')]=this[a22_0x4fea('0x19')]+a22_0x4fea('0x1b');this[a22_0x4fea('0x1c')]=this['mediaFolder']+a22_0x4fea('0x1d');this[a22_0x4fea('0x1e')]=this[a22_0x4fea('0x19')]+a22_0x4fea('0x1f');this[a22_0x4fea('0x20')]=this[a22_0x4fea('0x1c')]+'lulo_playlist.m3u';this[a22_0x4fea('0x21')]=0x0;this[a22_0x4fea('0x22')]=![];this[a22_0x4fea('0x23')]=[];this['failDownloadFiles']=[];this['newPlayList']={};this[a22_0x4fea('0x24')]=new HttpClientService_1['HttpClientService']();}[a22_0x4fea('0x25')](){this['config']=JSON[a22_0x4fea('0x26')](fs[a22_0x4fea('0x27')](configFile));this[a22_0x4fea('0x28')]=JSON[a22_0x4fea('0x26')](fs[a22_0x4fea('0x27')](contextFile));this[a22_0x4fea('0x29')]=this['config'][a22_0x4fea('0x29')];this[a22_0x4fea('0x2a')]=process[a22_0x4fea('0x2b')][a22_0x4fea('0x2c')]+a22_0x4fea('0x2d');this['playListServiceURL']=this[a22_0x4fea('0x2a')]+a22_0x4fea('0x2e');this[a22_0x4fea('0x2f')]=new kodi_rpc({'url':a22_0x4fea('0x30'),'user':a22_0x4fea('0x31'),'password':a22_0x4fea('0x32')});this['checkDependencies']();this[a22_0x4fea('0x33')]();this[a22_0x4fea('0x34')]();this[a22_0x4fea('0x35')]();setInterval(function(){this[a22_0x4fea('0x36')]();}[a22_0x4fea('0x37')](this),0x2710);setInterval(function(){this[a22_0x4fea('0x33')]();}[a22_0x4fea('0x37')](this),0x493e0);}[a22_0x4fea('0x38')](){}['registerClient'](){this[a22_0x4fea('0x2f')]['playlist']['getItems'](0x1)[a22_0x4fea('0x4')](function(_0x52548f){const _0x2d47a4=JSON['stringify'](_0x52548f);const _0x30c18c={'player_id':this[a22_0x4fea('0x29')],'device_uuid':this[a22_0x4fea('0x39')][a22_0x4fea('0x3a')],'network_info':JSON[a22_0x4fea('0x3b')](os[a22_0x4fea('0x3c')]()),'firmware_info':JSON['stringify'](this[a22_0x4fea('0x28')]),'playlist':_0x2d47a4,'playing_item':'','status':0x0};this[a22_0x4fea('0x24')]['post'](a22_0x4fea('0x3d'),_0x30c18c,![])[a22_0x4fea('0x4')](function(_0x59fcfb){console[a22_0x4fea('0x3e')](a22_0x4fea('0x3f')+Date());})[a22_0x4fea('0x40')](function(_0x4c3235){});console[a22_0x4fea('0x3e')](_0x30c18c);}[a22_0x4fea('0x37')](this));const _0x1d6eb8=this[a22_0x4fea('0x39')][a22_0x4fea('0x3a')];if(!_0x1d6eb8||_0x1d6eb8==''){this['config'][a22_0x4fea('0x3a')]=uuidv4();this['config']={'deviceUuid':this['config'][a22_0x4fea('0x3a')],'playerId':this[a22_0x4fea('0x39')][a22_0x4fea('0x29')]};fs[a22_0x4fea('0x41')](configFile,JSON['stringify'](this['config']));}}[a22_0x4fea('0x36')](){console[a22_0x4fea('0x3e')](a22_0x4fea('0x36'));this[a22_0x4fea('0x2f')]['player'][a22_0x4fea('0x42')]()[a22_0x4fea('0x4')](function(_0x14d7bb){const _0x3082ad=_0x14d7bb['item'][a22_0x4fea('0x43')];this['reportStatus'](_0x3082ad);}['bind'](this))[a22_0x4fea('0x40')](function(_0x48dec9){console[a22_0x4fea('0x3e')](_0x48dec9);this[a22_0x4fea('0x44')](_0x48dec9);}['bind'](this));}[a22_0x4fea('0x44')](_0x3e38b1){console['log'](a22_0x4fea('0x45')+_0x3e38b1);const _0x21390c={'player_id':this[a22_0x4fea('0x29')],'device_uuid':this[a22_0x4fea('0x39')][a22_0x4fea('0x3a')],'status':_0x3e38b1!=''&&_0x3e38b1!=null?0x1:0x0,'playing_item':_0x3e38b1};this[a22_0x4fea('0x24')][a22_0x4fea('0x46')](a22_0x4fea('0x47'),_0x21390c,![])['then'](function(_0x2a951c){console[a22_0x4fea('0x3e')](a22_0x4fea('0x48')+Date());})[a22_0x4fea('0x40')](function(_0x4c2134){});}['checkFolders'](){fsExtra[a22_0x4fea('0x49')](this[a22_0x4fea('0x19')],_0x3494e0=>{});fsExtra[a22_0x4fea('0x49')](this['tempFolder'],_0x3377f4=>{});fsExtra[a22_0x4fea('0x49')](this[a22_0x4fea('0x1c')],_0x30d729=>{});}[a22_0x4fea('0x35')](){const _0x2abd20=format(this[a22_0x4fea('0x4a')],this[a22_0x4fea('0x29')]);console[a22_0x4fea('0x3e')](_0x2abd20);request({'url':_0x2abd20,'json':!![]},function(_0x3d02f0,_0x1fa5ed,_0x51a6fb){console['log'](a22_0x4fea('0x4b'));console['log'](_0x51a6fb);this[a22_0x4fea('0x4c')]=_0x51a6fb;this[a22_0x4fea('0x22')]=this[a22_0x4fea('0x4d')]();fsExtra[a22_0x4fea('0x4e')](this[a22_0x4fea('0x1a')]);this[a22_0x4fea('0x23')]=[];this['failDownloadFiles']=[];this[a22_0x4fea('0x21')]=0x0;for(const _0x5cb7b7 in _0x51a6fb){this['downloadFiles']['push'](_0x51a6fb[_0x5cb7b7]);}console[a22_0x4fea('0x3e')](a22_0x4fea('0x4f')+this[a22_0x4fea('0x23')][a22_0x4fea('0x50')]);if(this[a22_0x4fea('0x23')]['length']>0x0){this[a22_0x4fea('0x51')]();}}['bind'](this));}[a22_0x4fea('0x52')](){if(fsExtra[a22_0x4fea('0x53')](this[a22_0x4fea('0x1a')])){fsExtra['emptyDirSync'](this[a22_0x4fea('0x1a')]);}if(fsExtra[a22_0x4fea('0x53')](this['playListFile'])){fsExtra['emptyDirSync'](this[a22_0x4fea('0x1e')]);}if(!fsExtra[a22_0x4fea('0x53')](this[a22_0x4fea('0x1e')])){fsExtra[a22_0x4fea('0x54')](this[a22_0x4fea('0x1e')]);}if(!fsExtra[a22_0x4fea('0x53')](this['m3uFile'])){fsExtra[a22_0x4fea('0x54')](this[a22_0x4fea('0x20')]);}this['loadMediaList']();}['reboot'](){this[a22_0x4fea('0x2f')][a22_0x4fea('0x55')][a22_0x4fea('0x56')]();}['hasPlayListChanged'](){const _0xb12c3f=JSON[a22_0x4fea('0x3b')](this[a22_0x4fea('0x4c')]);try{if(!fsExtra[a22_0x4fea('0x53')](this[a22_0x4fea('0x1e')])){return!![];}else{const _0x3181fd=fsExtra[a22_0x4fea('0x27')](this[a22_0x4fea('0x1e')])['toString']();if(_0x3181fd!=_0xb12c3f){return!![];}}}catch(_0x2ad46e){console['log'](_0x2ad46e);}return![];}['download'](){console[a22_0x4fea('0x3e')](a22_0x4fea('0x57')+this[a22_0x4fea('0x21')]+'\x20of\x20'+this[a22_0x4fea('0x23')]['length']);if(this[a22_0x4fea('0x21')]>=this[a22_0x4fea('0x23')]['length']){this['finishProcess']();return;}const _0x5d778e=String(this[a22_0x4fea('0x23')][this[a22_0x4fea('0x21')]][a22_0x4fea('0x58')]);const _0x5852a6=this['downloadFiles'][this['currentFile']]['media_type'];let _0x299b6c=_0x5d778e[a22_0x4fea('0x59')](_0x5d778e[a22_0x4fea('0x5a')]('/')+0x1);const _0xe0d349=_0x299b6c['split']('.')['slice'](0x0,-0x1)[a22_0x4fea('0x5b')]('.');let _0x2f867a=this[a22_0x4fea('0x2a')]+_0x5d778e;const _0x513d03=_0x2f867a[a22_0x4fea('0x5c')]('.')[a22_0x4fea('0x5d')](0x0,-0x1)['join']('.');if(_0x5852a6==a22_0x4fea('0x5e')){_0x299b6c=_0x299b6c+'.mp4';}else if(_0x5852a6==a22_0x4fea('0x5f')){_0x299b6c=_0xe0d349+a22_0x4fea('0x60');_0x2f867a=_0x513d03+'.mp4';}console[a22_0x4fea('0x3e')](a22_0x4fea('0x61'));console['log'](_0x5d778e);console[a22_0x4fea('0x3e')](_0x5852a6);console['log'](_0x299b6c);console[a22_0x4fea('0x3e')](_0x2f867a);console[a22_0x4fea('0x3e')](_0xe0d349);console['log'](_0x513d03);console[a22_0x4fea('0x3e')](a22_0x4fea('0x61'));if(fsExtra['existsSync'](this[a22_0x4fea('0x1a')]+_0x299b6c)){this[a22_0x4fea('0x62')](this[a22_0x4fea('0x1a')]+_0x299b6c)[a22_0x4fea('0x4')](function(_0x489f83){if(_0x489f83){this[a22_0x4fea('0x21')]++;}else{this[a22_0x4fea('0x22')]=!![];}this[a22_0x4fea('0x51')]();}[a22_0x4fea('0x37')](this));}else if(fsExtra['existsSync'](this[a22_0x4fea('0x1c')]+_0x299b6c)){this[a22_0x4fea('0x62')](this['filesFolder']+_0x299b6c)[a22_0x4fea('0x4')](function(_0x5a3c50){if(_0x5a3c50){fsExtra['copySync'](this[a22_0x4fea('0x1c')]+_0x299b6c,this[a22_0x4fea('0x1a')]+_0x299b6c);this['currentFile']++;}else{this[a22_0x4fea('0x22')]=!![];}this['download']();}[a22_0x4fea('0x37')](this));}else{console['log'](a22_0x4fea('0x63')+_0x2f867a);this['playlistChanged']=!![];if(_0x5852a6==a22_0x4fea('0x5e')){this['downloadYouTube'](_0x5d778e);}else{this['downloader'](_0x2f867a,_0x299b6c,_0x5852a6);}}}['checkVideo'](_0x5cb8ee){return __awaiter(this,void 0x0,void 0x0,function*(){console[a22_0x4fea('0x3e')](a22_0x4fea('0x64')+_0x5cb8ee);const _0x57e824=yield mediainfo(_0x5cb8ee)[a22_0x4fea('0x40')](_0x193fe1=>{console['log'](_0x193fe1);fsExtra[a22_0x4fea('0x54')](_0x5cb8ee);return![];});const _0x213ea9=_0x57e824[a22_0x4fea('0x65')][a22_0x4fea('0x66')]['length']>0x1&&_0x57e824['media'][a22_0x4fea('0x66')][0x1][a22_0x4fea('0x67')]==a22_0x4fea('0x68');if(!_0x213ea9){fsExtra[a22_0x4fea('0x54')](_0x5cb8ee);}console['log'](a22_0x4fea('0x69')+_0x213ea9);return _0x213ea9;});}[a22_0x4fea('0x6a')](_0x44577e,_0x3f38bf,_0x3e2ebb){const _0x29a057=new Downloader();console[a22_0x4fea('0x3e')](_0x44577e);console[a22_0x4fea('0x3e')](_0x3f38bf);console['log'](_0x3e2ebb);const _0x46ade7=_0x29a057[a22_0x4fea('0x51')](_0x44577e,this[a22_0x4fea('0x1a')]+_0x3f38bf);urlExists(_0x44577e,function(_0x407d0a,_0x5cb860){if(_0x5cb860){if(this[a22_0x4fea('0x6b')][a22_0x4fea('0x6c')](this[a22_0x4fea('0x21')])){const _0x12598d=this[a22_0x4fea('0x6b')]['indexOf'](this['currentFile']);if(_0x12598d>-0x1){this[a22_0x4fea('0x6b')][a22_0x4fea('0x6d')](_0x12598d,0x1);}}console[a22_0x4fea('0x3e')](a22_0x4fea('0x6e')+_0x44577e);_0x46ade7[a22_0x4fea('0x6f')]();}else{if(!this['failDownloadFiles'][a22_0x4fea('0x6c')](this[a22_0x4fea('0x21')])){this['failDownloadFiles'][a22_0x4fea('0x70')](this[a22_0x4fea('0x21')]);}console[a22_0x4fea('0x3e')](a22_0x4fea('0x71')+_0x44577e);this['currentFile']++;this[a22_0x4fea('0x51')]();}}[a22_0x4fea('0x37')](this));_0x46ade7['on']('start',function(_0x46ade7){console[a22_0x4fea('0x3e')](a22_0x4fea('0x72')+_0x44577e);});_0x46ade7['on']('error',function(_0x46ade7){console[a22_0x4fea('0x3e')](a22_0x4fea('0x73'));this['download']();}['bind'](this));_0x46ade7['on'](a22_0x4fea('0x74'),function(_0x46ade7){console[a22_0x4fea('0x3e')](a22_0x4fea('0x74'));console['log'](a22_0x4fea('0x75')+_0x3f38bf);console[a22_0x4fea('0x3e')](a22_0x4fea('0x76')+_0x3e2ebb);this[a22_0x4fea('0x62')](this['tempFolder']+_0x3f38bf)[a22_0x4fea('0x4')](function(_0x2f4ac2){if(_0x2f4ac2){this[a22_0x4fea('0x21')]++;}this['download']();}[a22_0x4fea('0x37')](this));}[a22_0x4fea('0x37')](this));_0x46ade7['on'](a22_0x4fea('0x77'),function(_0x46ade7){console['log'](a22_0x4fea('0x77'));});_0x46ade7['on'](a22_0x4fea('0x78'),function(_0x46ade7){console[a22_0x4fea('0x3e')](a22_0x4fea('0x78'));});_0x46ade7['on'](a22_0x4fea('0x79'),function(_0x46ade7){console[a22_0x4fea('0x3e')](a22_0x4fea('0x79'));});}[a22_0x4fea('0x7a')](_0x481b0c,_0x543a24,_0xab9eca,_0x5b8ba1){console[a22_0x4fea('0x3e')](a22_0x4fea('0x7a'));console[a22_0x4fea('0x3e')](_0x481b0c);const _0x3036b3=!![];let _0x178edb=0x0;const _0x3e56ef='';console[a22_0x4fea('0x3e')]('Attempting\x20to\x20download\x20'+_0x481b0c+a22_0x4fea('0x7b')+_0x543a24);if(_0x178edb){if(_0x178edb>0x5){_0x5b8ba1('Max\x20redirects\x20reached',_0x481b0c,_0xab9eca,null);return;}}else{_0x178edb=0x0;}const _0x3e9be4=this['tempFolder']+_0x543a24;let _0x6fb6cd;if(_0x5b8ba1===undefined){console['log'](a22_0x4fea('0x7c')+_0x481b0c+'\x20to\x20'+_0x3e9be4);_0x5b8ba1=function(_0x2555bf,_0x7e3a19){console['log'](a22_0x4fea('0x7d'),_0x2555bf,_0x7e3a19);};}http['globalAgent'][a22_0x4fea('0x7e')]=0x64;const _0x213812={'host':url[a22_0x4fea('0x26')](_0x481b0c)[a22_0x4fea('0x7f')],'port':0x50,'path':url['parse'](_0x481b0c)[a22_0x4fea('0x80')],'agent':![]};const _0x974954=http[a22_0x4fea('0x81')](_0x213812,function(_0x5b2cd7){let _0x16f54e=0x0;let _0x44dae0=0x0;function _0x4173d7(){if(_0x16f54e===undefined){console[a22_0x4fea('0x3e')](_0x543a24+'\x20Progress:\x20unknown\x09'+_0x44dae0+'/'+'?');}const _0xef46b7=_0x44dae0/_0x16f54e*0x64;console[a22_0x4fea('0x3e')](_0x543a24+a22_0x4fea('0x82')+_0xef46b7+'%\x09'+_0x44dae0+'/'+_0x16f54e);}console[a22_0x4fea('0x3e')](_0x543a24+'\x20'+_0x5b2cd7[a22_0x4fea('0x83')]);switch(_0x5b2cd7[a22_0x4fea('0x83')]){case 0xc8:_0x16f54e=_0x5b2cd7[a22_0x4fea('0x84')][a22_0x4fea('0x85')]||_0x3e56ef;fs[a22_0x4fea('0x86')](_0x3e9be4,function(_0x123359,_0x322ff0){if(!_0x123359){console[a22_0x4fea('0x3e')](a22_0x4fea('0x87')+_0x3e9be4);if(_0x322ff0[a22_0x4fea('0x88')]==_0x16f54e){console['log'](a22_0x4fea('0x89')+_0x16f54e+')');console[a22_0x4fea('0x3e')](a22_0x4fea('0x8a'));}else{console[a22_0x4fea('0x3e')](a22_0x4fea('0x8b')+_0x322ff0[a22_0x4fea('0x88')]+')\x20vs\x20New('+_0x16f54e+')');}}_0x6fb6cd=fs[a22_0x4fea('0x8c')](_0x3e9be4);_0x5b2cd7[a22_0x4fea('0x8d')](_0x6fb6cd);_0x5b2cd7['on']('data',function(_0x20a8e6){_0x44dae0+=_0x20a8e6[a22_0x4fea('0x50')];_0x4173d7();});_0x974954['on'](a22_0x4fea('0x8e'),function(_0x123359){console[a22_0x4fea('0x3e')](a22_0x4fea('0x8f'));console[a22_0x4fea('0x3e')](_0x123359);});_0x6fb6cd['on'](a22_0x4fea('0x90'),function(){console[a22_0x4fea('0x3e')](a22_0x4fea('0x91')+_0x481b0c+'\x20to\x20'+_0x543a24);_0x5b8ba1(null,_0x543a24,_0xab9eca,_0x543a24);}[a22_0x4fea('0x37')](this));});break;case 0x12e:const _0xd06bc7=_0x5b2cd7['headers'][a22_0x4fea('0x92')];console[a22_0x4fea('0x3e')](a22_0x4fea('0x93')+_0x481b0c+a22_0x4fea('0x7b')+_0xd06bc7);if(_0x178edb<0x5){this['downloadHTTPFile'](_0xd06bc7,_0x543a24,_0x5b8ba1,_0x178edb++);}else{console[a22_0x4fea('0x8e')]('Redirect\x20limit\x20encountered\x20for\x20'+_0x481b0c+'.');_0x5b8ba1(a22_0x4fea('0x94'),null,null,null);}return;case 0x194:console['log'](a22_0x4fea('0x95')+_0x481b0c);default:console['log']('Problem\x20downloading\x20'+_0x481b0c+a22_0x4fea('0x96')+_0x5b2cd7[a22_0x4fea('0x83')]);_0x974954[a22_0x4fea('0x97')]();_0x5b8ba1(_0x5b2cd7[a22_0x4fea('0x83')],null,null,null);return;}})['on'](a22_0x4fea('0x8e'),function(_0x88c8a0){console['log'](a22_0x4fea('0x98')+_0x481b0c+'\x20'+_0x88c8a0[a22_0x4fea('0x99')]);_0x5b8ba1(_0x88c8a0,null,null,null);});}[a22_0x4fea('0x9a')](_0xea6615,_0x46f823,_0x3f394b,_0x36a947){console[a22_0x4fea('0x3e')](a22_0x4fea('0x9a'));console[a22_0x4fea('0x3e')](_0xea6615);console['log'](_0x46f823);console['log'](_0x3f394b);console[a22_0x4fea('0x3e')](_0x36a947);if(_0x3f394b==a22_0x4fea('0x5f')){const _0x5f17ac=this[a22_0x4fea('0x23')][this[a22_0x4fea('0x21')]][a22_0x4fea('0x9b')]!=null?this[a22_0x4fea('0x23')][this[a22_0x4fea('0x21')]][a22_0x4fea('0x9b')]:0x1e;this[a22_0x4fea('0x9c')](_0x36a947,_0x5f17ac);}else if(_0x3f394b==a22_0x4fea('0x9d')){if(_0xea6615==null&&_0x46f823!=''){this['currentFile']++;}this[a22_0x4fea('0x51')]();}console[a22_0x4fea('0x3e')](this[a22_0x4fea('0x21')]);}[a22_0x4fea('0x9e')](_0x521794,_0x965532,_0x33ba5a){progress(request(_0x521794),{})['on'](a22_0x4fea('0x9f'),function(_0x25e239){console[a22_0x4fea('0x3e')](_0x25e239);})['on']('error',function(_0x21eaf6){console[a22_0x4fea('0x3e')]('Error\x20downloading\x20file');this[a22_0x4fea('0x51')]();})['on']('end',function(){console[a22_0x4fea('0x3e')](a22_0x4fea('0x75')+_0x965532);console['log']('mediaType:\x20'+_0x33ba5a);if(_0x33ba5a==a22_0x4fea('0x5f')){const _0x3790f6=this[a22_0x4fea('0x23')][this['currentFile']]['duration']!=null?this[a22_0x4fea('0x23')][this[a22_0x4fea('0x21')]][a22_0x4fea('0x9b')]:0x1e;this[a22_0x4fea('0x9c')](_0x965532,_0x3790f6);}else if(_0x33ba5a=='video'){this[a22_0x4fea('0x21')]++;this[a22_0x4fea('0x51')]();}}[a22_0x4fea('0x37')](this))[a22_0x4fea('0x8d')](fs[a22_0x4fea('0x8c')](this['tempFolder']+_0x965532));}['createImageVideo'](_0x50c5c0,_0x4076cd=0x1e){const _0x2cbad8=this[a22_0x4fea('0x1a')]+_0x50c5c0;console[a22_0x4fea('0x3e')](_0x2cbad8);console[a22_0x4fea('0x3e')](_0x50c5c0);const _0x3c5f7e=_0x50c5c0[a22_0x4fea('0x5c')]('.')[a22_0x4fea('0x5d')](0x0,-0x1)[a22_0x4fea('0x5b')]('.');const _0x372a62=a22_0x4fea('0xa0');const _0x4a16e7=['-y','-r',a22_0x4fea('0xa1'),a22_0x4fea('0xa2'),'1',a22_0x4fea('0xa3'),a22_0x4fea('0xa4'),'-i',_0x2cbad8,'-t',String(_0x4076cd),a22_0x4fea('0xa5'),a22_0x4fea('0xa6'),a22_0x4fea('0xa7'),a22_0x4fea('0xa8'),'-r','25','-vf','scale=1920:1080',this[a22_0x4fea('0x1a')]+_0x3c5f7e+a22_0x4fea('0x60')];const _0x41cd06=spawn(_0x372a62,_0x4a16e7);_0x41cd06[a22_0x4fea('0xa9')]['on'](a22_0x4fea('0xaa'),function(_0x50555d){console['log'](a22_0x4fea('0xab')+_0x2cbad8);});_0x41cd06['stderr']['on'](a22_0x4fea('0xaa'),function(_0x4aad1d){console['log'](a22_0x4fea('0xac')+_0x4aad1d);}[a22_0x4fea('0x37')](this));_0x41cd06['on'](a22_0x4fea('0xad'),function(){console[a22_0x4fea('0x3e')](a22_0x4fea('0xae'));this['currentFile']++;this[a22_0x4fea('0x51')]();}['bind'](this));}['downloadYouTube'](_0x4ba8f7){const _0x312270=this[a22_0x4fea('0x1a')]+'/'+_0x4ba8f7+a22_0x4fea('0x60');const _0x392158=youtubedl('http://www.youtube.com/watch?v='+_0x4ba8f7,[a22_0x4fea('0xaf')],{'cwd':__dirname});_0x392158['on'](a22_0x4fea('0xb0'),function(_0x35df1f){console[a22_0x4fea('0x3e')](a22_0x4fea('0xb1'));console[a22_0x4fea('0x3e')](a22_0x4fea('0xb2')+_0x35df1f['_filename']);console[a22_0x4fea('0x3e')](a22_0x4fea('0xb3')+_0x35df1f[a22_0x4fea('0x88')]);});_0x392158['on'](a22_0x4fea('0xb4'),function complete(_0x56d625){'use strict';console[a22_0x4fea('0x3e')](a22_0x4fea('0xb2')+_0x56d625['_filename']+a22_0x4fea('0xb5'));});_0x392158['on'](a22_0x4fea('0x74'),function(){console[a22_0x4fea('0x3e')]('finished\x20youtube\x20downloading!');this[a22_0x4fea('0x62')](_0x312270)['then'](function(_0x41d8ac){if(_0x41d8ac){this[a22_0x4fea('0x21')]++;}this[a22_0x4fea('0x51')]();}[a22_0x4fea('0x37')](this));}[a22_0x4fea('0x37')](this));_0x392158['pipe'](fs[a22_0x4fea('0x8c')](_0x312270));}[a22_0x4fea('0xb6')](){console['log'](a22_0x4fea('0xb7'));if(this[a22_0x4fea('0x22')]){if(this[a22_0x4fea('0x6b')][a22_0x4fea('0x50')]==0x0){fs[a22_0x4fea('0x41')](this['playListFile'],JSON[a22_0x4fea('0x3b')](this['newPlayList']));let _0x272e38=a22_0x4fea('0xb8')+'\x0d\x0a'+a22_0x4fea('0xb9')+'\x0d\x0a';for(const _0x3f3375 in this[a22_0x4fea('0x23')]){const _0x55869d=this[a22_0x4fea('0x23')][_0x3f3375]['path'];const _0x27730e=this[a22_0x4fea('0x23')][_0x3f3375][a22_0x4fea('0xba')];const _0x2fe2b1=_0x55869d[a22_0x4fea('0x59')](_0x55869d[a22_0x4fea('0x5a')]('/')+0x1);let _0x378850=_0x2fe2b1[a22_0x4fea('0x5c')]('.')[a22_0x4fea('0x5d')](0x0,-0x1)['join']('.');if(_0x27730e=='youtube_single'){_0x378850=_0x55869d;}_0x272e38+=a22_0x4fea('0xbb')+_0x378850+a22_0x4fea('0x60')+'\x0d\x0a';}fsExtra[a22_0x4fea('0x4e')](this['filesFolder']);fsExtra['copySync'](this[a22_0x4fea('0x1a')],this['filesFolder']);fsExtra['writeFileSync'](this[a22_0x4fea('0x20')],_0x272e38);fsExtra[a22_0x4fea('0x4e')](this['tempFolder']);console['log']('Rebooting..');const _0x5cb1fc=spawn(a22_0x4fea('0xbc'),['-r',a22_0x4fea('0xbd')]);}else{console['log']('Playlist\x20incomplete,\x20retry.');this['currentFile']=0x0;setTimeout(function(){this[a22_0x4fea('0x51')]();}[a22_0x4fea('0x37')](this),0x1388);}}else{console[a22_0x4fea('0x3e')](a22_0x4fea('0xbe'));}}}exports[a22_0x4fea('0xbf')]=SyncPlaylistsService;
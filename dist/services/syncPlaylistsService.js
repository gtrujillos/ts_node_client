var a22_0x48e5=['http','request-progress','spawn','string-template','youtube-dl','uuid/v4','context.json','url-exists','node-kodi','mt-files-downloader','mediaFolder','tempFolder','temp/','filesFolder','files/','playListFile','playlist.txt','lulo_playlist.m3u','downloadFiles','failDownloadFiles','newPlayList','httpClientService','HttpClientService','init','config','readFileSync','context','parse','playerId','baseURL','env','WEB_SERVICE_URL','deploy/','playListServiceURL','api/player_playlist.php?player_id={0}','kodi','lulo','.lulo123.','checkDependencies','registerClient','checkFolders','loadMediaList','getStatus','bind','playlist','getItems','stringify','networkInterfaces','post','http://restapi.lulo.run/player_devices/register','log','register\x20response:\x20','catch','deviceUuid','writeFileSync','player','getCurrentlyPlayingVideo','item','label','reportStatus','http://restapi.lulo.run/player_devices/report_status','reportStatusResponse:\x20','ensureDir','playlistChanged','emptyDirSync','currentFile','push','Total:\x20','length','download','existsSync','m3uFile','removeSync','reboot','Shutdown','toString','this.currentFile:\x20','finishProcess','path','media_type','lastIndexOf','split','slice','join','youtube_single','.mp4','image','**********+','checkVideo','Downloading:\x20','downloadYouTube','downloader','videoFile:\x20','track','media','Video','mediainfo\x20check:','includes','indexOf','downloading:\x20','start','Error:\x20','start:\x20','error','error:\x20','end','Downloaded:\x20','mediaType:\x20','stopped','destroyed','retry','downloadHTTPFile','Attempting\x20to\x20download\x20','Max\x20redirects\x20reached','WARNING\x20downloadFile\x20callback\x20is\x20undefined\x20for\x20','maxSockets','host','pathname','get','\x20Progress:\x20unknown\x09','\x20Progress:\x20','headers','stat','Have\x20already\x20downloaded\x20','size','And\x20the\x20file\x20size\x20matches\x20(','Redownloading','But\x20the\x20file\x20size\x20does\x20not\x20match\x20so\x20re-downloading\x20Old(','data','finish','Downloaded\x20','\x20to\x20','location','Redirect\x20','302','File\x20Not\x20Found\x20','Problem\x20downloading\x20','statusCode','abort','Error\x20Downloading:\x20','duration','video','downloadRequestFile','progress','pipe','1/2','-loop','-pattern_type','-c:v','libx264','-pix_fmt','yuv420p','-vf','scale=1920:1080','stdout','stderr','--format=18','info','Download\x20started','filename:\x20','_filename','size:\x20','finished\x20youtube\x20downloading!','createWriteStream','Finishing','#EXTCPlayListM3U::M3U','#EXTINF:0,luloPlayList','substring','/home/osmc/luloclient/media/files/','copySync','Rebooting..','now','Playlist\x20incomplete,\x20retry.','SyncPlaylistsService','throw','value','then','apply','next','defineProperty','__esModule','node-mediainfo','url'];(function(_0x538128,_0x3acceb){var _0x42f728=function(_0x3a4b56){while(--_0x3a4b56){_0x538128['push'](_0x538128['shift']());}};_0x42f728(++_0x3acceb);}(a22_0x48e5,0x165));var a22_0x36fc=function(_0x21213c,_0x1c24e3){_0x21213c=_0x21213c-0x0;var _0x1d3d0c=a22_0x48e5[_0x21213c];return _0x1d3d0c;};'use strict';var __awaiter=this&&this['__awaiter']||function(_0x51bbef,_0x127ed6,_0x2b0d1f,_0x1e0727){function _0xc17aa8(_0x48ee9b){return _0x48ee9b instanceof _0x2b0d1f?_0x48ee9b:new _0x2b0d1f(function(_0x5c7ef0){_0x5c7ef0(_0x48ee9b);});}return new(_0x2b0d1f||(_0x2b0d1f=Promise))(function(_0x492701,_0x45c6e2){function _0x2c4399(_0x532b26){try{_0x246650(_0x1e0727['next'](_0x532b26));}catch(_0x227896){_0x45c6e2(_0x227896);}}function _0x4f86e1(_0xbca947){try{_0x246650(_0x1e0727[a22_0x36fc('0x0')](_0xbca947));}catch(_0x425ae8){_0x45c6e2(_0x425ae8);}}function _0x246650(_0x83eb2d){_0x83eb2d['done']?_0x492701(_0x83eb2d[a22_0x36fc('0x1')]):_0xc17aa8(_0x83eb2d[a22_0x36fc('0x1')])[a22_0x36fc('0x2')](_0x2c4399,_0x4f86e1);}_0x246650((_0x1e0727=_0x1e0727[a22_0x36fc('0x3')](_0x51bbef,_0x127ed6||[]))[a22_0x36fc('0x4')]());});};Object[a22_0x36fc('0x5')](exports,a22_0x36fc('0x6'),{'value':!![]});const HttpClientService_1=require('../infrastructure/HttpClientService');const mediainfo=require(a22_0x36fc('0x7'));const fs=require('fs');const url=require(a22_0x36fc('0x8'));const http=require(a22_0x36fc('0x9'));const fsExtra=require('fs-extra');const request=require('request');const progress=require(a22_0x36fc('0xa'));const spawn=require('child_process')[a22_0x36fc('0xb')];const isImage=require('is-image');const format=require(a22_0x36fc('0xc'));const os=require('os');const youtubedl=require(a22_0x36fc('0xd'));const uuidv4=require(a22_0x36fc('0xe'));const configFile='config.json';const contextFile=a22_0x36fc('0xf');const urlExists=require(a22_0x36fc('0x10'));const kodi_rpc=require(a22_0x36fc('0x11'));const Downloader=require(a22_0x36fc('0x12'));class SyncPlaylistsService{constructor(){this[a22_0x36fc('0x13')]='media/';this[a22_0x36fc('0x14')]=this[a22_0x36fc('0x13')]+a22_0x36fc('0x15');this[a22_0x36fc('0x16')]=this[a22_0x36fc('0x13')]+a22_0x36fc('0x17');this[a22_0x36fc('0x18')]=this[a22_0x36fc('0x13')]+a22_0x36fc('0x19');this['m3uFile']=this[a22_0x36fc('0x16')]+a22_0x36fc('0x1a');this['currentFile']=0x0;this['playlistChanged']=![];this[a22_0x36fc('0x1b')]=[];this[a22_0x36fc('0x1c')]=[];this[a22_0x36fc('0x1d')]={};this[a22_0x36fc('0x1e')]=new HttpClientService_1[(a22_0x36fc('0x1f'))]();}[a22_0x36fc('0x20')](){this[a22_0x36fc('0x21')]=JSON['parse'](fs[a22_0x36fc('0x22')](configFile));this[a22_0x36fc('0x23')]=JSON[a22_0x36fc('0x24')](fs[a22_0x36fc('0x22')](contextFile));this[a22_0x36fc('0x25')]=this['config'][a22_0x36fc('0x25')];this[a22_0x36fc('0x26')]=process[a22_0x36fc('0x27')][a22_0x36fc('0x28')]+a22_0x36fc('0x29');this[a22_0x36fc('0x2a')]=this[a22_0x36fc('0x26')]+a22_0x36fc('0x2b');this[a22_0x36fc('0x2c')]=new kodi_rpc({'url':'http://localhost','user':a22_0x36fc('0x2d'),'password':a22_0x36fc('0x2e')});this[a22_0x36fc('0x2f')]();this[a22_0x36fc('0x30')]();this[a22_0x36fc('0x31')]();this[a22_0x36fc('0x32')]();setInterval(function(){this[a22_0x36fc('0x33')]();}[a22_0x36fc('0x34')](this),0x2710);setInterval(function(){this['registerClient']();}[a22_0x36fc('0x34')](this),0x493e0);}['checkDependencies'](){}[a22_0x36fc('0x30')](){this[a22_0x36fc('0x2c')][a22_0x36fc('0x35')][a22_0x36fc('0x36')](0x1)[a22_0x36fc('0x2')](function(_0x57b216){const _0x743974=JSON[a22_0x36fc('0x37')](_0x57b216);const _0x4f3d30={'player_id':this['playerId'],'device_uuid':this[a22_0x36fc('0x21')]['deviceUuid'],'network_info':JSON[a22_0x36fc('0x37')](os[a22_0x36fc('0x38')]()),'firmware_info':JSON[a22_0x36fc('0x37')](this[a22_0x36fc('0x23')]),'playlist':_0x743974,'playing_item':'','status':0x0};this[a22_0x36fc('0x1e')][a22_0x36fc('0x39')](a22_0x36fc('0x3a'),_0x4f3d30,![])['then'](function(_0x4861d1){console[a22_0x36fc('0x3b')](a22_0x36fc('0x3c')+Date());})[a22_0x36fc('0x3d')](function(_0x2f1c49){});console[a22_0x36fc('0x3b')](_0x4f3d30);}[a22_0x36fc('0x34')](this));const _0x2e6e15=this[a22_0x36fc('0x21')][a22_0x36fc('0x3e')];if(!_0x2e6e15||_0x2e6e15==''){this[a22_0x36fc('0x21')][a22_0x36fc('0x3e')]=uuidv4();this[a22_0x36fc('0x21')]={'deviceUuid':this['config'][a22_0x36fc('0x3e')],'playerId':this[a22_0x36fc('0x21')]['playerId']};fs[a22_0x36fc('0x3f')](configFile,JSON['stringify'](this[a22_0x36fc('0x21')]));}}[a22_0x36fc('0x33')](){console[a22_0x36fc('0x3b')](a22_0x36fc('0x33'));this['kodi'][a22_0x36fc('0x40')][a22_0x36fc('0x41')]()['then'](function(_0x53fb10){const _0x1d380a=_0x53fb10[a22_0x36fc('0x42')][a22_0x36fc('0x43')];this[a22_0x36fc('0x44')](_0x1d380a);}['bind'](this))[a22_0x36fc('0x3d')](function(_0x5490bb){console[a22_0x36fc('0x3b')](_0x5490bb);this['reportStatus'](_0x5490bb);}[a22_0x36fc('0x34')](this));}[a22_0x36fc('0x44')](_0x4bad03){console[a22_0x36fc('0x3b')]('playingItem:\x20'+_0x4bad03);const _0x593fb0={'player_id':this['playerId'],'device_uuid':this['config'][a22_0x36fc('0x3e')],'status':_0x4bad03!=''&&_0x4bad03!=null?0x1:0x0,'playing_item':_0x4bad03};this['httpClientService']['post'](a22_0x36fc('0x45'),_0x593fb0,![])[a22_0x36fc('0x2')](function(_0x4384de){console['log'](a22_0x36fc('0x46')+Date());})[a22_0x36fc('0x3d')](function(_0x5b8e4a){});}[a22_0x36fc('0x31')](){fsExtra['ensureDir'](this[a22_0x36fc('0x13')],_0x1ce3e0=>{});fsExtra['ensureDir'](this[a22_0x36fc('0x14')],_0x5206c7=>{});fsExtra[a22_0x36fc('0x47')](this[a22_0x36fc('0x16')],_0x1f483c=>{});}[a22_0x36fc('0x32')](){const _0x5221d8=format(this['playListServiceURL'],this[a22_0x36fc('0x25')]);console['log'](_0x5221d8);request({'url':_0x5221d8,'json':!![]},function(_0x1670f8,_0xd384a3,_0x26ef23){console[a22_0x36fc('0x3b')]('loadMediaList:\x20');console[a22_0x36fc('0x3b')](_0x26ef23);this[a22_0x36fc('0x1d')]=_0x26ef23;this[a22_0x36fc('0x48')]=this['hasPlayListChanged']();fsExtra[a22_0x36fc('0x49')](this['tempFolder']);this[a22_0x36fc('0x1b')]=[];this[a22_0x36fc('0x1c')]=[];this[a22_0x36fc('0x4a')]=0x0;for(const _0x5b81f6 in _0x26ef23){this[a22_0x36fc('0x1b')][a22_0x36fc('0x4b')](_0x26ef23[_0x5b81f6]);}console[a22_0x36fc('0x3b')](a22_0x36fc('0x4c')+this[a22_0x36fc('0x1b')][a22_0x36fc('0x4d')]);if(this[a22_0x36fc('0x1b')]['length']>0x0){this[a22_0x36fc('0x4e')]();}}['bind'](this));}['reloadMediaList'](){if(fsExtra[a22_0x36fc('0x4f')](this[a22_0x36fc('0x14')])){fsExtra[a22_0x36fc('0x49')](this[a22_0x36fc('0x14')]);}if(fsExtra[a22_0x36fc('0x4f')](this[a22_0x36fc('0x18')])){fsExtra['emptyDirSync'](this[a22_0x36fc('0x18')]);}if(!fsExtra[a22_0x36fc('0x4f')](this[a22_0x36fc('0x18')])){fsExtra['removeSync'](this[a22_0x36fc('0x18')]);}if(!fsExtra['existsSync'](this[a22_0x36fc('0x50')])){fsExtra[a22_0x36fc('0x51')](this[a22_0x36fc('0x50')]);}this[a22_0x36fc('0x32')]();}[a22_0x36fc('0x52')](){this[a22_0x36fc('0x2c')]['System'][a22_0x36fc('0x53')]();}['hasPlayListChanged'](){const _0x5cfe5f=JSON[a22_0x36fc('0x37')](this[a22_0x36fc('0x1d')]);try{if(!fsExtra[a22_0x36fc('0x4f')](this[a22_0x36fc('0x18')])){return!![];}else{const _0x1bc181=fsExtra[a22_0x36fc('0x22')](this[a22_0x36fc('0x18')])[a22_0x36fc('0x54')]();if(_0x1bc181!=_0x5cfe5f){return!![];}}}catch(_0x42c35d){console['log'](_0x42c35d);}return![];}[a22_0x36fc('0x4e')](){console[a22_0x36fc('0x3b')](a22_0x36fc('0x55')+this[a22_0x36fc('0x4a')]+'\x20of\x20'+this[a22_0x36fc('0x1b')][a22_0x36fc('0x4d')]);if(this[a22_0x36fc('0x4a')]>=this[a22_0x36fc('0x1b')][a22_0x36fc('0x4d')]){this[a22_0x36fc('0x56')]();return;}const _0xc625df=String(this[a22_0x36fc('0x1b')][this[a22_0x36fc('0x4a')]][a22_0x36fc('0x57')]);const _0x1d9782=this[a22_0x36fc('0x1b')][this['currentFile']][a22_0x36fc('0x58')];let _0x3aee59=_0xc625df['substring'](_0xc625df[a22_0x36fc('0x59')]('/')+0x1);const _0x3a7e8b=_0x3aee59[a22_0x36fc('0x5a')]('.')['slice'](0x0,-0x1)['join']('.');let _0x2d66b6=this[a22_0x36fc('0x26')]+_0xc625df;const _0x45224a=_0x2d66b6[a22_0x36fc('0x5a')]('.')[a22_0x36fc('0x5b')](0x0,-0x1)[a22_0x36fc('0x5c')]('.');if(_0x1d9782==a22_0x36fc('0x5d')){_0x3aee59=_0x3aee59+a22_0x36fc('0x5e');}else if(_0x1d9782==a22_0x36fc('0x5f')){_0x3aee59=_0x3a7e8b+'.mp4';_0x2d66b6=_0x45224a+'.mp4';}console[a22_0x36fc('0x3b')]('**********+');console[a22_0x36fc('0x3b')](_0xc625df);console[a22_0x36fc('0x3b')](_0x1d9782);console[a22_0x36fc('0x3b')](_0x3aee59);console[a22_0x36fc('0x3b')](_0x2d66b6);console[a22_0x36fc('0x3b')](_0x3a7e8b);console['log'](_0x45224a);console[a22_0x36fc('0x3b')](a22_0x36fc('0x60'));if(fsExtra['existsSync'](this['tempFolder']+_0x3aee59)){this[a22_0x36fc('0x61')](this['tempFolder']+_0x3aee59)['then'](function(_0x10ea1c){if(_0x10ea1c){this[a22_0x36fc('0x4a')]++;}else{this[a22_0x36fc('0x48')]=!![];}this['download']();}[a22_0x36fc('0x34')](this));}else if(fsExtra[a22_0x36fc('0x4f')](this['filesFolder']+_0x3aee59)){this['checkVideo'](this[a22_0x36fc('0x16')]+_0x3aee59)[a22_0x36fc('0x2')](function(_0x5c01fd){if(_0x5c01fd){fsExtra['copySync'](this[a22_0x36fc('0x16')]+_0x3aee59,this['tempFolder']+_0x3aee59);this['currentFile']++;}else{this['playlistChanged']=!![];}this[a22_0x36fc('0x4e')]();}[a22_0x36fc('0x34')](this));}else{console[a22_0x36fc('0x3b')](a22_0x36fc('0x62')+_0x2d66b6);this[a22_0x36fc('0x48')]=!![];if(_0x1d9782==a22_0x36fc('0x5d')){this[a22_0x36fc('0x63')](_0xc625df);}else{this[a22_0x36fc('0x64')](_0x2d66b6,_0x3aee59,_0x1d9782);}}}[a22_0x36fc('0x61')](_0x464b0c){return __awaiter(this,void 0x0,void 0x0,function*(){console['log'](a22_0x36fc('0x65')+_0x464b0c);const _0x41a836=yield mediainfo(_0x464b0c)[a22_0x36fc('0x3d')](_0x3a2509=>{console[a22_0x36fc('0x3b')](_0x3a2509);fsExtra['removeSync'](_0x464b0c);return![];});const _0x42f39f=_0x41a836['media'][a22_0x36fc('0x66')][a22_0x36fc('0x4d')]>0x1&&_0x41a836[a22_0x36fc('0x67')][a22_0x36fc('0x66')][0x1]['@type']==a22_0x36fc('0x68');if(!_0x42f39f){fsExtra['removeSync'](_0x464b0c);}console[a22_0x36fc('0x3b')](a22_0x36fc('0x69')+_0x42f39f);return _0x42f39f;});}[a22_0x36fc('0x64')](_0x1aba9f,_0x2e43ae,_0x44dac6){const _0x177c1e=new Downloader();console[a22_0x36fc('0x3b')](_0x1aba9f);console['log'](_0x2e43ae);console['log'](_0x44dac6);const _0x104148=_0x177c1e[a22_0x36fc('0x4e')](_0x1aba9f,this[a22_0x36fc('0x14')]+_0x2e43ae);urlExists(_0x1aba9f,function(_0x5ced24,_0x26054b){if(_0x26054b){if(this[a22_0x36fc('0x1c')][a22_0x36fc('0x6a')](this[a22_0x36fc('0x4a')])){const _0x29c1d4=this['failDownloadFiles'][a22_0x36fc('0x6b')](this[a22_0x36fc('0x4a')]);if(_0x29c1d4>-0x1){this[a22_0x36fc('0x1c')]['splice'](_0x29c1d4,0x1);}}console['log'](a22_0x36fc('0x6c')+_0x1aba9f);_0x104148[a22_0x36fc('0x6d')]();}else{if(!this['failDownloadFiles'][a22_0x36fc('0x6a')](this[a22_0x36fc('0x4a')])){this[a22_0x36fc('0x1c')]['push'](this['currentFile']);}console[a22_0x36fc('0x3b')](a22_0x36fc('0x6e')+_0x1aba9f);this[a22_0x36fc('0x4a')]++;this[a22_0x36fc('0x4e')]();}}[a22_0x36fc('0x34')](this));_0x104148['on']('start',function(_0x104148){console['log'](a22_0x36fc('0x6f')+_0x1aba9f);});_0x104148['on'](a22_0x36fc('0x70'),function(_0x104148){console['log'](a22_0x36fc('0x71'));this[a22_0x36fc('0x4e')]();}[a22_0x36fc('0x34')](this));_0x104148['on'](a22_0x36fc('0x72'),function(_0x104148){console[a22_0x36fc('0x3b')]('end');console[a22_0x36fc('0x3b')](a22_0x36fc('0x73')+_0x2e43ae);console['log'](a22_0x36fc('0x74')+_0x44dac6);this[a22_0x36fc('0x61')](this[a22_0x36fc('0x14')]+_0x2e43ae)[a22_0x36fc('0x2')](function(_0x5401d6){if(_0x5401d6){this['currentFile']++;}this[a22_0x36fc('0x4e')]();}[a22_0x36fc('0x34')](this));}[a22_0x36fc('0x34')](this));_0x104148['on'](a22_0x36fc('0x75'),function(_0x104148){console[a22_0x36fc('0x3b')]('stopped');});_0x104148['on'](a22_0x36fc('0x76'),function(_0x104148){console[a22_0x36fc('0x3b')](a22_0x36fc('0x76'));});_0x104148['on']('retry',function(_0x104148){console[a22_0x36fc('0x3b')](a22_0x36fc('0x77'));});}[a22_0x36fc('0x78')](_0x2e9ed9,_0x48f1a0,_0x4bfee7,_0x73d2fd){console[a22_0x36fc('0x3b')]('downloadHTTPFile');console[a22_0x36fc('0x3b')](_0x2e9ed9);const _0x1ae8d5=!![];let _0x330cdc=0x0;const _0x334154='';console[a22_0x36fc('0x3b')](a22_0x36fc('0x79')+_0x2e9ed9+'\x20to\x20'+_0x48f1a0);if(_0x330cdc){if(_0x330cdc>0x5){_0x73d2fd(a22_0x36fc('0x7a'),_0x2e9ed9,_0x4bfee7,null);return;}}else{_0x330cdc=0x0;}const _0x3fec2b=this[a22_0x36fc('0x14')]+_0x48f1a0;let _0xd22ce3;if(_0x73d2fd===undefined){console[a22_0x36fc('0x3b')](a22_0x36fc('0x7b')+_0x2e9ed9+'\x20to\x20'+_0x3fec2b);_0x73d2fd=function(_0x514272,_0x39c646){console[a22_0x36fc('0x3b')]('downloadFile\x20callback\x20result\x20undefined:\x20',_0x514272,_0x39c646);};}http['globalAgent'][a22_0x36fc('0x7c')]=0x64;const _0x12098a={'host':url['parse'](_0x2e9ed9)[a22_0x36fc('0x7d')],'port':0x50,'path':url[a22_0x36fc('0x24')](_0x2e9ed9)[a22_0x36fc('0x7e')],'agent':![]};const _0xb5a5cb=http[a22_0x36fc('0x7f')](_0x12098a,function(_0x3c2f03){let _0x2c5249=0x0;let _0x4cf84f=0x0;function _0x4f75b8(){if(_0x2c5249===undefined){console[a22_0x36fc('0x3b')](_0x48f1a0+a22_0x36fc('0x80')+_0x4cf84f+'/'+'?');}const _0x1b187c=_0x4cf84f/_0x2c5249*0x64;console['log'](_0x48f1a0+a22_0x36fc('0x81')+_0x1b187c+'%\x09'+_0x4cf84f+'/'+_0x2c5249);}console[a22_0x36fc('0x3b')](_0x48f1a0+'\x20'+_0x3c2f03['statusCode']);switch(_0x3c2f03['statusCode']){case 0xc8:_0x2c5249=_0x3c2f03[a22_0x36fc('0x82')]['content-length']||_0x334154;fs[a22_0x36fc('0x83')](_0x3fec2b,function(_0x38beff,_0x2ea686){if(!_0x38beff){console[a22_0x36fc('0x3b')](a22_0x36fc('0x84')+_0x3fec2b);if(_0x2ea686[a22_0x36fc('0x85')]==_0x2c5249){console[a22_0x36fc('0x3b')](a22_0x36fc('0x86')+_0x2c5249+')');console['log'](a22_0x36fc('0x87'));}else{console['log'](a22_0x36fc('0x88')+_0x2ea686[a22_0x36fc('0x85')]+')\x20vs\x20New('+_0x2c5249+')');}}_0xd22ce3=fs['createWriteStream'](_0x3fec2b);_0x3c2f03['pipe'](_0xd22ce3);_0x3c2f03['on'](a22_0x36fc('0x89'),function(_0x34e416){_0x4cf84f+=_0x34e416['length'];_0x4f75b8();});_0xb5a5cb['on'](a22_0x36fc('0x70'),function(_0x38beff){console[a22_0x36fc('0x3b')]('err:\x20');console[a22_0x36fc('0x3b')](_0x38beff);});_0xd22ce3['on'](a22_0x36fc('0x8a'),function(){console['log'](a22_0x36fc('0x8b')+_0x2e9ed9+a22_0x36fc('0x8c')+_0x48f1a0);_0x73d2fd(null,_0x48f1a0,_0x4bfee7,_0x48f1a0);}[a22_0x36fc('0x34')](this));});break;case 0x12e:const _0x2894c4=_0x3c2f03[a22_0x36fc('0x82')][a22_0x36fc('0x8d')];console[a22_0x36fc('0x3b')](a22_0x36fc('0x8e')+_0x2e9ed9+a22_0x36fc('0x8c')+_0x2894c4);if(_0x330cdc<0x5){this[a22_0x36fc('0x78')](_0x2894c4,_0x48f1a0,_0x73d2fd,_0x330cdc++);}else{console[a22_0x36fc('0x70')]('Redirect\x20limit\x20encountered\x20for\x20'+_0x2e9ed9+'.');_0x73d2fd(a22_0x36fc('0x8f'),null,null,null);}return;case 0x194:console['log'](a22_0x36fc('0x90')+_0x2e9ed9);default:console[a22_0x36fc('0x3b')](a22_0x36fc('0x91')+_0x2e9ed9+'\x20STATUS:\x20'+_0x3c2f03[a22_0x36fc('0x92')]);_0xb5a5cb[a22_0x36fc('0x93')]();_0x73d2fd(_0x3c2f03[a22_0x36fc('0x92')],null,null,null);return;}})['on'](a22_0x36fc('0x70'),function(_0x349f73){console['log'](a22_0x36fc('0x94')+_0x2e9ed9+'\x20'+_0x349f73['message']);_0x73d2fd(_0x349f73,null,null,null);});}['downloadHTTPFileCallback'](_0x1aeb25,_0x15319e,_0x4db130,_0x5b9495){console[a22_0x36fc('0x3b')]('downloadHTTPFileCallback');console[a22_0x36fc('0x3b')](_0x1aeb25);console[a22_0x36fc('0x3b')](_0x15319e);console[a22_0x36fc('0x3b')](_0x4db130);console[a22_0x36fc('0x3b')](_0x5b9495);if(_0x4db130==a22_0x36fc('0x5f')){const _0x46bc3d=this[a22_0x36fc('0x1b')][this[a22_0x36fc('0x4a')]]['duration']!=null?this['downloadFiles'][this[a22_0x36fc('0x4a')]][a22_0x36fc('0x95')]:0x1e;this['createImageVideo'](_0x5b9495,_0x46bc3d);}else if(_0x4db130==a22_0x36fc('0x96')){if(_0x1aeb25==null&&_0x15319e!=''){this[a22_0x36fc('0x4a')]++;}this[a22_0x36fc('0x4e')]();}console['log'](this[a22_0x36fc('0x4a')]);}[a22_0x36fc('0x97')](_0x45a8d8,_0x3c7de8,_0x3d8a18){progress(request(_0x45a8d8),{})['on'](a22_0x36fc('0x98'),function(_0x3d4495){console[a22_0x36fc('0x3b')](_0x3d4495);})['on'](a22_0x36fc('0x70'),function(_0x539e91){console['log']('Error\x20downloading\x20file');this[a22_0x36fc('0x4e')]();})['on'](a22_0x36fc('0x72'),function(){console[a22_0x36fc('0x3b')](a22_0x36fc('0x73')+_0x3c7de8);console[a22_0x36fc('0x3b')](a22_0x36fc('0x74')+_0x3d8a18);if(_0x3d8a18==a22_0x36fc('0x5f')){const _0x3017f3=this['downloadFiles'][this[a22_0x36fc('0x4a')]]['duration']!=null?this[a22_0x36fc('0x1b')][this['currentFile']]['duration']:0x1e;this['createImageVideo'](_0x3c7de8,_0x3017f3);}else if(_0x3d8a18==a22_0x36fc('0x96')){this['currentFile']++;this[a22_0x36fc('0x4e')]();}}[a22_0x36fc('0x34')](this))[a22_0x36fc('0x99')](fs['createWriteStream'](this[a22_0x36fc('0x14')]+_0x3c7de8));}['createImageVideo'](_0x4a1d7d,_0x2a73ed=0x1e){const _0x12bfb6=this[a22_0x36fc('0x14')]+_0x4a1d7d;console[a22_0x36fc('0x3b')](_0x12bfb6);console['log'](_0x4a1d7d);const _0x316a75=_0x4a1d7d[a22_0x36fc('0x5a')]('.')[a22_0x36fc('0x5b')](0x0,-0x1)[a22_0x36fc('0x5c')]('.');const _0x4bb4a0='ffmpeg';const _0x91af7b=['-y','-r',a22_0x36fc('0x9a'),a22_0x36fc('0x9b'),'1',a22_0x36fc('0x9c'),'glob','-i',_0x12bfb6,'-t',String(_0x2a73ed),a22_0x36fc('0x9d'),a22_0x36fc('0x9e'),a22_0x36fc('0x9f'),a22_0x36fc('0xa0'),'-r','25',a22_0x36fc('0xa1'),a22_0x36fc('0xa2'),this[a22_0x36fc('0x14')]+_0x316a75+a22_0x36fc('0x5e')];const _0x228d19=spawn(_0x4bb4a0,_0x91af7b);_0x228d19[a22_0x36fc('0xa3')]['on'](a22_0x36fc('0x89'),function(_0x2eccbe){console[a22_0x36fc('0x3b')]('Converting\x20'+_0x12bfb6);});_0x228d19[a22_0x36fc('0xa4')]['on'](a22_0x36fc('0x89'),function(_0x94a977){console[a22_0x36fc('0x3b')]('stderr:\x20'+_0x94a977);}[a22_0x36fc('0x34')](this));_0x228d19['on']('close',function(){console[a22_0x36fc('0x3b')]('finished\x20mp4\x20convert');this[a22_0x36fc('0x4a')]++;this[a22_0x36fc('0x4e')]();}['bind'](this));}[a22_0x36fc('0x63')](_0x2aa81e){const _0x4f5749=this['tempFolder']+'/'+_0x2aa81e+a22_0x36fc('0x5e');const _0x2442fb=youtubedl('http://www.youtube.com/watch?v='+_0x2aa81e,[a22_0x36fc('0xa5')],{'cwd':__dirname});_0x2442fb['on'](a22_0x36fc('0xa6'),function(_0x86e163){console[a22_0x36fc('0x3b')](a22_0x36fc('0xa7'));console[a22_0x36fc('0x3b')](a22_0x36fc('0xa8')+_0x86e163[a22_0x36fc('0xa9')]);console[a22_0x36fc('0x3b')](a22_0x36fc('0xaa')+_0x86e163['size']);});_0x2442fb['on']('complete',function complete(_0x3cdf89){'use strict';console[a22_0x36fc('0x3b')](a22_0x36fc('0xa8')+_0x3cdf89[a22_0x36fc('0xa9')]+'\x20already\x20downloaded.');});_0x2442fb['on'](a22_0x36fc('0x72'),function(){console['log'](a22_0x36fc('0xab'));this[a22_0x36fc('0x61')](_0x4f5749)[a22_0x36fc('0x2')](function(_0x34fb30){if(_0x34fb30){this['currentFile']++;}this['download']();}[a22_0x36fc('0x34')](this));}[a22_0x36fc('0x34')](this));_0x2442fb[a22_0x36fc('0x99')](fs[a22_0x36fc('0xac')](_0x4f5749));}[a22_0x36fc('0x56')](){console[a22_0x36fc('0x3b')](a22_0x36fc('0xad'));if(this[a22_0x36fc('0x48')]){if(this['failDownloadFiles'][a22_0x36fc('0x4d')]==0x0){fs[a22_0x36fc('0x3f')](this[a22_0x36fc('0x18')],JSON[a22_0x36fc('0x37')](this['newPlayList']));let _0x5b1981=a22_0x36fc('0xae')+'\x0d\x0a'+a22_0x36fc('0xaf')+'\x0d\x0a';for(const _0x3d9d5d in this[a22_0x36fc('0x1b')]){const _0x41ac04=this[a22_0x36fc('0x1b')][_0x3d9d5d]['path'];const _0x2d14f4=this[a22_0x36fc('0x1b')][_0x3d9d5d]['media_type'];const _0x3103e8=_0x41ac04[a22_0x36fc('0xb0')](_0x41ac04[a22_0x36fc('0x59')]('/')+0x1);let _0x5c58ab=_0x3103e8[a22_0x36fc('0x5a')]('.')[a22_0x36fc('0x5b')](0x0,-0x1)[a22_0x36fc('0x5c')]('.');if(_0x2d14f4==a22_0x36fc('0x5d')){_0x5c58ab=_0x41ac04;}_0x5b1981+=a22_0x36fc('0xb1')+_0x5c58ab+a22_0x36fc('0x5e')+'\x0d\x0a';}fsExtra[a22_0x36fc('0x49')](this[a22_0x36fc('0x16')]);fsExtra[a22_0x36fc('0xb2')](this[a22_0x36fc('0x14')],this[a22_0x36fc('0x16')]);fsExtra['writeFileSync'](this[a22_0x36fc('0x50')],_0x5b1981);fsExtra['emptyDirSync'](this[a22_0x36fc('0x14')]);console[a22_0x36fc('0x3b')](a22_0x36fc('0xb3'));const _0xd27792=spawn('shutdown',['-r',a22_0x36fc('0xb4')]);}else{console['log'](a22_0x36fc('0xb5'));this['currentFile']=0x0;setTimeout(function(){this[a22_0x36fc('0x4e')]();}[a22_0x36fc('0x34')](this),0x1388);}}else{console[a22_0x36fc('0x3b')]('No\x20playlist\x20changes.');}}}exports[a22_0x36fc('0xb6')]=SyncPlaylistsService;
var a22_0x9a92=['url-exists','node-kodi','mt-files-downloader','media/','mediaFolder','files/','playListFile','filesFolder','lulo_playlist.m3u','playlistChanged','downloadFiles','failDownloadFiles','newPlayList','kodiUser','lulo','kodiPassword','httpClientService','HttpClientService','init','config','parse','readFileSync','context','playerId','baseURL','env','WEB_SERVICE_URL','playListServiceURL','api/player_playlist.php?player_id={0}','playerServiceURL','api/player.php?player_id={0}','kodi','kodiHost','checkDependencies','registerClient','checkFolders','loadMediaList','getStatus','bind','getItems','stringify','post','register\x20response:\x20','catch','log','deviceUuid','writeFileSync','player','getCurrentlyPlayingVideo','item','label','reportStatus','reportStatusResponse:\x20','ensureDir','tempFolder','loadMediaList:\x20','hasPlayListChanged','emptyDirSync','currentFile','push','Total:\x20','length','download','reloadMediaList','existsSync','removeSync','m3uFile','toString','this.currentFile:\x20','media_type','substring','slice','join','split','youtube_single','.mp4','**********+','checkVideo','copySync','downloadYouTube','downloader','videoFile:\x20','media','track','Video','mediainfo\x20check:','includes','indexOf','splice','downloading:\x20','Error:\x20','start:\x20','error','error:\x20','end','Downloaded:\x20','stopped','destroyed','downloadHTTPFile','Attempting\x20to\x20download\x20','\x20to\x20','downloadFile\x20callback\x20result\x20undefined:\x20','maxSockets','host','pathname','get','\x20Progress:\x20unknown\x09','\x20Progress:\x20','statusCode','stat','Have\x20already\x20downloaded\x20','size','But\x20the\x20file\x20size\x20does\x20not\x20match\x20so\x20re-downloading\x20Old(',')\x20vs\x20New(','createWriteStream','pipe','Redirect\x20','302','File\x20Not\x20Found\x20','Problem\x20downloading\x20','Error\x20Downloading:\x20','message','downloadHTTPFileCallback','duration','downloadRequestFile','progress','Error\x20downloading\x20file','mediaType:\x20','video','createImageVideo','-pattern_type','glob','-c:v','libx264','-pix_fmt','yuv420p','scale=1920:1080','stdout','Converting\x20','data','stderr:\x20','finished\x20mp4\x20convert','--format=18','Download\x20started','filename:\x20','_filename','size:\x20','complete','finished\x20youtube\x20downloading!','finishProcess','Finishing','#EXTINF:0,luloPlayList','path','/home/osmc/luloclient/media/files/','Refreshing..','refreshPlayer','jsonrpcClient','Playlist.Clear','Playlist.Cleared','Playlist.Add','Playlist.Added','Player.Open','Playlist.Opened','reboot','updateSettings','rss','header_active','setRss','/home/osmc/.kodi/userdata/RssFeeds.xml','xmlContent:\x20','xml2js','parseString','result:\x20%j','none','rssfeeds','feed','buildObject','xml:\x20%j','kodi-send\x20--action=\x22RefreshRSS()\x22','Settings.SetSettingValue','enableClock','enableClock:\x20','2.0','SyncPlaylistsService','__awaiter','throw','value','then','apply','__esModule','url','http','request-progress','child_process','exec','is-image','string-template','uuid/v4','context.json'];(function(_0x3562b5,_0x22dabc){var _0x54d52d=function(_0x27bd3d){while(--_0x27bd3d){_0x3562b5['push'](_0x3562b5['shift']());}};_0x54d52d(++_0x22dabc);}(a22_0x9a92,0xb8));var a22_0xfdc0=function(_0x322ac7,_0xcc5665){_0x322ac7=_0x322ac7-0x0;var _0x571e97=a22_0x9a92[_0x322ac7];return _0x571e97;};'use strict';var __awaiter=this&&this[a22_0xfdc0('0x0')]||function(_0x262194,_0x3701a9,_0x331c1f,_0x1ac1ef){function _0x22b269(_0xd3e56c){return _0xd3e56c instanceof _0x331c1f?_0xd3e56c:new _0x331c1f(function(_0x56a3df){_0x56a3df(_0xd3e56c);});}return new(_0x331c1f||(_0x331c1f=Promise))(function(_0x30c57f,_0x149a36){function _0x3e0862(_0x997da1){try{_0x3380c8(_0x1ac1ef['next'](_0x997da1));}catch(_0x3aa68d){_0x149a36(_0x3aa68d);}}function _0x4e259d(_0x2884c3){try{_0x3380c8(_0x1ac1ef[a22_0xfdc0('0x1')](_0x2884c3));}catch(_0x8da833){_0x149a36(_0x8da833);}}function _0x3380c8(_0x4db839){_0x4db839['done']?_0x30c57f(_0x4db839['value']):_0x22b269(_0x4db839[a22_0xfdc0('0x2')])[a22_0xfdc0('0x3')](_0x3e0862,_0x4e259d);}_0x3380c8((_0x1ac1ef=_0x1ac1ef[a22_0xfdc0('0x4')](_0x262194,_0x3701a9||[]))['next']());});};Object['defineProperty'](exports,a22_0xfdc0('0x5'),{'value':!![]});const HttpClientService_1=require('../infrastructure/HttpClientService');const mediainfo=require('node-mediainfo');const fs=require('fs');const url=require(a22_0xfdc0('0x6'));const http=require(a22_0xfdc0('0x7'));const fsExtra=require('fs-extra');const request=require('request');const progress=require(a22_0xfdc0('0x8'));const spawn=require(a22_0xfdc0('0x9'))['spawn'];const exec=require(a22_0xfdc0('0x9'))[a22_0xfdc0('0xa')];const isImage=require(a22_0xfdc0('0xb'));const format=require(a22_0xfdc0('0xc'));const os=require('os');const youtubedl=require('youtube-dl');const uuidv4=require(a22_0xfdc0('0xd'));const configFile='config.json';const contextFile=a22_0xfdc0('0xe');const urlExists=require(a22_0xfdc0('0xf'));const kodi_rpc=require(a22_0xfdc0('0x10'));const Downloader=require(a22_0xfdc0('0x11'));class SyncPlaylistsService{constructor(){this['mediaFolder']=a22_0xfdc0('0x12');this['tempFolder']=this[a22_0xfdc0('0x13')]+'temp/';this['filesFolder']=this[a22_0xfdc0('0x13')]+a22_0xfdc0('0x14');this[a22_0xfdc0('0x15')]=this['mediaFolder']+'playlist.txt';this['m3uFile']=this[a22_0xfdc0('0x16')]+a22_0xfdc0('0x17');this['currentFile']=0x0;this[a22_0xfdc0('0x18')]=![];this[a22_0xfdc0('0x19')]=[];this[a22_0xfdc0('0x1a')]=[];this[a22_0xfdc0('0x1b')]={};this['kodiHost']='http://localhost';this[a22_0xfdc0('0x1c')]=a22_0xfdc0('0x1d');this[a22_0xfdc0('0x1e')]='.lulo123.';this[a22_0xfdc0('0x1f')]=new HttpClientService_1[(a22_0xfdc0('0x20'))]();}[a22_0xfdc0('0x21')](){this[a22_0xfdc0('0x22')]=JSON[a22_0xfdc0('0x23')](fs[a22_0xfdc0('0x24')](configFile));this[a22_0xfdc0('0x25')]=JSON[a22_0xfdc0('0x23')](fs[a22_0xfdc0('0x24')](contextFile));this['playerId']=this[a22_0xfdc0('0x22')][a22_0xfdc0('0x26')];this[a22_0xfdc0('0x27')]=process[a22_0xfdc0('0x28')][a22_0xfdc0('0x29')]+'deploy/';this[a22_0xfdc0('0x2a')]=this[a22_0xfdc0('0x27')]+a22_0xfdc0('0x2b');this[a22_0xfdc0('0x2c')]=this['baseURL']+a22_0xfdc0('0x2d');this[a22_0xfdc0('0x2e')]=new kodi_rpc({'url':this[a22_0xfdc0('0x2f')],'user':this['kodiUser'],'password':this[a22_0xfdc0('0x1e')]});this[a22_0xfdc0('0x30')]();this[a22_0xfdc0('0x31')]();this[a22_0xfdc0('0x32')]();this[a22_0xfdc0('0x33')]();setInterval(function(){this[a22_0xfdc0('0x34')]();}[a22_0xfdc0('0x35')](this),0x2710);setInterval(function(){this[a22_0xfdc0('0x31')]();}[a22_0xfdc0('0x35')](this),0x493e0);}[a22_0xfdc0('0x30')](){}[a22_0xfdc0('0x31')](){this[a22_0xfdc0('0x2e')]['playlist'][a22_0xfdc0('0x36')](0x1)[a22_0xfdc0('0x3')](function(_0x526b58){const _0x4fcd9e=JSON[a22_0xfdc0('0x37')](_0x526b58);const _0xef71d9={'player_id':this[a22_0xfdc0('0x26')],'device_uuid':this[a22_0xfdc0('0x22')]['deviceUuid'],'network_info':JSON[a22_0xfdc0('0x37')](os['networkInterfaces']()),'firmware_info':JSON[a22_0xfdc0('0x37')](this[a22_0xfdc0('0x25')]),'playlist':_0x4fcd9e,'playing_item':'','status':0x0};this[a22_0xfdc0('0x1f')][a22_0xfdc0('0x38')]('http://restapi.lulo.run/player_devices/register',_0xef71d9,![])[a22_0xfdc0('0x3')](function(_0x9a010a){console['log'](a22_0xfdc0('0x39')+Date());})[a22_0xfdc0('0x3a')](function(_0x47c834){});console[a22_0xfdc0('0x3b')](_0xef71d9);}[a22_0xfdc0('0x35')](this));const _0x5216ad=this[a22_0xfdc0('0x22')][a22_0xfdc0('0x3c')];if(!_0x5216ad||_0x5216ad==''){this[a22_0xfdc0('0x22')][a22_0xfdc0('0x3c')]=uuidv4();this['config']={'deviceUuid':this[a22_0xfdc0('0x22')][a22_0xfdc0('0x3c')],'playerId':this[a22_0xfdc0('0x22')][a22_0xfdc0('0x26')]};fs[a22_0xfdc0('0x3d')](configFile,JSON[a22_0xfdc0('0x37')](this[a22_0xfdc0('0x22')]));}}[a22_0xfdc0('0x34')](){console['log'](a22_0xfdc0('0x34'));this['kodi'][a22_0xfdc0('0x3e')][a22_0xfdc0('0x3f')]()['then'](function(_0xdd3714){const _0x595b34=_0xdd3714[a22_0xfdc0('0x40')][a22_0xfdc0('0x41')];this[a22_0xfdc0('0x42')](_0x595b34);}['bind'](this))['catch'](function(_0x25f309){console[a22_0xfdc0('0x3b')](_0x25f309);this[a22_0xfdc0('0x42')](_0x25f309);}[a22_0xfdc0('0x35')](this));}[a22_0xfdc0('0x42')](_0x4bfee0){console[a22_0xfdc0('0x3b')]('playingItem:\x20'+_0x4bfee0);const _0x2957c4={'player_id':this[a22_0xfdc0('0x26')],'device_uuid':this['config'][a22_0xfdc0('0x3c')],'status':_0x4bfee0!=''&&_0x4bfee0!=null?0x1:0x0,'playing_item':_0x4bfee0};this[a22_0xfdc0('0x1f')][a22_0xfdc0('0x38')]('http://restapi.lulo.run/player_devices/report_status',_0x2957c4,![])['then'](function(_0x28ecf2){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x43')+Date());})[a22_0xfdc0('0x3a')](function(_0x240841){});}[a22_0xfdc0('0x32')](){fsExtra[a22_0xfdc0('0x44')](this[a22_0xfdc0('0x13')],_0x2719a9=>{});fsExtra[a22_0xfdc0('0x44')](this[a22_0xfdc0('0x45')],_0x2fac9d=>{});fsExtra[a22_0xfdc0('0x44')](this['filesFolder'],_0x5737ba=>{});}[a22_0xfdc0('0x33')](){const _0x5d149c=format(this['playListServiceURL'],this['playerId']);console[a22_0xfdc0('0x3b')](_0x5d149c);request({'url':_0x5d149c,'json':!![]},function(_0x4931e6,_0x2b619c,_0x19fb76){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x46'));console[a22_0xfdc0('0x3b')](_0x19fb76);this['newPlayList']=_0x19fb76;this[a22_0xfdc0('0x18')]=this[a22_0xfdc0('0x47')]();fsExtra[a22_0xfdc0('0x48')](this[a22_0xfdc0('0x45')]);this[a22_0xfdc0('0x19')]=[];this[a22_0xfdc0('0x1a')]=[];this[a22_0xfdc0('0x49')]=0x0;for(const _0x3bf7e0 in _0x19fb76){this[a22_0xfdc0('0x19')][a22_0xfdc0('0x4a')](_0x19fb76[_0x3bf7e0]);}console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x4b')+this['downloadFiles'][a22_0xfdc0('0x4c')]);if(this['downloadFiles'][a22_0xfdc0('0x4c')]>0x0){this[a22_0xfdc0('0x4d')]();}}[a22_0xfdc0('0x35')](this));}[a22_0xfdc0('0x4e')](){if(fsExtra[a22_0xfdc0('0x4f')](this[a22_0xfdc0('0x45')])){fsExtra[a22_0xfdc0('0x48')](this[a22_0xfdc0('0x45')]);}if(fsExtra[a22_0xfdc0('0x4f')](this[a22_0xfdc0('0x16')])){fsExtra[a22_0xfdc0('0x48')](this[a22_0xfdc0('0x16')]);}if(!fsExtra[a22_0xfdc0('0x4f')](this[a22_0xfdc0('0x15')])){fsExtra[a22_0xfdc0('0x50')](this[a22_0xfdc0('0x15')]);}if(!fsExtra['existsSync'](this[a22_0xfdc0('0x51')])){fsExtra[a22_0xfdc0('0x50')](this[a22_0xfdc0('0x51')]);}this[a22_0xfdc0('0x33')]();}['hasPlayListChanged'](){const _0x50af19=JSON[a22_0xfdc0('0x37')](this[a22_0xfdc0('0x1b')]);try{if(!fsExtra[a22_0xfdc0('0x4f')](this[a22_0xfdc0('0x15')])){return!![];}else{const _0x4d0ebc=fsExtra[a22_0xfdc0('0x24')](this[a22_0xfdc0('0x15')])[a22_0xfdc0('0x52')]();if(_0x4d0ebc!=_0x50af19){return!![];}}}catch(_0x4aaed4){console[a22_0xfdc0('0x3b')](_0x4aaed4);}return![];}['download'](){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x53')+this[a22_0xfdc0('0x49')]+'\x20of\x20'+this[a22_0xfdc0('0x19')][a22_0xfdc0('0x4c')]);if(this[a22_0xfdc0('0x49')]>=this['downloadFiles']['length']){this['finishProcess']();return;}const _0xc44e26=String(this[a22_0xfdc0('0x19')][this[a22_0xfdc0('0x49')]]['path']);const _0x31fbbb=this[a22_0xfdc0('0x19')][this['currentFile']][a22_0xfdc0('0x54')];let _0x3b65e9=_0xc44e26[a22_0xfdc0('0x55')](_0xc44e26['lastIndexOf']('/')+0x1);const _0x3f38a9=_0x3b65e9['split']('.')[a22_0xfdc0('0x56')](0x0,-0x1)[a22_0xfdc0('0x57')]('.');let _0x15eacf=this[a22_0xfdc0('0x27')]+_0xc44e26;const _0x4618ee=_0x15eacf[a22_0xfdc0('0x58')]('.')[a22_0xfdc0('0x56')](0x0,-0x1)[a22_0xfdc0('0x57')]('.');if(_0x31fbbb==a22_0xfdc0('0x59')){_0x3b65e9=_0x3b65e9+'.mp4';}else if(_0x31fbbb=='image'){_0x3b65e9=_0x3f38a9+'.mp4';_0x15eacf=_0x4618ee+a22_0xfdc0('0x5a');}console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x5b'));console['log'](_0xc44e26);console[a22_0xfdc0('0x3b')](_0x31fbbb);console[a22_0xfdc0('0x3b')](_0x3b65e9);console[a22_0xfdc0('0x3b')](_0x15eacf);console[a22_0xfdc0('0x3b')](_0x3f38a9);console[a22_0xfdc0('0x3b')](_0x4618ee);console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x5b'));if(fsExtra['existsSync'](this['tempFolder']+_0x3b65e9)){this[a22_0xfdc0('0x5c')](this['tempFolder']+_0x3b65e9)[a22_0xfdc0('0x3')](function(_0x136fdc){if(_0x136fdc){this[a22_0xfdc0('0x49')]++;}else{this[a22_0xfdc0('0x18')]=!![];}this['download']();}[a22_0xfdc0('0x35')](this));}else if(fsExtra[a22_0xfdc0('0x4f')](this['filesFolder']+_0x3b65e9)){this[a22_0xfdc0('0x5c')](this[a22_0xfdc0('0x16')]+_0x3b65e9)['then'](function(_0x18acf8){if(_0x18acf8){fsExtra[a22_0xfdc0('0x5d')](this[a22_0xfdc0('0x16')]+_0x3b65e9,this[a22_0xfdc0('0x45')]+_0x3b65e9);this[a22_0xfdc0('0x49')]++;}else{this['playlistChanged']=!![];}this[a22_0xfdc0('0x4d')]();}[a22_0xfdc0('0x35')](this));}else{console[a22_0xfdc0('0x3b')]('Downloading:\x20'+_0x15eacf);this[a22_0xfdc0('0x18')]=!![];if(_0x31fbbb==a22_0xfdc0('0x59')){this[a22_0xfdc0('0x5e')](_0xc44e26);}else{this[a22_0xfdc0('0x5f')](_0x15eacf,_0x3b65e9,_0x31fbbb);}}}[a22_0xfdc0('0x5c')](_0x592461){return __awaiter(this,void 0x0,void 0x0,function*(){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x60')+_0x592461);const _0x26775c=yield mediainfo(_0x592461)[a22_0xfdc0('0x3a')](_0x70aaf9=>{console[a22_0xfdc0('0x3b')](_0x70aaf9);fsExtra[a22_0xfdc0('0x50')](_0x592461);return![];});const _0x39bc43=_0x26775c[a22_0xfdc0('0x61')]['track']['length']>0x1&&_0x26775c[a22_0xfdc0('0x61')][a22_0xfdc0('0x62')][0x1]['@type']==a22_0xfdc0('0x63');if(!_0x39bc43){fsExtra[a22_0xfdc0('0x50')](_0x592461);}console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x64')+_0x39bc43);return _0x39bc43;});}[a22_0xfdc0('0x5f')](_0x3bc3b2,_0x1affe1,_0x27dc49){const _0x4beefe=new Downloader();console['log'](_0x3bc3b2);console[a22_0xfdc0('0x3b')](_0x1affe1);console[a22_0xfdc0('0x3b')](_0x27dc49);const _0x62bf6a=_0x4beefe[a22_0xfdc0('0x4d')](_0x3bc3b2,this['tempFolder']+_0x1affe1);urlExists(_0x3bc3b2,function(_0x1903c0,_0x23c04f){if(_0x23c04f){if(this[a22_0xfdc0('0x1a')][a22_0xfdc0('0x65')](this[a22_0xfdc0('0x49')])){const _0x489a76=this['failDownloadFiles'][a22_0xfdc0('0x66')](this[a22_0xfdc0('0x49')]);if(_0x489a76>-0x1){this[a22_0xfdc0('0x1a')][a22_0xfdc0('0x67')](_0x489a76,0x1);}}console['log'](a22_0xfdc0('0x68')+_0x3bc3b2);_0x62bf6a['start']();}else{if(!this[a22_0xfdc0('0x1a')][a22_0xfdc0('0x65')](this[a22_0xfdc0('0x49')])){this[a22_0xfdc0('0x1a')][a22_0xfdc0('0x4a')](this[a22_0xfdc0('0x49')]);}console['log'](a22_0xfdc0('0x69')+_0x3bc3b2);this[a22_0xfdc0('0x49')]++;this[a22_0xfdc0('0x4d')]();}}[a22_0xfdc0('0x35')](this));_0x62bf6a['on']('start',function(_0x62bf6a){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x6a')+_0x3bc3b2);});_0x62bf6a['on'](a22_0xfdc0('0x6b'),function(_0x62bf6a){console['log'](a22_0xfdc0('0x6c'));this[a22_0xfdc0('0x4d')]();}['bind'](this));_0x62bf6a['on'](a22_0xfdc0('0x6d'),function(_0x62bf6a){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x6d'));console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x6e')+_0x1affe1);console[a22_0xfdc0('0x3b')]('mediaType:\x20'+_0x27dc49);this[a22_0xfdc0('0x5c')](this[a22_0xfdc0('0x45')]+_0x1affe1)['then'](function(_0x1ff1e1){if(_0x1ff1e1){this['currentFile']++;}this[a22_0xfdc0('0x4d')]();}['bind'](this));}['bind'](this));_0x62bf6a['on']('stopped',function(_0x62bf6a){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x6f'));});_0x62bf6a['on'](a22_0xfdc0('0x70'),function(_0x62bf6a){console['log'](a22_0xfdc0('0x70'));});_0x62bf6a['on']('retry',function(_0x62bf6a){console[a22_0xfdc0('0x3b')]('retry');});}[a22_0xfdc0('0x71')](_0x516052,_0x48916a,_0x107c00,_0xbec574){console[a22_0xfdc0('0x3b')]('downloadHTTPFile');console[a22_0xfdc0('0x3b')](_0x516052);const _0x46b092=!![];let _0x5d8c6a=0x0;const _0x4ad17d='';console['log'](a22_0xfdc0('0x72')+_0x516052+a22_0xfdc0('0x73')+_0x48916a);if(_0x5d8c6a){if(_0x5d8c6a>0x5){_0xbec574('Max\x20redirects\x20reached',_0x516052,_0x107c00,null);return;}}else{_0x5d8c6a=0x0;}const _0x3427d2=this[a22_0xfdc0('0x45')]+_0x48916a;let _0x53120;if(_0xbec574===undefined){console[a22_0xfdc0('0x3b')]('WARNING\x20downloadFile\x20callback\x20is\x20undefined\x20for\x20'+_0x516052+a22_0xfdc0('0x73')+_0x3427d2);_0xbec574=function(_0x27a5bd,_0x48f277){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x74'),_0x27a5bd,_0x48f277);};}http['globalAgent'][a22_0xfdc0('0x75')]=0x64;const _0x2a96e6={'host':url[a22_0xfdc0('0x23')](_0x516052)[a22_0xfdc0('0x76')],'port':0x50,'path':url[a22_0xfdc0('0x23')](_0x516052)[a22_0xfdc0('0x77')],'agent':![]};const _0x415120=http[a22_0xfdc0('0x78')](_0x2a96e6,function(_0x6daa6c){let _0x48fbe2=0x0;let _0x340822=0x0;function _0x4c4413(){if(_0x48fbe2===undefined){console[a22_0xfdc0('0x3b')](_0x48916a+a22_0xfdc0('0x79')+_0x340822+'/'+'?');}const _0x2bfa5e=_0x340822/_0x48fbe2*0x64;console[a22_0xfdc0('0x3b')](_0x48916a+a22_0xfdc0('0x7a')+_0x2bfa5e+'%\x09'+_0x340822+'/'+_0x48fbe2);}console[a22_0xfdc0('0x3b')](_0x48916a+'\x20'+_0x6daa6c[a22_0xfdc0('0x7b')]);switch(_0x6daa6c['statusCode']){case 0xc8:_0x48fbe2=_0x6daa6c['headers']['content-length']||_0x4ad17d;fs[a22_0xfdc0('0x7c')](_0x3427d2,function(_0x4f0726,_0x5e01c3){if(!_0x4f0726){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x7d')+_0x3427d2);if(_0x5e01c3[a22_0xfdc0('0x7e')]==_0x48fbe2){console[a22_0xfdc0('0x3b')]('And\x20the\x20file\x20size\x20matches\x20('+_0x48fbe2+')');console[a22_0xfdc0('0x3b')]('Redownloading');}else{console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x7f')+_0x5e01c3[a22_0xfdc0('0x7e')]+a22_0xfdc0('0x80')+_0x48fbe2+')');}}_0x53120=fs[a22_0xfdc0('0x81')](_0x3427d2);_0x6daa6c[a22_0xfdc0('0x82')](_0x53120);_0x6daa6c['on']('data',function(_0x331c0c){_0x340822+=_0x331c0c['length'];_0x4c4413();});_0x415120['on'](a22_0xfdc0('0x6b'),function(_0x4f0726){console[a22_0xfdc0('0x3b')]('err:\x20');console[a22_0xfdc0('0x3b')](_0x4f0726);});_0x53120['on']('finish',function(){console['log']('Downloaded\x20'+_0x516052+a22_0xfdc0('0x73')+_0x48916a);_0xbec574(null,_0x48916a,_0x107c00,_0x48916a);}[a22_0xfdc0('0x35')](this));});break;case 0x12e:const _0x38e15b=_0x6daa6c['headers']['location'];console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x83')+_0x516052+a22_0xfdc0('0x73')+_0x38e15b);if(_0x5d8c6a<0x5){this[a22_0xfdc0('0x71')](_0x38e15b,_0x48916a,_0xbec574,_0x5d8c6a++);}else{console[a22_0xfdc0('0x6b')]('Redirect\x20limit\x20encountered\x20for\x20'+_0x516052+'.');_0xbec574(a22_0xfdc0('0x84'),null,null,null);}return;case 0x194:console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x85')+_0x516052);default:console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x86')+_0x516052+'\x20STATUS:\x20'+_0x6daa6c[a22_0xfdc0('0x7b')]);_0x415120['abort']();_0xbec574(_0x6daa6c[a22_0xfdc0('0x7b')],null,null,null);return;}})['on'](a22_0xfdc0('0x6b'),function(_0x58d225){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x87')+_0x516052+'\x20'+_0x58d225[a22_0xfdc0('0x88')]);_0xbec574(_0x58d225,null,null,null);});}[a22_0xfdc0('0x89')](_0x24c472,_0x3059ac,_0x44282f,_0x3c268e){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x89'));console['log'](_0x24c472);console[a22_0xfdc0('0x3b')](_0x3059ac);console[a22_0xfdc0('0x3b')](_0x44282f);console[a22_0xfdc0('0x3b')](_0x3c268e);if(_0x44282f=='image'){const _0x562c44=this[a22_0xfdc0('0x19')][this[a22_0xfdc0('0x49')]][a22_0xfdc0('0x8a')]!=null?this[a22_0xfdc0('0x19')][this['currentFile']][a22_0xfdc0('0x8a')]:0x1e;this['createImageVideo'](_0x3c268e,_0x562c44);}else if(_0x44282f=='video'){if(_0x24c472==null&&_0x3059ac!=''){this[a22_0xfdc0('0x49')]++;}this[a22_0xfdc0('0x4d')]();}console[a22_0xfdc0('0x3b')](this[a22_0xfdc0('0x49')]);}[a22_0xfdc0('0x8b')](_0x1472d7,_0xcbafe6,_0x8ff667){progress(request(_0x1472d7),{})['on'](a22_0xfdc0('0x8c'),function(_0x3f73ad){console['log'](_0x3f73ad);})['on'](a22_0xfdc0('0x6b'),function(_0x31f92c){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x8d'));this[a22_0xfdc0('0x4d')]();})['on'](a22_0xfdc0('0x6d'),function(){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x6e')+_0xcbafe6);console['log'](a22_0xfdc0('0x8e')+_0x8ff667);if(_0x8ff667=='image'){const _0x1728d2=this[a22_0xfdc0('0x19')][this['currentFile']][a22_0xfdc0('0x8a')]!=null?this[a22_0xfdc0('0x19')][this[a22_0xfdc0('0x49')]][a22_0xfdc0('0x8a')]:0x1e;this['createImageVideo'](_0xcbafe6,_0x1728d2);}else if(_0x8ff667==a22_0xfdc0('0x8f')){this[a22_0xfdc0('0x49')]++;this[a22_0xfdc0('0x4d')]();}}[a22_0xfdc0('0x35')](this))[a22_0xfdc0('0x82')](fs[a22_0xfdc0('0x81')](this[a22_0xfdc0('0x45')]+_0xcbafe6));}[a22_0xfdc0('0x90')](_0x9b665f,_0x2a4485=0x1e){const _0x579bbc=this[a22_0xfdc0('0x45')]+_0x9b665f;console['log'](_0x579bbc);console[a22_0xfdc0('0x3b')](_0x9b665f);const _0xb0a6ac=_0x9b665f[a22_0xfdc0('0x58')]('.')['slice'](0x0,-0x1)['join']('.');const _0x22e083='ffmpeg';const _0x2dd82e=['-y','-r','1/2','-loop','1',a22_0xfdc0('0x91'),a22_0xfdc0('0x92'),'-i',_0x579bbc,'-t',String(_0x2a4485),a22_0xfdc0('0x93'),a22_0xfdc0('0x94'),a22_0xfdc0('0x95'),a22_0xfdc0('0x96'),'-r','25','-vf',a22_0xfdc0('0x97'),this[a22_0xfdc0('0x45')]+_0xb0a6ac+'.mp4'];const _0x3ce629=spawn(_0x22e083,_0x2dd82e);_0x3ce629[a22_0xfdc0('0x98')]['on']('data',function(_0x50fb98){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x99')+_0x579bbc);});_0x3ce629['stderr']['on'](a22_0xfdc0('0x9a'),function(_0x3739e6){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x9b')+_0x3739e6);}['bind'](this));_0x3ce629['on']('close',function(){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x9c'));this[a22_0xfdc0('0x49')]++;this['download']();}[a22_0xfdc0('0x35')](this));}[a22_0xfdc0('0x5e')](_0x270a7f){const _0x1d58aa=this['tempFolder']+'/'+_0x270a7f+a22_0xfdc0('0x5a');const _0x22e805=youtubedl('http://www.youtube.com/watch?v='+_0x270a7f,[a22_0xfdc0('0x9d')],{'cwd':__dirname});_0x22e805['on']('info',function(_0x3de2f1){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x9e'));console[a22_0xfdc0('0x3b')](a22_0xfdc0('0x9f')+_0x3de2f1[a22_0xfdc0('0xa0')]);console[a22_0xfdc0('0x3b')](a22_0xfdc0('0xa1')+_0x3de2f1['size']);});_0x22e805['on'](a22_0xfdc0('0xa2'),function complete(_0x3a6429){'use strict';console['log']('filename:\x20'+_0x3a6429[a22_0xfdc0('0xa0')]+'\x20already\x20downloaded.');});_0x22e805['on'](a22_0xfdc0('0x6d'),function(){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0xa3'));this[a22_0xfdc0('0x5c')](_0x1d58aa)[a22_0xfdc0('0x3')](function(_0x57f9d4){if(_0x57f9d4){this[a22_0xfdc0('0x49')]++;}this[a22_0xfdc0('0x4d')]();}[a22_0xfdc0('0x35')](this));}[a22_0xfdc0('0x35')](this));_0x22e805[a22_0xfdc0('0x82')](fs[a22_0xfdc0('0x81')](_0x1d58aa));}[a22_0xfdc0('0xa4')](){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0xa5'));if(this[a22_0xfdc0('0x18')]){if(this[a22_0xfdc0('0x1a')][a22_0xfdc0('0x4c')]==0x0){fs['writeFileSync'](this[a22_0xfdc0('0x15')],JSON[a22_0xfdc0('0x37')](this[a22_0xfdc0('0x1b')]));let _0x2d8ca9='#EXTCPlayListM3U::M3U'+'\x0d\x0a'+a22_0xfdc0('0xa6')+'\x0d\x0a';for(const _0x33f1e2 in this[a22_0xfdc0('0x19')]){const _0x3301ca=this['downloadFiles'][_0x33f1e2][a22_0xfdc0('0xa7')];const _0x37c3bf=this['downloadFiles'][_0x33f1e2][a22_0xfdc0('0x54')];const _0x42bd3d=_0x3301ca[a22_0xfdc0('0x55')](_0x3301ca['lastIndexOf']('/')+0x1);let _0x9e7dd7=_0x42bd3d[a22_0xfdc0('0x58')]('.')[a22_0xfdc0('0x56')](0x0,-0x1)[a22_0xfdc0('0x57')]('.');if(_0x37c3bf=='youtube_single'){_0x9e7dd7=_0x3301ca;}_0x2d8ca9+=a22_0xfdc0('0xa8')+_0x9e7dd7+a22_0xfdc0('0x5a')+'\x0d\x0a';}fsExtra['emptyDirSync'](this[a22_0xfdc0('0x16')]);fsExtra['copySync'](this[a22_0xfdc0('0x45')],this[a22_0xfdc0('0x16')]);fsExtra[a22_0xfdc0('0x3d')](this[a22_0xfdc0('0x51')],_0x2d8ca9);fsExtra['emptyDirSync'](this[a22_0xfdc0('0x45')]);console[a22_0xfdc0('0x3b')](a22_0xfdc0('0xa9'));this[a22_0xfdc0('0xaa')]();}else{console['log']('Playlist\x20incomplete,\x20retry.');this[a22_0xfdc0('0x49')]=0x0;setTimeout(function(){this[a22_0xfdc0('0x4d')]();}[a22_0xfdc0('0x35')](this),0x1388);}}else{console['log']('No\x20playlist\x20changes.');}}[a22_0xfdc0('0xaa')](){this[a22_0xfdc0('0xab')](a22_0xfdc0('0xac'),{'playlistid':0x1},function(_0xd7732b){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0xad'));console[a22_0xfdc0('0x3b')](_0xd7732b);this[a22_0xfdc0('0xab')](a22_0xfdc0('0xae'),{'item':{'file':'//home/osmc/luloclient/media/files/lulo_playlist.m3u'},'playlistid':0x1},function(_0xd7732b){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0xaf'));console['log'](_0xd7732b);this[a22_0xfdc0('0xab')](a22_0xfdc0('0xb0'),{'item':{'playlistid':0x1,'position':0x0}},function(_0xd7732b){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0xb1'));console['log'](_0xd7732b);}['bind'](this));}[a22_0xfdc0('0x35')](this));}['bind'](this));}[a22_0xfdc0('0xb2')](){exec('sudo\x20/sbin/shutdown\x20-r\x20now',function(_0x183aec){console[a22_0xfdc0('0x3b')](_0x183aec);});}[a22_0xfdc0('0xb3')](){const _0x225824=format(this[a22_0xfdc0('0x2c')],this['playerId']);console[a22_0xfdc0('0x3b')](_0x225824);request({'url':_0x225824,'json':!![]},function(_0x440c0e,_0x1694d7,_0x2efec8){if(_0x2efec8[a22_0xfdc0('0x4c')]>0x0){const _0xe30797=_0x2efec8[0x0];const _0x1549e4=_0xe30797[a22_0xfdc0('0xb4')];const _0x11cd96=_0xe30797[a22_0xfdc0('0xb5')]==0x1;this[a22_0xfdc0('0xb6')](_0x1549e4);this['enableClock'](_0x11cd96);}console['log'](_0x2efec8);}['bind'](this));}[a22_0xfdc0('0xb6')](_0x370a6e){const _0x21fc90=_0x370a6e!=null&&_0x370a6e!='';const _0x43e884=a22_0xfdc0('0xb7');const _0x43ec14=fsExtra[a22_0xfdc0('0x24')](_0x43e884);console['log'](a22_0xfdc0('0xb8')+_0x43ec14);const _0xc6afc5=require(a22_0xfdc0('0xb9'));const _0x279e95=_0xc6afc5[a22_0xfdc0('0xba')];_0x279e95(_0x43ec14,function(_0x3525c7,_0xed9d41){console[a22_0xfdc0('0x3b')]('err:\x20%j',_0x3525c7);console[a22_0xfdc0('0x3b')](a22_0xfdc0('0xbb'),_0xed9d41);if(!_0x370a6e||_0x370a6e==null||_0x370a6e==''){_0x370a6e=a22_0xfdc0('0xbc');}_0xed9d41[a22_0xfdc0('0xbd')]['set'][0x0][a22_0xfdc0('0xbe')][0x0]['_']=_0x370a6e;const _0x36fcd6=new _0xc6afc5['Builder']();const _0x19b79b=_0x36fcd6[a22_0xfdc0('0xbf')](_0xed9d41);console[a22_0xfdc0('0x3b')](a22_0xfdc0('0xc0'),_0x19b79b);fsExtra['writeFileSync'](_0x43e884,_0x19b79b);});exec(a22_0xfdc0('0xc1'),function(_0x322f4e){console[a22_0xfdc0('0x3b')](_0x322f4e);});this[a22_0xfdc0('0xab')](a22_0xfdc0('0xc2'),{'setting':'lookandfeel.enablerssfeeds','value':_0x21fc90},function(_0x79cbfa){console[a22_0xfdc0('0x3b')]('setRss:');console[a22_0xfdc0('0x3b')](_0x79cbfa);}[a22_0xfdc0('0x35')](this));}[a22_0xfdc0('0xc3')](_0x2387eb){this[a22_0xfdc0('0xab')](a22_0xfdc0('0xc2'),{'setting':'videoplayer.usedisplayasclock','value':_0x2387eb},function(_0x49eb1d){console[a22_0xfdc0('0x3b')](a22_0xfdc0('0xc4'));console[a22_0xfdc0('0x3b')](_0x49eb1d);}[a22_0xfdc0('0x35')](this));}['jsonrpcClient'](_0x377da5,_0x5e7dd7,_0x5546c4){const _0xcf0d35={'jsonrpc':a22_0xfdc0('0xc5'),'method':_0x377da5,'params':_0x5e7dd7,'id':0x1};this[a22_0xfdc0('0x1f')]['post'](this[a22_0xfdc0('0x2f')]+'/jsonrpc',_0xcf0d35,![],{'user':this[a22_0xfdc0('0x1c')],'pass':this[a22_0xfdc0('0x1e')]})[a22_0xfdc0('0x3')](function(_0x504bc2){_0x5546c4(_0x504bc2);})[a22_0xfdc0('0x3a')](function(_0x23efd3){});}}exports[a22_0xfdc0('0xc6')]=SyncPlaylistsService;
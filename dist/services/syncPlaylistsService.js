var a22_0x3c36=['pipe','data','err:\x20','finish','Downloaded\x20','\x20to\x20','Redirect\x20','Redirect\x20limit\x20encountered\x20for\x20','302','File\x20Not\x20Found\x20','\x20STATUS:\x20','abort','Error\x20Downloading:\x20','message','downloadHTTPFileCallback','duration','createImageVideo','downloadRequestFile','Error\x20downloading\x20file','mediaType:\x20','image','video','ffmpeg','1/2','-loop','-pattern_type','-c:v','libx264','-pix_fmt','yuv420p','-vf','stdout','Converting\x20','stderr','stderr:\x20','close','finished\x20mp4\x20convert','http://www.youtube.com/watch?v=','--format=18','info','Download\x20started','filename:\x20','_filename','size:\x20','complete','\x20already\x20downloaded.','finished\x20youtube\x20downloading!','Finishing','#EXTINF:0,luloPlayList','path','youtube_single','shutdown','now','Playlist\x20incomplete,\x20retry.','No\x20playlist\x20changes.','SyncPlaylistsService','__awaiter','next','throw','value','then','apply','__esModule','../infrastructure/HttpClientService','request','child_process','spawn','is-image','string-template','youtube-dl','config.json','context.json','url-exists','media/','tempFolder','mediaFolder','temp/','filesFolder','playListFile','playlist.txt','lulo_playlist.m3u','currentFile','playlistChanged','downloadFiles','httpClientService','HttpClientService','init','config','parse','context','readFileSync','playerId','env','WEB_SERVICE_URL','baseURL','api/player_playlist.php?player_id={0}','kodi','http://localhost','.lulo123.','checkDependencies','checkFolders','getStatus','bind','playlist','getItems','stringify','deviceUuid','networkInterfaces','post','http://restapi.lulo.run/player_devices/register','log','writeFileSync','player','getCurrentlyPlayingVideo','item','label','reportStatus','catch','playingItem:\x20','http://restapi.lulo.run/player_devices/report_status','reportStatusResponse:\x20','ensureDir','loadMediaList','newPlayList','hasPlayListChanged','emptyDirSync','failDownloadFiles','push','Total:\x20','length','download','reloadMediaList','existsSync','m3uFile','removeSync','reboot','System','Shutdown','toString','\x20of\x20','media_type','substring','lastIndexOf','slice','join','split','.mp4','**********+','checkVideo','copySync','downloadYouTube','downloader','videoFile:\x20','media','track','@type','includes','indexOf','downloading:\x20','start','Error:\x20','error','error:\x20','end','Downloaded:\x20','stopped','destroyed','retry','downloadHTTPFile','Attempting\x20to\x20download\x20','Max\x20redirects\x20reached','globalAgent','maxSockets','pathname','get','\x20Progress:\x20unknown\x09','\x20Progress:\x20','statusCode','headers','content-length','stat','size','Redownloading','But\x20the\x20file\x20size\x20does\x20not\x20match\x20so\x20re-downloading\x20Old(',')\x20vs\x20New(','createWriteStream'];(function(_0x1e18ef,_0x231fc0){var _0x29eca3=function(_0x392723){while(--_0x392723){_0x1e18ef['push'](_0x1e18ef['shift']());}};_0x29eca3(++_0x231fc0);}(a22_0x3c36,0x1ac));var a22_0x174e=function(_0x31183b,_0x2fd526){_0x31183b=_0x31183b-0x0;var _0x2e47d8=a22_0x3c36[_0x31183b];return _0x2e47d8;};'use strict';var __awaiter=this&&this[a22_0x174e('0x0')]||function(_0x43c91a,_0x47d868,_0x4777fb,_0x25d20e){function _0x1b7620(_0x2a8540){return _0x2a8540 instanceof _0x4777fb?_0x2a8540:new _0x4777fb(function(_0x3534d8){_0x3534d8(_0x2a8540);});}return new(_0x4777fb||(_0x4777fb=Promise))(function(_0x4d53a3,_0x1009e0){function _0x1db0c0(_0x208eb5){try{_0xdd740d(_0x25d20e[a22_0x174e('0x1')](_0x208eb5));}catch(_0x425f5d){_0x1009e0(_0x425f5d);}}function _0xcbdcc9(_0x1b1ebb){try{_0xdd740d(_0x25d20e[a22_0x174e('0x2')](_0x1b1ebb));}catch(_0xab2d24){_0x1009e0(_0xab2d24);}}function _0xdd740d(_0x505f64){_0x505f64['done']?_0x4d53a3(_0x505f64[a22_0x174e('0x3')]):_0x1b7620(_0x505f64['value'])[a22_0x174e('0x4')](_0x1db0c0,_0xcbdcc9);}_0xdd740d((_0x25d20e=_0x25d20e[a22_0x174e('0x5')](_0x43c91a,_0x47d868||[]))[a22_0x174e('0x1')]());});};Object['defineProperty'](exports,a22_0x174e('0x6'),{'value':!![]});const HttpClientService_1=require(a22_0x174e('0x7'));const mediainfo=require('node-mediainfo');const fs=require('fs');const url=require('url');const http=require('http');const fsExtra=require('fs-extra');const request=require(a22_0x174e('0x8'));const progress=require('request-progress');const spawn=require(a22_0x174e('0x9'))[a22_0x174e('0xa')];const isImage=require(a22_0x174e('0xb'));const format=require(a22_0x174e('0xc'));const os=require('os');const youtubedl=require(a22_0x174e('0xd'));const uuidv4=require('uuid/v4');const configFile=a22_0x174e('0xe');const contextFile=a22_0x174e('0xf');const urlExists=require(a22_0x174e('0x10'));const kodi_rpc=require('node-kodi');const Downloader=require('mt-files-downloader');class SyncPlaylistsService{constructor(){this['mediaFolder']=a22_0x174e('0x11');this[a22_0x174e('0x12')]=this[a22_0x174e('0x13')]+a22_0x174e('0x14');this[a22_0x174e('0x15')]=this[a22_0x174e('0x13')]+'files/';this[a22_0x174e('0x16')]=this[a22_0x174e('0x13')]+a22_0x174e('0x17');this['m3uFile']=this[a22_0x174e('0x15')]+a22_0x174e('0x18');this[a22_0x174e('0x19')]=0x0;this[a22_0x174e('0x1a')]=![];this[a22_0x174e('0x1b')]=[];this['failDownloadFiles']=[];this['newPlayList']={};this[a22_0x174e('0x1c')]=new HttpClientService_1[(a22_0x174e('0x1d'))]();}[a22_0x174e('0x1e')](){this[a22_0x174e('0x1f')]=JSON[a22_0x174e('0x20')](fs['readFileSync'](configFile));this[a22_0x174e('0x21')]=JSON[a22_0x174e('0x20')](fs[a22_0x174e('0x22')](contextFile));this[a22_0x174e('0x23')]=this['config'][a22_0x174e('0x23')];this['baseURL']=process[a22_0x174e('0x24')][a22_0x174e('0x25')]+'deploy/';this['playListServiceURL']=this[a22_0x174e('0x26')]+a22_0x174e('0x27');this[a22_0x174e('0x28')]=new kodi_rpc({'url':a22_0x174e('0x29'),'user':'lulo','password':a22_0x174e('0x2a')});this[a22_0x174e('0x2b')]();this['registerClient']();this[a22_0x174e('0x2c')]();this['loadMediaList']();setInterval(function(){this[a22_0x174e('0x2d')]();}[a22_0x174e('0x2e')](this),0x2710);setInterval(function(){this['registerClient']();}[a22_0x174e('0x2e')](this),0x493e0);}[a22_0x174e('0x2b')](){}['registerClient'](){this[a22_0x174e('0x28')][a22_0x174e('0x2f')][a22_0x174e('0x30')](0x1)[a22_0x174e('0x4')](function(_0x49d88c){const _0x5b695f=JSON[a22_0x174e('0x31')](_0x49d88c);const _0x920627={'player_id':this[a22_0x174e('0x23')],'device_uuid':this[a22_0x174e('0x1f')][a22_0x174e('0x32')],'network_info':JSON['stringify'](os[a22_0x174e('0x33')]()),'firmware_info':JSON[a22_0x174e('0x31')](this['context']),'playlist':_0x5b695f,'playing_item':'','status':0x0};this[a22_0x174e('0x1c')][a22_0x174e('0x34')](a22_0x174e('0x35'),_0x920627,![])['then'](function(_0x2c7e6a){console['log']('register\x20response:\x20'+Date());})['catch'](function(_0x3b49fc){});console[a22_0x174e('0x36')](_0x920627);}[a22_0x174e('0x2e')](this));const _0x30cea1=this[a22_0x174e('0x1f')][a22_0x174e('0x32')];if(!_0x30cea1||_0x30cea1==''){this[a22_0x174e('0x1f')][a22_0x174e('0x32')]=uuidv4();this[a22_0x174e('0x1f')]={'deviceUuid':this['config'][a22_0x174e('0x32')],'playerId':this['config'][a22_0x174e('0x23')]};fs[a22_0x174e('0x37')](configFile,JSON[a22_0x174e('0x31')](this[a22_0x174e('0x1f')]));}}[a22_0x174e('0x2d')](){console[a22_0x174e('0x36')](a22_0x174e('0x2d'));this[a22_0x174e('0x28')][a22_0x174e('0x38')][a22_0x174e('0x39')]()[a22_0x174e('0x4')](function(_0x1cfaeb){const _0x347917=_0x1cfaeb[a22_0x174e('0x3a')][a22_0x174e('0x3b')];this[a22_0x174e('0x3c')](_0x347917);}[a22_0x174e('0x2e')](this))[a22_0x174e('0x3d')](function(_0x7f68bb){console[a22_0x174e('0x36')](_0x7f68bb);this['reportStatus'](_0x7f68bb);}['bind'](this));}[a22_0x174e('0x3c')](_0x12698c){console[a22_0x174e('0x36')](a22_0x174e('0x3e')+_0x12698c);const _0x44710d={'player_id':this[a22_0x174e('0x23')],'device_uuid':this[a22_0x174e('0x1f')][a22_0x174e('0x32')],'status':_0x12698c!=''&&_0x12698c!=null?0x1:0x0,'playing_item':_0x12698c};this[a22_0x174e('0x1c')][a22_0x174e('0x34')](a22_0x174e('0x3f'),_0x44710d,![])['then'](function(_0x3a80ff){console[a22_0x174e('0x36')](a22_0x174e('0x40')+Date());})['catch'](function(_0x3bb269){});}[a22_0x174e('0x2c')](){fsExtra[a22_0x174e('0x41')](this[a22_0x174e('0x13')],_0x292e5f=>{});fsExtra[a22_0x174e('0x41')](this['tempFolder'],_0x5ea3c6=>{});fsExtra[a22_0x174e('0x41')](this[a22_0x174e('0x15')],_0x296f99=>{});}[a22_0x174e('0x42')](){const _0x40e627=format(this['playListServiceURL'],this[a22_0x174e('0x23')]);console['log'](_0x40e627);request({'url':_0x40e627,'json':!![]},function(_0x2c67d7,_0x22e02f,_0x549569){console[a22_0x174e('0x36')]('loadMediaList:\x20');console[a22_0x174e('0x36')](_0x549569);this[a22_0x174e('0x43')]=_0x549569;this[a22_0x174e('0x1a')]=this[a22_0x174e('0x44')]();fsExtra[a22_0x174e('0x45')](this['tempFolder']);this[a22_0x174e('0x1b')]=[];this[a22_0x174e('0x46')]=[];this[a22_0x174e('0x19')]=0x0;for(const _0xf092f0 in _0x549569){this['downloadFiles'][a22_0x174e('0x47')](_0x549569[_0xf092f0]);}console[a22_0x174e('0x36')](a22_0x174e('0x48')+this[a22_0x174e('0x1b')][a22_0x174e('0x49')]);if(this[a22_0x174e('0x1b')]['length']>0x0){this[a22_0x174e('0x4a')]();}}[a22_0x174e('0x2e')](this));}[a22_0x174e('0x4b')](){if(fsExtra['existsSync'](this[a22_0x174e('0x12')])){fsExtra[a22_0x174e('0x45')](this[a22_0x174e('0x12')]);}if(fsExtra['existsSync'](this[a22_0x174e('0x16')])){fsExtra[a22_0x174e('0x45')](this[a22_0x174e('0x16')]);}if(!fsExtra['existsSync'](this[a22_0x174e('0x16')])){fsExtra['removeSync'](this[a22_0x174e('0x16')]);}if(!fsExtra[a22_0x174e('0x4c')](this[a22_0x174e('0x4d')])){fsExtra[a22_0x174e('0x4e')](this['m3uFile']);}this['loadMediaList']();}[a22_0x174e('0x4f')](){this[a22_0x174e('0x28')][a22_0x174e('0x50')][a22_0x174e('0x51')]();}[a22_0x174e('0x44')](){const _0x18e261=JSON[a22_0x174e('0x31')](this[a22_0x174e('0x43')]);try{if(!fsExtra[a22_0x174e('0x4c')](this[a22_0x174e('0x16')])){return!![];}else{const _0x571cf2=fsExtra[a22_0x174e('0x22')](this['playListFile'])[a22_0x174e('0x52')]();if(_0x571cf2!=_0x18e261){return!![];}}}catch(_0x467c6b){console[a22_0x174e('0x36')](_0x467c6b);}return![];}['download'](){console['log']('this.currentFile:\x20'+this[a22_0x174e('0x19')]+a22_0x174e('0x53')+this[a22_0x174e('0x1b')]['length']);if(this[a22_0x174e('0x19')]>=this['downloadFiles'][a22_0x174e('0x49')]){this['finishProcess']();return;}const _0x565823=String(this[a22_0x174e('0x1b')][this[a22_0x174e('0x19')]]['path']);const _0x28decc=this[a22_0x174e('0x1b')][this[a22_0x174e('0x19')]][a22_0x174e('0x54')];let _0x13746f=_0x565823[a22_0x174e('0x55')](_0x565823[a22_0x174e('0x56')]('/')+0x1);const _0x891405=_0x13746f['split']('.')[a22_0x174e('0x57')](0x0,-0x1)[a22_0x174e('0x58')]('.');let _0x405fea=this[a22_0x174e('0x26')]+_0x565823;const _0x2271e8=_0x405fea[a22_0x174e('0x59')]('.')[a22_0x174e('0x57')](0x0,-0x1)[a22_0x174e('0x58')]('.');if(_0x28decc=='youtube_single'){_0x13746f=_0x13746f+'.mp4';}else if(_0x28decc=='image'){_0x13746f=_0x891405+a22_0x174e('0x5a');_0x405fea=_0x2271e8+a22_0x174e('0x5a');}console['log'](a22_0x174e('0x5b'));console[a22_0x174e('0x36')](_0x565823);console[a22_0x174e('0x36')](_0x28decc);console['log'](_0x13746f);console['log'](_0x405fea);console[a22_0x174e('0x36')](_0x891405);console[a22_0x174e('0x36')](_0x2271e8);console[a22_0x174e('0x36')](a22_0x174e('0x5b'));if(fsExtra[a22_0x174e('0x4c')](this[a22_0x174e('0x12')]+_0x13746f)){this['checkVideo'](this['tempFolder']+_0x13746f)['then'](function(_0x46da9a){if(_0x46da9a){this[a22_0x174e('0x19')]++;}else{this[a22_0x174e('0x1a')]=!![];}this['download']();}[a22_0x174e('0x2e')](this));}else if(fsExtra[a22_0x174e('0x4c')](this[a22_0x174e('0x15')]+_0x13746f)){this[a22_0x174e('0x5c')](this['filesFolder']+_0x13746f)[a22_0x174e('0x4')](function(_0x7fa5d){if(_0x7fa5d){fsExtra[a22_0x174e('0x5d')](this['filesFolder']+_0x13746f,this[a22_0x174e('0x12')]+_0x13746f);this['currentFile']++;}else{this['playlistChanged']=!![];}this[a22_0x174e('0x4a')]();}[a22_0x174e('0x2e')](this));}else{console['log']('Downloading:\x20'+_0x405fea);this[a22_0x174e('0x1a')]=!![];if(_0x28decc=='youtube_single'){this[a22_0x174e('0x5e')](_0x565823);}else{this[a22_0x174e('0x5f')](_0x405fea,_0x13746f,_0x28decc);}}}[a22_0x174e('0x5c')](_0x371c6f){return __awaiter(this,void 0x0,void 0x0,function*(){console['log'](a22_0x174e('0x60')+_0x371c6f);const _0x520dac=yield mediainfo(_0x371c6f)[a22_0x174e('0x3d')](_0x178c9a=>{console[a22_0x174e('0x36')](_0x178c9a);fsExtra[a22_0x174e('0x4e')](_0x371c6f);return![];});const _0x3e2810=_0x520dac[a22_0x174e('0x61')]['track'][a22_0x174e('0x49')]>0x1&&_0x520dac[a22_0x174e('0x61')][a22_0x174e('0x62')][0x1][a22_0x174e('0x63')]=='Video';if(!_0x3e2810){fsExtra['removeSync'](_0x371c6f);}console[a22_0x174e('0x36')]('mediainfo\x20check:'+_0x3e2810);return _0x3e2810;});}['downloader'](_0x5dea45,_0x249c3d,_0x4333d5){const _0xacb87c=new Downloader();console[a22_0x174e('0x36')](_0x5dea45);console[a22_0x174e('0x36')](_0x249c3d);console['log'](_0x4333d5);const _0x27c528=_0xacb87c[a22_0x174e('0x4a')](_0x5dea45,this[a22_0x174e('0x12')]+_0x249c3d);urlExists(_0x5dea45,function(_0x1a87be,_0x1b73bb){if(_0x1b73bb){if(this[a22_0x174e('0x46')][a22_0x174e('0x64')](this[a22_0x174e('0x19')])){const _0x9c7596=this[a22_0x174e('0x46')][a22_0x174e('0x65')](this[a22_0x174e('0x19')]);if(_0x9c7596>-0x1){this[a22_0x174e('0x46')]['splice'](_0x9c7596,0x1);}}console[a22_0x174e('0x36')](a22_0x174e('0x66')+_0x5dea45);_0x27c528[a22_0x174e('0x67')]();}else{if(!this[a22_0x174e('0x46')][a22_0x174e('0x64')](this[a22_0x174e('0x19')])){this['failDownloadFiles'][a22_0x174e('0x47')](this[a22_0x174e('0x19')]);}console['log'](a22_0x174e('0x68')+_0x5dea45);this[a22_0x174e('0x19')]++;this[a22_0x174e('0x4a')]();}}[a22_0x174e('0x2e')](this));_0x27c528['on'](a22_0x174e('0x67'),function(_0x27c528){console[a22_0x174e('0x36')]('start:\x20'+_0x5dea45);});_0x27c528['on'](a22_0x174e('0x69'),function(_0x27c528){console['log'](a22_0x174e('0x6a'));this[a22_0x174e('0x4a')]();}[a22_0x174e('0x2e')](this));_0x27c528['on'](a22_0x174e('0x6b'),function(_0x27c528){console['log'](a22_0x174e('0x6b'));console[a22_0x174e('0x36')](a22_0x174e('0x6c')+_0x249c3d);console[a22_0x174e('0x36')]('mediaType:\x20'+_0x4333d5);this[a22_0x174e('0x5c')](this[a22_0x174e('0x12')]+_0x249c3d)[a22_0x174e('0x4')](function(_0x3e285c){if(_0x3e285c){this[a22_0x174e('0x19')]++;}this['download']();}[a22_0x174e('0x2e')](this));}['bind'](this));_0x27c528['on'](a22_0x174e('0x6d'),function(_0x27c528){console[a22_0x174e('0x36')](a22_0x174e('0x6d'));});_0x27c528['on'](a22_0x174e('0x6e'),function(_0x27c528){console[a22_0x174e('0x36')](a22_0x174e('0x6e'));});_0x27c528['on']('retry',function(_0x27c528){console[a22_0x174e('0x36')](a22_0x174e('0x6f'));});}[a22_0x174e('0x70')](_0x1fe2f6,_0x1f26b7,_0x2df5cf,_0x2c952d){console[a22_0x174e('0x36')]('downloadHTTPFile');console[a22_0x174e('0x36')](_0x1fe2f6);const _0x32c143=!![];let _0x51cee5=0x0;const _0x5e81ce='';console[a22_0x174e('0x36')](a22_0x174e('0x71')+_0x1fe2f6+'\x20to\x20'+_0x1f26b7);if(_0x51cee5){if(_0x51cee5>0x5){_0x2c952d(a22_0x174e('0x72'),_0x1fe2f6,_0x2df5cf,null);return;}}else{_0x51cee5=0x0;}const _0x345706=this[a22_0x174e('0x12')]+_0x1f26b7;let _0x1e4fe3;if(_0x2c952d===undefined){console['log']('WARNING\x20downloadFile\x20callback\x20is\x20undefined\x20for\x20'+_0x1fe2f6+'\x20to\x20'+_0x345706);_0x2c952d=function(_0x26d4d6,_0x54643e){console[a22_0x174e('0x36')]('downloadFile\x20callback\x20result\x20undefined:\x20',_0x26d4d6,_0x54643e);};}http[a22_0x174e('0x73')][a22_0x174e('0x74')]=0x64;const _0x3f5f56={'host':url[a22_0x174e('0x20')](_0x1fe2f6)['host'],'port':0x50,'path':url[a22_0x174e('0x20')](_0x1fe2f6)[a22_0x174e('0x75')],'agent':![]};const _0x23eef7=http[a22_0x174e('0x76')](_0x3f5f56,function(_0xfa2c1e){let _0x226c25=0x0;let _0x476d84=0x0;function _0x23a18d(){if(_0x226c25===undefined){console[a22_0x174e('0x36')](_0x1f26b7+a22_0x174e('0x77')+_0x476d84+'/'+'?');}const _0x5cc6ea=_0x476d84/_0x226c25*0x64;console[a22_0x174e('0x36')](_0x1f26b7+a22_0x174e('0x78')+_0x5cc6ea+'%\x09'+_0x476d84+'/'+_0x226c25);}console['log'](_0x1f26b7+'\x20'+_0xfa2c1e[a22_0x174e('0x79')]);switch(_0xfa2c1e[a22_0x174e('0x79')]){case 0xc8:_0x226c25=_0xfa2c1e[a22_0x174e('0x7a')][a22_0x174e('0x7b')]||_0x5e81ce;fs[a22_0x174e('0x7c')](_0x345706,function(_0x31bc65,_0x3e1e94){if(!_0x31bc65){console[a22_0x174e('0x36')]('Have\x20already\x20downloaded\x20'+_0x345706);if(_0x3e1e94[a22_0x174e('0x7d')]==_0x226c25){console[a22_0x174e('0x36')]('And\x20the\x20file\x20size\x20matches\x20('+_0x226c25+')');console[a22_0x174e('0x36')](a22_0x174e('0x7e'));}else{console['log'](a22_0x174e('0x7f')+_0x3e1e94['size']+a22_0x174e('0x80')+_0x226c25+')');}}_0x1e4fe3=fs[a22_0x174e('0x81')](_0x345706);_0xfa2c1e[a22_0x174e('0x82')](_0x1e4fe3);_0xfa2c1e['on'](a22_0x174e('0x83'),function(_0x32606e){_0x476d84+=_0x32606e[a22_0x174e('0x49')];_0x23a18d();});_0x23eef7['on'](a22_0x174e('0x69'),function(_0x31bc65){console[a22_0x174e('0x36')](a22_0x174e('0x84'));console[a22_0x174e('0x36')](_0x31bc65);});_0x1e4fe3['on'](a22_0x174e('0x85'),function(){console['log'](a22_0x174e('0x86')+_0x1fe2f6+a22_0x174e('0x87')+_0x1f26b7);_0x2c952d(null,_0x1f26b7,_0x2df5cf,_0x1f26b7);}[a22_0x174e('0x2e')](this));});break;case 0x12e:const _0x35cade=_0xfa2c1e[a22_0x174e('0x7a')]['location'];console[a22_0x174e('0x36')](a22_0x174e('0x88')+_0x1fe2f6+a22_0x174e('0x87')+_0x35cade);if(_0x51cee5<0x5){this['downloadHTTPFile'](_0x35cade,_0x1f26b7,_0x2c952d,_0x51cee5++);}else{console[a22_0x174e('0x69')](a22_0x174e('0x89')+_0x1fe2f6+'.');_0x2c952d(a22_0x174e('0x8a'),null,null,null);}return;case 0x194:console[a22_0x174e('0x36')](a22_0x174e('0x8b')+_0x1fe2f6);default:console[a22_0x174e('0x36')]('Problem\x20downloading\x20'+_0x1fe2f6+a22_0x174e('0x8c')+_0xfa2c1e[a22_0x174e('0x79')]);_0x23eef7[a22_0x174e('0x8d')]();_0x2c952d(_0xfa2c1e['statusCode'],null,null,null);return;}})['on']('error',function(_0x12bbcb){console[a22_0x174e('0x36')](a22_0x174e('0x8e')+_0x1fe2f6+'\x20'+_0x12bbcb[a22_0x174e('0x8f')]);_0x2c952d(_0x12bbcb,null,null,null);});}[a22_0x174e('0x90')](_0x212f09,_0x4e7901,_0x1a3569,_0x4eaf69){console[a22_0x174e('0x36')]('downloadHTTPFileCallback');console[a22_0x174e('0x36')](_0x212f09);console[a22_0x174e('0x36')](_0x4e7901);console['log'](_0x1a3569);console[a22_0x174e('0x36')](_0x4eaf69);if(_0x1a3569=='image'){const _0x33fc38=this['downloadFiles'][this[a22_0x174e('0x19')]][a22_0x174e('0x91')]!=null?this[a22_0x174e('0x1b')][this[a22_0x174e('0x19')]][a22_0x174e('0x91')]:0x1e;this[a22_0x174e('0x92')](_0x4eaf69,_0x33fc38);}else if(_0x1a3569=='video'){if(_0x212f09==null&&_0x4e7901!=''){this['currentFile']++;}this['download']();}console['log'](this[a22_0x174e('0x19')]);}[a22_0x174e('0x93')](_0x1ce883,_0x31f81f,_0x41e65c){progress(request(_0x1ce883),{})['on']('progress',function(_0x19e41e){console[a22_0x174e('0x36')](_0x19e41e);})['on'](a22_0x174e('0x69'),function(_0x4ca5ea){console['log'](a22_0x174e('0x94'));this[a22_0x174e('0x4a')]();})['on'](a22_0x174e('0x6b'),function(){console[a22_0x174e('0x36')](a22_0x174e('0x6c')+_0x31f81f);console['log'](a22_0x174e('0x95')+_0x41e65c);if(_0x41e65c==a22_0x174e('0x96')){const _0x1603d7=this['downloadFiles'][this[a22_0x174e('0x19')]][a22_0x174e('0x91')]!=null?this[a22_0x174e('0x1b')][this[a22_0x174e('0x19')]][a22_0x174e('0x91')]:0x1e;this['createImageVideo'](_0x31f81f,_0x1603d7);}else if(_0x41e65c==a22_0x174e('0x97')){this[a22_0x174e('0x19')]++;this[a22_0x174e('0x4a')]();}}[a22_0x174e('0x2e')](this))['pipe'](fs[a22_0x174e('0x81')](this[a22_0x174e('0x12')]+_0x31f81f));}[a22_0x174e('0x92')](_0x152994,_0x7c7618=0x1e){const _0x3c2fe6=this[a22_0x174e('0x12')]+_0x152994;console[a22_0x174e('0x36')](_0x3c2fe6);console[a22_0x174e('0x36')](_0x152994);const _0x4e26e3=_0x152994['split']('.')[a22_0x174e('0x57')](0x0,-0x1)[a22_0x174e('0x58')]('.');const _0x57b817=a22_0x174e('0x98');const _0x2a5874=['-y','-r',a22_0x174e('0x99'),a22_0x174e('0x9a'),'1',a22_0x174e('0x9b'),'glob','-i',_0x3c2fe6,'-t',String(_0x7c7618),a22_0x174e('0x9c'),a22_0x174e('0x9d'),a22_0x174e('0x9e'),a22_0x174e('0x9f'),'-r','25',a22_0x174e('0xa0'),'scale=1920:1080',this[a22_0x174e('0x12')]+_0x4e26e3+a22_0x174e('0x5a')];const _0x283b60=spawn(_0x57b817,_0x2a5874);_0x283b60[a22_0x174e('0xa1')]['on'](a22_0x174e('0x83'),function(_0x50aa9c){console[a22_0x174e('0x36')](a22_0x174e('0xa2')+_0x3c2fe6);});_0x283b60[a22_0x174e('0xa3')]['on'](a22_0x174e('0x83'),function(_0x4a24f4){console[a22_0x174e('0x36')](a22_0x174e('0xa4')+_0x4a24f4);}['bind'](this));_0x283b60['on'](a22_0x174e('0xa5'),function(){console[a22_0x174e('0x36')](a22_0x174e('0xa6'));this[a22_0x174e('0x19')]++;this[a22_0x174e('0x4a')]();}['bind'](this));}[a22_0x174e('0x5e')](_0x42f892){const _0x39c1d9=this[a22_0x174e('0x12')]+'/'+_0x42f892+a22_0x174e('0x5a');const _0x29084f=youtubedl(a22_0x174e('0xa7')+_0x42f892,[a22_0x174e('0xa8')],{'cwd':__dirname});_0x29084f['on'](a22_0x174e('0xa9'),function(_0x35d175){console[a22_0x174e('0x36')](a22_0x174e('0xaa'));console[a22_0x174e('0x36')](a22_0x174e('0xab')+_0x35d175[a22_0x174e('0xac')]);console['log'](a22_0x174e('0xad')+_0x35d175[a22_0x174e('0x7d')]);});_0x29084f['on'](a22_0x174e('0xae'),function complete(_0x49305c){'use strict';console[a22_0x174e('0x36')]('filename:\x20'+_0x49305c[a22_0x174e('0xac')]+a22_0x174e('0xaf'));});_0x29084f['on'](a22_0x174e('0x6b'),function(){console['log'](a22_0x174e('0xb0'));this[a22_0x174e('0x5c')](_0x39c1d9)['then'](function(_0x48ffe3){if(_0x48ffe3){this[a22_0x174e('0x19')]++;}this['download']();}[a22_0x174e('0x2e')](this));}['bind'](this));_0x29084f[a22_0x174e('0x82')](fs['createWriteStream'](_0x39c1d9));}['finishProcess'](){console[a22_0x174e('0x36')](a22_0x174e('0xb1'));if(this[a22_0x174e('0x1a')]){if(this[a22_0x174e('0x46')][a22_0x174e('0x49')]==0x0){fs[a22_0x174e('0x37')](this[a22_0x174e('0x16')],JSON[a22_0x174e('0x31')](this[a22_0x174e('0x43')]));let _0x349f34='#EXTCPlayListM3U::M3U'+'\x0d\x0a'+a22_0x174e('0xb2')+'\x0d\x0a';for(const _0x38dd1a in this[a22_0x174e('0x1b')]){const _0x53c906=this['downloadFiles'][_0x38dd1a][a22_0x174e('0xb3')];const _0x509651=this[a22_0x174e('0x1b')][_0x38dd1a][a22_0x174e('0x54')];const _0x4c2e9f=_0x53c906[a22_0x174e('0x55')](_0x53c906[a22_0x174e('0x56')]('/')+0x1);let _0x51ee4e=_0x4c2e9f[a22_0x174e('0x59')]('.')['slice'](0x0,-0x1)[a22_0x174e('0x58')]('.');if(_0x509651==a22_0x174e('0xb4')){_0x51ee4e=_0x53c906;}_0x349f34+='/home/osmc/luloclient/media/files/'+_0x51ee4e+a22_0x174e('0x5a')+'\x0d\x0a';}fsExtra[a22_0x174e('0x45')](this[a22_0x174e('0x15')]);fsExtra[a22_0x174e('0x5d')](this['tempFolder'],this[a22_0x174e('0x15')]);fsExtra['writeFileSync'](this[a22_0x174e('0x4d')],_0x349f34);fsExtra[a22_0x174e('0x45')](this[a22_0x174e('0x12')]);console[a22_0x174e('0x36')]('Rebooting..');const _0x35115a=spawn(a22_0x174e('0xb5'),['-r',a22_0x174e('0xb6')]);}else{console[a22_0x174e('0x36')](a22_0x174e('0xb7'));this['currentFile']=0x0;setTimeout(function(){this['download']();}[a22_0x174e('0x2e')](this),0x1388);}}else{console[a22_0x174e('0x36')](a22_0x174e('0xb8'));}}}exports[a22_0x174e('0xb9')]=SyncPlaylistsService;
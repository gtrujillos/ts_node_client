var a23_0x4892=['newPlayList','kodiHost','kodiUser','.lulo123.','forceReload','httpClientService','HttpClientService','config','parse','readFileSync','playerId','baseURL','env','WEB_SERVICE_URL','deploy/','playListServiceURL','api/player_playlist.php?player_id={0}','playerServiceURL','api/player.php?player_id={0}','kodi','kodiPassword','checkDependencies','registerClient','loadMediaList','updateSettings','getStatus','bind','deviceUuid','writeFileSync','stringify','registerClient\x20deviceUuid:\x20','log','kodi\x20playlist:\x20','playlist','Kodi\x20exist','getItems','this.kodi.playlist.getItems:\x20','currentPlaylist','sendDeviceRegistration','catch','sendDeviceRegistration:\x20','context','post','player','label','reportStatus','playingItem:\x20','http://restapi.lulo.run/player_devices/report_status','reportStatusResponse:\x20','checkFolders','ensureDir','tempFolder','loadMediaList:\x20','hasPlayListChanged','emptyDirSync','push','Total:\x20','length','download','reloadMediaList','existsSync','removeSync','m3uFile','toString','this.currentFile:\x20','\x20of\x20','finishProcess','path','media_type','substring','lastIndexOf','slice','join','youtube_single','.mp4','**********+','checkVideo','copySync','Downloading:\x20','downloader','videoFile:\x20','media','track','@type','Video','mediainfo\x20check:','includes','indexOf','splice','start','Error:\x20','start:\x20','error:\x20','end','mediaType:\x20','stopped','destroyed','retry','downloadHTTPFile','Attempting\x20to\x20download\x20','\x20to\x20','Max\x20redirects\x20reached','WARNING\x20downloadFile\x20callback\x20is\x20undefined\x20for\x20','downloadFile\x20callback\x20result\x20undefined:\x20','maxSockets','get','\x20Progress:\x20unknown\x09','\x20Progress:\x20','statusCode','headers','stat','Have\x20already\x20downloaded\x20','size','And\x20the\x20file\x20size\x20matches\x20(','Redownloading',')\x20vs\x20New(','createWriteStream','pipe','data','error','err:\x20','location','Redirect\x20limit\x20encountered\x20for\x20','302','File\x20Not\x20Found\x20','\x20STATUS:\x20','abort','message','image','duration','createImageVideo','progress','Error\x20downloading\x20file','Downloaded:\x20','split','1/2','-loop','-pattern_type','glob','-c:v','libx264','yuv420p','scale=1920:1080','Converting\x20','stderr','close','finished\x20mp4\x20convert','downloadYouTube','http://www.youtube.com/watch?v=','--format=18','info','filename:\x20','_filename','size:\x20','\x20already\x20downloaded.','finished\x20youtube\x20downloading!','Finishing','#EXTCPlayListM3U::M3U','#EXTINF:0,luloPlayList','Refreshing..','No\x20playlist\x20changes.','refreshPlayer','jsonrpcClient','Playlist.Clear','Playlist.Cleared','Playlist.Add','//home/osmc/luloclient/media/files/lulo_playlist.m3u','Playlist.Added','Player.Open','Playlist.Opened','kodiCommandClient','reboot','Reboot()','rss','header_active','setRss','turnOnTV','CECActivateSource()','turnOffTV','CECStandby()','/home/osmc/.kodi/userdata/RssFeeds.xml','xmlContent:\x20','xml2js','parseString','result:\x20%j','none','rssfeeds','feed','Builder','buildObject','xml:\x20%j','Settings.SetSettingValue','lookandfeel.enablerssfeeds','setRss:','videoplayer.usedisplayasclock','enableClock:\x20','kodi-send\x20--action=\x22','2.0','/jsonrpc','SyncPlaylistsService','next','done','value','then','apply','defineProperty','node-mediainfo','url','http','request','request-progress','child_process','exec','string-template','youtube-dl','uuid/v4','config.json','context.json','url-exists','mt-files-downloader','mediaFolder','temp/','filesFolder','files/','playListFile','playlist.txt','lulo_playlist.m3u','currentFile','playlistChanged','downloadFiles','failDownloadFiles'];(function(_0x5c8311,_0x106682){var _0x563e7f=function(_0x4dc99d){while(--_0x4dc99d){_0x5c8311['push'](_0x5c8311['shift']());}};_0x563e7f(++_0x106682);}(a23_0x4892,0xc8));var a23_0x3d5b=function(_0x3f29e6,_0x59949d){_0x3f29e6=_0x3f29e6-0x0;var _0x2f3185=a23_0x4892[_0x3f29e6];return _0x2f3185;};'use strict';var __awaiter=this&&this['__awaiter']||function(_0x568f1c,_0xad0029,_0x5370ee,_0x80c4cf){function _0x4af004(_0x2219f6){return _0x2219f6 instanceof _0x5370ee?_0x2219f6:new _0x5370ee(function(_0x2f3ec0){_0x2f3ec0(_0x2219f6);});}return new(_0x5370ee||(_0x5370ee=Promise))(function(_0x17ab53,_0x1e1c27){function _0x2b78ee(_0x53c99d){try{_0x1aac3(_0x80c4cf[a23_0x3d5b('0x0')](_0x53c99d));}catch(_0x49a9f8){_0x1e1c27(_0x49a9f8);}}function _0x215970(_0x3195b6){try{_0x1aac3(_0x80c4cf['throw'](_0x3195b6));}catch(_0xd78906){_0x1e1c27(_0xd78906);}}function _0x1aac3(_0xf8c068){_0xf8c068[a23_0x3d5b('0x1')]?_0x17ab53(_0xf8c068[a23_0x3d5b('0x2')]):_0x4af004(_0xf8c068['value'])[a23_0x3d5b('0x3')](_0x2b78ee,_0x215970);}_0x1aac3((_0x80c4cf=_0x80c4cf[a23_0x3d5b('0x4')](_0x568f1c,_0xad0029||[]))[a23_0x3d5b('0x0')]());});};Object[a23_0x3d5b('0x5')](exports,'__esModule',{'value':!![]});const HttpClientService_1=require('../infrastructure/HttpClientService');const playerService_1=require('./playerService');const mediainfo=require(a23_0x3d5b('0x6'));const fs=require('fs');const url=require(a23_0x3d5b('0x7'));const http=require(a23_0x3d5b('0x8'));const fsExtra=require('fs-extra');const request=require(a23_0x3d5b('0x9'));const progress=require(a23_0x3d5b('0xa'));const spawn=require('child_process')['spawn'];const exec=require(a23_0x3d5b('0xb'))[a23_0x3d5b('0xc')];const isImage=require('is-image');const format=require(a23_0x3d5b('0xd'));const os=require('os');const youtubedl=require(a23_0x3d5b('0xe'));const uuidv4=require(a23_0x3d5b('0xf'));const configFile=a23_0x3d5b('0x10');const contextFile=a23_0x3d5b('0x11');const urlExists=require(a23_0x3d5b('0x12'));const kodi_rpc=require('node-kodi');const Downloader=require(a23_0x3d5b('0x13'));class SyncPlaylistsService{constructor(){this['mediaFolder']='media/';this['tempFolder']=this[a23_0x3d5b('0x14')]+a23_0x3d5b('0x15');this[a23_0x3d5b('0x16')]=this['mediaFolder']+a23_0x3d5b('0x17');this[a23_0x3d5b('0x18')]=this[a23_0x3d5b('0x14')]+a23_0x3d5b('0x19');this['m3uFile']=this[a23_0x3d5b('0x16')]+a23_0x3d5b('0x1a');this[a23_0x3d5b('0x1b')]=0x0;this[a23_0x3d5b('0x1c')]=![];this[a23_0x3d5b('0x1d')]=[];this[a23_0x3d5b('0x1e')]=[];this[a23_0x3d5b('0x1f')]={};this[a23_0x3d5b('0x20')]='http://localhost';this[a23_0x3d5b('0x21')]='lulo';this['kodiPassword']=a23_0x3d5b('0x22');this[a23_0x3d5b('0x23')]=![];this[a23_0x3d5b('0x24')]=new HttpClientService_1[(a23_0x3d5b('0x25'))]();this['playerService']=new playerService_1['PlayerService']();}['init'](){this[a23_0x3d5b('0x26')]=JSON[a23_0x3d5b('0x27')](fs[a23_0x3d5b('0x28')](configFile));this['context']=JSON[a23_0x3d5b('0x27')](fs['readFileSync'](contextFile));this['playerId']=this['config'][a23_0x3d5b('0x29')];this[a23_0x3d5b('0x2a')]=process[a23_0x3d5b('0x2b')][a23_0x3d5b('0x2c')]+a23_0x3d5b('0x2d');this[a23_0x3d5b('0x2e')]=this['baseURL']+a23_0x3d5b('0x2f');this[a23_0x3d5b('0x30')]=this[a23_0x3d5b('0x2a')]+a23_0x3d5b('0x31');this[a23_0x3d5b('0x32')]=new kodi_rpc({'url':this[a23_0x3d5b('0x20')],'user':this[a23_0x3d5b('0x21')],'password':this[a23_0x3d5b('0x33')]});this[a23_0x3d5b('0x34')]();this[a23_0x3d5b('0x35')]();this['checkFolders']();this[a23_0x3d5b('0x36')]();this[a23_0x3d5b('0x37')]();setInterval(function(){this[a23_0x3d5b('0x38')]();}[a23_0x3d5b('0x39')](this),0x2710);setInterval(function(){this[a23_0x3d5b('0x35')]();}[a23_0x3d5b('0x39')](this),0x493e0);}['checkDependencies'](){}[a23_0x3d5b('0x35')](){const _0x154de0=this[a23_0x3d5b('0x26')]['deviceUuid'];if(!_0x154de0||_0x154de0==''){this[a23_0x3d5b('0x26')][a23_0x3d5b('0x3a')]=uuidv4();this[a23_0x3d5b('0x26')]={'deviceUuid':this[a23_0x3d5b('0x26')][a23_0x3d5b('0x3a')],'playerId':this[a23_0x3d5b('0x26')]['playerId']};fs[a23_0x3d5b('0x3b')](configFile,JSON[a23_0x3d5b('0x3c')](this[a23_0x3d5b('0x26')]));}console['log'](a23_0x3d5b('0x3d')+_0x154de0);console[a23_0x3d5b('0x3e')]('kodi:\x20');console[a23_0x3d5b('0x3e')](this[a23_0x3d5b('0x32')]);console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x3f'));console[a23_0x3d5b('0x3e')](this['kodi'][a23_0x3d5b('0x40')]);if(this[a23_0x3d5b('0x32')]&&this[a23_0x3d5b('0x32')]['playlist']){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x41'));this[a23_0x3d5b('0x32')][a23_0x3d5b('0x40')][a23_0x3d5b('0x42')](0x1)[a23_0x3d5b('0x3')](function(_0x2fc6b8){console['log'](a23_0x3d5b('0x43')+_0x2fc6b8);if(_0x2fc6b8&&_0x2fc6b8!=''){this[a23_0x3d5b('0x44')]=JSON[a23_0x3d5b('0x3c')](_0x2fc6b8);}this[a23_0x3d5b('0x45')]();}[a23_0x3d5b('0x39')](this))[a23_0x3d5b('0x46')](function(_0x283c21){this[a23_0x3d5b('0x45')]();}['bind'](this));}else{console[a23_0x3d5b('0x3e')]('Kodi\x20not\x20exist');this[a23_0x3d5b('0x45')]();}}[a23_0x3d5b('0x45')](){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x47'));const _0x40901f={'player_id':this[a23_0x3d5b('0x29')],'device_uuid':this[a23_0x3d5b('0x26')]['deviceUuid'],'network_info':JSON['stringify'](os['networkInterfaces']()),'firmware_info':JSON['stringify'](this[a23_0x3d5b('0x48')]),'playlist':this[a23_0x3d5b('0x44')],'playing_item':'','status':0x0};console[a23_0x3d5b('0x3e')](_0x40901f);this[a23_0x3d5b('0x24')][a23_0x3d5b('0x49')]('http://restapi.lulo.run/player_devices/register',_0x40901f,![])[a23_0x3d5b('0x3')](function(_0x4acb69){console[a23_0x3d5b('0x3e')]('register\x20response:\x20'+Date());})['catch'](function(_0x1b704f){});}[a23_0x3d5b('0x38')](){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x38'));this[a23_0x3d5b('0x32')][a23_0x3d5b('0x4a')]['getCurrentlyPlayingVideo']()[a23_0x3d5b('0x3')](function(_0x59566c){const _0x2bf9a1=_0x59566c['item'][a23_0x3d5b('0x4b')];this[a23_0x3d5b('0x4c')](_0x2bf9a1);}[a23_0x3d5b('0x39')](this))[a23_0x3d5b('0x46')](function(_0x171bc8){console[a23_0x3d5b('0x3e')](_0x171bc8);this[a23_0x3d5b('0x4c')](_0x171bc8);}[a23_0x3d5b('0x39')](this));}[a23_0x3d5b('0x4c')](_0x14a1da){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x4d')+_0x14a1da);const _0x35fac5={'player_id':this[a23_0x3d5b('0x29')],'device_uuid':this[a23_0x3d5b('0x26')][a23_0x3d5b('0x3a')],'status':_0x14a1da!=''&&_0x14a1da!=null?0x1:0x0,'playing_item':_0x14a1da};this['httpClientService'][a23_0x3d5b('0x49')](a23_0x3d5b('0x4e'),_0x35fac5,![])['then'](function(_0x29683d){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x4f')+Date());})[a23_0x3d5b('0x46')](function(_0x42c6ff){});}[a23_0x3d5b('0x50')](){fsExtra[a23_0x3d5b('0x51')](this['mediaFolder'],_0x5510fd=>{});fsExtra[a23_0x3d5b('0x51')](this[a23_0x3d5b('0x52')],_0x23625d=>{});fsExtra[a23_0x3d5b('0x51')](this[a23_0x3d5b('0x16')],_0x2994bf=>{});}[a23_0x3d5b('0x36')](){const _0x1b1d51=format(this['playListServiceURL'],this['playerId']);console[a23_0x3d5b('0x3e')](_0x1b1d51);request({'url':_0x1b1d51,'json':!![]},function(_0x18b152,_0x183c25,_0x4ad12f){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x53'));this[a23_0x3d5b('0x1f')]=_0x4ad12f;this['playlistChanged']=this[a23_0x3d5b('0x54')]();fsExtra[a23_0x3d5b('0x55')](this[a23_0x3d5b('0x52')]);this[a23_0x3d5b('0x1d')]=[];this[a23_0x3d5b('0x1e')]=[];this[a23_0x3d5b('0x1b')]=0x0;for(const _0x33e768 in _0x4ad12f){this['downloadFiles'][a23_0x3d5b('0x56')](_0x4ad12f[_0x33e768]);}console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x57')+this['downloadFiles'][a23_0x3d5b('0x58')]);if(this[a23_0x3d5b('0x1d')][a23_0x3d5b('0x58')]>0x0){this[a23_0x3d5b('0x59')]();}}[a23_0x3d5b('0x39')](this));}[a23_0x3d5b('0x5a')](){this[a23_0x3d5b('0x23')]=!![];if(fsExtra[a23_0x3d5b('0x5b')](this[a23_0x3d5b('0x52')])){fsExtra['emptyDirSync'](this[a23_0x3d5b('0x52')]);}if(fsExtra[a23_0x3d5b('0x5b')](this[a23_0x3d5b('0x16')])){fsExtra[a23_0x3d5b('0x55')](this['filesFolder']);}if(!fsExtra[a23_0x3d5b('0x5b')](this[a23_0x3d5b('0x18')])){fsExtra[a23_0x3d5b('0x5c')](this['playListFile']);}if(!fsExtra[a23_0x3d5b('0x5b')](this['m3uFile'])){fsExtra['removeSync'](this[a23_0x3d5b('0x5d')]);}this[a23_0x3d5b('0x36')]();}[a23_0x3d5b('0x54')](){const _0x16e19f=JSON[a23_0x3d5b('0x3c')](this['newPlayList']);try{if(!fsExtra[a23_0x3d5b('0x5b')](this['playListFile'])){return!![];}else{const _0x11b975=fsExtra[a23_0x3d5b('0x28')](this[a23_0x3d5b('0x18')])[a23_0x3d5b('0x5e')]();if(_0x11b975!=_0x16e19f){return!![];}}}catch(_0x43850f){console[a23_0x3d5b('0x3e')](_0x43850f);}return![];}[a23_0x3d5b('0x59')](){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x5f')+this[a23_0x3d5b('0x1b')]+a23_0x3d5b('0x60')+this[a23_0x3d5b('0x1d')][a23_0x3d5b('0x58')]);if(this['currentFile']>=this[a23_0x3d5b('0x1d')][a23_0x3d5b('0x58')]){this[a23_0x3d5b('0x61')]();return;}const _0x2c6570=String(this[a23_0x3d5b('0x1d')][this[a23_0x3d5b('0x1b')]][a23_0x3d5b('0x62')]);const _0x2be42b=this[a23_0x3d5b('0x1d')][this[a23_0x3d5b('0x1b')]][a23_0x3d5b('0x63')];let _0x52b747=_0x2c6570[a23_0x3d5b('0x64')](_0x2c6570[a23_0x3d5b('0x65')]('/')+0x1);const _0x226844=_0x52b747['split']('.')[a23_0x3d5b('0x66')](0x0,-0x1)[a23_0x3d5b('0x67')]('.');let _0x2c24a9=this[a23_0x3d5b('0x2a')]+_0x2c6570;const _0x3a733a=_0x2c24a9['split']('.')[a23_0x3d5b('0x66')](0x0,-0x1)[a23_0x3d5b('0x67')]('.');if(_0x2be42b==a23_0x3d5b('0x68')){_0x52b747=_0x52b747+'.mp4';}else if(_0x2be42b=='image'){_0x52b747=_0x226844+a23_0x3d5b('0x69');_0x2c24a9=_0x3a733a+a23_0x3d5b('0x69');}console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x6a'));console[a23_0x3d5b('0x3e')](_0x2c6570);console[a23_0x3d5b('0x3e')](_0x2be42b);console[a23_0x3d5b('0x3e')](_0x52b747);console[a23_0x3d5b('0x3e')](_0x2c24a9);console[a23_0x3d5b('0x3e')](_0x226844);console[a23_0x3d5b('0x3e')](_0x3a733a);console['log'](a23_0x3d5b('0x6a'));if(fsExtra[a23_0x3d5b('0x5b')](this[a23_0x3d5b('0x52')]+_0x52b747)){this[a23_0x3d5b('0x6b')](this[a23_0x3d5b('0x52')]+_0x52b747)['then'](function(_0x1fdc71){if(_0x1fdc71){this[a23_0x3d5b('0x1b')]++;}else{this[a23_0x3d5b('0x1c')]=!![];}this[a23_0x3d5b('0x59')]();}[a23_0x3d5b('0x39')](this));}else if(fsExtra[a23_0x3d5b('0x5b')](this[a23_0x3d5b('0x16')]+_0x52b747)){this[a23_0x3d5b('0x6b')](this[a23_0x3d5b('0x16')]+_0x52b747)[a23_0x3d5b('0x3')](function(_0x5414f7){if(_0x5414f7){fsExtra[a23_0x3d5b('0x6c')](this[a23_0x3d5b('0x16')]+_0x52b747,this[a23_0x3d5b('0x52')]+_0x52b747);this[a23_0x3d5b('0x1b')]++;}else{this[a23_0x3d5b('0x1c')]=!![];}this[a23_0x3d5b('0x59')]();}[a23_0x3d5b('0x39')](this));}else{console['log'](a23_0x3d5b('0x6d')+_0x2c24a9);this['playlistChanged']=!![];if(_0x2be42b==a23_0x3d5b('0x68')){this['downloadYouTube'](_0x2c6570);}else{this[a23_0x3d5b('0x6e')](_0x2c24a9,_0x52b747,_0x2be42b);}}}[a23_0x3d5b('0x6b')](_0xc825af){return __awaiter(this,void 0x0,void 0x0,function*(){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x6f')+_0xc825af);const _0x330dd7=yield mediainfo(_0xc825af)['catch'](_0x544513=>{console[a23_0x3d5b('0x3e')](_0x544513);fsExtra['removeSync'](_0xc825af);return![];});const _0x355de6=_0x330dd7[a23_0x3d5b('0x70')][a23_0x3d5b('0x71')][a23_0x3d5b('0x58')]>0x1&&_0x330dd7[a23_0x3d5b('0x70')][a23_0x3d5b('0x71')][0x1][a23_0x3d5b('0x72')]==a23_0x3d5b('0x73');if(!_0x355de6){fsExtra[a23_0x3d5b('0x5c')](_0xc825af);}console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x74')+_0x355de6);return _0x355de6;});}[a23_0x3d5b('0x6e')](_0x45a9ed,_0x586b13,_0x143821){const _0x650635=new Downloader();console[a23_0x3d5b('0x3e')](_0x45a9ed);console[a23_0x3d5b('0x3e')](_0x586b13);console[a23_0x3d5b('0x3e')](_0x143821);const _0x514ce4=_0x650635[a23_0x3d5b('0x59')](_0x45a9ed,this[a23_0x3d5b('0x52')]+_0x586b13);urlExists(_0x45a9ed,function(_0x3973d0,_0x5d97df){if(_0x5d97df){if(this['failDownloadFiles'][a23_0x3d5b('0x75')](this[a23_0x3d5b('0x1b')])){const _0x49f852=this['failDownloadFiles'][a23_0x3d5b('0x76')](this[a23_0x3d5b('0x1b')]);if(_0x49f852>-0x1){this[a23_0x3d5b('0x1e')][a23_0x3d5b('0x77')](_0x49f852,0x1);}}console[a23_0x3d5b('0x3e')]('downloading:\x20'+_0x45a9ed);_0x514ce4[a23_0x3d5b('0x78')]();}else{if(!this[a23_0x3d5b('0x1e')][a23_0x3d5b('0x75')](this[a23_0x3d5b('0x1b')])){this['failDownloadFiles']['push'](this[a23_0x3d5b('0x1b')]);}console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x79')+_0x45a9ed);this[a23_0x3d5b('0x1b')]++;this[a23_0x3d5b('0x59')]();}}[a23_0x3d5b('0x39')](this));_0x514ce4['on']('start',function(_0x514ce4){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x7a')+_0x45a9ed);});_0x514ce4['on']('error',function(_0x514ce4){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x7b'));this[a23_0x3d5b('0x59')]();}[a23_0x3d5b('0x39')](this));_0x514ce4['on'](a23_0x3d5b('0x7c'),function(_0x514ce4){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x7c'));console['log']('Downloaded:\x20'+_0x586b13);console['log'](a23_0x3d5b('0x7d')+_0x143821);this['checkVideo'](this['tempFolder']+_0x586b13)[a23_0x3d5b('0x3')](function(_0x2f7388){if(_0x2f7388){this[a23_0x3d5b('0x1b')]++;}this['download']();}[a23_0x3d5b('0x39')](this));}[a23_0x3d5b('0x39')](this));_0x514ce4['on'](a23_0x3d5b('0x7e'),function(_0x514ce4){console[a23_0x3d5b('0x3e')]('stopped');});_0x514ce4['on'](a23_0x3d5b('0x7f'),function(_0x514ce4){console['log'](a23_0x3d5b('0x7f'));});_0x514ce4['on'](a23_0x3d5b('0x80'),function(_0x514ce4){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x80'));});}[a23_0x3d5b('0x81')](_0x15b0a7,_0x47ead1,_0x41cde4,_0x2fa19c){console['log'](a23_0x3d5b('0x81'));console[a23_0x3d5b('0x3e')](_0x15b0a7);const _0x3f0942=!![];let _0x10d55f=0x0;const _0x598c07='';console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x82')+_0x15b0a7+a23_0x3d5b('0x83')+_0x47ead1);if(_0x10d55f){if(_0x10d55f>0x5){_0x2fa19c(a23_0x3d5b('0x84'),_0x15b0a7,_0x41cde4,null);return;}}else{_0x10d55f=0x0;}const _0x57e909=this[a23_0x3d5b('0x52')]+_0x47ead1;let _0x4c6e90;if(_0x2fa19c===undefined){console['log'](a23_0x3d5b('0x85')+_0x15b0a7+a23_0x3d5b('0x83')+_0x57e909);_0x2fa19c=function(_0x15ca2f,_0x3d8431){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x86'),_0x15ca2f,_0x3d8431);};}http['globalAgent'][a23_0x3d5b('0x87')]=0x64;const _0x2dca5c={'host':url[a23_0x3d5b('0x27')](_0x15b0a7)['host'],'port':0x50,'path':url['parse'](_0x15b0a7)['pathname'],'agent':![]};const _0xeb8539=http[a23_0x3d5b('0x88')](_0x2dca5c,function(_0x5c61dc){let _0x3c17b5=0x0;let _0x580af1=0x0;function _0x59043d(){if(_0x3c17b5===undefined){console[a23_0x3d5b('0x3e')](_0x47ead1+a23_0x3d5b('0x89')+_0x580af1+'/'+'?');}const _0x25c6de=_0x580af1/_0x3c17b5*0x64;console['log'](_0x47ead1+a23_0x3d5b('0x8a')+_0x25c6de+'%\x09'+_0x580af1+'/'+_0x3c17b5);}console[a23_0x3d5b('0x3e')](_0x47ead1+'\x20'+_0x5c61dc[a23_0x3d5b('0x8b')]);switch(_0x5c61dc['statusCode']){case 0xc8:_0x3c17b5=_0x5c61dc[a23_0x3d5b('0x8c')]['content-length']||_0x598c07;fs[a23_0x3d5b('0x8d')](_0x57e909,function(_0x4edc73,_0x3ea0a7){if(!_0x4edc73){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x8e')+_0x57e909);if(_0x3ea0a7[a23_0x3d5b('0x8f')]==_0x3c17b5){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0x90')+_0x3c17b5+')');console['log'](a23_0x3d5b('0x91'));}else{console[a23_0x3d5b('0x3e')]('But\x20the\x20file\x20size\x20does\x20not\x20match\x20so\x20re-downloading\x20Old('+_0x3ea0a7[a23_0x3d5b('0x8f')]+a23_0x3d5b('0x92')+_0x3c17b5+')');}}_0x4c6e90=fs[a23_0x3d5b('0x93')](_0x57e909);_0x5c61dc[a23_0x3d5b('0x94')](_0x4c6e90);_0x5c61dc['on'](a23_0x3d5b('0x95'),function(_0x4dc15b){_0x580af1+=_0x4dc15b[a23_0x3d5b('0x58')];_0x59043d();});_0xeb8539['on'](a23_0x3d5b('0x96'),function(_0x4edc73){console['log'](a23_0x3d5b('0x97'));console[a23_0x3d5b('0x3e')](_0x4edc73);});_0x4c6e90['on']('finish',function(){console[a23_0x3d5b('0x3e')]('Downloaded\x20'+_0x15b0a7+a23_0x3d5b('0x83')+_0x47ead1);_0x2fa19c(null,_0x47ead1,_0x41cde4,_0x47ead1);}[a23_0x3d5b('0x39')](this));});break;case 0x12e:const _0x1b99fb=_0x5c61dc[a23_0x3d5b('0x8c')][a23_0x3d5b('0x98')];console[a23_0x3d5b('0x3e')]('Redirect\x20'+_0x15b0a7+a23_0x3d5b('0x83')+_0x1b99fb);if(_0x10d55f<0x5){this[a23_0x3d5b('0x81')](_0x1b99fb,_0x47ead1,_0x2fa19c,_0x10d55f++);}else{console[a23_0x3d5b('0x96')](a23_0x3d5b('0x99')+_0x15b0a7+'.');_0x2fa19c(a23_0x3d5b('0x9a'),null,null,null);}return;case 0x194:console['log'](a23_0x3d5b('0x9b')+_0x15b0a7);default:console[a23_0x3d5b('0x3e')]('Problem\x20downloading\x20'+_0x15b0a7+a23_0x3d5b('0x9c')+_0x5c61dc['statusCode']);_0xeb8539[a23_0x3d5b('0x9d')]();_0x2fa19c(_0x5c61dc[a23_0x3d5b('0x8b')],null,null,null);return;}})['on'](a23_0x3d5b('0x96'),function(_0x367e2a){console[a23_0x3d5b('0x3e')]('Error\x20Downloading:\x20'+_0x15b0a7+'\x20'+_0x367e2a[a23_0x3d5b('0x9e')]);_0x2fa19c(_0x367e2a,null,null,null);});}['downloadHTTPFileCallback'](_0x59326b,_0x3e8688,_0x4983a4,_0x4cafad){console[a23_0x3d5b('0x3e')]('downloadHTTPFileCallback');console[a23_0x3d5b('0x3e')](_0x59326b);console['log'](_0x3e8688);console[a23_0x3d5b('0x3e')](_0x4983a4);console[a23_0x3d5b('0x3e')](_0x4cafad);if(_0x4983a4==a23_0x3d5b('0x9f')){const _0x5b11ca=this[a23_0x3d5b('0x1d')][this[a23_0x3d5b('0x1b')]][a23_0x3d5b('0xa0')]!=null?this[a23_0x3d5b('0x1d')][this[a23_0x3d5b('0x1b')]][a23_0x3d5b('0xa0')]:0x1e;this[a23_0x3d5b('0xa1')](_0x4cafad,_0x5b11ca);}else if(_0x4983a4=='video'){if(_0x59326b==null&&_0x3e8688!=''){this['currentFile']++;}this['download']();}console[a23_0x3d5b('0x3e')](this[a23_0x3d5b('0x1b')]);}['downloadRequestFile'](_0x54d8e4,_0x187c2f,_0x27ec19){progress(request(_0x54d8e4),{})['on'](a23_0x3d5b('0xa2'),function(_0x278596){console[a23_0x3d5b('0x3e')](_0x278596);})['on'](a23_0x3d5b('0x96'),function(_0x569aea){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0xa3'));this[a23_0x3d5b('0x59')]();})['on'](a23_0x3d5b('0x7c'),function(){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0xa4')+_0x187c2f);console[a23_0x3d5b('0x3e')]('mediaType:\x20'+_0x27ec19);if(_0x27ec19=='image'){const _0x339aa8=this['downloadFiles'][this[a23_0x3d5b('0x1b')]][a23_0x3d5b('0xa0')]!=null?this[a23_0x3d5b('0x1d')][this[a23_0x3d5b('0x1b')]]['duration']:0x1e;this[a23_0x3d5b('0xa1')](_0x187c2f,_0x339aa8);}else if(_0x27ec19=='video'){this['currentFile']++;this[a23_0x3d5b('0x59')]();}}[a23_0x3d5b('0x39')](this))[a23_0x3d5b('0x94')](fs['createWriteStream'](this['tempFolder']+_0x187c2f));}[a23_0x3d5b('0xa1')](_0x4ea530,_0x8bee74=0x1e){const _0x1c8f5a=this[a23_0x3d5b('0x52')]+_0x4ea530;console[a23_0x3d5b('0x3e')](_0x1c8f5a);console[a23_0x3d5b('0x3e')](_0x4ea530);const _0x45946e=_0x4ea530[a23_0x3d5b('0xa5')]('.')['slice'](0x0,-0x1)[a23_0x3d5b('0x67')]('.');const _0x383763='ffmpeg';const _0x52422e=['-y','-r',a23_0x3d5b('0xa6'),a23_0x3d5b('0xa7'),'1',a23_0x3d5b('0xa8'),a23_0x3d5b('0xa9'),'-i',_0x1c8f5a,'-t',String(_0x8bee74),a23_0x3d5b('0xaa'),a23_0x3d5b('0xab'),'-pix_fmt',a23_0x3d5b('0xac'),'-r','25','-vf',a23_0x3d5b('0xad'),this[a23_0x3d5b('0x52')]+_0x45946e+a23_0x3d5b('0x69')];const _0x38fac6=spawn(_0x383763,_0x52422e);_0x38fac6['stdout']['on'](a23_0x3d5b('0x95'),function(_0x231211){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0xae')+_0x1c8f5a);});_0x38fac6[a23_0x3d5b('0xaf')]['on'](a23_0x3d5b('0x95'),function(_0x3bacde){console[a23_0x3d5b('0x3e')]('stderr:\x20'+_0x3bacde);}[a23_0x3d5b('0x39')](this));_0x38fac6['on'](a23_0x3d5b('0xb0'),function(){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0xb1'));this[a23_0x3d5b('0x1b')]++;this['download']();}['bind'](this));}[a23_0x3d5b('0xb2')](_0x5a4408){const _0x5cf859=this['tempFolder']+'/'+_0x5a4408+a23_0x3d5b('0x69');const _0x529d46=youtubedl(a23_0x3d5b('0xb3')+_0x5a4408,[a23_0x3d5b('0xb4')],{'cwd':__dirname});_0x529d46['on'](a23_0x3d5b('0xb5'),function(_0x340d09){console[a23_0x3d5b('0x3e')]('Download\x20started');console['log'](a23_0x3d5b('0xb6')+_0x340d09[a23_0x3d5b('0xb7')]);console[a23_0x3d5b('0x3e')](a23_0x3d5b('0xb8')+_0x340d09['size']);});_0x529d46['on']('complete',function complete(_0x4c9fe0){'use strict';console[a23_0x3d5b('0x3e')](a23_0x3d5b('0xb6')+_0x4c9fe0[a23_0x3d5b('0xb7')]+a23_0x3d5b('0xb9'));});_0x529d46['on'](a23_0x3d5b('0x7c'),function(){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0xba'));this[a23_0x3d5b('0x6b')](_0x5cf859)[a23_0x3d5b('0x3')](function(_0x407490){if(_0x407490){this[a23_0x3d5b('0x1b')]++;}this['download']();}[a23_0x3d5b('0x39')](this));}[a23_0x3d5b('0x39')](this));_0x529d46[a23_0x3d5b('0x94')](fs[a23_0x3d5b('0x93')](_0x5cf859));}[a23_0x3d5b('0x61')](){console['log'](a23_0x3d5b('0xbb'));if(this[a23_0x3d5b('0x1c')]){if(this['failDownloadFiles'][a23_0x3d5b('0x58')]==0x0){fs[a23_0x3d5b('0x3b')](this[a23_0x3d5b('0x18')],JSON['stringify'](this[a23_0x3d5b('0x1f')]));let _0x115e49=a23_0x3d5b('0xbc')+'\x0d\x0a'+a23_0x3d5b('0xbd')+'\x0d\x0a';for(const _0xa68808 in this[a23_0x3d5b('0x1d')]){const _0x53e011=this[a23_0x3d5b('0x1d')][_0xa68808][a23_0x3d5b('0x62')];const _0x33d99a=this[a23_0x3d5b('0x1d')][_0xa68808][a23_0x3d5b('0x63')];const _0x90fc77=_0x53e011['substring'](_0x53e011['lastIndexOf']('/')+0x1);let _0x78f02=_0x90fc77[a23_0x3d5b('0xa5')]('.')[a23_0x3d5b('0x66')](0x0,-0x1)['join']('.');if(_0x33d99a=='youtube_single'){_0x78f02=_0x53e011;}_0x115e49+='/home/osmc/luloclient/media/files/'+_0x78f02+a23_0x3d5b('0x69')+'\x0d\x0a';}fsExtra[a23_0x3d5b('0x55')](this[a23_0x3d5b('0x16')]);fsExtra[a23_0x3d5b('0x6c')](this['tempFolder'],this[a23_0x3d5b('0x16')]);fsExtra[a23_0x3d5b('0x3b')](this['m3uFile'],_0x115e49);fsExtra[a23_0x3d5b('0x55')](this[a23_0x3d5b('0x52')]);console['log'](a23_0x3d5b('0xbe'));this['refreshPlayer']();}else{console[a23_0x3d5b('0x3e')]('Playlist\x20incomplete,\x20retry.');this['currentFile']=0x0;setTimeout(function(){this[a23_0x3d5b('0x59')]();}['bind'](this),0x1388);}}else{console['log'](a23_0x3d5b('0xbf'));}}[a23_0x3d5b('0xc0')](){this[a23_0x3d5b('0xc1')](a23_0x3d5b('0xc2'),{'playlistid':0x1},function(_0x4c73fc){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0xc3'));console[a23_0x3d5b('0x3e')](_0x4c73fc);this[a23_0x3d5b('0xc1')](a23_0x3d5b('0xc4'),{'item':{'file':a23_0x3d5b('0xc5')},'playlistid':0x1},function(_0x4c73fc){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0xc6'));console[a23_0x3d5b('0x3e')](_0x4c73fc);this[a23_0x3d5b('0xc1')](a23_0x3d5b('0xc7'),{'item':{'playlistid':0x1,'position':0x0}},function(_0x4c73fc){console[a23_0x3d5b('0x3e')](a23_0x3d5b('0xc8'));console[a23_0x3d5b('0x3e')](_0x4c73fc);if(this[a23_0x3d5b('0x23')]){this[a23_0x3d5b('0x23')]=![];this[a23_0x3d5b('0xc9')]('RestartApp()');}}[a23_0x3d5b('0x39')](this));}['bind'](this));}['bind'](this));}[a23_0x3d5b('0xca')](){console[a23_0x3d5b('0x3e')]('Rebooting');this['kodiCommandClient'](a23_0x3d5b('0xcb'));}[a23_0x3d5b('0x37')](){const _0x45480e=format(this[a23_0x3d5b('0x30')],this['playerId']);console[a23_0x3d5b('0x3e')](_0x45480e);request({'url':_0x45480e,'json':!![]},function(_0x2058e5,_0x4f1051,_0x14b5b3){if(_0x14b5b3['length']>0x0){const _0x6d2e71=_0x14b5b3[0x0];const _0x132984=_0x6d2e71[a23_0x3d5b('0xcc')];const _0x20b22c=_0x6d2e71[a23_0x3d5b('0xcd')]==0x1;this[a23_0x3d5b('0xce')](_0x132984);this['enableClock'](_0x20b22c);}console[a23_0x3d5b('0x3e')](_0x14b5b3);}[a23_0x3d5b('0x39')](this));}[a23_0x3d5b('0xcf')](){this[a23_0x3d5b('0xc9')](a23_0x3d5b('0xd0'));}[a23_0x3d5b('0xd1')](){this['kodiCommandClient'](a23_0x3d5b('0xd2'));}[a23_0x3d5b('0xce')](_0x45dd76){const _0x5754ee=_0x45dd76!=null&&_0x45dd76!='';const _0x459bb8=a23_0x3d5b('0xd3');if(fsExtra[a23_0x3d5b('0x5b')](_0x459bb8)){const _0x3e8a8c=fsExtra[a23_0x3d5b('0x28')](_0x459bb8);console[a23_0x3d5b('0x3e')](a23_0x3d5b('0xd4')+_0x3e8a8c);const _0x26d037=require(a23_0x3d5b('0xd5'));const _0x15b693=_0x26d037[a23_0x3d5b('0xd6')];_0x15b693(_0x3e8a8c,function(_0x5a36a0,_0x48a4c8){console[a23_0x3d5b('0x3e')]('err:\x20%j',_0x5a36a0);console[a23_0x3d5b('0x3e')](a23_0x3d5b('0xd7'),_0x48a4c8);if(!_0x45dd76||_0x45dd76==null||_0x45dd76==''){_0x45dd76=a23_0x3d5b('0xd8');}_0x48a4c8[a23_0x3d5b('0xd9')]['set'][0x0][a23_0x3d5b('0xda')][0x0]['_']=_0x45dd76;const _0x4daf7b=new _0x26d037[(a23_0x3d5b('0xdb'))]();const _0x5a7a20=_0x4daf7b[a23_0x3d5b('0xdc')](_0x48a4c8);console['log'](a23_0x3d5b('0xdd'),_0x5a7a20);fsExtra[a23_0x3d5b('0x3b')](_0x459bb8,_0x5a7a20);});this[a23_0x3d5b('0xc9')]('RefreshRSS()');this[a23_0x3d5b('0xc1')](a23_0x3d5b('0xde'),{'setting':a23_0x3d5b('0xdf'),'value':_0x5754ee},function(_0x58c058){console['log'](a23_0x3d5b('0xe0'));console[a23_0x3d5b('0x3e')](_0x58c058);}[a23_0x3d5b('0x39')](this));}else{}}['enableClock'](_0x1cd829){this['jsonrpcClient']('Settings.SetSettingValue',{'setting':a23_0x3d5b('0xe1'),'value':_0x1cd829},function(_0x117d82){console['log'](a23_0x3d5b('0xe2'));console['log'](_0x117d82);}['bind'](this));}['kodiCommandClient'](_0x3c98b0){exec(a23_0x3d5b('0xe3')+_0x3c98b0+'\x22',function(_0x2bfa80){console[a23_0x3d5b('0x3e')](_0x2bfa80);});}[a23_0x3d5b('0xc1')](_0x2c9f98,_0x2d0607,_0x24a7f8){const _0x1f0319={'jsonrpc':a23_0x3d5b('0xe4'),'method':_0x2c9f98,'params':_0x2d0607,'id':0x1};this[a23_0x3d5b('0x24')][a23_0x3d5b('0x49')](this[a23_0x3d5b('0x20')]+a23_0x3d5b('0xe5'),_0x1f0319,![],{'user':this[a23_0x3d5b('0x21')],'pass':this[a23_0x3d5b('0x33')]})[a23_0x3d5b('0x3')](function(_0x149a3d){_0x24a7f8(_0x149a3d);})[a23_0x3d5b('0x46')](function(_0x5b8827){});}}exports[a23_0x3d5b('0xe6')]=SyncPlaylistsService;
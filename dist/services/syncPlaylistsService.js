var a22_0x18a8=['WARNING\x20downloadFile\x20callback\x20is\x20undefined\x20for\x20','\x20to\x20','downloadFile\x20callback\x20result\x20undefined:\x20','globalAgent','maxSockets','host','pathname','\x20Progress:\x20unknown\x09','\x20Progress:\x20','statusCode','headers','content-length','stat','Have\x20already\x20downloaded\x20','And\x20the\x20file\x20size\x20matches\x20(','Redownloading','But\x20the\x20file\x20size\x20does\x20not\x20match\x20so\x20re-downloading\x20Old(','size',')\x20vs\x20New(','createWriteStream','pipe','data','error','err:\x20','finish','Downloaded\x20','location','Redirect\x20','downloadHTTPFile','Redirect\x20limit\x20encountered\x20for\x20','302','File\x20Not\x20Found\x20','Problem\x20downloading\x20','\x20STATUS:\x20','Error\x20Downloading:\x20','message','downloadHTTPFileCallback','duration','createImageVideo','progress','ffmpeg','1/2','-pattern_type','-c:v','-pix_fmt','yuv420p','-vf','scale=1920:1080','stdout','stderr','stderr:\x20','close','finished\x20mp4\x20convert','http://www.youtube.com/watch?v=','--format=18','Download\x20started','filename:\x20','_filename','size:\x20','complete','\x20already\x20downloaded.','#EXTCPlayListM3U::M3U','path','split','Refreshing..','refreshPlaylist','Playlist\x20incomplete,\x20retry.','No\x20playlist\x20changes.','jsonrpcClient','Playlist.Clear','Playlist.Cleared','//home/osmc/luloclient/media/files/lulo_playlist.m3u','Player.Open','2.0','http://localhost/jsonrpc','SyncPlaylistsService','__awaiter','next','throw','done','value','then','apply','defineProperty','__esModule','../infrastructure/HttpClientService','node-mediainfo','url','request-progress','spawn','child_process','exec','is-image','string-template','youtube-dl','uuid/v4','config.json','url-exists','mediaFolder','media/','tempFolder','temp/','filesFolder','files/','playListFile','m3uFile','lulo_playlist.m3u','currentFile','playlistChanged','downloadFiles','failDownloadFiles','newPlayList','httpClientService','init','context','parse','readFileSync','playerId','config','env','deploy/','playListServiceURL','baseURL','api/player_playlist.php?player_id={0}','kodi','lulo','.lulo123.','checkDependencies','registerClient','checkFolders','loadMediaList','getStatus','bind','getItems','stringify','deviceUuid','networkInterfaces','post','http://restapi.lulo.run/player_devices/register','log','catch','writeFileSync','item','label','reportStatus','playingItem:\x20','http://restapi.lulo.run/player_devices/report_status','ensureDir','hasPlayListChanged','emptyDirSync','Total:\x20','length','download','reloadMediaList','existsSync','removeSync','reboot','sudo\x20/sbin/shutdown\x20-r\x20now','toString','this.currentFile:\x20','\x20of\x20','finishProcess','media_type','substring','lastIndexOf','join','slice','image','.mp4','**********+','copySync','Downloading:\x20','youtube_single','downloadYouTube','downloader','checkVideo','videoFile:\x20','media','track','Video','mediainfo\x20check:','includes','splice','downloading:\x20','push','Error:\x20','start','start:\x20','end','mediaType:\x20','stopped','destroyed','retry','Attempting\x20to\x20download\x20','Max\x20redirects\x20reached'];(function(_0x28b3a5,_0x454c05){var _0x474c4b=function(_0x4e3afd){while(--_0x4e3afd){_0x28b3a5['push'](_0x28b3a5['shift']());}};_0x474c4b(++_0x454c05);}(a22_0x18a8,0x10f));var a22_0x1b24=function(_0x20540f,_0x5bc9e8){_0x20540f=_0x20540f-0x0;var _0x48cac0=a22_0x18a8[_0x20540f];return _0x48cac0;};'use strict';var __awaiter=this&&this[a22_0x1b24('0x0')]||function(_0x2167ea,_0x37f6b7,_0x4af508,_0x23b39c){function _0x9707e1(_0xcad507){return _0xcad507 instanceof _0x4af508?_0xcad507:new _0x4af508(function(_0x57751b){_0x57751b(_0xcad507);});}return new(_0x4af508||(_0x4af508=Promise))(function(_0x5e9720,_0x1f0ad6){function _0x2e9bf6(_0x2dbdb2){try{_0x491fc7(_0x23b39c[a22_0x1b24('0x1')](_0x2dbdb2));}catch(_0x48820a){_0x1f0ad6(_0x48820a);}}function _0x22d512(_0x22f967){try{_0x491fc7(_0x23b39c[a22_0x1b24('0x2')](_0x22f967));}catch(_0x386d52){_0x1f0ad6(_0x386d52);}}function _0x491fc7(_0x7371ed){_0x7371ed[a22_0x1b24('0x3')]?_0x5e9720(_0x7371ed[a22_0x1b24('0x4')]):_0x9707e1(_0x7371ed['value'])[a22_0x1b24('0x5')](_0x2e9bf6,_0x22d512);}_0x491fc7((_0x23b39c=_0x23b39c[a22_0x1b24('0x6')](_0x2167ea,_0x37f6b7||[]))['next']());});};Object[a22_0x1b24('0x7')](exports,a22_0x1b24('0x8'),{'value':!![]});const HttpClientService_1=require(a22_0x1b24('0x9'));const mediainfo=require(a22_0x1b24('0xa'));const fs=require('fs');const url=require(a22_0x1b24('0xb'));const http=require('http');const fsExtra=require('fs-extra');const request=require('request');const progress=require(a22_0x1b24('0xc'));const spawn=require('child_process')[a22_0x1b24('0xd')];const exec=require(a22_0x1b24('0xe'))[a22_0x1b24('0xf')];const isImage=require(a22_0x1b24('0x10'));const format=require(a22_0x1b24('0x11'));const os=require('os');const youtubedl=require(a22_0x1b24('0x12'));const uuidv4=require(a22_0x1b24('0x13'));const configFile=a22_0x1b24('0x14');const contextFile='context.json';const urlExists=require(a22_0x1b24('0x15'));const kodi_rpc=require('node-kodi');const Downloader=require('mt-files-downloader');class SyncPlaylistsService{constructor(){this[a22_0x1b24('0x16')]=a22_0x1b24('0x17');this[a22_0x1b24('0x18')]=this[a22_0x1b24('0x16')]+a22_0x1b24('0x19');this[a22_0x1b24('0x1a')]=this['mediaFolder']+a22_0x1b24('0x1b');this[a22_0x1b24('0x1c')]=this[a22_0x1b24('0x16')]+'playlist.txt';this[a22_0x1b24('0x1d')]=this[a22_0x1b24('0x1a')]+a22_0x1b24('0x1e');this[a22_0x1b24('0x1f')]=0x0;this[a22_0x1b24('0x20')]=![];this[a22_0x1b24('0x21')]=[];this[a22_0x1b24('0x22')]=[];this[a22_0x1b24('0x23')]={};this[a22_0x1b24('0x24')]=new HttpClientService_1['HttpClientService']();}[a22_0x1b24('0x25')](){this['config']=JSON['parse'](fs['readFileSync'](configFile));this[a22_0x1b24('0x26')]=JSON[a22_0x1b24('0x27')](fs[a22_0x1b24('0x28')](contextFile));this[a22_0x1b24('0x29')]=this[a22_0x1b24('0x2a')][a22_0x1b24('0x29')];this['baseURL']=process[a22_0x1b24('0x2b')]['WEB_SERVICE_URL']+a22_0x1b24('0x2c');this[a22_0x1b24('0x2d')]=this[a22_0x1b24('0x2e')]+a22_0x1b24('0x2f');this[a22_0x1b24('0x30')]=new kodi_rpc({'url':'http://localhost','user':a22_0x1b24('0x31'),'password':a22_0x1b24('0x32')});this[a22_0x1b24('0x33')]();this[a22_0x1b24('0x34')]();this[a22_0x1b24('0x35')]();this[a22_0x1b24('0x36')]();setInterval(function(){this[a22_0x1b24('0x37')]();}[a22_0x1b24('0x38')](this),0x2710);setInterval(function(){this[a22_0x1b24('0x34')]();}[a22_0x1b24('0x38')](this),0x493e0);}['checkDependencies'](){}[a22_0x1b24('0x34')](){this[a22_0x1b24('0x30')]['playlist'][a22_0x1b24('0x39')](0x1)[a22_0x1b24('0x5')](function(_0x581c6d){const _0x3ae573=JSON[a22_0x1b24('0x3a')](_0x581c6d);const _0x4bc2f4={'player_id':this[a22_0x1b24('0x29')],'device_uuid':this[a22_0x1b24('0x2a')][a22_0x1b24('0x3b')],'network_info':JSON[a22_0x1b24('0x3a')](os[a22_0x1b24('0x3c')]()),'firmware_info':JSON[a22_0x1b24('0x3a')](this[a22_0x1b24('0x26')]),'playlist':_0x3ae573,'playing_item':'','status':0x0};this[a22_0x1b24('0x24')][a22_0x1b24('0x3d')](a22_0x1b24('0x3e'),_0x4bc2f4,![])[a22_0x1b24('0x5')](function(_0x2c7d33){console[a22_0x1b24('0x3f')]('register\x20response:\x20'+Date());})[a22_0x1b24('0x40')](function(_0x3a6702){});console[a22_0x1b24('0x3f')](_0x4bc2f4);}[a22_0x1b24('0x38')](this));const _0x289fc6=this['config'][a22_0x1b24('0x3b')];if(!_0x289fc6||_0x289fc6==''){this['config'][a22_0x1b24('0x3b')]=uuidv4();this[a22_0x1b24('0x2a')]={'deviceUuid':this['config']['deviceUuid'],'playerId':this['config']['playerId']};fs[a22_0x1b24('0x41')](configFile,JSON[a22_0x1b24('0x3a')](this[a22_0x1b24('0x2a')]));}}['getStatus'](){console['log'](a22_0x1b24('0x37'));this[a22_0x1b24('0x30')]['player']['getCurrentlyPlayingVideo']()[a22_0x1b24('0x5')](function(_0x5d9e39){const _0xe78438=_0x5d9e39[a22_0x1b24('0x42')][a22_0x1b24('0x43')];this[a22_0x1b24('0x44')](_0xe78438);}[a22_0x1b24('0x38')](this))[a22_0x1b24('0x40')](function(_0x375807){console['log'](_0x375807);this[a22_0x1b24('0x44')](_0x375807);}[a22_0x1b24('0x38')](this));}[a22_0x1b24('0x44')](_0x453e8c){console[a22_0x1b24('0x3f')](a22_0x1b24('0x45')+_0x453e8c);const _0x785831={'player_id':this[a22_0x1b24('0x29')],'device_uuid':this['config']['deviceUuid'],'status':_0x453e8c!=''&&_0x453e8c!=null?0x1:0x0,'playing_item':_0x453e8c};this[a22_0x1b24('0x24')][a22_0x1b24('0x3d')](a22_0x1b24('0x46'),_0x785831,![])[a22_0x1b24('0x5')](function(_0x4d183c){console[a22_0x1b24('0x3f')]('reportStatusResponse:\x20'+Date());})['catch'](function(_0x31fa4e){});}[a22_0x1b24('0x35')](){fsExtra[a22_0x1b24('0x47')](this[a22_0x1b24('0x16')],_0xbf0101=>{});fsExtra[a22_0x1b24('0x47')](this[a22_0x1b24('0x18')],_0x29e9f9=>{});fsExtra[a22_0x1b24('0x47')](this[a22_0x1b24('0x1a')],_0x4c9a54=>{});}[a22_0x1b24('0x36')](){const _0x1cd871=format(this['playListServiceURL'],this[a22_0x1b24('0x29')]);console[a22_0x1b24('0x3f')](_0x1cd871);request({'url':_0x1cd871,'json':!![]},function(_0x208749,_0x3d4d9c,_0x3a17f0){console[a22_0x1b24('0x3f')]('loadMediaList:\x20');console[a22_0x1b24('0x3f')](_0x3a17f0);this[a22_0x1b24('0x23')]=_0x3a17f0;this[a22_0x1b24('0x20')]=this[a22_0x1b24('0x48')]();fsExtra[a22_0x1b24('0x49')](this[a22_0x1b24('0x18')]);this[a22_0x1b24('0x21')]=[];this['failDownloadFiles']=[];this['currentFile']=0x0;for(const _0x9eb132 in _0x3a17f0){this['downloadFiles']['push'](_0x3a17f0[_0x9eb132]);}console['log'](a22_0x1b24('0x4a')+this[a22_0x1b24('0x21')][a22_0x1b24('0x4b')]);if(this[a22_0x1b24('0x21')][a22_0x1b24('0x4b')]>0x0){this[a22_0x1b24('0x4c')]();}}[a22_0x1b24('0x38')](this));}[a22_0x1b24('0x4d')](){if(fsExtra[a22_0x1b24('0x4e')](this[a22_0x1b24('0x18')])){fsExtra[a22_0x1b24('0x49')](this[a22_0x1b24('0x18')]);}if(fsExtra['existsSync'](this[a22_0x1b24('0x1a')])){fsExtra[a22_0x1b24('0x49')](this[a22_0x1b24('0x1a')]);}if(!fsExtra[a22_0x1b24('0x4e')](this['playListFile'])){fsExtra[a22_0x1b24('0x4f')](this[a22_0x1b24('0x1c')]);}if(!fsExtra[a22_0x1b24('0x4e')](this[a22_0x1b24('0x1d')])){fsExtra[a22_0x1b24('0x4f')](this[a22_0x1b24('0x1d')]);}this[a22_0x1b24('0x36')]();}[a22_0x1b24('0x50')](){exec(a22_0x1b24('0x51'),function(_0x4dab6c){console[a22_0x1b24('0x3f')](_0x4dab6c);});}[a22_0x1b24('0x48')](){const _0x5eaa9d=JSON['stringify'](this[a22_0x1b24('0x23')]);try{if(!fsExtra[a22_0x1b24('0x4e')](this[a22_0x1b24('0x1c')])){return!![];}else{const _0x541e90=fsExtra[a22_0x1b24('0x28')](this[a22_0x1b24('0x1c')])[a22_0x1b24('0x52')]();if(_0x541e90!=_0x5eaa9d){return!![];}}}catch(_0x2d9f59){console['log'](_0x2d9f59);}return![];}['download'](){console[a22_0x1b24('0x3f')](a22_0x1b24('0x53')+this[a22_0x1b24('0x1f')]+a22_0x1b24('0x54')+this[a22_0x1b24('0x21')]['length']);if(this['currentFile']>=this[a22_0x1b24('0x21')]['length']){this[a22_0x1b24('0x55')]();return;}const _0x218e8b=String(this[a22_0x1b24('0x21')][this[a22_0x1b24('0x1f')]]['path']);const _0x34337e=this['downloadFiles'][this[a22_0x1b24('0x1f')]][a22_0x1b24('0x56')];let _0xbb2d99=_0x218e8b[a22_0x1b24('0x57')](_0x218e8b[a22_0x1b24('0x58')]('/')+0x1);const _0x1f1ea8=_0xbb2d99['split']('.')['slice'](0x0,-0x1)[a22_0x1b24('0x59')]('.');let _0x2c0081=this[a22_0x1b24('0x2e')]+_0x218e8b;const _0x3b20a8=_0x2c0081['split']('.')[a22_0x1b24('0x5a')](0x0,-0x1)[a22_0x1b24('0x59')]('.');if(_0x34337e=='youtube_single'){_0xbb2d99=_0xbb2d99+'.mp4';}else if(_0x34337e==a22_0x1b24('0x5b')){_0xbb2d99=_0x1f1ea8+a22_0x1b24('0x5c');_0x2c0081=_0x3b20a8+a22_0x1b24('0x5c');}console['log'](a22_0x1b24('0x5d'));console[a22_0x1b24('0x3f')](_0x218e8b);console[a22_0x1b24('0x3f')](_0x34337e);console[a22_0x1b24('0x3f')](_0xbb2d99);console[a22_0x1b24('0x3f')](_0x2c0081);console[a22_0x1b24('0x3f')](_0x1f1ea8);console[a22_0x1b24('0x3f')](_0x3b20a8);console['log']('**********+');if(fsExtra[a22_0x1b24('0x4e')](this[a22_0x1b24('0x18')]+_0xbb2d99)){this['checkVideo'](this['tempFolder']+_0xbb2d99)[a22_0x1b24('0x5')](function(_0x3b9d73){if(_0x3b9d73){this[a22_0x1b24('0x1f')]++;}else{this['playlistChanged']=!![];}this[a22_0x1b24('0x4c')]();}[a22_0x1b24('0x38')](this));}else if(fsExtra[a22_0x1b24('0x4e')](this['filesFolder']+_0xbb2d99)){this['checkVideo'](this[a22_0x1b24('0x1a')]+_0xbb2d99)['then'](function(_0x12b0c2){if(_0x12b0c2){fsExtra[a22_0x1b24('0x5e')](this[a22_0x1b24('0x1a')]+_0xbb2d99,this[a22_0x1b24('0x18')]+_0xbb2d99);this['currentFile']++;}else{this[a22_0x1b24('0x20')]=!![];}this[a22_0x1b24('0x4c')]();}[a22_0x1b24('0x38')](this));}else{console['log'](a22_0x1b24('0x5f')+_0x2c0081);this[a22_0x1b24('0x20')]=!![];if(_0x34337e==a22_0x1b24('0x60')){this[a22_0x1b24('0x61')](_0x218e8b);}else{this[a22_0x1b24('0x62')](_0x2c0081,_0xbb2d99,_0x34337e);}}}[a22_0x1b24('0x63')](_0x53da47){return __awaiter(this,void 0x0,void 0x0,function*(){console[a22_0x1b24('0x3f')](a22_0x1b24('0x64')+_0x53da47);const _0x4e4319=yield mediainfo(_0x53da47)[a22_0x1b24('0x40')](_0xbae5ae=>{console[a22_0x1b24('0x3f')](_0xbae5ae);fsExtra['removeSync'](_0x53da47);return![];});const _0xa799fe=_0x4e4319[a22_0x1b24('0x65')][a22_0x1b24('0x66')][a22_0x1b24('0x4b')]>0x1&&_0x4e4319['media'][a22_0x1b24('0x66')][0x1]['@type']==a22_0x1b24('0x67');if(!_0xa799fe){fsExtra[a22_0x1b24('0x4f')](_0x53da47);}console[a22_0x1b24('0x3f')](a22_0x1b24('0x68')+_0xa799fe);return _0xa799fe;});}[a22_0x1b24('0x62')](_0x3cb20e,_0x203805,_0x18dee3){const _0x11e471=new Downloader();console['log'](_0x3cb20e);console[a22_0x1b24('0x3f')](_0x203805);console['log'](_0x18dee3);const _0xecdb10=_0x11e471[a22_0x1b24('0x4c')](_0x3cb20e,this['tempFolder']+_0x203805);urlExists(_0x3cb20e,function(_0x1d7976,_0x4f5e04){if(_0x4f5e04){if(this[a22_0x1b24('0x22')][a22_0x1b24('0x69')](this[a22_0x1b24('0x1f')])){const _0x40c12e=this[a22_0x1b24('0x22')]['indexOf'](this['currentFile']);if(_0x40c12e>-0x1){this[a22_0x1b24('0x22')][a22_0x1b24('0x6a')](_0x40c12e,0x1);}}console[a22_0x1b24('0x3f')](a22_0x1b24('0x6b')+_0x3cb20e);_0xecdb10['start']();}else{if(!this[a22_0x1b24('0x22')][a22_0x1b24('0x69')](this[a22_0x1b24('0x1f')])){this[a22_0x1b24('0x22')][a22_0x1b24('0x6c')](this[a22_0x1b24('0x1f')]);}console['log'](a22_0x1b24('0x6d')+_0x3cb20e);this[a22_0x1b24('0x1f')]++;this[a22_0x1b24('0x4c')]();}}[a22_0x1b24('0x38')](this));_0xecdb10['on'](a22_0x1b24('0x6e'),function(_0xecdb10){console[a22_0x1b24('0x3f')](a22_0x1b24('0x6f')+_0x3cb20e);});_0xecdb10['on']('error',function(_0xecdb10){console[a22_0x1b24('0x3f')]('error:\x20');this['download']();}[a22_0x1b24('0x38')](this));_0xecdb10['on'](a22_0x1b24('0x70'),function(_0xecdb10){console[a22_0x1b24('0x3f')](a22_0x1b24('0x70'));console['log']('Downloaded:\x20'+_0x203805);console[a22_0x1b24('0x3f')](a22_0x1b24('0x71')+_0x18dee3);this[a22_0x1b24('0x63')](this['tempFolder']+_0x203805)[a22_0x1b24('0x5')](function(_0xe51783){if(_0xe51783){this[a22_0x1b24('0x1f')]++;}this['download']();}[a22_0x1b24('0x38')](this));}[a22_0x1b24('0x38')](this));_0xecdb10['on'](a22_0x1b24('0x72'),function(_0xecdb10){console[a22_0x1b24('0x3f')](a22_0x1b24('0x72'));});_0xecdb10['on'](a22_0x1b24('0x73'),function(_0xecdb10){console[a22_0x1b24('0x3f')](a22_0x1b24('0x73'));});_0xecdb10['on'](a22_0x1b24('0x74'),function(_0xecdb10){console['log'](a22_0x1b24('0x74'));});}['downloadHTTPFile'](_0x5eed90,_0x3bb2bb,_0x5924ef,_0x29da5a){console[a22_0x1b24('0x3f')]('downloadHTTPFile');console['log'](_0x5eed90);const _0x50aee4=!![];let _0x404457=0x0;const _0x6941f5='';console[a22_0x1b24('0x3f')](a22_0x1b24('0x75')+_0x5eed90+'\x20to\x20'+_0x3bb2bb);if(_0x404457){if(_0x404457>0x5){_0x29da5a(a22_0x1b24('0x76'),_0x5eed90,_0x5924ef,null);return;}}else{_0x404457=0x0;}const _0x3e44d0=this[a22_0x1b24('0x18')]+_0x3bb2bb;let _0x2a7d5d;if(_0x29da5a===undefined){console[a22_0x1b24('0x3f')](a22_0x1b24('0x77')+_0x5eed90+a22_0x1b24('0x78')+_0x3e44d0);_0x29da5a=function(_0x3869f0,_0x3b796b){console['log'](a22_0x1b24('0x79'),_0x3869f0,_0x3b796b);};}http[a22_0x1b24('0x7a')][a22_0x1b24('0x7b')]=0x64;const _0x590bb3={'host':url[a22_0x1b24('0x27')](_0x5eed90)[a22_0x1b24('0x7c')],'port':0x50,'path':url[a22_0x1b24('0x27')](_0x5eed90)[a22_0x1b24('0x7d')],'agent':![]};const _0x156222=http['get'](_0x590bb3,function(_0x475759){let _0x554cd9=0x0;let _0x28ca85=0x0;function _0x1f3eba(){if(_0x554cd9===undefined){console[a22_0x1b24('0x3f')](_0x3bb2bb+a22_0x1b24('0x7e')+_0x28ca85+'/'+'?');}const _0x3ddecf=_0x28ca85/_0x554cd9*0x64;console[a22_0x1b24('0x3f')](_0x3bb2bb+a22_0x1b24('0x7f')+_0x3ddecf+'%\x09'+_0x28ca85+'/'+_0x554cd9);}console['log'](_0x3bb2bb+'\x20'+_0x475759[a22_0x1b24('0x80')]);switch(_0x475759['statusCode']){case 0xc8:_0x554cd9=_0x475759[a22_0x1b24('0x81')][a22_0x1b24('0x82')]||_0x6941f5;fs[a22_0x1b24('0x83')](_0x3e44d0,function(_0x361035,_0x291c04){if(!_0x361035){console[a22_0x1b24('0x3f')](a22_0x1b24('0x84')+_0x3e44d0);if(_0x291c04['size']==_0x554cd9){console[a22_0x1b24('0x3f')](a22_0x1b24('0x85')+_0x554cd9+')');console[a22_0x1b24('0x3f')](a22_0x1b24('0x86'));}else{console[a22_0x1b24('0x3f')](a22_0x1b24('0x87')+_0x291c04[a22_0x1b24('0x88')]+a22_0x1b24('0x89')+_0x554cd9+')');}}_0x2a7d5d=fs[a22_0x1b24('0x8a')](_0x3e44d0);_0x475759[a22_0x1b24('0x8b')](_0x2a7d5d);_0x475759['on'](a22_0x1b24('0x8c'),function(_0x441c05){_0x28ca85+=_0x441c05['length'];_0x1f3eba();});_0x156222['on'](a22_0x1b24('0x8d'),function(_0x361035){console[a22_0x1b24('0x3f')](a22_0x1b24('0x8e'));console[a22_0x1b24('0x3f')](_0x361035);});_0x2a7d5d['on'](a22_0x1b24('0x8f'),function(){console['log'](a22_0x1b24('0x90')+_0x5eed90+a22_0x1b24('0x78')+_0x3bb2bb);_0x29da5a(null,_0x3bb2bb,_0x5924ef,_0x3bb2bb);}[a22_0x1b24('0x38')](this));});break;case 0x12e:const _0x5104cf=_0x475759['headers'][a22_0x1b24('0x91')];console[a22_0x1b24('0x3f')](a22_0x1b24('0x92')+_0x5eed90+a22_0x1b24('0x78')+_0x5104cf);if(_0x404457<0x5){this[a22_0x1b24('0x93')](_0x5104cf,_0x3bb2bb,_0x29da5a,_0x404457++);}else{console[a22_0x1b24('0x8d')](a22_0x1b24('0x94')+_0x5eed90+'.');_0x29da5a(a22_0x1b24('0x95'),null,null,null);}return;case 0x194:console['log'](a22_0x1b24('0x96')+_0x5eed90);default:console['log'](a22_0x1b24('0x97')+_0x5eed90+a22_0x1b24('0x98')+_0x475759[a22_0x1b24('0x80')]);_0x156222['abort']();_0x29da5a(_0x475759[a22_0x1b24('0x80')],null,null,null);return;}})['on'](a22_0x1b24('0x8d'),function(_0x5a6887){console['log'](a22_0x1b24('0x99')+_0x5eed90+'\x20'+_0x5a6887[a22_0x1b24('0x9a')]);_0x29da5a(_0x5a6887,null,null,null);});}[a22_0x1b24('0x9b')](_0x19c6f2,_0x3bb0d9,_0x469228,_0x52b64f){console['log'](a22_0x1b24('0x9b'));console[a22_0x1b24('0x3f')](_0x19c6f2);console[a22_0x1b24('0x3f')](_0x3bb0d9);console[a22_0x1b24('0x3f')](_0x469228);console[a22_0x1b24('0x3f')](_0x52b64f);if(_0x469228=='image'){const _0x232d9f=this[a22_0x1b24('0x21')][this[a22_0x1b24('0x1f')]][a22_0x1b24('0x9c')]!=null?this[a22_0x1b24('0x21')][this['currentFile']][a22_0x1b24('0x9c')]:0x1e;this[a22_0x1b24('0x9d')](_0x52b64f,_0x232d9f);}else if(_0x469228=='video'){if(_0x19c6f2==null&&_0x3bb0d9!=''){this[a22_0x1b24('0x1f')]++;}this[a22_0x1b24('0x4c')]();}console[a22_0x1b24('0x3f')](this[a22_0x1b24('0x1f')]);}['downloadRequestFile'](_0xff4f6e,_0x1a4a20,_0x50f83e){progress(request(_0xff4f6e),{})['on'](a22_0x1b24('0x9e'),function(_0x3ad132){console['log'](_0x3ad132);})['on'](a22_0x1b24('0x8d'),function(_0x207f56){console[a22_0x1b24('0x3f')]('Error\x20downloading\x20file');this[a22_0x1b24('0x4c')]();})['on'](a22_0x1b24('0x70'),function(){console['log']('Downloaded:\x20'+_0x1a4a20);console[a22_0x1b24('0x3f')](a22_0x1b24('0x71')+_0x50f83e);if(_0x50f83e==a22_0x1b24('0x5b')){const _0x3729d9=this['downloadFiles'][this[a22_0x1b24('0x1f')]][a22_0x1b24('0x9c')]!=null?this['downloadFiles'][this[a22_0x1b24('0x1f')]][a22_0x1b24('0x9c')]:0x1e;this[a22_0x1b24('0x9d')](_0x1a4a20,_0x3729d9);}else if(_0x50f83e=='video'){this[a22_0x1b24('0x1f')]++;this[a22_0x1b24('0x4c')]();}}[a22_0x1b24('0x38')](this))[a22_0x1b24('0x8b')](fs[a22_0x1b24('0x8a')](this[a22_0x1b24('0x18')]+_0x1a4a20));}[a22_0x1b24('0x9d')](_0x49a38f,_0x3a8d9b=0x1e){const _0x33927=this[a22_0x1b24('0x18')]+_0x49a38f;console[a22_0x1b24('0x3f')](_0x33927);console[a22_0x1b24('0x3f')](_0x49a38f);const _0x53957b=_0x49a38f['split']('.')[a22_0x1b24('0x5a')](0x0,-0x1)['join']('.');const _0x26df9e=a22_0x1b24('0x9f');const _0x10d2a0=['-y','-r',a22_0x1b24('0xa0'),'-loop','1',a22_0x1b24('0xa1'),'glob','-i',_0x33927,'-t',String(_0x3a8d9b),a22_0x1b24('0xa2'),'libx264',a22_0x1b24('0xa3'),a22_0x1b24('0xa4'),'-r','25',a22_0x1b24('0xa5'),a22_0x1b24('0xa6'),this[a22_0x1b24('0x18')]+_0x53957b+a22_0x1b24('0x5c')];const _0x19e9fe=spawn(_0x26df9e,_0x10d2a0);_0x19e9fe[a22_0x1b24('0xa7')]['on']('data',function(_0x2bea0b){console['log']('Converting\x20'+_0x33927);});_0x19e9fe[a22_0x1b24('0xa8')]['on'](a22_0x1b24('0x8c'),function(_0xa78d3b){console['log'](a22_0x1b24('0xa9')+_0xa78d3b);}[a22_0x1b24('0x38')](this));_0x19e9fe['on'](a22_0x1b24('0xaa'),function(){console['log'](a22_0x1b24('0xab'));this[a22_0x1b24('0x1f')]++;this[a22_0x1b24('0x4c')]();}[a22_0x1b24('0x38')](this));}['downloadYouTube'](_0x375734){const _0x5bcab0=this['tempFolder']+'/'+_0x375734+a22_0x1b24('0x5c');const _0x1b4f90=youtubedl(a22_0x1b24('0xac')+_0x375734,[a22_0x1b24('0xad')],{'cwd':__dirname});_0x1b4f90['on']('info',function(_0x2ba07b){console[a22_0x1b24('0x3f')](a22_0x1b24('0xae'));console['log'](a22_0x1b24('0xaf')+_0x2ba07b[a22_0x1b24('0xb0')]);console[a22_0x1b24('0x3f')](a22_0x1b24('0xb1')+_0x2ba07b[a22_0x1b24('0x88')]);});_0x1b4f90['on'](a22_0x1b24('0xb2'),function complete(_0x1a6199){'use strict';console[a22_0x1b24('0x3f')](a22_0x1b24('0xaf')+_0x1a6199[a22_0x1b24('0xb0')]+a22_0x1b24('0xb3'));});_0x1b4f90['on']('end',function(){console[a22_0x1b24('0x3f')]('finished\x20youtube\x20downloading!');this['checkVideo'](_0x5bcab0)[a22_0x1b24('0x5')](function(_0x3ee55e){if(_0x3ee55e){this[a22_0x1b24('0x1f')]++;}this[a22_0x1b24('0x4c')]();}['bind'](this));}[a22_0x1b24('0x38')](this));_0x1b4f90['pipe'](fs[a22_0x1b24('0x8a')](_0x5bcab0));}[a22_0x1b24('0x55')](){console[a22_0x1b24('0x3f')]('Finishing');if(this['playlistChanged']){if(this[a22_0x1b24('0x22')][a22_0x1b24('0x4b')]==0x0){fs[a22_0x1b24('0x41')](this['playListFile'],JSON[a22_0x1b24('0x3a')](this[a22_0x1b24('0x23')]));let _0x21c8c3=a22_0x1b24('0xb4')+'\x0d\x0a'+'#EXTINF:0,luloPlayList'+'\x0d\x0a';for(const _0x217f0c in this[a22_0x1b24('0x21')]){const _0xc907b6=this['downloadFiles'][_0x217f0c][a22_0x1b24('0xb5')];const _0x331091=this[a22_0x1b24('0x21')][_0x217f0c][a22_0x1b24('0x56')];const _0x4d8e19=_0xc907b6[a22_0x1b24('0x57')](_0xc907b6['lastIndexOf']('/')+0x1);let _0x2e3076=_0x4d8e19[a22_0x1b24('0xb6')]('.')[a22_0x1b24('0x5a')](0x0,-0x1)['join']('.');if(_0x331091==a22_0x1b24('0x60')){_0x2e3076=_0xc907b6;}_0x21c8c3+='/home/osmc/luloclient/media/files/'+_0x2e3076+'.mp4'+'\x0d\x0a';}fsExtra['emptyDirSync'](this['filesFolder']);fsExtra[a22_0x1b24('0x5e')](this['tempFolder'],this[a22_0x1b24('0x1a')]);fsExtra['writeFileSync'](this[a22_0x1b24('0x1d')],_0x21c8c3);fsExtra['emptyDirSync'](this[a22_0x1b24('0x18')]);console[a22_0x1b24('0x3f')](a22_0x1b24('0xb7'));this[a22_0x1b24('0xb8')]();}else{console['log'](a22_0x1b24('0xb9'));this[a22_0x1b24('0x1f')]=0x0;setTimeout(function(){this[a22_0x1b24('0x4c')]();}[a22_0x1b24('0x38')](this),0x1388);}}else{console[a22_0x1b24('0x3f')](a22_0x1b24('0xba'));}}['refreshPlaylist'](){this[a22_0x1b24('0xbb')](a22_0x1b24('0xbc'),{'playlistid':0x1},function(_0x2107f1){console[a22_0x1b24('0x3f')](a22_0x1b24('0xbd'));console[a22_0x1b24('0x3f')](_0x2107f1);this['jsonrpcClient']('Playlist.Add',{'item':{'file':a22_0x1b24('0xbe')},'playlistid':0x1},function(_0x2107f1){console[a22_0x1b24('0x3f')]('Playlist.Added');console[a22_0x1b24('0x3f')](_0x2107f1);this[a22_0x1b24('0xbb')](a22_0x1b24('0xbf'),{'item':{'playlistid':0x1,'position':0x0}},function(_0x2107f1){console[a22_0x1b24('0x3f')]('Playlist.Opened');console['log'](_0x2107f1);}[a22_0x1b24('0x38')](this));}[a22_0x1b24('0x38')](this));}['bind'](this));}[a22_0x1b24('0xbb')](_0x1bbd03,_0x203d52,_0x4188c4){const _0x39d444={'jsonrpc':a22_0x1b24('0xc0'),'method':_0x1bbd03,'params':_0x203d52,'id':0x1};this[a22_0x1b24('0x24')][a22_0x1b24('0x3d')](a22_0x1b24('0xc1'),_0x39d444,![],{'user':a22_0x1b24('0x31'),'pass':a22_0x1b24('0x32')})[a22_0x1b24('0x5')](function(_0x4f15f1){_0x4188c4(_0x4f15f1);})['catch'](function(_0x2695e9){});}}exports[a22_0x1b24('0xc2')]=SyncPlaylistsService;
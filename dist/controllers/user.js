var a5_0x349b=['findById','profile','gender','location','website','save','/account','postUpdatePassword','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','Passwords\x20do\x20not\x20match','equals','Password\x20has\x20been\x20changed.','remove','Your\x20account\x20has\x20been\x20deleted.','params','tokens','filter','kind','getReset','isAuthenticated','where','passwordResetExpires','now','exec','/forgot','account/reset','Password\x20Reset','postReset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','Passwords\x20must\x20match.','back','waterfall','token','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','passwordResetToken','createTransport','SendGrid','SENDGRID_USER','express-ts@starter.com','Your\x20password\x20has\x20been\x20changed','Success!\x20Your\x20password\x20has\x20been\x20changed.','getForgot','Forgot\x20Password','postForgot','Please\x20enter\x20a\x20valid\x20email\x20address.','toString','hex','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','env','SENDGRID_PASSWORD','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','headers','host','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','info','__importDefault','__esModule','async','crypto','nodemailer','passport','express-validator','getLogin','user','redirect','render','account/login','Login','postLogin','assert','password','Password\x20cannot\x20be\x20blank','notEmpty','sanitize','email','normalizeEmail','flash','errors','/login','default','authenticate','local','message','logIn','success','Success!\x20You\x20are\x20logged\x20in.','session','logout','getSignup','account/signup','Create\x20Account','Email\x20is\x20not\x20valid','confirmPassword','body','/signup','findOne','Account\x20Management','postUpdateProfile','isEmail','validationErrors'];(function(_0x5b7478,_0x50f5bd){var _0x599038=function(_0x53ee29){while(--_0x53ee29){_0x5b7478['push'](_0x5b7478['shift']());}};_0x599038(++_0x50f5bd);}(a5_0x349b,0x167));var a5_0x28a6=function(_0x1326d9,_0x3e05fe){_0x1326d9=_0x1326d9-0x0;var _0x36abc1=a5_0x349b[_0x1326d9];return _0x36abc1;};'use strict';var __importDefault=this&&this[a5_0x28a6('0x0')]||function(_0x3b5544){return _0x3b5544&&_0x3b5544[a5_0x28a6('0x1')]?_0x3b5544:{'default':_0x3b5544};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const async_1=__importDefault(require(a5_0x28a6('0x2')));const crypto_1=__importDefault(require(a5_0x28a6('0x3')));const nodemailer_1=__importDefault(require(a5_0x28a6('0x4')));const passport_1=__importDefault(require(a5_0x28a6('0x5')));const User_1=__importDefault(require('../models/User'));const request=require(a5_0x28a6('0x6'));exports[a5_0x28a6('0x7')]=(_0x23db7,_0x4d46b5)=>{if(_0x23db7[a5_0x28a6('0x8')]){return _0x4d46b5[a5_0x28a6('0x9')]('/');}_0x4d46b5[a5_0x28a6('0xa')](a5_0x28a6('0xb'),{'title':a5_0x28a6('0xc')});};exports[a5_0x28a6('0xd')]=(_0x2593a4,_0x70ead0,_0x3a0e3b)=>{_0x2593a4['assert']('email','Email\x20is\x20not\x20valid')['isEmail']();_0x2593a4[a5_0x28a6('0xe')](a5_0x28a6('0xf'),a5_0x28a6('0x10'))[a5_0x28a6('0x11')]();_0x2593a4[a5_0x28a6('0x12')](a5_0x28a6('0x13'))[a5_0x28a6('0x14')]({'gmail_remove_dots':![]});const _0x433350=_0x2593a4['validationErrors']();if(_0x433350){_0x2593a4[a5_0x28a6('0x15')](a5_0x28a6('0x16'),_0x433350);return _0x70ead0[a5_0x28a6('0x9')](a5_0x28a6('0x17'));}passport_1[a5_0x28a6('0x18')][a5_0x28a6('0x19')](a5_0x28a6('0x1a'),(_0xec9f3a,_0x3ccdc8,_0x53f59a)=>{if(_0xec9f3a){return _0x3a0e3b(_0xec9f3a);}if(!_0x3ccdc8){_0x2593a4[a5_0x28a6('0x15')](a5_0x28a6('0x16'),_0x53f59a[a5_0x28a6('0x1b')]);return _0x70ead0[a5_0x28a6('0x9')](a5_0x28a6('0x17'));}_0x2593a4[a5_0x28a6('0x1c')](_0x3ccdc8,_0xec9f3a=>{if(_0xec9f3a){return _0x3a0e3b(_0xec9f3a);}_0x2593a4[a5_0x28a6('0x15')](a5_0x28a6('0x1d'),{'msg':a5_0x28a6('0x1e')});_0x70ead0[a5_0x28a6('0x9')](_0x2593a4[a5_0x28a6('0x1f')]['returnTo']||'/');});})(_0x2593a4,_0x70ead0,_0x3a0e3b);};exports[a5_0x28a6('0x20')]=(_0x5b05a2,_0x27a6a8)=>{_0x5b05a2['logout']();_0x27a6a8[a5_0x28a6('0x9')]('/');};exports[a5_0x28a6('0x21')]=(_0x4221aa,_0x93b107)=>{if(_0x4221aa[a5_0x28a6('0x8')]){return _0x93b107[a5_0x28a6('0x9')]('/');}_0x93b107[a5_0x28a6('0xa')](a5_0x28a6('0x22'),{'title':a5_0x28a6('0x23')});};exports['postSignup']=(_0x47047c,_0x3e0fa9,_0x2d7351)=>{_0x47047c[a5_0x28a6('0xe')](a5_0x28a6('0x13'),a5_0x28a6('0x24'))['isEmail']();_0x47047c[a5_0x28a6('0xe')](a5_0x28a6('0xf'),'Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long')['len']({'min':0x4});_0x47047c['assert'](a5_0x28a6('0x25'),'Passwords\x20do\x20not\x20match')['equals'](_0x47047c[a5_0x28a6('0x26')][a5_0x28a6('0xf')]);_0x47047c['sanitize'](a5_0x28a6('0x13'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x19a618=_0x47047c['validationErrors']();if(_0x19a618){_0x47047c[a5_0x28a6('0x15')](a5_0x28a6('0x16'),_0x19a618);return _0x3e0fa9[a5_0x28a6('0x9')](a5_0x28a6('0x27'));}const _0xb34326=new User_1['default']({});User_1[a5_0x28a6('0x18')][a5_0x28a6('0x28')]({'email':_0x47047c[a5_0x28a6('0x26')][a5_0x28a6('0x13')]},(_0x50dc4a,_0xc73068)=>{if(_0x50dc4a){return _0x2d7351(_0x50dc4a);}if(_0xc73068){_0x47047c[a5_0x28a6('0x15')](a5_0x28a6('0x16'),{'msg':'Account\x20with\x20that\x20email\x20address\x20already\x20exists.'});return _0x3e0fa9[a5_0x28a6('0x9')]('/signup');}_0xb34326['save'](_0x50dc4a=>{if(_0x50dc4a){return _0x2d7351(_0x50dc4a);}_0x47047c[a5_0x28a6('0x1c')](_0xb34326,_0x50dc4a=>{if(_0x50dc4a){return _0x2d7351(_0x50dc4a);}_0x3e0fa9['redirect']('/');});});});};exports['getAccount']=(_0x258ecc,_0x39a1f4)=>{_0x39a1f4[a5_0x28a6('0xa')]('account/profile',{'title':a5_0x28a6('0x29')});};exports[a5_0x28a6('0x2a')]=(_0x47cd45,_0x23bc59,_0x51a032)=>{_0x47cd45[a5_0x28a6('0xe')](a5_0x28a6('0x13'),'Please\x20enter\x20a\x20valid\x20email\x20address.')[a5_0x28a6('0x2b')]();_0x47cd45['sanitize'](a5_0x28a6('0x13'))[a5_0x28a6('0x14')]({'gmail_remove_dots':![]});const _0x2a3fd9=_0x47cd45[a5_0x28a6('0x2c')]();if(_0x2a3fd9){_0x47cd45[a5_0x28a6('0x15')](a5_0x28a6('0x16'),_0x2a3fd9);return _0x23bc59[a5_0x28a6('0x9')]('/account');}User_1[a5_0x28a6('0x18')][a5_0x28a6('0x2d')](_0x47cd45[a5_0x28a6('0x8')]['id'],(_0x34d000,_0x13085f)=>{if(_0x34d000){return _0x51a032(_0x34d000);}_0x13085f[a5_0x28a6('0x13')]=_0x47cd45[a5_0x28a6('0x26')][a5_0x28a6('0x13')]||'';_0x13085f[a5_0x28a6('0x2e')]['name']=_0x47cd45[a5_0x28a6('0x26')]['name']||'';_0x13085f[a5_0x28a6('0x2e')]['gender']=_0x47cd45['body'][a5_0x28a6('0x2f')]||'';_0x13085f[a5_0x28a6('0x2e')][a5_0x28a6('0x30')]=_0x47cd45[a5_0x28a6('0x26')]['location']||'';_0x13085f[a5_0x28a6('0x2e')][a5_0x28a6('0x31')]=_0x47cd45[a5_0x28a6('0x26')][a5_0x28a6('0x31')]||'';_0x13085f[a5_0x28a6('0x32')](_0x34d000=>{if(_0x34d000){if(_0x34d000['code']===0x2af8){_0x47cd45[a5_0x28a6('0x15')]('errors',{'msg':'The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.'});return _0x23bc59[a5_0x28a6('0x9')](a5_0x28a6('0x33'));}return _0x51a032(_0x34d000);}_0x47cd45[a5_0x28a6('0x15')](a5_0x28a6('0x1d'),{'msg':'Profile\x20information\x20has\x20been\x20updated.'});_0x23bc59['redirect'](a5_0x28a6('0x33'));});});};exports[a5_0x28a6('0x34')]=(_0x8bb80a,_0x148a1b,_0x3f215d)=>{_0x8bb80a[a5_0x28a6('0xe')]('password',a5_0x28a6('0x35'))['len']({'min':0x4});_0x8bb80a[a5_0x28a6('0xe')](a5_0x28a6('0x25'),a5_0x28a6('0x36'))[a5_0x28a6('0x37')](_0x8bb80a[a5_0x28a6('0x26')][a5_0x28a6('0xf')]);const _0x6599c4=_0x8bb80a[a5_0x28a6('0x2c')]();if(_0x6599c4){_0x8bb80a['flash'](a5_0x28a6('0x16'),_0x6599c4);return _0x148a1b[a5_0x28a6('0x9')]('/account');}User_1[a5_0x28a6('0x18')]['findById'](_0x8bb80a[a5_0x28a6('0x8')]['id'],(_0x29043f,_0x55510a)=>{if(_0x29043f){return _0x3f215d(_0x29043f);}_0x55510a[a5_0x28a6('0xf')]=_0x8bb80a[a5_0x28a6('0x26')][a5_0x28a6('0xf')];_0x55510a[a5_0x28a6('0x32')](_0x29043f=>{if(_0x29043f){return _0x3f215d(_0x29043f);}_0x8bb80a[a5_0x28a6('0x15')](a5_0x28a6('0x1d'),{'msg':a5_0x28a6('0x38')});_0x148a1b[a5_0x28a6('0x9')]('/account');});});};exports['postDeleteAccount']=(_0x50e4a5,_0x202024,_0x4bf286)=>{User_1[a5_0x28a6('0x18')][a5_0x28a6('0x39')]({'_id':_0x50e4a5[a5_0x28a6('0x8')]['id']},_0x443f4d=>{if(_0x443f4d){return _0x4bf286(_0x443f4d);}_0x50e4a5[a5_0x28a6('0x20')]();_0x50e4a5[a5_0x28a6('0x15')]('info',{'msg':a5_0x28a6('0x3a')});_0x202024[a5_0x28a6('0x9')]('/');});};exports['getOauthUnlink']=(_0x4c94d7,_0x2f945d,_0x32f34d)=>{const _0x5212d5=_0x4c94d7[a5_0x28a6('0x3b')]['provider'];User_1[a5_0x28a6('0x18')][a5_0x28a6('0x2d')](_0x4c94d7[a5_0x28a6('0x8')]['id'],(_0x291918,_0xa9d536)=>{if(_0x291918){return _0x32f34d(_0x291918);}_0xa9d536[_0x5212d5]=undefined;_0xa9d536[a5_0x28a6('0x3c')]=_0xa9d536[a5_0x28a6('0x3c')][a5_0x28a6('0x3d')](_0x19c970=>_0x19c970[a5_0x28a6('0x3e')]!==_0x5212d5);_0xa9d536['save'](_0x291918=>{if(_0x291918){return _0x32f34d(_0x291918);}_0x4c94d7[a5_0x28a6('0x15')]('info',{'msg':_0x5212d5+'\x20account\x20has\x20been\x20unlinked.'});_0x2f945d['redirect'](a5_0x28a6('0x33'));});});};exports[a5_0x28a6('0x3f')]=(_0x113876,_0x59a02d,_0x4b77e3)=>{if(_0x113876[a5_0x28a6('0x40')]()){return _0x59a02d[a5_0x28a6('0x9')]('/');}User_1['default']['findOne']({'passwordResetToken':_0x113876[a5_0x28a6('0x3b')]['token']})[a5_0x28a6('0x41')](a5_0x28a6('0x42'))['gt'](Date[a5_0x28a6('0x43')]())[a5_0x28a6('0x44')]((_0x210dc7,_0x14944e)=>{if(_0x210dc7){return _0x4b77e3(_0x210dc7);}if(!_0x14944e){_0x113876[a5_0x28a6('0x15')](a5_0x28a6('0x16'),{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x59a02d['redirect'](a5_0x28a6('0x45'));}_0x59a02d[a5_0x28a6('0xa')](a5_0x28a6('0x46'),{'title':a5_0x28a6('0x47')});});};exports[a5_0x28a6('0x48')]=(_0x4dd987,_0x59ea7e,_0x101986)=>{_0x4dd987['assert']('password',a5_0x28a6('0x49'))['len']({'min':0x4});_0x4dd987[a5_0x28a6('0xe')]('confirm',a5_0x28a6('0x4a'))['equals'](_0x4dd987['body'][a5_0x28a6('0xf')]);const _0x4205f9=_0x4dd987[a5_0x28a6('0x2c')]();if(_0x4205f9){_0x4dd987[a5_0x28a6('0x15')](a5_0x28a6('0x16'),_0x4205f9);return _0x59ea7e[a5_0x28a6('0x9')](a5_0x28a6('0x4b'));}async_1[a5_0x28a6('0x18')][a5_0x28a6('0x4c')]([function resetPassword(_0xcd69e8){User_1[a5_0x28a6('0x18')]['findOne']({'passwordResetToken':_0x4dd987[a5_0x28a6('0x3b')][a5_0x28a6('0x4d')]})[a5_0x28a6('0x41')]('passwordResetExpires')['gt'](Date[a5_0x28a6('0x43')]())['exec']((_0x45a99d,_0x1926d1)=>{if(_0x45a99d){return _0x101986(_0x45a99d);}if(!_0x1926d1){_0x4dd987['flash'](a5_0x28a6('0x16'),{'msg':a5_0x28a6('0x4e')});return _0x59ea7e[a5_0x28a6('0x9')]('back');}_0x1926d1[a5_0x28a6('0xf')]=_0x4dd987['body'][a5_0x28a6('0xf')];_0x1926d1[a5_0x28a6('0x4f')]=undefined;_0x1926d1[a5_0x28a6('0x42')]=undefined;_0x1926d1[a5_0x28a6('0x32')](_0x45a99d=>{if(_0x45a99d){return _0x101986(_0x45a99d);}_0x4dd987[a5_0x28a6('0x1c')](_0x1926d1,_0x45a99d=>{_0xcd69e8(_0x45a99d,_0x1926d1);});});});},function sendResetPasswordEmail(_0x1f8535,_0x4b00f8){const _0x2ad239=nodemailer_1[a5_0x28a6('0x18')][a5_0x28a6('0x50')]({'service':a5_0x28a6('0x51'),'auth':{'user':process['env'][a5_0x28a6('0x52')],'pass':process['env']['SENDGRID_PASSWORD']}});const _0x3bc6dd={'to':_0x1f8535[a5_0x28a6('0x13')],'from':a5_0x28a6('0x53'),'subject':a5_0x28a6('0x54'),'text':'Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20'+_0x1f8535['email']+'\x20has\x20just\x20been\x20changed.\x0a'};_0x2ad239['sendMail'](_0x3bc6dd,_0x39bf6a=>{_0x4dd987[a5_0x28a6('0x15')]('success',{'msg':a5_0x28a6('0x55')});_0x4b00f8(_0x39bf6a);});}],_0x2fc11d=>{if(_0x2fc11d){return _0x101986(_0x2fc11d);}_0x59ea7e[a5_0x28a6('0x9')]('/');});};exports[a5_0x28a6('0x56')]=(_0x45eda3,_0x5d9779)=>{if(_0x45eda3[a5_0x28a6('0x40')]()){return _0x5d9779['redirect']('/');}_0x5d9779[a5_0x28a6('0xa')]('account/forgot',{'title':a5_0x28a6('0x57')});};exports[a5_0x28a6('0x58')]=(_0x1babb8,_0x5bccf3,_0x1067f7)=>{_0x1babb8[a5_0x28a6('0xe')](a5_0x28a6('0x13'),a5_0x28a6('0x59'))[a5_0x28a6('0x2b')]();_0x1babb8[a5_0x28a6('0x12')](a5_0x28a6('0x13'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x559438=_0x1babb8[a5_0x28a6('0x2c')]();if(_0x559438){_0x1babb8[a5_0x28a6('0x15')](a5_0x28a6('0x16'),_0x559438);return _0x5bccf3[a5_0x28a6('0x9')]('/forgot');}async_1[a5_0x28a6('0x18')][a5_0x28a6('0x4c')]([function createRandomToken(_0x192054){crypto_1[a5_0x28a6('0x18')]['randomBytes'](0x10,(_0x1d3e7c,_0x420895)=>{const _0x5a6e4a=_0x420895[a5_0x28a6('0x5a')](a5_0x28a6('0x5b'));_0x192054(_0x1d3e7c,_0x5a6e4a);});},function setRandomToken(_0x24a3bc,_0x4b30bb){User_1[a5_0x28a6('0x18')][a5_0x28a6('0x28')]({'email':_0x1babb8[a5_0x28a6('0x26')][a5_0x28a6('0x13')]},(_0x1a86ca,_0x3da3a0)=>{if(_0x1a86ca){return _0x4b30bb(_0x1a86ca);}if(!_0x3da3a0){_0x1babb8[a5_0x28a6('0x15')](a5_0x28a6('0x16'),{'msg':a5_0x28a6('0x5c')});return _0x5bccf3['redirect'](a5_0x28a6('0x45'));}_0x3da3a0[a5_0x28a6('0x4f')]=_0x24a3bc;_0x3da3a0[a5_0x28a6('0x42')]=Date[a5_0x28a6('0x43')]()+0x36ee80;_0x3da3a0[a5_0x28a6('0x32')](_0x1a86ca=>{_0x4b30bb(_0x1a86ca,_0x24a3bc,_0x3da3a0);});});},function sendForgotPasswordEmail(_0x2f5bd6,_0x3c5677,_0x1a909e){const _0x58612f=nodemailer_1[a5_0x28a6('0x18')][a5_0x28a6('0x50')]({'service':'SendGrid','auth':{'user':process[a5_0x28a6('0x5d')]['SENDGRID_USER'],'pass':process['env'][a5_0x28a6('0x5e')]}});const _0x42efb7={'to':_0x3c5677[a5_0x28a6('0x13')],'from':a5_0x28a6('0x5f'),'subject':a5_0x28a6('0x60'),'text':'You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://'+_0x1babb8[a5_0x28a6('0x61')][a5_0x28a6('0x62')]+'/reset/'+_0x2f5bd6+a5_0x28a6('0x63')};_0x58612f['sendMail'](_0x42efb7,_0x5836b7=>{_0x1babb8['flash'](a5_0x28a6('0x64'),{'msg':'An\x20e-mail\x20has\x20been\x20sent\x20to\x20'+_0x3c5677[a5_0x28a6('0x13')]+'\x20with\x20further\x20instructions.'});_0x1a909e(_0x5836b7);});}],_0xbbef9c=>{if(_0xbbef9c){return _0x1067f7(_0xbbef9c);}_0x5bccf3[a5_0x28a6('0x9')]('/forgot');});};
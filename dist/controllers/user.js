var a5_0x3667=['crypto','nodemailer','express-validator','user','render','account/login','Login','assert','isEmail','password','Password\x20cannot\x20be\x20blank','notEmpty','email','normalizeEmail','validationErrors','flash','redirect','/login','default','authenticate','message','logIn','Success!\x20You\x20are\x20logged\x20in.','session','logout','Create\x20Account','postSignup','Email\x20is\x20not\x20valid','len','confirmPassword','Passwords\x20do\x20not\x20match','equals','body','errors','/signup','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','save','account/profile','Account\x20Management','Please\x20enter\x20a\x20valid\x20email\x20address.','sanitize','/account','findById','profile','name','gender','location','website','code','Profile\x20information\x20has\x20been\x20updated.','postUpdatePassword','Password\x20has\x20been\x20changed.','postDeleteAccount','info','Your\x20account\x20has\x20been\x20deleted.','getOauthUnlink','params','provider','tokens','filter','kind','isAuthenticated','findOne','token','where','passwordResetExpires','now','exec','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','Password\x20Reset','postReset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','Passwords\x20must\x20match.','back','waterfall','passwordResetToken','SendGrid','env','SENDGRID_USER','SENDGRID_PASSWORD','express-ts@starter.com','Your\x20password\x20has\x20been\x20changed','Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20','\x20has\x20just\x20been\x20changed.\x0a','sendMail','success','getForgot','account/forgot','postForgot','/forgot','randomBytes','toString','hex','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','createTransport','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://','headers','host','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','An\x20e-mail\x20has\x20been\x20sent\x20to\x20','\x20with\x20further\x20instructions.','__esModule','defineProperty','async'];(function(_0x562a9b,_0x3b0aa5){var _0x46ee08=function(_0x353339){while(--_0x353339){_0x562a9b['push'](_0x562a9b['shift']());}};_0x46ee08(++_0x3b0aa5);}(a5_0x3667,0x1a5));var a5_0x61a2=function(_0x1e4bd0,_0x582a98){_0x1e4bd0=_0x1e4bd0-0x0;var _0x59b29f=a5_0x3667[_0x1e4bd0];return _0x59b29f;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x36dd0a){return _0x36dd0a&&_0x36dd0a[a5_0x61a2('0x0')]?_0x36dd0a:{'default':_0x36dd0a};};Object[a5_0x61a2('0x1')](exports,a5_0x61a2('0x0'),{'value':!![]});const async_1=__importDefault(require(a5_0x61a2('0x2')));const crypto_1=__importDefault(require(a5_0x61a2('0x3')));const nodemailer_1=__importDefault(require(a5_0x61a2('0x4')));const passport_1=__importDefault(require('passport'));const User_1=__importDefault(require('../models/User'));const request=require(a5_0x61a2('0x5'));exports['getLogin']=(_0x20fe43,_0x5ede10)=>{if(_0x20fe43[a5_0x61a2('0x6')]){return _0x5ede10['redirect']('/');}_0x5ede10[a5_0x61a2('0x7')](a5_0x61a2('0x8'),{'title':a5_0x61a2('0x9')});};exports['postLogin']=(_0x35d439,_0x386241,_0x3f7cc7)=>{_0x35d439[a5_0x61a2('0xa')]('email','Email\x20is\x20not\x20valid')[a5_0x61a2('0xb')]();_0x35d439[a5_0x61a2('0xa')](a5_0x61a2('0xc'),a5_0x61a2('0xd'))[a5_0x61a2('0xe')]();_0x35d439['sanitize'](a5_0x61a2('0xf'))[a5_0x61a2('0x10')]({'gmail_remove_dots':![]});const _0x174969=_0x35d439[a5_0x61a2('0x11')]();if(_0x174969){_0x35d439[a5_0x61a2('0x12')]('errors',_0x174969);return _0x386241[a5_0x61a2('0x13')](a5_0x61a2('0x14'));}passport_1[a5_0x61a2('0x15')][a5_0x61a2('0x16')]('local',(_0x9eda68,_0x3471f3,_0x4105d2)=>{if(_0x9eda68){return _0x3f7cc7(_0x9eda68);}if(!_0x3471f3){_0x35d439[a5_0x61a2('0x12')]('errors',_0x4105d2[a5_0x61a2('0x17')]);return _0x386241[a5_0x61a2('0x13')](a5_0x61a2('0x14'));}_0x35d439[a5_0x61a2('0x18')](_0x3471f3,_0x9eda68=>{if(_0x9eda68){return _0x3f7cc7(_0x9eda68);}_0x35d439[a5_0x61a2('0x12')]('success',{'msg':a5_0x61a2('0x19')});_0x386241['redirect'](_0x35d439[a5_0x61a2('0x1a')]['returnTo']||'/');});})(_0x35d439,_0x386241,_0x3f7cc7);};exports['logout']=(_0x274aed,_0x13cfea)=>{_0x274aed[a5_0x61a2('0x1b')]();_0x13cfea[a5_0x61a2('0x13')]('/');};exports['getSignup']=(_0x3a6e26,_0x42ad03)=>{if(_0x3a6e26[a5_0x61a2('0x6')]){return _0x42ad03['redirect']('/');}_0x42ad03[a5_0x61a2('0x7')]('account/signup',{'title':a5_0x61a2('0x1c')});};exports[a5_0x61a2('0x1d')]=(_0xdf0ba0,_0x1ccb71,_0x540782)=>{_0xdf0ba0['assert']('email',a5_0x61a2('0x1e'))['isEmail']();_0xdf0ba0['assert'](a5_0x61a2('0xc'),'Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long')[a5_0x61a2('0x1f')]({'min':0x4});_0xdf0ba0[a5_0x61a2('0xa')](a5_0x61a2('0x20'),a5_0x61a2('0x21'))[a5_0x61a2('0x22')](_0xdf0ba0[a5_0x61a2('0x23')][a5_0x61a2('0xc')]);_0xdf0ba0['sanitize'](a5_0x61a2('0xf'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x4cdcd9=_0xdf0ba0[a5_0x61a2('0x11')]();if(_0x4cdcd9){_0xdf0ba0[a5_0x61a2('0x12')](a5_0x61a2('0x24'),_0x4cdcd9);return _0x1ccb71['redirect'](a5_0x61a2('0x25'));}const _0x196ef6=new User_1[(a5_0x61a2('0x15'))]({});User_1[a5_0x61a2('0x15')]['findOne']({'email':_0xdf0ba0[a5_0x61a2('0x23')][a5_0x61a2('0xf')]},(_0x134987,_0x293711)=>{if(_0x134987){return _0x540782(_0x134987);}if(_0x293711){_0xdf0ba0[a5_0x61a2('0x12')](a5_0x61a2('0x24'),{'msg':a5_0x61a2('0x26')});return _0x1ccb71[a5_0x61a2('0x13')](a5_0x61a2('0x25'));}_0x196ef6[a5_0x61a2('0x27')](_0x134987=>{if(_0x134987){return _0x540782(_0x134987);}_0xdf0ba0[a5_0x61a2('0x18')](_0x196ef6,_0x134987=>{if(_0x134987){return _0x540782(_0x134987);}_0x1ccb71['redirect']('/');});});});};exports['getAccount']=(_0x31a10a,_0x4ca8b4)=>{_0x4ca8b4[a5_0x61a2('0x7')](a5_0x61a2('0x28'),{'title':a5_0x61a2('0x29')});};exports['postUpdateProfile']=(_0x123787,_0x1df50e,_0x266862)=>{_0x123787[a5_0x61a2('0xa')](a5_0x61a2('0xf'),a5_0x61a2('0x2a'))[a5_0x61a2('0xb')]();_0x123787[a5_0x61a2('0x2b')](a5_0x61a2('0xf'))[a5_0x61a2('0x10')]({'gmail_remove_dots':![]});const _0x521350=_0x123787[a5_0x61a2('0x11')]();if(_0x521350){_0x123787[a5_0x61a2('0x12')](a5_0x61a2('0x24'),_0x521350);return _0x1df50e[a5_0x61a2('0x13')](a5_0x61a2('0x2c'));}User_1[a5_0x61a2('0x15')][a5_0x61a2('0x2d')](_0x123787['user']['id'],(_0x4218e1,_0x331305)=>{if(_0x4218e1){return _0x266862(_0x4218e1);}_0x331305[a5_0x61a2('0xf')]=_0x123787[a5_0x61a2('0x23')]['email']||'';_0x331305[a5_0x61a2('0x2e')][a5_0x61a2('0x2f')]=_0x123787[a5_0x61a2('0x23')][a5_0x61a2('0x2f')]||'';_0x331305[a5_0x61a2('0x2e')][a5_0x61a2('0x30')]=_0x123787[a5_0x61a2('0x23')][a5_0x61a2('0x30')]||'';_0x331305[a5_0x61a2('0x2e')][a5_0x61a2('0x31')]=_0x123787[a5_0x61a2('0x23')][a5_0x61a2('0x31')]||'';_0x331305['profile']['website']=_0x123787['body'][a5_0x61a2('0x32')]||'';_0x331305[a5_0x61a2('0x27')](_0x4218e1=>{if(_0x4218e1){if(_0x4218e1[a5_0x61a2('0x33')]===0x2af8){_0x123787[a5_0x61a2('0x12')](a5_0x61a2('0x24'),{'msg':'The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.'});return _0x1df50e[a5_0x61a2('0x13')]('/account');}return _0x266862(_0x4218e1);}_0x123787['flash']('success',{'msg':a5_0x61a2('0x34')});_0x1df50e[a5_0x61a2('0x13')](a5_0x61a2('0x2c'));});});};exports[a5_0x61a2('0x35')]=(_0x11d2ac,_0x3e71a7,_0x3422b6)=>{_0x11d2ac[a5_0x61a2('0xa')](a5_0x61a2('0xc'),'Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long')[a5_0x61a2('0x1f')]({'min':0x4});_0x11d2ac[a5_0x61a2('0xa')](a5_0x61a2('0x20'),'Passwords\x20do\x20not\x20match')[a5_0x61a2('0x22')](_0x11d2ac[a5_0x61a2('0x23')]['password']);const _0x56b025=_0x11d2ac[a5_0x61a2('0x11')]();if(_0x56b025){_0x11d2ac['flash']('errors',_0x56b025);return _0x3e71a7[a5_0x61a2('0x13')](a5_0x61a2('0x2c'));}User_1[a5_0x61a2('0x15')][a5_0x61a2('0x2d')](_0x11d2ac[a5_0x61a2('0x6')]['id'],(_0x235862,_0x3323ee)=>{if(_0x235862){return _0x3422b6(_0x235862);}_0x3323ee[a5_0x61a2('0xc')]=_0x11d2ac[a5_0x61a2('0x23')]['password'];_0x3323ee['save'](_0x235862=>{if(_0x235862){return _0x3422b6(_0x235862);}_0x11d2ac[a5_0x61a2('0x12')]('success',{'msg':a5_0x61a2('0x36')});_0x3e71a7['redirect'](a5_0x61a2('0x2c'));});});};exports[a5_0x61a2('0x37')]=(_0x3c3b62,_0x11c2f3,_0x3115e2)=>{User_1[a5_0x61a2('0x15')]['remove']({'_id':_0x3c3b62['user']['id']},_0x437490=>{if(_0x437490){return _0x3115e2(_0x437490);}_0x3c3b62[a5_0x61a2('0x1b')]();_0x3c3b62[a5_0x61a2('0x12')](a5_0x61a2('0x38'),{'msg':a5_0x61a2('0x39')});_0x11c2f3[a5_0x61a2('0x13')]('/');});};exports[a5_0x61a2('0x3a')]=(_0x1688ef,_0x3074ac,_0x5a0123)=>{const _0x3f2efd=_0x1688ef[a5_0x61a2('0x3b')][a5_0x61a2('0x3c')];User_1[a5_0x61a2('0x15')]['findById'](_0x1688ef[a5_0x61a2('0x6')]['id'],(_0x2f9fb5,_0x1aab4e)=>{if(_0x2f9fb5){return _0x5a0123(_0x2f9fb5);}_0x1aab4e[_0x3f2efd]=undefined;_0x1aab4e['tokens']=_0x1aab4e[a5_0x61a2('0x3d')][a5_0x61a2('0x3e')](_0x38b602=>_0x38b602[a5_0x61a2('0x3f')]!==_0x3f2efd);_0x1aab4e['save'](_0x2f9fb5=>{if(_0x2f9fb5){return _0x5a0123(_0x2f9fb5);}_0x1688ef[a5_0x61a2('0x12')](a5_0x61a2('0x38'),{'msg':_0x3f2efd+'\x20account\x20has\x20been\x20unlinked.'});_0x3074ac['redirect'](a5_0x61a2('0x2c'));});});};exports['getReset']=(_0x37262a,_0x55c6e4,_0x184653)=>{if(_0x37262a[a5_0x61a2('0x40')]()){return _0x55c6e4[a5_0x61a2('0x13')]('/');}User_1['default'][a5_0x61a2('0x41')]({'passwordResetToken':_0x37262a['params'][a5_0x61a2('0x42')]})[a5_0x61a2('0x43')](a5_0x61a2('0x44'))['gt'](Date[a5_0x61a2('0x45')]())[a5_0x61a2('0x46')]((_0x5369f8,_0x9017f4)=>{if(_0x5369f8){return _0x184653(_0x5369f8);}if(!_0x9017f4){_0x37262a['flash'](a5_0x61a2('0x24'),{'msg':a5_0x61a2('0x47')});return _0x55c6e4[a5_0x61a2('0x13')]('/forgot');}_0x55c6e4['render']('account/reset',{'title':a5_0x61a2('0x48')});});};exports[a5_0x61a2('0x49')]=(_0x45efc9,_0x457879,_0x196ffe)=>{_0x45efc9[a5_0x61a2('0xa')](a5_0x61a2('0xc'),a5_0x61a2('0x4a'))[a5_0x61a2('0x1f')]({'min':0x4});_0x45efc9[a5_0x61a2('0xa')]('confirm',a5_0x61a2('0x4b'))[a5_0x61a2('0x22')](_0x45efc9[a5_0x61a2('0x23')][a5_0x61a2('0xc')]);const _0x4efb2b=_0x45efc9['validationErrors']();if(_0x4efb2b){_0x45efc9[a5_0x61a2('0x12')](a5_0x61a2('0x24'),_0x4efb2b);return _0x457879[a5_0x61a2('0x13')](a5_0x61a2('0x4c'));}async_1[a5_0x61a2('0x15')][a5_0x61a2('0x4d')]([function resetPassword(_0x50aff7){User_1[a5_0x61a2('0x15')][a5_0x61a2('0x41')]({'passwordResetToken':_0x45efc9[a5_0x61a2('0x3b')][a5_0x61a2('0x42')]})['where'](a5_0x61a2('0x44'))['gt'](Date['now']())[a5_0x61a2('0x46')]((_0x4b2110,_0x11e42d)=>{if(_0x4b2110){return _0x196ffe(_0x4b2110);}if(!_0x11e42d){_0x45efc9[a5_0x61a2('0x12')](a5_0x61a2('0x24'),{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x457879['redirect'](a5_0x61a2('0x4c'));}_0x11e42d[a5_0x61a2('0xc')]=_0x45efc9['body']['password'];_0x11e42d[a5_0x61a2('0x4e')]=undefined;_0x11e42d['passwordResetExpires']=undefined;_0x11e42d[a5_0x61a2('0x27')](_0x4b2110=>{if(_0x4b2110){return _0x196ffe(_0x4b2110);}_0x45efc9[a5_0x61a2('0x18')](_0x11e42d,_0x4b2110=>{_0x50aff7(_0x4b2110,_0x11e42d);});});});},function sendResetPasswordEmail(_0x24671a,_0x573552){const _0x11c279=nodemailer_1[a5_0x61a2('0x15')]['createTransport']({'service':a5_0x61a2('0x4f'),'auth':{'user':process[a5_0x61a2('0x50')][a5_0x61a2('0x51')],'pass':process[a5_0x61a2('0x50')][a5_0x61a2('0x52')]}});const _0x29c0e2={'to':_0x24671a['email'],'from':a5_0x61a2('0x53'),'subject':a5_0x61a2('0x54'),'text':a5_0x61a2('0x55')+_0x24671a[a5_0x61a2('0xf')]+a5_0x61a2('0x56')};_0x11c279[a5_0x61a2('0x57')](_0x29c0e2,_0x8913b0=>{_0x45efc9[a5_0x61a2('0x12')](a5_0x61a2('0x58'),{'msg':'Success!\x20Your\x20password\x20has\x20been\x20changed.'});_0x573552(_0x8913b0);});}],_0x2cba8=>{if(_0x2cba8){return _0x196ffe(_0x2cba8);}_0x457879[a5_0x61a2('0x13')]('/');});};exports[a5_0x61a2('0x59')]=(_0x3ab8b3,_0x19c93f)=>{if(_0x3ab8b3[a5_0x61a2('0x40')]()){return _0x19c93f['redirect']('/');}_0x19c93f[a5_0x61a2('0x7')](a5_0x61a2('0x5a'),{'title':'Forgot\x20Password'});};exports[a5_0x61a2('0x5b')]=(_0x14638d,_0x3a232f,_0x256224)=>{_0x14638d['assert'](a5_0x61a2('0xf'),a5_0x61a2('0x2a'))[a5_0x61a2('0xb')]();_0x14638d[a5_0x61a2('0x2b')](a5_0x61a2('0xf'))[a5_0x61a2('0x10')]({'gmail_remove_dots':![]});const _0x265534=_0x14638d[a5_0x61a2('0x11')]();if(_0x265534){_0x14638d[a5_0x61a2('0x12')](a5_0x61a2('0x24'),_0x265534);return _0x3a232f['redirect'](a5_0x61a2('0x5c'));}async_1[a5_0x61a2('0x15')][a5_0x61a2('0x4d')]([function createRandomToken(_0x2b8aca){crypto_1['default'][a5_0x61a2('0x5d')](0x10,(_0x26c43c,_0x3f2605)=>{const _0x1c0533=_0x3f2605[a5_0x61a2('0x5e')](a5_0x61a2('0x5f'));_0x2b8aca(_0x26c43c,_0x1c0533);});},function setRandomToken(_0x185363,_0x49f0b7){User_1['default'][a5_0x61a2('0x41')]({'email':_0x14638d[a5_0x61a2('0x23')][a5_0x61a2('0xf')]},(_0x43fb09,_0xaef77)=>{if(_0x43fb09){return _0x49f0b7(_0x43fb09);}if(!_0xaef77){_0x14638d[a5_0x61a2('0x12')]('errors',{'msg':a5_0x61a2('0x60')});return _0x3a232f[a5_0x61a2('0x13')](a5_0x61a2('0x5c'));}_0xaef77[a5_0x61a2('0x4e')]=_0x185363;_0xaef77[a5_0x61a2('0x44')]=Date[a5_0x61a2('0x45')]()+0x36ee80;_0xaef77['save'](_0x43fb09=>{_0x49f0b7(_0x43fb09,_0x185363,_0xaef77);});});},function sendForgotPasswordEmail(_0x28b205,_0x28ad40,_0x1fc4ac){const _0xfddd73=nodemailer_1[a5_0x61a2('0x15')][a5_0x61a2('0x61')]({'service':a5_0x61a2('0x4f'),'auth':{'user':process[a5_0x61a2('0x50')][a5_0x61a2('0x51')],'pass':process[a5_0x61a2('0x50')][a5_0x61a2('0x52')]}});const _0x10fb5f={'to':_0x28ad40[a5_0x61a2('0xf')],'from':a5_0x61a2('0x62'),'subject':a5_0x61a2('0x63'),'text':a5_0x61a2('0x64')+_0x14638d[a5_0x61a2('0x65')][a5_0x61a2('0x66')]+'/reset/'+_0x28b205+a5_0x61a2('0x67')};_0xfddd73['sendMail'](_0x10fb5f,_0x14eada=>{_0x14638d['flash'](a5_0x61a2('0x38'),{'msg':a5_0x61a2('0x68')+_0x28ad40[a5_0x61a2('0xf')]+a5_0x61a2('0x69')});_0x1fc4ac(_0x14eada);});}],_0x1e13f0=>{if(_0x1e13f0){return _0x256224(_0x1e13f0);}_0x3a232f[a5_0x61a2('0x13')](a5_0x61a2('0x5c'));});};
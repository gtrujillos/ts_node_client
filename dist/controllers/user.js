var a5_0x1ea3=['SENDGRID_PASSWORD','Your\x20password\x20has\x20been\x20changed','\x20has\x20just\x20been\x20changed.\x0a','sendMail','Success!\x20Your\x20password\x20has\x20been\x20changed.','account/forgot','postForgot','randomBytes','toString','hex','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','now','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://','headers','host','/reset/','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','An\x20e-mail\x20has\x20been\x20sent\x20to\x20','\x20with\x20further\x20instructions.','__importDefault','__esModule','async','passport','express-validator','getLogin','Login','postLogin','isEmail','password','Password\x20cannot\x20be\x20blank','sanitize','email','validationErrors','flash','errors','redirect','/login','default','local','message','logIn','success','Success!\x20You\x20are\x20logged\x20in.','returnTo','logout','getSignup','user','account/signup','assert','Email\x20is\x20not\x20valid','len','confirmPassword','Passwords\x20do\x20not\x20match','equals','body','normalizeEmail','/signup','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','save','getAccount','render','postUpdateProfile','Please\x20enter\x20a\x20valid\x20email\x20address.','/account','profile','gender','location','website','code','Profile\x20information\x20has\x20been\x20updated.','postUpdatePassword','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','findById','Password\x20has\x20been\x20changed.','postDeleteAccount','remove','info','Your\x20account\x20has\x20been\x20deleted.','getOauthUnlink','params','provider','tokens','filter','kind','\x20account\x20has\x20been\x20unlinked.','getReset','isAuthenticated','findOne','where','exec','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','/forgot','account/reset','postReset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','back','waterfall','token','passwordResetToken','passwordResetExpires','createTransport','SendGrid','env','SENDGRID_USER'];(function(_0x2cf112,_0x450101){var _0x477cf8=function(_0x3ac1c6){while(--_0x3ac1c6){_0x2cf112['push'](_0x2cf112['shift']());}};_0x477cf8(++_0x450101);}(a5_0x1ea3,0x7f));var a5_0x5954=function(_0x147779,_0x15ca3a){_0x147779=_0x147779-0x0;var _0xb66e18=a5_0x1ea3[_0x147779];return _0xb66e18;};'use strict';var __importDefault=this&&this[a5_0x5954('0x0')]||function(_0x542f8a){return _0x542f8a&&_0x542f8a['__esModule']?_0x542f8a:{'default':_0x542f8a};};Object['defineProperty'](exports,a5_0x5954('0x1'),{'value':!![]});const async_1=__importDefault(require(a5_0x5954('0x2')));const crypto_1=__importDefault(require('crypto'));const nodemailer_1=__importDefault(require('nodemailer'));const passport_1=__importDefault(require(a5_0x5954('0x3')));const User_1=__importDefault(require('../models/User'));const request=require(a5_0x5954('0x4'));exports[a5_0x5954('0x5')]=(_0x29fd9d,_0x2a74a6)=>{if(_0x29fd9d['user']){return _0x2a74a6['redirect']('/');}_0x2a74a6['render']('account/login',{'title':a5_0x5954('0x6')});};exports[a5_0x5954('0x7')]=(_0x58d8a8,_0x1e32a1,_0x1757c8)=>{_0x58d8a8['assert']('email','Email\x20is\x20not\x20valid')[a5_0x5954('0x8')]();_0x58d8a8['assert'](a5_0x5954('0x9'),a5_0x5954('0xa'))['notEmpty']();_0x58d8a8[a5_0x5954('0xb')](a5_0x5954('0xc'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x1114bd=_0x58d8a8[a5_0x5954('0xd')]();if(_0x1114bd){_0x58d8a8[a5_0x5954('0xe')](a5_0x5954('0xf'),_0x1114bd);return _0x1e32a1[a5_0x5954('0x10')](a5_0x5954('0x11'));}passport_1[a5_0x5954('0x12')]['authenticate'](a5_0x5954('0x13'),(_0x158935,_0x43867b,_0x254007)=>{if(_0x158935){return _0x1757c8(_0x158935);}if(!_0x43867b){_0x58d8a8['flash'](a5_0x5954('0xf'),_0x254007[a5_0x5954('0x14')]);return _0x1e32a1['redirect'](a5_0x5954('0x11'));}_0x58d8a8[a5_0x5954('0x15')](_0x43867b,_0x158935=>{if(_0x158935){return _0x1757c8(_0x158935);}_0x58d8a8['flash'](a5_0x5954('0x16'),{'msg':a5_0x5954('0x17')});_0x1e32a1[a5_0x5954('0x10')](_0x58d8a8['session'][a5_0x5954('0x18')]||'/');});})(_0x58d8a8,_0x1e32a1,_0x1757c8);};exports[a5_0x5954('0x19')]=(_0xa3cb32,_0x21921d)=>{_0xa3cb32[a5_0x5954('0x19')]();_0x21921d[a5_0x5954('0x10')]('/');};exports[a5_0x5954('0x1a')]=(_0x564827,_0x2291d7)=>{if(_0x564827[a5_0x5954('0x1b')]){return _0x2291d7[a5_0x5954('0x10')]('/');}_0x2291d7['render'](a5_0x5954('0x1c'),{'title':'Create\x20Account'});};exports['postSignup']=(_0x23762e,_0x593bd7,_0x1f4a95)=>{_0x23762e[a5_0x5954('0x1d')](a5_0x5954('0xc'),a5_0x5954('0x1e'))[a5_0x5954('0x8')]();_0x23762e[a5_0x5954('0x1d')](a5_0x5954('0x9'),'Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long')[a5_0x5954('0x1f')]({'min':0x4});_0x23762e[a5_0x5954('0x1d')](a5_0x5954('0x20'),a5_0x5954('0x21'))[a5_0x5954('0x22')](_0x23762e[a5_0x5954('0x23')][a5_0x5954('0x9')]);_0x23762e[a5_0x5954('0xb')](a5_0x5954('0xc'))[a5_0x5954('0x24')]({'gmail_remove_dots':![]});const _0x31ec71=_0x23762e[a5_0x5954('0xd')]();if(_0x31ec71){_0x23762e[a5_0x5954('0xe')](a5_0x5954('0xf'),_0x31ec71);return _0x593bd7[a5_0x5954('0x10')](a5_0x5954('0x25'));}const _0x74ac4a=new User_1[(a5_0x5954('0x12'))]({});User_1[a5_0x5954('0x12')]['findOne']({'email':_0x23762e['body'][a5_0x5954('0xc')]},(_0x5b0845,_0x30ecf9)=>{if(_0x5b0845){return _0x1f4a95(_0x5b0845);}if(_0x30ecf9){_0x23762e[a5_0x5954('0xe')](a5_0x5954('0xf'),{'msg':a5_0x5954('0x26')});return _0x593bd7['redirect'](a5_0x5954('0x25'));}_0x74ac4a[a5_0x5954('0x27')](_0x5b0845=>{if(_0x5b0845){return _0x1f4a95(_0x5b0845);}_0x23762e[a5_0x5954('0x15')](_0x74ac4a,_0x5b0845=>{if(_0x5b0845){return _0x1f4a95(_0x5b0845);}_0x593bd7['redirect']('/');});});});};exports[a5_0x5954('0x28')]=(_0x5d89aa,_0x6e5f02)=>{_0x6e5f02[a5_0x5954('0x29')]('account/profile',{'title':'Account\x20Management'});};exports[a5_0x5954('0x2a')]=(_0x21c144,_0x24c5a9,_0x1ca375)=>{_0x21c144[a5_0x5954('0x1d')](a5_0x5954('0xc'),a5_0x5954('0x2b'))['isEmail']();_0x21c144[a5_0x5954('0xb')](a5_0x5954('0xc'))[a5_0x5954('0x24')]({'gmail_remove_dots':![]});const _0x586e01=_0x21c144[a5_0x5954('0xd')]();if(_0x586e01){_0x21c144[a5_0x5954('0xe')](a5_0x5954('0xf'),_0x586e01);return _0x24c5a9['redirect'](a5_0x5954('0x2c'));}User_1[a5_0x5954('0x12')]['findById'](_0x21c144[a5_0x5954('0x1b')]['id'],(_0x56ed97,_0x27f4d5)=>{if(_0x56ed97){return _0x1ca375(_0x56ed97);}_0x27f4d5['email']=_0x21c144[a5_0x5954('0x23')][a5_0x5954('0xc')]||'';_0x27f4d5['profile']['name']=_0x21c144[a5_0x5954('0x23')]['name']||'';_0x27f4d5[a5_0x5954('0x2d')][a5_0x5954('0x2e')]=_0x21c144['body'][a5_0x5954('0x2e')]||'';_0x27f4d5[a5_0x5954('0x2d')][a5_0x5954('0x2f')]=_0x21c144[a5_0x5954('0x23')][a5_0x5954('0x2f')]||'';_0x27f4d5[a5_0x5954('0x2d')][a5_0x5954('0x30')]=_0x21c144['body']['website']||'';_0x27f4d5[a5_0x5954('0x27')](_0x56ed97=>{if(_0x56ed97){if(_0x56ed97[a5_0x5954('0x31')]===0x2af8){_0x21c144[a5_0x5954('0xe')](a5_0x5954('0xf'),{'msg':'The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.'});return _0x24c5a9[a5_0x5954('0x10')](a5_0x5954('0x2c'));}return _0x1ca375(_0x56ed97);}_0x21c144[a5_0x5954('0xe')](a5_0x5954('0x16'),{'msg':a5_0x5954('0x32')});_0x24c5a9[a5_0x5954('0x10')](a5_0x5954('0x2c'));});});};exports[a5_0x5954('0x33')]=(_0x463713,_0x550d00,_0x1d041e)=>{_0x463713[a5_0x5954('0x1d')](a5_0x5954('0x9'),a5_0x5954('0x34'))['len']({'min':0x4});_0x463713[a5_0x5954('0x1d')]('confirmPassword',a5_0x5954('0x21'))['equals'](_0x463713['body']['password']);const _0x339385=_0x463713['validationErrors']();if(_0x339385){_0x463713[a5_0x5954('0xe')](a5_0x5954('0xf'),_0x339385);return _0x550d00[a5_0x5954('0x10')](a5_0x5954('0x2c'));}User_1[a5_0x5954('0x12')][a5_0x5954('0x35')](_0x463713[a5_0x5954('0x1b')]['id'],(_0x5cfea2,_0x46e693)=>{if(_0x5cfea2){return _0x1d041e(_0x5cfea2);}_0x46e693[a5_0x5954('0x9')]=_0x463713[a5_0x5954('0x23')]['password'];_0x46e693['save'](_0x5cfea2=>{if(_0x5cfea2){return _0x1d041e(_0x5cfea2);}_0x463713[a5_0x5954('0xe')](a5_0x5954('0x16'),{'msg':a5_0x5954('0x36')});_0x550d00[a5_0x5954('0x10')]('/account');});});};exports[a5_0x5954('0x37')]=(_0x145279,_0x1c3e98,_0x3e233d)=>{User_1[a5_0x5954('0x12')][a5_0x5954('0x38')]({'_id':_0x145279[a5_0x5954('0x1b')]['id']},_0x56eca0=>{if(_0x56eca0){return _0x3e233d(_0x56eca0);}_0x145279[a5_0x5954('0x19')]();_0x145279[a5_0x5954('0xe')](a5_0x5954('0x39'),{'msg':a5_0x5954('0x3a')});_0x1c3e98[a5_0x5954('0x10')]('/');});};exports[a5_0x5954('0x3b')]=(_0x4a583e,_0x3e1253,_0x4e5fe5)=>{const _0x5629f4=_0x4a583e[a5_0x5954('0x3c')][a5_0x5954('0x3d')];User_1[a5_0x5954('0x12')][a5_0x5954('0x35')](_0x4a583e[a5_0x5954('0x1b')]['id'],(_0x3a659f,_0x439467)=>{if(_0x3a659f){return _0x4e5fe5(_0x3a659f);}_0x439467[_0x5629f4]=undefined;_0x439467[a5_0x5954('0x3e')]=_0x439467[a5_0x5954('0x3e')][a5_0x5954('0x3f')](_0x4c4d29=>_0x4c4d29[a5_0x5954('0x40')]!==_0x5629f4);_0x439467[a5_0x5954('0x27')](_0x3a659f=>{if(_0x3a659f){return _0x4e5fe5(_0x3a659f);}_0x4a583e[a5_0x5954('0xe')](a5_0x5954('0x39'),{'msg':_0x5629f4+a5_0x5954('0x41')});_0x3e1253[a5_0x5954('0x10')](a5_0x5954('0x2c'));});});};exports[a5_0x5954('0x42')]=(_0x2b0963,_0x24f87c,_0xd4afa2)=>{if(_0x2b0963[a5_0x5954('0x43')]()){return _0x24f87c['redirect']('/');}User_1[a5_0x5954('0x12')][a5_0x5954('0x44')]({'passwordResetToken':_0x2b0963[a5_0x5954('0x3c')]['token']})[a5_0x5954('0x45')]('passwordResetExpires')['gt'](Date['now']())[a5_0x5954('0x46')]((_0x843e49,_0x1b61bb)=>{if(_0x843e49){return _0xd4afa2(_0x843e49);}if(!_0x1b61bb){_0x2b0963['flash'](a5_0x5954('0xf'),{'msg':a5_0x5954('0x47')});return _0x24f87c[a5_0x5954('0x10')](a5_0x5954('0x48'));}_0x24f87c[a5_0x5954('0x29')](a5_0x5954('0x49'),{'title':'Password\x20Reset'});});};exports[a5_0x5954('0x4a')]=(_0x1e2460,_0x48145d,_0x3398b3)=>{_0x1e2460[a5_0x5954('0x1d')](a5_0x5954('0x9'),a5_0x5954('0x4b'))[a5_0x5954('0x1f')]({'min':0x4});_0x1e2460[a5_0x5954('0x1d')]('confirm','Passwords\x20must\x20match.')[a5_0x5954('0x22')](_0x1e2460[a5_0x5954('0x23')]['password']);const _0x31720e=_0x1e2460[a5_0x5954('0xd')]();if(_0x31720e){_0x1e2460['flash'](a5_0x5954('0xf'),_0x31720e);return _0x48145d['redirect'](a5_0x5954('0x4c'));}async_1[a5_0x5954('0x12')][a5_0x5954('0x4d')]([function resetPassword(_0x50e717){User_1[a5_0x5954('0x12')][a5_0x5954('0x44')]({'passwordResetToken':_0x1e2460[a5_0x5954('0x3c')][a5_0x5954('0x4e')]})[a5_0x5954('0x45')]('passwordResetExpires')['gt'](Date['now']())[a5_0x5954('0x46')]((_0x36449f,_0x585468)=>{if(_0x36449f){return _0x3398b3(_0x36449f);}if(!_0x585468){_0x1e2460[a5_0x5954('0xe')](a5_0x5954('0xf'),{'msg':a5_0x5954('0x47')});return _0x48145d[a5_0x5954('0x10')](a5_0x5954('0x4c'));}_0x585468[a5_0x5954('0x9')]=_0x1e2460['body'][a5_0x5954('0x9')];_0x585468[a5_0x5954('0x4f')]=undefined;_0x585468[a5_0x5954('0x50')]=undefined;_0x585468[a5_0x5954('0x27')](_0x36449f=>{if(_0x36449f){return _0x3398b3(_0x36449f);}_0x1e2460[a5_0x5954('0x15')](_0x585468,_0x36449f=>{_0x50e717(_0x36449f,_0x585468);});});});},function sendResetPasswordEmail(_0x42eed9,_0x385de8){const _0x112514=nodemailer_1[a5_0x5954('0x12')][a5_0x5954('0x51')]({'service':a5_0x5954('0x52'),'auth':{'user':process[a5_0x5954('0x53')][a5_0x5954('0x54')],'pass':process[a5_0x5954('0x53')][a5_0x5954('0x55')]}});const _0x2b8b86={'to':_0x42eed9['email'],'from':'express-ts@starter.com','subject':a5_0x5954('0x56'),'text':'Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20'+_0x42eed9[a5_0x5954('0xc')]+a5_0x5954('0x57')};_0x112514[a5_0x5954('0x58')](_0x2b8b86,_0x1432d3=>{_0x1e2460[a5_0x5954('0xe')](a5_0x5954('0x16'),{'msg':a5_0x5954('0x59')});_0x385de8(_0x1432d3);});}],_0x39ee9d=>{if(_0x39ee9d){return _0x3398b3(_0x39ee9d);}_0x48145d[a5_0x5954('0x10')]('/');});};exports['getForgot']=(_0x2b2fe6,_0x5672ce)=>{if(_0x2b2fe6[a5_0x5954('0x43')]()){return _0x5672ce['redirect']('/');}_0x5672ce[a5_0x5954('0x29')](a5_0x5954('0x5a'),{'title':'Forgot\x20Password'});};exports[a5_0x5954('0x5b')]=(_0x31f986,_0xa5c265,_0x2854e9)=>{_0x31f986[a5_0x5954('0x1d')](a5_0x5954('0xc'),'Please\x20enter\x20a\x20valid\x20email\x20address.')[a5_0x5954('0x8')]();_0x31f986[a5_0x5954('0xb')]('email')[a5_0x5954('0x24')]({'gmail_remove_dots':![]});const _0x1ba8cf=_0x31f986['validationErrors']();if(_0x1ba8cf){_0x31f986[a5_0x5954('0xe')](a5_0x5954('0xf'),_0x1ba8cf);return _0xa5c265['redirect'](a5_0x5954('0x48'));}async_1[a5_0x5954('0x12')]['waterfall']([function createRandomToken(_0x226b75){crypto_1[a5_0x5954('0x12')][a5_0x5954('0x5c')](0x10,(_0x12a7d9,_0x141b8e)=>{const _0x2de430=_0x141b8e[a5_0x5954('0x5d')](a5_0x5954('0x5e'));_0x226b75(_0x12a7d9,_0x2de430);});},function setRandomToken(_0x58e2e9,_0x537230){User_1[a5_0x5954('0x12')][a5_0x5954('0x44')]({'email':_0x31f986[a5_0x5954('0x23')][a5_0x5954('0xc')]},(_0x117886,_0x1355e6)=>{if(_0x117886){return _0x537230(_0x117886);}if(!_0x1355e6){_0x31f986[a5_0x5954('0xe')](a5_0x5954('0xf'),{'msg':a5_0x5954('0x5f')});return _0xa5c265[a5_0x5954('0x10')](a5_0x5954('0x48'));}_0x1355e6['passwordResetToken']=_0x58e2e9;_0x1355e6[a5_0x5954('0x50')]=Date[a5_0x5954('0x60')]()+0x36ee80;_0x1355e6[a5_0x5954('0x27')](_0x117886=>{_0x537230(_0x117886,_0x58e2e9,_0x1355e6);});});},function sendForgotPasswordEmail(_0x469cb1,_0x1205d7,_0x2a896e){const _0xa04b42=nodemailer_1[a5_0x5954('0x12')]['createTransport']({'service':'SendGrid','auth':{'user':process[a5_0x5954('0x53')]['SENDGRID_USER'],'pass':process['env'][a5_0x5954('0x55')]}});const _0x1c1786={'to':_0x1205d7[a5_0x5954('0xc')],'from':a5_0x5954('0x61'),'subject':a5_0x5954('0x62'),'text':a5_0x5954('0x63')+_0x31f986[a5_0x5954('0x64')][a5_0x5954('0x65')]+a5_0x5954('0x66')+_0x469cb1+a5_0x5954('0x67')};_0xa04b42[a5_0x5954('0x58')](_0x1c1786,_0x24364f=>{_0x31f986['flash'](a5_0x5954('0x39'),{'msg':a5_0x5954('0x68')+_0x1205d7['email']+a5_0x5954('0x69')});_0x2a896e(_0x24364f);});}],_0x18b73b=>{if(_0x18b73b){return _0x2854e9(_0x18b73b);}_0xa5c265[a5_0x5954('0x10')]('/forgot');});};
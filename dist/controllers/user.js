var a5_0x5984=['Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','/forgot','account/reset','Password\x20Reset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','Passwords\x20must\x20match.','validationErrors','back','waterfall','now','passwordResetToken','createTransport','env','SENDGRID_PASSWORD','Your\x20password\x20has\x20been\x20changed','\x20has\x20just\x20been\x20changed.\x0a','sendMail','Success!\x20Your\x20password\x20has\x20been\x20changed.','getForgot','account/forgot','Forgot\x20Password','postForgot','Please\x20enter\x20a\x20valid\x20email\x20address.','randomBytes','toString','hex','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','SENDGRID_USER','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://','headers','host','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','An\x20e-mail\x20has\x20been\x20sent\x20to\x20','\x20with\x20further\x20instructions.','__importDefault','__esModule','defineProperty','async','crypto','nodemailer','express-validator','user','redirect','render','account/login','Login','postLogin','assert','email','Email\x20is\x20not\x20valid','isEmail','password','Password\x20cannot\x20be\x20blank','notEmpty','sanitize','normalizeEmail','/login','default','local','flash','errors','message','session','returnTo','logout','account/signup','Create\x20Account','postSignup','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','len','confirmPassword','body','findOne','/signup','save','logIn','getAccount','Account\x20Management','postUpdateProfile','/account','profile','name','gender','location','website','success','Profile\x20information\x20has\x20been\x20updated.','postUpdatePassword','Passwords\x20do\x20not\x20match','equals','Password\x20has\x20been\x20changed.','postDeleteAccount','info','getOauthUnlink','params','provider','tokens','filter','kind','\x20account\x20has\x20been\x20unlinked.','isAuthenticated','where','passwordResetExpires','exec'];(function(_0x5b49d6,_0x434148){var _0x49c840=function(_0x44ed69){while(--_0x44ed69){_0x5b49d6['push'](_0x5b49d6['shift']());}};_0x49c840(++_0x434148);}(a5_0x5984,0xf5));var a5_0x4691=function(_0xb5c7cb,_0x3d5de2){_0xb5c7cb=_0xb5c7cb-0x0;var _0x109689=a5_0x5984[_0xb5c7cb];return _0x109689;};'use strict';var __importDefault=this&&this[a5_0x4691('0x0')]||function(_0xc3d7a4){return _0xc3d7a4&&_0xc3d7a4[a5_0x4691('0x1')]?_0xc3d7a4:{'default':_0xc3d7a4};};Object[a5_0x4691('0x2')](exports,'__esModule',{'value':!![]});const async_1=__importDefault(require(a5_0x4691('0x3')));const crypto_1=__importDefault(require(a5_0x4691('0x4')));const nodemailer_1=__importDefault(require(a5_0x4691('0x5')));const passport_1=__importDefault(require('passport'));const User_1=__importDefault(require('../models/User'));const request=require(a5_0x4691('0x6'));exports['getLogin']=(_0x3a220d,_0x35a037)=>{if(_0x3a220d[a5_0x4691('0x7')]){return _0x35a037[a5_0x4691('0x8')]('/');}_0x35a037[a5_0x4691('0x9')](a5_0x4691('0xa'),{'title':a5_0x4691('0xb')});};exports[a5_0x4691('0xc')]=(_0x5a4978,_0x3dc846,_0x44e669)=>{_0x5a4978[a5_0x4691('0xd')](a5_0x4691('0xe'),a5_0x4691('0xf'))[a5_0x4691('0x10')]();_0x5a4978['assert'](a5_0x4691('0x11'),a5_0x4691('0x12'))[a5_0x4691('0x13')]();_0x5a4978[a5_0x4691('0x14')](a5_0x4691('0xe'))[a5_0x4691('0x15')]({'gmail_remove_dots':![]});const _0x142e6c=_0x5a4978['validationErrors']();if(_0x142e6c){_0x5a4978['flash']('errors',_0x142e6c);return _0x3dc846[a5_0x4691('0x8')](a5_0x4691('0x16'));}passport_1[a5_0x4691('0x17')]['authenticate'](a5_0x4691('0x18'),(_0x1e10da,_0x390d0d,_0x1e632a)=>{if(_0x1e10da){return _0x44e669(_0x1e10da);}if(!_0x390d0d){_0x5a4978[a5_0x4691('0x19')](a5_0x4691('0x1a'),_0x1e632a[a5_0x4691('0x1b')]);return _0x3dc846[a5_0x4691('0x8')](a5_0x4691('0x16'));}_0x5a4978['logIn'](_0x390d0d,_0x1e10da=>{if(_0x1e10da){return _0x44e669(_0x1e10da);}_0x5a4978[a5_0x4691('0x19')]('success',{'msg':'Success!\x20You\x20are\x20logged\x20in.'});_0x3dc846[a5_0x4691('0x8')](_0x5a4978[a5_0x4691('0x1c')][a5_0x4691('0x1d')]||'/');});})(_0x5a4978,_0x3dc846,_0x44e669);};exports[a5_0x4691('0x1e')]=(_0x593f46,_0x51c574)=>{_0x593f46[a5_0x4691('0x1e')]();_0x51c574['redirect']('/');};exports['getSignup']=(_0x403f91,_0x457f55)=>{if(_0x403f91[a5_0x4691('0x7')]){return _0x457f55['redirect']('/');}_0x457f55[a5_0x4691('0x9')](a5_0x4691('0x1f'),{'title':a5_0x4691('0x20')});};exports[a5_0x4691('0x21')]=(_0x5281a5,_0x310aad,_0x4522af)=>{_0x5281a5[a5_0x4691('0xd')](a5_0x4691('0xe'),a5_0x4691('0xf'))['isEmail']();_0x5281a5[a5_0x4691('0xd')]('password',a5_0x4691('0x22'))[a5_0x4691('0x23')]({'min':0x4});_0x5281a5[a5_0x4691('0xd')](a5_0x4691('0x24'),'Passwords\x20do\x20not\x20match')['equals'](_0x5281a5[a5_0x4691('0x25')][a5_0x4691('0x11')]);_0x5281a5[a5_0x4691('0x14')](a5_0x4691('0xe'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x17c0b5=_0x5281a5['validationErrors']();if(_0x17c0b5){_0x5281a5['flash'](a5_0x4691('0x1a'),_0x17c0b5);return _0x310aad['redirect']('/signup');}const _0x2e3820=new User_1['default']({'email':_0x5281a5[a5_0x4691('0x25')][a5_0x4691('0xe')],'password':_0x5281a5[a5_0x4691('0x25')]['password']});User_1[a5_0x4691('0x17')][a5_0x4691('0x26')]({'email':_0x5281a5['body']['email']},(_0x404249,_0x3f80fc)=>{if(_0x404249){return _0x4522af(_0x404249);}if(_0x3f80fc){_0x5281a5[a5_0x4691('0x19')](a5_0x4691('0x1a'),{'msg':'Account\x20with\x20that\x20email\x20address\x20already\x20exists.'});return _0x310aad[a5_0x4691('0x8')](a5_0x4691('0x27'));}_0x2e3820[a5_0x4691('0x28')](_0x404249=>{if(_0x404249){return _0x4522af(_0x404249);}_0x5281a5[a5_0x4691('0x29')](_0x2e3820,_0x404249=>{if(_0x404249){return _0x4522af(_0x404249);}_0x310aad[a5_0x4691('0x8')]('/');});});});};exports[a5_0x4691('0x2a')]=(_0x38c22e,_0x4dd1cc)=>{_0x4dd1cc['render']('account/profile',{'title':a5_0x4691('0x2b')});};exports[a5_0x4691('0x2c')]=(_0x3478d6,_0xf99ea4,_0x316cc8)=>{_0x3478d6[a5_0x4691('0xd')](a5_0x4691('0xe'),'Please\x20enter\x20a\x20valid\x20email\x20address.')[a5_0x4691('0x10')]();_0x3478d6[a5_0x4691('0x14')](a5_0x4691('0xe'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x31acb5=_0x3478d6['validationErrors']();if(_0x31acb5){_0x3478d6[a5_0x4691('0x19')]('errors',_0x31acb5);return _0xf99ea4[a5_0x4691('0x8')](a5_0x4691('0x2d'));}User_1[a5_0x4691('0x17')]['findById'](_0x3478d6[a5_0x4691('0x7')]['id'],(_0x1bfdd9,_0x2bae72)=>{if(_0x1bfdd9){return _0x316cc8(_0x1bfdd9);}_0x2bae72['email']=_0x3478d6['body']['email']||'';_0x2bae72[a5_0x4691('0x2e')][a5_0x4691('0x2f')]=_0x3478d6['body'][a5_0x4691('0x2f')]||'';_0x2bae72['profile'][a5_0x4691('0x30')]=_0x3478d6[a5_0x4691('0x25')][a5_0x4691('0x30')]||'';_0x2bae72[a5_0x4691('0x2e')][a5_0x4691('0x31')]=_0x3478d6[a5_0x4691('0x25')][a5_0x4691('0x31')]||'';_0x2bae72[a5_0x4691('0x2e')][a5_0x4691('0x32')]=_0x3478d6[a5_0x4691('0x25')]['website']||'';_0x2bae72[a5_0x4691('0x28')](_0x1bfdd9=>{if(_0x1bfdd9){if(_0x1bfdd9['code']===0x2af8){_0x3478d6[a5_0x4691('0x19')](a5_0x4691('0x1a'),{'msg':'The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.'});return _0xf99ea4[a5_0x4691('0x8')](a5_0x4691('0x2d'));}return _0x316cc8(_0x1bfdd9);}_0x3478d6[a5_0x4691('0x19')](a5_0x4691('0x33'),{'msg':a5_0x4691('0x34')});_0xf99ea4[a5_0x4691('0x8')]('/account');});});};exports[a5_0x4691('0x35')]=(_0x1dac9a,_0xfc5aad,_0x1a0b5e)=>{_0x1dac9a['assert']('password','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long')['len']({'min':0x4});_0x1dac9a[a5_0x4691('0xd')](a5_0x4691('0x24'),a5_0x4691('0x36'))[a5_0x4691('0x37')](_0x1dac9a[a5_0x4691('0x25')][a5_0x4691('0x11')]);const _0x30594b=_0x1dac9a['validationErrors']();if(_0x30594b){_0x1dac9a['flash'](a5_0x4691('0x1a'),_0x30594b);return _0xfc5aad[a5_0x4691('0x8')](a5_0x4691('0x2d'));}User_1[a5_0x4691('0x17')]['findById'](_0x1dac9a[a5_0x4691('0x7')]['id'],(_0x1f3e4f,_0x11b460)=>{if(_0x1f3e4f){return _0x1a0b5e(_0x1f3e4f);}_0x11b460['password']=_0x1dac9a['body'][a5_0x4691('0x11')];_0x11b460[a5_0x4691('0x28')](_0x1f3e4f=>{if(_0x1f3e4f){return _0x1a0b5e(_0x1f3e4f);}_0x1dac9a[a5_0x4691('0x19')](a5_0x4691('0x33'),{'msg':a5_0x4691('0x38')});_0xfc5aad[a5_0x4691('0x8')](a5_0x4691('0x2d'));});});};exports[a5_0x4691('0x39')]=(_0x586829,_0x3062e6,_0x2b8681)=>{User_1['default']['remove']({'_id':_0x586829[a5_0x4691('0x7')]['id']},_0x4915c1=>{if(_0x4915c1){return _0x2b8681(_0x4915c1);}_0x586829[a5_0x4691('0x1e')]();_0x586829[a5_0x4691('0x19')](a5_0x4691('0x3a'),{'msg':'Your\x20account\x20has\x20been\x20deleted.'});_0x3062e6[a5_0x4691('0x8')]('/');});};exports[a5_0x4691('0x3b')]=(_0x2e3538,_0x7145bb,_0x59f96a)=>{const _0x220b90=_0x2e3538[a5_0x4691('0x3c')][a5_0x4691('0x3d')];User_1[a5_0x4691('0x17')]['findById'](_0x2e3538[a5_0x4691('0x7')]['id'],(_0x37c476,_0xf2256c)=>{if(_0x37c476){return _0x59f96a(_0x37c476);}_0xf2256c[_0x220b90]=undefined;_0xf2256c[a5_0x4691('0x3e')]=_0xf2256c['tokens'][a5_0x4691('0x3f')](_0x3b9ec6=>_0x3b9ec6[a5_0x4691('0x40')]!==_0x220b90);_0xf2256c[a5_0x4691('0x28')](_0x37c476=>{if(_0x37c476){return _0x59f96a(_0x37c476);}_0x2e3538[a5_0x4691('0x19')]('info',{'msg':_0x220b90+a5_0x4691('0x41')});_0x7145bb[a5_0x4691('0x8')](a5_0x4691('0x2d'));});});};exports['getReset']=(_0x50cd6c,_0x23ddb1,_0x560154)=>{if(_0x50cd6c[a5_0x4691('0x42')]()){return _0x23ddb1[a5_0x4691('0x8')]('/');}User_1['default'][a5_0x4691('0x26')]({'passwordResetToken':_0x50cd6c[a5_0x4691('0x3c')]['token']})[a5_0x4691('0x43')](a5_0x4691('0x44'))['gt'](Date['now']())[a5_0x4691('0x45')]((_0x252635,_0x8e175b)=>{if(_0x252635){return _0x560154(_0x252635);}if(!_0x8e175b){_0x50cd6c[a5_0x4691('0x19')](a5_0x4691('0x1a'),{'msg':a5_0x4691('0x46')});return _0x23ddb1[a5_0x4691('0x8')](a5_0x4691('0x47'));}_0x23ddb1[a5_0x4691('0x9')](a5_0x4691('0x48'),{'title':a5_0x4691('0x49')});});};exports['postReset']=(_0x3848fc,_0x201ce8,_0x2ef16a)=>{_0x3848fc[a5_0x4691('0xd')]('password',a5_0x4691('0x4a'))[a5_0x4691('0x23')]({'min':0x4});_0x3848fc[a5_0x4691('0xd')]('confirm',a5_0x4691('0x4b'))['equals'](_0x3848fc[a5_0x4691('0x25')][a5_0x4691('0x11')]);const _0x3e75d7=_0x3848fc[a5_0x4691('0x4c')]();if(_0x3e75d7){_0x3848fc['flash'](a5_0x4691('0x1a'),_0x3e75d7);return _0x201ce8[a5_0x4691('0x8')](a5_0x4691('0x4d'));}async_1[a5_0x4691('0x17')][a5_0x4691('0x4e')]([function resetPassword(_0x3cc384){User_1[a5_0x4691('0x17')][a5_0x4691('0x26')]({'passwordResetToken':_0x3848fc[a5_0x4691('0x3c')]['token']})[a5_0x4691('0x43')](a5_0x4691('0x44'))['gt'](Date[a5_0x4691('0x4f')]())[a5_0x4691('0x45')]((_0x414a66,_0x24ccf4)=>{if(_0x414a66){return _0x2ef16a(_0x414a66);}if(!_0x24ccf4){_0x3848fc[a5_0x4691('0x19')](a5_0x4691('0x1a'),{'msg':a5_0x4691('0x46')});return _0x201ce8[a5_0x4691('0x8')]('back');}_0x24ccf4[a5_0x4691('0x11')]=_0x3848fc['body']['password'];_0x24ccf4[a5_0x4691('0x50')]=undefined;_0x24ccf4[a5_0x4691('0x44')]=undefined;_0x24ccf4['save'](_0x414a66=>{if(_0x414a66){return _0x2ef16a(_0x414a66);}_0x3848fc[a5_0x4691('0x29')](_0x24ccf4,_0x414a66=>{_0x3cc384(_0x414a66,_0x24ccf4);});});});},function sendResetPasswordEmail(_0x3a72ab,_0x4c74a4){const _0x1d2f57=nodemailer_1[a5_0x4691('0x17')][a5_0x4691('0x51')]({'service':'SendGrid','auth':{'user':process['env']['SENDGRID_USER'],'pass':process[a5_0x4691('0x52')][a5_0x4691('0x53')]}});const _0xb1444c={'to':_0x3a72ab[a5_0x4691('0xe')],'from':'express-ts@starter.com','subject':a5_0x4691('0x54'),'text':'Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20'+_0x3a72ab[a5_0x4691('0xe')]+a5_0x4691('0x55')};_0x1d2f57[a5_0x4691('0x56')](_0xb1444c,_0x1ddc58=>{_0x3848fc[a5_0x4691('0x19')](a5_0x4691('0x33'),{'msg':a5_0x4691('0x57')});_0x4c74a4(_0x1ddc58);});}],_0x5dfbf0=>{if(_0x5dfbf0){return _0x2ef16a(_0x5dfbf0);}_0x201ce8['redirect']('/');});};exports[a5_0x4691('0x58')]=(_0x58516b,_0x3ad96f)=>{if(_0x58516b[a5_0x4691('0x42')]()){return _0x3ad96f[a5_0x4691('0x8')]('/');}_0x3ad96f[a5_0x4691('0x9')](a5_0x4691('0x59'),{'title':a5_0x4691('0x5a')});};exports[a5_0x4691('0x5b')]=(_0xc34fcd,_0xe8b929,_0x17a531)=>{_0xc34fcd[a5_0x4691('0xd')]('email',a5_0x4691('0x5c'))['isEmail']();_0xc34fcd['sanitize'](a5_0x4691('0xe'))[a5_0x4691('0x15')]({'gmail_remove_dots':![]});const _0xea6c6c=_0xc34fcd[a5_0x4691('0x4c')]();if(_0xea6c6c){_0xc34fcd[a5_0x4691('0x19')](a5_0x4691('0x1a'),_0xea6c6c);return _0xe8b929[a5_0x4691('0x8')](a5_0x4691('0x47'));}async_1[a5_0x4691('0x17')][a5_0x4691('0x4e')]([function createRandomToken(_0x39271a){crypto_1[a5_0x4691('0x17')][a5_0x4691('0x5d')](0x10,(_0x283e76,_0x1c4ff9)=>{const _0x5f2059=_0x1c4ff9[a5_0x4691('0x5e')](a5_0x4691('0x5f'));_0x39271a(_0x283e76,_0x5f2059);});},function setRandomToken(_0x5083cc,_0x26789b){User_1[a5_0x4691('0x17')][a5_0x4691('0x26')]({'email':_0xc34fcd['body'][a5_0x4691('0xe')]},(_0x1a778f,_0x3949e3)=>{if(_0x1a778f){return _0x26789b(_0x1a778f);}if(!_0x3949e3){_0xc34fcd[a5_0x4691('0x19')](a5_0x4691('0x1a'),{'msg':a5_0x4691('0x60')});return _0xe8b929[a5_0x4691('0x8')](a5_0x4691('0x47'));}_0x3949e3[a5_0x4691('0x50')]=_0x5083cc;_0x3949e3[a5_0x4691('0x44')]=Date[a5_0x4691('0x4f')]()+0x36ee80;_0x3949e3[a5_0x4691('0x28')](_0x1a778f=>{_0x26789b(_0x1a778f,_0x5083cc,_0x3949e3);});});},function sendForgotPasswordEmail(_0x564f1e,_0x49802f,_0x23afe3){const _0x5d1145=nodemailer_1[a5_0x4691('0x17')][a5_0x4691('0x51')]({'service':'SendGrid','auth':{'user':process[a5_0x4691('0x52')][a5_0x4691('0x61')],'pass':process[a5_0x4691('0x52')][a5_0x4691('0x53')]}});const _0x1a1f7f={'to':_0x49802f['email'],'from':'hackathon@starter.com','subject':a5_0x4691('0x62'),'text':a5_0x4691('0x63')+_0xc34fcd[a5_0x4691('0x64')][a5_0x4691('0x65')]+'/reset/'+_0x564f1e+a5_0x4691('0x66')};_0x5d1145['sendMail'](_0x1a1f7f,_0x3e721b=>{_0xc34fcd['flash'](a5_0x4691('0x3a'),{'msg':a5_0x4691('0x67')+_0x49802f['email']+a5_0x4691('0x68')});_0x23afe3(_0x3e721b);});}],_0x3d210b=>{if(_0x3d210b){return _0x17a531(_0x3d210b);}_0xe8b929['redirect'](a5_0x4691('0x47'));});};
var a5_0x31fe=['\x20with\x20further\x20instructions.','__importDefault','__esModule','async','passport','../models/User','express-validator','getLogin','redirect','render','account/login','Login','assert','email','Email\x20is\x20not\x20valid','isEmail','password','notEmpty','sanitize','normalizeEmail','validationErrors','flash','/login','default','local','errors','message','success','Success!\x20You\x20are\x20logged\x20in.','session','logout','getSignup','user','account/signup','Create\x20Account','postSignup','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','Passwords\x20do\x20not\x20match','equals','body','/signup','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','save','logIn','getAccount','account/profile','postUpdateProfile','/account','findById','profile','name','gender','location','website','code','The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.','Profile\x20information\x20has\x20been\x20updated.','postUpdatePassword','len','confirmPassword','Password\x20has\x20been\x20changed.','remove','info','Your\x20account\x20has\x20been\x20deleted.','getOauthUnlink','provider','tokens','filter','kind','getReset','isAuthenticated','findOne','params','token','where','passwordResetExpires','now','exec','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','/forgot','Password\x20Reset','postReset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','confirm','Passwords\x20must\x20match.','back','waterfall','passwordResetToken','createTransport','SendGrid','env','SENDGRID_USER','SENDGRID_PASSWORD','Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20','\x20has\x20just\x20been\x20changed.\x0a','sendMail','getForgot','account/forgot','postForgot','randomBytes','toString','hex','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://','headers','host','/reset/','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','An\x20e-mail\x20has\x20been\x20sent\x20to\x20'];(function(_0x4ffb26,_0x1d7b94){var _0x852e91=function(_0x14ae5e){while(--_0x14ae5e){_0x4ffb26['push'](_0x4ffb26['shift']());}};_0x852e91(++_0x1d7b94);}(a5_0x31fe,0x70));var a5_0x258b=function(_0x2d98c9,_0x5a1ee7){_0x2d98c9=_0x2d98c9-0x0;var _0x3180a0=a5_0x31fe[_0x2d98c9];return _0x3180a0;};'use strict';var __importDefault=this&&this[a5_0x258b('0x0')]||function(_0x1f46bf){return _0x1f46bf&&_0x1f46bf[a5_0x258b('0x1')]?_0x1f46bf:{'default':_0x1f46bf};};Object['defineProperty'](exports,a5_0x258b('0x1'),{'value':!![]});const async_1=__importDefault(require(a5_0x258b('0x2')));const crypto_1=__importDefault(require('crypto'));const nodemailer_1=__importDefault(require('nodemailer'));const passport_1=__importDefault(require(a5_0x258b('0x3')));const User_1=__importDefault(require(a5_0x258b('0x4')));const request=require(a5_0x258b('0x5'));exports[a5_0x258b('0x6')]=(_0x533bec,_0x10583b)=>{if(_0x533bec['user']){return _0x10583b[a5_0x258b('0x7')]('/');}_0x10583b[a5_0x258b('0x8')](a5_0x258b('0x9'),{'title':a5_0x258b('0xa')});};exports['postLogin']=(_0x317a94,_0x360be5,_0x50ea50)=>{_0x317a94[a5_0x258b('0xb')](a5_0x258b('0xc'),a5_0x258b('0xd'))[a5_0x258b('0xe')]();_0x317a94['assert'](a5_0x258b('0xf'),'Password\x20cannot\x20be\x20blank')[a5_0x258b('0x10')]();_0x317a94[a5_0x258b('0x11')](a5_0x258b('0xc'))[a5_0x258b('0x12')]({'gmail_remove_dots':![]});const _0x4b9b93=_0x317a94[a5_0x258b('0x13')]();if(_0x4b9b93){_0x317a94[a5_0x258b('0x14')]('errors',_0x4b9b93);return _0x360be5['redirect'](a5_0x258b('0x15'));}passport_1[a5_0x258b('0x16')]['authenticate'](a5_0x258b('0x17'),(_0x5cc496,_0x1c39ff,_0x4b7913)=>{if(_0x5cc496){return _0x50ea50(_0x5cc496);}if(!_0x1c39ff){_0x317a94[a5_0x258b('0x14')](a5_0x258b('0x18'),_0x4b7913[a5_0x258b('0x19')]);return _0x360be5[a5_0x258b('0x7')](a5_0x258b('0x15'));}_0x317a94['logIn'](_0x1c39ff,_0x5cc496=>{if(_0x5cc496){return _0x50ea50(_0x5cc496);}_0x317a94[a5_0x258b('0x14')](a5_0x258b('0x1a'),{'msg':a5_0x258b('0x1b')});_0x360be5[a5_0x258b('0x7')](_0x317a94[a5_0x258b('0x1c')]['returnTo']||'/');});})(_0x317a94,_0x360be5,_0x50ea50);};exports[a5_0x258b('0x1d')]=(_0x48c315,_0x4a57dd)=>{_0x48c315[a5_0x258b('0x1d')]();_0x4a57dd[a5_0x258b('0x7')]('/');};exports[a5_0x258b('0x1e')]=(_0x16c3e3,_0x568409)=>{if(_0x16c3e3[a5_0x258b('0x1f')]){return _0x568409[a5_0x258b('0x7')]('/');}_0x568409[a5_0x258b('0x8')](a5_0x258b('0x20'),{'title':a5_0x258b('0x21')});};exports[a5_0x258b('0x22')]=(_0x5c82ed,_0x3cdd8c,_0x3107ce)=>{_0x5c82ed['assert']('email',a5_0x258b('0xd'))[a5_0x258b('0xe')]();_0x5c82ed[a5_0x258b('0xb')]('password',a5_0x258b('0x23'))['len']({'min':0x4});_0x5c82ed[a5_0x258b('0xb')]('confirmPassword',a5_0x258b('0x24'))[a5_0x258b('0x25')](_0x5c82ed[a5_0x258b('0x26')][a5_0x258b('0xf')]);_0x5c82ed['sanitize'](a5_0x258b('0xc'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x20b318=_0x5c82ed[a5_0x258b('0x13')]();if(_0x20b318){_0x5c82ed[a5_0x258b('0x14')](a5_0x258b('0x18'),_0x20b318);return _0x3cdd8c['redirect'](a5_0x258b('0x27'));}const _0xe49d3b=new User_1[(a5_0x258b('0x16'))]({});User_1[a5_0x258b('0x16')]['findOne']({'email':_0x5c82ed[a5_0x258b('0x26')][a5_0x258b('0xc')]},(_0x2eae30,_0x5c446e)=>{if(_0x2eae30){return _0x3107ce(_0x2eae30);}if(_0x5c446e){_0x5c82ed['flash'](a5_0x258b('0x18'),{'msg':a5_0x258b('0x28')});return _0x3cdd8c[a5_0x258b('0x7')](a5_0x258b('0x27'));}_0xe49d3b[a5_0x258b('0x29')](_0x2eae30=>{if(_0x2eae30){return _0x3107ce(_0x2eae30);}_0x5c82ed[a5_0x258b('0x2a')](_0xe49d3b,_0x2eae30=>{if(_0x2eae30){return _0x3107ce(_0x2eae30);}_0x3cdd8c[a5_0x258b('0x7')]('/');});});});};exports[a5_0x258b('0x2b')]=(_0x41e994,_0x554191)=>{_0x554191[a5_0x258b('0x8')](a5_0x258b('0x2c'),{'title':'Account\x20Management'});};exports[a5_0x258b('0x2d')]=(_0x122f56,_0x49c3d4,_0x47c19b)=>{_0x122f56[a5_0x258b('0xb')]('email','Please\x20enter\x20a\x20valid\x20email\x20address.')[a5_0x258b('0xe')]();_0x122f56[a5_0x258b('0x11')](a5_0x258b('0xc'))[a5_0x258b('0x12')]({'gmail_remove_dots':![]});const _0x37f2d=_0x122f56[a5_0x258b('0x13')]();if(_0x37f2d){_0x122f56[a5_0x258b('0x14')]('errors',_0x37f2d);return _0x49c3d4[a5_0x258b('0x7')](a5_0x258b('0x2e'));}User_1['default'][a5_0x258b('0x2f')](_0x122f56[a5_0x258b('0x1f')]['id'],(_0x2363e6,_0x578ee3)=>{if(_0x2363e6){return _0x47c19b(_0x2363e6);}_0x578ee3['email']=_0x122f56[a5_0x258b('0x26')][a5_0x258b('0xc')]||'';_0x578ee3[a5_0x258b('0x30')][a5_0x258b('0x31')]=_0x122f56['body'][a5_0x258b('0x31')]||'';_0x578ee3[a5_0x258b('0x30')][a5_0x258b('0x32')]=_0x122f56['body'][a5_0x258b('0x32')]||'';_0x578ee3[a5_0x258b('0x30')][a5_0x258b('0x33')]=_0x122f56['body'][a5_0x258b('0x33')]||'';_0x578ee3[a5_0x258b('0x30')][a5_0x258b('0x34')]=_0x122f56[a5_0x258b('0x26')][a5_0x258b('0x34')]||'';_0x578ee3[a5_0x258b('0x29')](_0x2363e6=>{if(_0x2363e6){if(_0x2363e6[a5_0x258b('0x35')]===0x2af8){_0x122f56[a5_0x258b('0x14')](a5_0x258b('0x18'),{'msg':a5_0x258b('0x36')});return _0x49c3d4[a5_0x258b('0x7')](a5_0x258b('0x2e'));}return _0x47c19b(_0x2363e6);}_0x122f56[a5_0x258b('0x14')](a5_0x258b('0x1a'),{'msg':a5_0x258b('0x37')});_0x49c3d4[a5_0x258b('0x7')]('/account');});});};exports[a5_0x258b('0x38')]=(_0x17428f,_0x3d3769,_0x5aadc9)=>{_0x17428f[a5_0x258b('0xb')](a5_0x258b('0xf'),a5_0x258b('0x23'))[a5_0x258b('0x39')]({'min':0x4});_0x17428f['assert'](a5_0x258b('0x3a'),a5_0x258b('0x24'))[a5_0x258b('0x25')](_0x17428f[a5_0x258b('0x26')][a5_0x258b('0xf')]);const _0x5b6dca=_0x17428f[a5_0x258b('0x13')]();if(_0x5b6dca){_0x17428f[a5_0x258b('0x14')](a5_0x258b('0x18'),_0x5b6dca);return _0x3d3769[a5_0x258b('0x7')](a5_0x258b('0x2e'));}User_1['default'][a5_0x258b('0x2f')](_0x17428f[a5_0x258b('0x1f')]['id'],(_0x27358c,_0x1a0c79)=>{if(_0x27358c){return _0x5aadc9(_0x27358c);}_0x1a0c79[a5_0x258b('0xf')]=_0x17428f['body'][a5_0x258b('0xf')];_0x1a0c79[a5_0x258b('0x29')](_0x27358c=>{if(_0x27358c){return _0x5aadc9(_0x27358c);}_0x17428f['flash'](a5_0x258b('0x1a'),{'msg':a5_0x258b('0x3b')});_0x3d3769[a5_0x258b('0x7')](a5_0x258b('0x2e'));});});};exports['postDeleteAccount']=(_0x464499,_0x109097,_0x1dc4ed)=>{User_1[a5_0x258b('0x16')][a5_0x258b('0x3c')]({'_id':_0x464499[a5_0x258b('0x1f')]['id']},_0x39fa5b=>{if(_0x39fa5b){return _0x1dc4ed(_0x39fa5b);}_0x464499[a5_0x258b('0x1d')]();_0x464499[a5_0x258b('0x14')](a5_0x258b('0x3d'),{'msg':a5_0x258b('0x3e')});_0x109097[a5_0x258b('0x7')]('/');});};exports[a5_0x258b('0x3f')]=(_0x3bb0fb,_0x40751c,_0x1f1178)=>{const _0x1bd660=_0x3bb0fb['params'][a5_0x258b('0x40')];User_1['default'][a5_0x258b('0x2f')](_0x3bb0fb[a5_0x258b('0x1f')]['id'],(_0x15002c,_0x132eca)=>{if(_0x15002c){return _0x1f1178(_0x15002c);}_0x132eca[_0x1bd660]=undefined;_0x132eca[a5_0x258b('0x41')]=_0x132eca[a5_0x258b('0x41')][a5_0x258b('0x42')](_0x29f515=>_0x29f515[a5_0x258b('0x43')]!==_0x1bd660);_0x132eca['save'](_0x15002c=>{if(_0x15002c){return _0x1f1178(_0x15002c);}_0x3bb0fb[a5_0x258b('0x14')](a5_0x258b('0x3d'),{'msg':_0x1bd660+'\x20account\x20has\x20been\x20unlinked.'});_0x40751c[a5_0x258b('0x7')](a5_0x258b('0x2e'));});});};exports[a5_0x258b('0x44')]=(_0x4a35dd,_0xc1a16b,_0x7e1058)=>{if(_0x4a35dd[a5_0x258b('0x45')]()){return _0xc1a16b[a5_0x258b('0x7')]('/');}User_1['default'][a5_0x258b('0x46')]({'passwordResetToken':_0x4a35dd[a5_0x258b('0x47')][a5_0x258b('0x48')]})[a5_0x258b('0x49')](a5_0x258b('0x4a'))['gt'](Date[a5_0x258b('0x4b')]())[a5_0x258b('0x4c')]((_0x4cf7fa,_0x63cbda)=>{if(_0x4cf7fa){return _0x7e1058(_0x4cf7fa);}if(!_0x63cbda){_0x4a35dd[a5_0x258b('0x14')]('errors',{'msg':a5_0x258b('0x4d')});return _0xc1a16b[a5_0x258b('0x7')](a5_0x258b('0x4e'));}_0xc1a16b['render']('account/reset',{'title':a5_0x258b('0x4f')});});};exports[a5_0x258b('0x50')]=(_0x3f67ac,_0x1397dd,_0x51387d)=>{_0x3f67ac['assert'](a5_0x258b('0xf'),a5_0x258b('0x51'))['len']({'min':0x4});_0x3f67ac['assert'](a5_0x258b('0x52'),a5_0x258b('0x53'))[a5_0x258b('0x25')](_0x3f67ac[a5_0x258b('0x26')][a5_0x258b('0xf')]);const _0x361bf1=_0x3f67ac[a5_0x258b('0x13')]();if(_0x361bf1){_0x3f67ac[a5_0x258b('0x14')](a5_0x258b('0x18'),_0x361bf1);return _0x1397dd[a5_0x258b('0x7')](a5_0x258b('0x54'));}async_1['default'][a5_0x258b('0x55')]([function resetPassword(_0x2be9d3){User_1[a5_0x258b('0x16')]['findOne']({'passwordResetToken':_0x3f67ac[a5_0x258b('0x47')][a5_0x258b('0x48')]})[a5_0x258b('0x49')]('passwordResetExpires')['gt'](Date[a5_0x258b('0x4b')]())[a5_0x258b('0x4c')]((_0xe2d6f2,_0x16c230)=>{if(_0xe2d6f2){return _0x51387d(_0xe2d6f2);}if(!_0x16c230){_0x3f67ac[a5_0x258b('0x14')](a5_0x258b('0x18'),{'msg':a5_0x258b('0x4d')});return _0x1397dd['redirect'](a5_0x258b('0x54'));}_0x16c230[a5_0x258b('0xf')]=_0x3f67ac[a5_0x258b('0x26')][a5_0x258b('0xf')];_0x16c230[a5_0x258b('0x56')]=undefined;_0x16c230[a5_0x258b('0x4a')]=undefined;_0x16c230[a5_0x258b('0x29')](_0xe2d6f2=>{if(_0xe2d6f2){return _0x51387d(_0xe2d6f2);}_0x3f67ac['logIn'](_0x16c230,_0xe2d6f2=>{_0x2be9d3(_0xe2d6f2,_0x16c230);});});});},function sendResetPasswordEmail(_0x40d0f5,_0x512ba0){const _0x331a0a=nodemailer_1['default'][a5_0x258b('0x57')]({'service':a5_0x258b('0x58'),'auth':{'user':process[a5_0x258b('0x59')][a5_0x258b('0x5a')],'pass':process[a5_0x258b('0x59')][a5_0x258b('0x5b')]}});const _0x1c7191={'to':_0x40d0f5[a5_0x258b('0xc')],'from':'express-ts@starter.com','subject':'Your\x20password\x20has\x20been\x20changed','text':a5_0x258b('0x5c')+_0x40d0f5['email']+a5_0x258b('0x5d')};_0x331a0a[a5_0x258b('0x5e')](_0x1c7191,_0x3c526a=>{_0x3f67ac['flash'](a5_0x258b('0x1a'),{'msg':'Success!\x20Your\x20password\x20has\x20been\x20changed.'});_0x512ba0(_0x3c526a);});}],_0x89b5bb=>{if(_0x89b5bb){return _0x51387d(_0x89b5bb);}_0x1397dd[a5_0x258b('0x7')]('/');});};exports[a5_0x258b('0x5f')]=(_0x597b3b,_0x1ad8ed)=>{if(_0x597b3b['isAuthenticated']()){return _0x1ad8ed[a5_0x258b('0x7')]('/');}_0x1ad8ed['render'](a5_0x258b('0x60'),{'title':'Forgot\x20Password'});};exports[a5_0x258b('0x61')]=(_0x4725ab,_0x258aa4,_0x141568)=>{_0x4725ab[a5_0x258b('0xb')](a5_0x258b('0xc'),'Please\x20enter\x20a\x20valid\x20email\x20address.')[a5_0x258b('0xe')]();_0x4725ab[a5_0x258b('0x11')](a5_0x258b('0xc'))['normalizeEmail']({'gmail_remove_dots':![]});const _0xce43b9=_0x4725ab[a5_0x258b('0x13')]();if(_0xce43b9){_0x4725ab[a5_0x258b('0x14')](a5_0x258b('0x18'),_0xce43b9);return _0x258aa4[a5_0x258b('0x7')]('/forgot');}async_1[a5_0x258b('0x16')][a5_0x258b('0x55')]([function createRandomToken(_0x1192f7){crypto_1[a5_0x258b('0x16')][a5_0x258b('0x62')](0x10,(_0x3514d8,_0x3139b3)=>{const _0x442956=_0x3139b3[a5_0x258b('0x63')](a5_0x258b('0x64'));_0x1192f7(_0x3514d8,_0x442956);});},function setRandomToken(_0x522919,_0x1d9d6a){User_1[a5_0x258b('0x16')][a5_0x258b('0x46')]({'email':_0x4725ab[a5_0x258b('0x26')][a5_0x258b('0xc')]},(_0x278cad,_0x1f47c)=>{if(_0x278cad){return _0x1d9d6a(_0x278cad);}if(!_0x1f47c){_0x4725ab[a5_0x258b('0x14')](a5_0x258b('0x18'),{'msg':a5_0x258b('0x65')});return _0x258aa4[a5_0x258b('0x7')](a5_0x258b('0x4e'));}_0x1f47c[a5_0x258b('0x56')]=_0x522919;_0x1f47c[a5_0x258b('0x4a')]=Date[a5_0x258b('0x4b')]()+0x36ee80;_0x1f47c[a5_0x258b('0x29')](_0x278cad=>{_0x1d9d6a(_0x278cad,_0x522919,_0x1f47c);});});},function sendForgotPasswordEmail(_0x22f035,_0x47b623,_0x1fd76e){const _0x5141a8=nodemailer_1[a5_0x258b('0x16')][a5_0x258b('0x57')]({'service':a5_0x258b('0x58'),'auth':{'user':process[a5_0x258b('0x59')][a5_0x258b('0x5a')],'pass':process[a5_0x258b('0x59')][a5_0x258b('0x5b')]}});const _0x5c7c5a={'to':_0x47b623[a5_0x258b('0xc')],'from':a5_0x258b('0x66'),'subject':a5_0x258b('0x67'),'text':a5_0x258b('0x68')+_0x4725ab[a5_0x258b('0x69')][a5_0x258b('0x6a')]+a5_0x258b('0x6b')+_0x22f035+a5_0x258b('0x6c')};_0x5141a8[a5_0x258b('0x5e')](_0x5c7c5a,_0x4da18d=>{_0x4725ab[a5_0x258b('0x14')](a5_0x258b('0x3d'),{'msg':a5_0x258b('0x6d')+_0x47b623[a5_0x258b('0xc')]+a5_0x258b('0x6e')});_0x1fd76e(_0x4da18d);});}],_0x3636cd=>{if(_0x3636cd){return _0x141568(_0x3636cd);}_0x258aa4[a5_0x258b('0x7')](a5_0x258b('0x4e'));});};
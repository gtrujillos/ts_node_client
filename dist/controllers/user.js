var a5_0x51aa=['info','Your\x20account\x20has\x20been\x20deleted.','getOauthUnlink','provider','tokens','\x20account\x20has\x20been\x20unlinked.','isAuthenticated','token','where','passwordResetExpires','now','exec','/forgot','Password\x20Reset','postReset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','confirm','Passwords\x20must\x20match.','equals','waterfall','findOne','params','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','back','passwordResetToken','createTransport','SendGrid','env','SENDGRID_USER','express-ts@starter.com','Your\x20password\x20has\x20been\x20changed','Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20','getForgot','postForgot','Please\x20enter\x20a\x20valid\x20email\x20address.','toString','hex','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','SENDGRID_PASSWORD','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://','headers','host','/reset/','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','sendMail','__esModule','defineProperty','async','crypto','express-validator','user','redirect','render','account/login','assert','email','Email\x20is\x20not\x20valid','isEmail','password','Password\x20cannot\x20be\x20blank','notEmpty','sanitize','validationErrors','flash','errors','/login','default','authenticate','local','message','logIn','success','session','returnTo','logout','getSignup','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','len','confirmPassword','Passwords\x20do\x20not\x20match','body','normalizeEmail','/signup','getAccount','account/profile','Account\x20Management','postUpdateProfile','findById','profile','name','gender','location','website','save','code','The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.','/account','Profile\x20information\x20has\x20been\x20updated.','postUpdatePassword','postDeleteAccount','remove'];(function(_0x3906b4,_0x3a9d31){var _0x533568=function(_0x280147){while(--_0x280147){_0x3906b4['push'](_0x3906b4['shift']());}};_0x533568(++_0x3a9d31);}(a5_0x51aa,0xfd));var a5_0x4ffd=function(_0x1d913b,_0x5b859f){_0x1d913b=_0x1d913b-0x0;var _0x262e74=a5_0x51aa[_0x1d913b];return _0x262e74;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x45cf49){return _0x45cf49&&_0x45cf49[a5_0x4ffd('0x0')]?_0x45cf49:{'default':_0x45cf49};};Object[a5_0x4ffd('0x1')](exports,a5_0x4ffd('0x0'),{'value':!![]});const async_1=__importDefault(require(a5_0x4ffd('0x2')));const crypto_1=__importDefault(require(a5_0x4ffd('0x3')));const nodemailer_1=__importDefault(require('nodemailer'));const passport_1=__importDefault(require('passport'));const User_1=__importDefault(require('../models/User'));const request=require(a5_0x4ffd('0x4'));exports['getLogin']=(_0x50d1d2,_0x45cb20)=>{if(_0x50d1d2[a5_0x4ffd('0x5')]){return _0x45cb20[a5_0x4ffd('0x6')]('/');}_0x45cb20[a5_0x4ffd('0x7')](a5_0x4ffd('0x8'),{'title':'Login'});};exports['postLogin']=(_0xfdfa7a,_0x5f3c1c,_0xd36287)=>{_0xfdfa7a[a5_0x4ffd('0x9')](a5_0x4ffd('0xa'),a5_0x4ffd('0xb'))[a5_0x4ffd('0xc')]();_0xfdfa7a[a5_0x4ffd('0x9')](a5_0x4ffd('0xd'),a5_0x4ffd('0xe'))[a5_0x4ffd('0xf')]();_0xfdfa7a[a5_0x4ffd('0x10')]('email')['normalizeEmail']({'gmail_remove_dots':![]});const _0x380339=_0xfdfa7a[a5_0x4ffd('0x11')]();if(_0x380339){_0xfdfa7a[a5_0x4ffd('0x12')](a5_0x4ffd('0x13'),_0x380339);return _0x5f3c1c[a5_0x4ffd('0x6')](a5_0x4ffd('0x14'));}passport_1[a5_0x4ffd('0x15')][a5_0x4ffd('0x16')](a5_0x4ffd('0x17'),(_0x478717,_0x2b769c,_0x32d4bd)=>{if(_0x478717){return _0xd36287(_0x478717);}if(!_0x2b769c){_0xfdfa7a[a5_0x4ffd('0x12')]('errors',_0x32d4bd[a5_0x4ffd('0x18')]);return _0x5f3c1c['redirect'](a5_0x4ffd('0x14'));}_0xfdfa7a[a5_0x4ffd('0x19')](_0x2b769c,_0x478717=>{if(_0x478717){return _0xd36287(_0x478717);}_0xfdfa7a[a5_0x4ffd('0x12')](a5_0x4ffd('0x1a'),{'msg':'Success!\x20You\x20are\x20logged\x20in.'});_0x5f3c1c[a5_0x4ffd('0x6')](_0xfdfa7a[a5_0x4ffd('0x1b')][a5_0x4ffd('0x1c')]||'/');});})(_0xfdfa7a,_0x5f3c1c,_0xd36287);};exports['logout']=(_0x1153d7,_0x42f374)=>{_0x1153d7[a5_0x4ffd('0x1d')]();_0x42f374[a5_0x4ffd('0x6')]('/');};exports[a5_0x4ffd('0x1e')]=(_0x27a3ea,_0x4a8b7f)=>{if(_0x27a3ea[a5_0x4ffd('0x5')]){return _0x4a8b7f[a5_0x4ffd('0x6')]('/');}_0x4a8b7f[a5_0x4ffd('0x7')]('account/signup',{'title':'Create\x20Account'});};exports['postSignup']=(_0x1da4a6,_0xc7aaa6,_0x1ba973)=>{_0x1da4a6[a5_0x4ffd('0x9')](a5_0x4ffd('0xa'),a5_0x4ffd('0xb'))[a5_0x4ffd('0xc')]();_0x1da4a6[a5_0x4ffd('0x9')](a5_0x4ffd('0xd'),a5_0x4ffd('0x1f'))[a5_0x4ffd('0x20')]({'min':0x4});_0x1da4a6[a5_0x4ffd('0x9')](a5_0x4ffd('0x21'),a5_0x4ffd('0x22'))['equals'](_0x1da4a6[a5_0x4ffd('0x23')][a5_0x4ffd('0xd')]);_0x1da4a6[a5_0x4ffd('0x10')](a5_0x4ffd('0xa'))[a5_0x4ffd('0x24')]({'gmail_remove_dots':![]});const _0x3f6e8b=_0x1da4a6['validationErrors']();if(_0x3f6e8b){_0x1da4a6[a5_0x4ffd('0x12')](a5_0x4ffd('0x13'),_0x3f6e8b);return _0xc7aaa6[a5_0x4ffd('0x6')](a5_0x4ffd('0x25'));}const _0x5b763f=new User_1['default']({'email':_0x1da4a6[a5_0x4ffd('0x23')]['email'],'password':_0x1da4a6[a5_0x4ffd('0x23')][a5_0x4ffd('0xd')]});User_1[a5_0x4ffd('0x15')]['findOne']({'email':_0x1da4a6[a5_0x4ffd('0x23')][a5_0x4ffd('0xa')]},(_0x2c7047,_0x529be8)=>{if(_0x2c7047){return _0x1ba973(_0x2c7047);}if(_0x529be8){_0x1da4a6[a5_0x4ffd('0x12')](a5_0x4ffd('0x13'),{'msg':'Account\x20with\x20that\x20email\x20address\x20already\x20exists.'});return _0xc7aaa6[a5_0x4ffd('0x6')]('/signup');}_0x5b763f['save'](_0x2c7047=>{if(_0x2c7047){return _0x1ba973(_0x2c7047);}_0x1da4a6['logIn'](_0x5b763f,_0x2c7047=>{if(_0x2c7047){return _0x1ba973(_0x2c7047);}_0xc7aaa6[a5_0x4ffd('0x6')]('/');});});});};exports[a5_0x4ffd('0x26')]=(_0x36b2e9,_0x48832b)=>{_0x48832b[a5_0x4ffd('0x7')](a5_0x4ffd('0x27'),{'title':a5_0x4ffd('0x28')});};exports[a5_0x4ffd('0x29')]=(_0x12ec96,_0x341e14,_0x2838c2)=>{_0x12ec96[a5_0x4ffd('0x9')](a5_0x4ffd('0xa'),'Please\x20enter\x20a\x20valid\x20email\x20address.')[a5_0x4ffd('0xc')]();_0x12ec96[a5_0x4ffd('0x10')]('email')['normalizeEmail']({'gmail_remove_dots':![]});const _0x5a0575=_0x12ec96['validationErrors']();if(_0x5a0575){_0x12ec96['flash'](a5_0x4ffd('0x13'),_0x5a0575);return _0x341e14['redirect']('/account');}User_1[a5_0x4ffd('0x15')][a5_0x4ffd('0x2a')](_0x12ec96['user']['id'],(_0x473954,_0x36993a)=>{if(_0x473954){return _0x2838c2(_0x473954);}_0x36993a['email']=_0x12ec96['body'][a5_0x4ffd('0xa')]||'';_0x36993a[a5_0x4ffd('0x2b')]['name']=_0x12ec96['body'][a5_0x4ffd('0x2c')]||'';_0x36993a[a5_0x4ffd('0x2b')]['gender']=_0x12ec96[a5_0x4ffd('0x23')][a5_0x4ffd('0x2d')]||'';_0x36993a[a5_0x4ffd('0x2b')][a5_0x4ffd('0x2e')]=_0x12ec96[a5_0x4ffd('0x23')][a5_0x4ffd('0x2e')]||'';_0x36993a['profile'][a5_0x4ffd('0x2f')]=_0x12ec96[a5_0x4ffd('0x23')][a5_0x4ffd('0x2f')]||'';_0x36993a[a5_0x4ffd('0x30')](_0x473954=>{if(_0x473954){if(_0x473954[a5_0x4ffd('0x31')]===0x2af8){_0x12ec96[a5_0x4ffd('0x12')]('errors',{'msg':a5_0x4ffd('0x32')});return _0x341e14[a5_0x4ffd('0x6')](a5_0x4ffd('0x33'));}return _0x2838c2(_0x473954);}_0x12ec96[a5_0x4ffd('0x12')](a5_0x4ffd('0x1a'),{'msg':a5_0x4ffd('0x34')});_0x341e14[a5_0x4ffd('0x6')](a5_0x4ffd('0x33'));});});};exports[a5_0x4ffd('0x35')]=(_0x39129c,_0x1d3e2a,_0x3368cd)=>{_0x39129c[a5_0x4ffd('0x9')](a5_0x4ffd('0xd'),a5_0x4ffd('0x1f'))[a5_0x4ffd('0x20')]({'min':0x4});_0x39129c['assert'](a5_0x4ffd('0x21'),a5_0x4ffd('0x22'))['equals'](_0x39129c[a5_0x4ffd('0x23')]['password']);const _0x14f5dc=_0x39129c[a5_0x4ffd('0x11')]();if(_0x14f5dc){_0x39129c[a5_0x4ffd('0x12')](a5_0x4ffd('0x13'),_0x14f5dc);return _0x1d3e2a[a5_0x4ffd('0x6')](a5_0x4ffd('0x33'));}User_1[a5_0x4ffd('0x15')]['findById'](_0x39129c[a5_0x4ffd('0x5')]['id'],(_0x4398bf,_0x4c8dbf)=>{if(_0x4398bf){return _0x3368cd(_0x4398bf);}_0x4c8dbf[a5_0x4ffd('0xd')]=_0x39129c[a5_0x4ffd('0x23')][a5_0x4ffd('0xd')];_0x4c8dbf['save'](_0x4398bf=>{if(_0x4398bf){return _0x3368cd(_0x4398bf);}_0x39129c[a5_0x4ffd('0x12')](a5_0x4ffd('0x1a'),{'msg':'Password\x20has\x20been\x20changed.'});_0x1d3e2a[a5_0x4ffd('0x6')]('/account');});});};exports[a5_0x4ffd('0x36')]=(_0x434fdd,_0x323703,_0x6947fa)=>{User_1['default'][a5_0x4ffd('0x37')]({'_id':_0x434fdd[a5_0x4ffd('0x5')]['id']},_0x3310e6=>{if(_0x3310e6){return _0x6947fa(_0x3310e6);}_0x434fdd[a5_0x4ffd('0x1d')]();_0x434fdd[a5_0x4ffd('0x12')](a5_0x4ffd('0x38'),{'msg':a5_0x4ffd('0x39')});_0x323703['redirect']('/');});};exports[a5_0x4ffd('0x3a')]=(_0x273c34,_0x36df38,_0x1a425a)=>{const _0x449738=_0x273c34['params'][a5_0x4ffd('0x3b')];User_1['default'][a5_0x4ffd('0x2a')](_0x273c34[a5_0x4ffd('0x5')]['id'],(_0x511a96,_0x400ca5)=>{if(_0x511a96){return _0x1a425a(_0x511a96);}_0x400ca5[_0x449738]=undefined;_0x400ca5[a5_0x4ffd('0x3c')]=_0x400ca5[a5_0x4ffd('0x3c')]['filter'](_0x1a8034=>_0x1a8034['kind']!==_0x449738);_0x400ca5[a5_0x4ffd('0x30')](_0x511a96=>{if(_0x511a96){return _0x1a425a(_0x511a96);}_0x273c34['flash'](a5_0x4ffd('0x38'),{'msg':_0x449738+a5_0x4ffd('0x3d')});_0x36df38[a5_0x4ffd('0x6')]('/account');});});};exports['getReset']=(_0x3b98f8,_0xcd430,_0x292b44)=>{if(_0x3b98f8[a5_0x4ffd('0x3e')]()){return _0xcd430[a5_0x4ffd('0x6')]('/');}User_1['default']['findOne']({'passwordResetToken':_0x3b98f8['params'][a5_0x4ffd('0x3f')]})[a5_0x4ffd('0x40')](a5_0x4ffd('0x41'))['gt'](Date[a5_0x4ffd('0x42')]())[a5_0x4ffd('0x43')]((_0x5b622c,_0xa2c4c0)=>{if(_0x5b622c){return _0x292b44(_0x5b622c);}if(!_0xa2c4c0){_0x3b98f8[a5_0x4ffd('0x12')]('errors',{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0xcd430[a5_0x4ffd('0x6')](a5_0x4ffd('0x44'));}_0xcd430[a5_0x4ffd('0x7')]('account/reset',{'title':a5_0x4ffd('0x45')});});};exports[a5_0x4ffd('0x46')]=(_0x2a2a71,_0x29a453,_0x5aa0b4)=>{_0x2a2a71[a5_0x4ffd('0x9')](a5_0x4ffd('0xd'),a5_0x4ffd('0x47'))[a5_0x4ffd('0x20')]({'min':0x4});_0x2a2a71[a5_0x4ffd('0x9')](a5_0x4ffd('0x48'),a5_0x4ffd('0x49'))[a5_0x4ffd('0x4a')](_0x2a2a71[a5_0x4ffd('0x23')][a5_0x4ffd('0xd')]);const _0x4f2b54=_0x2a2a71[a5_0x4ffd('0x11')]();if(_0x4f2b54){_0x2a2a71['flash']('errors',_0x4f2b54);return _0x29a453[a5_0x4ffd('0x6')]('back');}async_1['default'][a5_0x4ffd('0x4b')]([function resetPassword(_0x7c280e){User_1[a5_0x4ffd('0x15')][a5_0x4ffd('0x4c')]({'passwordResetToken':_0x2a2a71[a5_0x4ffd('0x4d')][a5_0x4ffd('0x3f')]})[a5_0x4ffd('0x40')](a5_0x4ffd('0x41'))['gt'](Date[a5_0x4ffd('0x42')]())[a5_0x4ffd('0x43')]((_0x40c333,_0x5852bd)=>{if(_0x40c333){return _0x5aa0b4(_0x40c333);}if(!_0x5852bd){_0x2a2a71['flash']('errors',{'msg':a5_0x4ffd('0x4e')});return _0x29a453[a5_0x4ffd('0x6')](a5_0x4ffd('0x4f'));}_0x5852bd['password']=_0x2a2a71['body'][a5_0x4ffd('0xd')];_0x5852bd[a5_0x4ffd('0x50')]=undefined;_0x5852bd[a5_0x4ffd('0x41')]=undefined;_0x5852bd[a5_0x4ffd('0x30')](_0x40c333=>{if(_0x40c333){return _0x5aa0b4(_0x40c333);}_0x2a2a71['logIn'](_0x5852bd,_0x40c333=>{_0x7c280e(_0x40c333,_0x5852bd);});});});},function sendResetPasswordEmail(_0x3c4c7b,_0x6a3e8d){const _0x26e9a9=nodemailer_1[a5_0x4ffd('0x15')][a5_0x4ffd('0x51')]({'service':a5_0x4ffd('0x52'),'auth':{'user':process[a5_0x4ffd('0x53')][a5_0x4ffd('0x54')],'pass':process[a5_0x4ffd('0x53')]['SENDGRID_PASSWORD']}});const _0x33538a={'to':_0x3c4c7b[a5_0x4ffd('0xa')],'from':a5_0x4ffd('0x55'),'subject':a5_0x4ffd('0x56'),'text':a5_0x4ffd('0x57')+_0x3c4c7b[a5_0x4ffd('0xa')]+'\x20has\x20just\x20been\x20changed.\x0a'};_0x26e9a9['sendMail'](_0x33538a,_0x1070f6=>{_0x2a2a71[a5_0x4ffd('0x12')]('success',{'msg':'Success!\x20Your\x20password\x20has\x20been\x20changed.'});_0x6a3e8d(_0x1070f6);});}],_0x4f14e0=>{if(_0x4f14e0){return _0x5aa0b4(_0x4f14e0);}_0x29a453['redirect']('/');});};exports[a5_0x4ffd('0x58')]=(_0x3ba510,_0x5467ad)=>{if(_0x3ba510[a5_0x4ffd('0x3e')]()){return _0x5467ad[a5_0x4ffd('0x6')]('/');}_0x5467ad[a5_0x4ffd('0x7')]('account/forgot',{'title':'Forgot\x20Password'});};exports[a5_0x4ffd('0x59')]=(_0x422e46,_0x222ed6,_0x278b7a)=>{_0x422e46[a5_0x4ffd('0x9')](a5_0x4ffd('0xa'),a5_0x4ffd('0x5a'))['isEmail']();_0x422e46[a5_0x4ffd('0x10')](a5_0x4ffd('0xa'))[a5_0x4ffd('0x24')]({'gmail_remove_dots':![]});const _0xe1074b=_0x422e46[a5_0x4ffd('0x11')]();if(_0xe1074b){_0x422e46[a5_0x4ffd('0x12')]('errors',_0xe1074b);return _0x222ed6[a5_0x4ffd('0x6')](a5_0x4ffd('0x44'));}async_1[a5_0x4ffd('0x15')][a5_0x4ffd('0x4b')]([function createRandomToken(_0x2d9ef2){crypto_1[a5_0x4ffd('0x15')]['randomBytes'](0x10,(_0x47eb92,_0x129473)=>{const _0x2b0df0=_0x129473[a5_0x4ffd('0x5b')](a5_0x4ffd('0x5c'));_0x2d9ef2(_0x47eb92,_0x2b0df0);});},function setRandomToken(_0x3ae5c6,_0x2af149){User_1['default']['findOne']({'email':_0x422e46[a5_0x4ffd('0x23')]['email']},(_0x18832c,_0x518568)=>{if(_0x18832c){return _0x2af149(_0x18832c);}if(!_0x518568){_0x422e46[a5_0x4ffd('0x12')](a5_0x4ffd('0x13'),{'msg':a5_0x4ffd('0x5d')});return _0x222ed6[a5_0x4ffd('0x6')]('/forgot');}_0x518568[a5_0x4ffd('0x50')]=_0x3ae5c6;_0x518568['passwordResetExpires']=Date[a5_0x4ffd('0x42')]()+0x36ee80;_0x518568[a5_0x4ffd('0x30')](_0x18832c=>{_0x2af149(_0x18832c,_0x3ae5c6,_0x518568);});});},function sendForgotPasswordEmail(_0x155c4f,_0x16dcac,_0x26a2cf){const _0xcea67a=nodemailer_1[a5_0x4ffd('0x15')]['createTransport']({'service':a5_0x4ffd('0x52'),'auth':{'user':process[a5_0x4ffd('0x53')][a5_0x4ffd('0x54')],'pass':process[a5_0x4ffd('0x53')][a5_0x4ffd('0x5e')]}});const _0x1fb9d2={'to':_0x16dcac[a5_0x4ffd('0xa')],'from':a5_0x4ffd('0x5f'),'subject':a5_0x4ffd('0x60'),'text':a5_0x4ffd('0x61')+_0x422e46[a5_0x4ffd('0x62')][a5_0x4ffd('0x63')]+a5_0x4ffd('0x64')+_0x155c4f+a5_0x4ffd('0x65')};_0xcea67a[a5_0x4ffd('0x66')](_0x1fb9d2,_0x34abc8=>{_0x422e46[a5_0x4ffd('0x12')](a5_0x4ffd('0x38'),{'msg':'An\x20e-mail\x20has\x20been\x20sent\x20to\x20'+_0x16dcac[a5_0x4ffd('0xa')]+'\x20with\x20further\x20instructions.'});_0x26a2cf(_0x34abc8);});}],_0x4c6dc1=>{if(_0x4c6dc1){return _0x278b7a(_0x4c6dc1);}_0x222ed6[a5_0x4ffd('0x6')](a5_0x4ffd('0x44'));});};
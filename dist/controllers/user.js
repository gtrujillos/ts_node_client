var a5_0x2b14=['confirmPassword','Passwords\x20do\x20not\x20match','errors','/signup','body','findOne','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','save','getAccount','Account\x20Management','postUpdateProfile','Please\x20enter\x20a\x20valid\x20email\x20address.','/account','findById','profile','name','gender','location','website','code','Profile\x20information\x20has\x20been\x20updated.','postUpdatePassword','Password\x20has\x20been\x20changed.','remove','info','Your\x20account\x20has\x20been\x20deleted.','getOauthUnlink','params','provider','tokens','filter','\x20account\x20has\x20been\x20unlinked.','getReset','isAuthenticated','token','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','/forgot','account/reset','Password\x20Reset','postReset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','confirm','Passwords\x20must\x20match.','back','waterfall','passwordResetExpires','now','exec','SendGrid','env','SENDGRID_USER','SENDGRID_PASSWORD','express-ts@starter.com','Your\x20password\x20has\x20been\x20changed','Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20','\x20has\x20just\x20been\x20changed.\x0a','Success!\x20Your\x20password\x20has\x20been\x20changed.','getForgot','account/forgot','Forgot\x20Password','randomBytes','toString','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','passwordResetToken','createTransport','hackathon@starter.com','/reset/','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','sendMail','An\x20e-mail\x20has\x20been\x20sent\x20to\x20','\x20with\x20further\x20instructions.','__importDefault','__esModule','async','nodemailer','passport','express-validator','getLogin','user','render','account/login','Login','postLogin','assert','Email\x20is\x20not\x20valid','isEmail','password','Password\x20cannot\x20be\x20blank','sanitize','email','normalizeEmail','validationErrors','flash','/login','default','local','message','redirect','logIn','success','Success!\x20You\x20are\x20logged\x20in.','session','logout','getSignup','Create\x20Account','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','len'];(function(_0x5f21c9,_0x582d4b){var _0x2135ea=function(_0x3febc6){while(--_0x3febc6){_0x5f21c9['push'](_0x5f21c9['shift']());}};_0x2135ea(++_0x582d4b);}(a5_0x2b14,0x1f3));var a5_0x56ef=function(_0x2699a9,_0x501e82){_0x2699a9=_0x2699a9-0x0;var _0x5b6c40=a5_0x2b14[_0x2699a9];return _0x5b6c40;};'use strict';var __importDefault=this&&this[a5_0x56ef('0x0')]||function(_0x291f89){return _0x291f89&&_0x291f89['__esModule']?_0x291f89:{'default':_0x291f89};};Object['defineProperty'](exports,a5_0x56ef('0x1'),{'value':!![]});const async_1=__importDefault(require(a5_0x56ef('0x2')));const crypto_1=__importDefault(require('crypto'));const nodemailer_1=__importDefault(require(a5_0x56ef('0x3')));const passport_1=__importDefault(require(a5_0x56ef('0x4')));const User_1=__importDefault(require('../models/User'));const request=require(a5_0x56ef('0x5'));exports[a5_0x56ef('0x6')]=(_0x57f70c,_0x40cc2f)=>{if(_0x57f70c[a5_0x56ef('0x7')]){return _0x40cc2f['redirect']('/');}_0x40cc2f[a5_0x56ef('0x8')](a5_0x56ef('0x9'),{'title':a5_0x56ef('0xa')});};exports[a5_0x56ef('0xb')]=(_0x3e54e7,_0xc1537c,_0x312f8f)=>{_0x3e54e7[a5_0x56ef('0xc')]('email',a5_0x56ef('0xd'))[a5_0x56ef('0xe')]();_0x3e54e7[a5_0x56ef('0xc')](a5_0x56ef('0xf'),a5_0x56ef('0x10'))['notEmpty']();_0x3e54e7[a5_0x56ef('0x11')](a5_0x56ef('0x12'))[a5_0x56ef('0x13')]({'gmail_remove_dots':![]});const _0x364113=_0x3e54e7[a5_0x56ef('0x14')]();if(_0x364113){_0x3e54e7[a5_0x56ef('0x15')]('errors',_0x364113);return _0xc1537c['redirect'](a5_0x56ef('0x16'));}passport_1[a5_0x56ef('0x17')]['authenticate'](a5_0x56ef('0x18'),(_0x25dbfc,_0xa84d00,_0x271049)=>{if(_0x25dbfc){return _0x312f8f(_0x25dbfc);}if(!_0xa84d00){_0x3e54e7[a5_0x56ef('0x15')]('errors',_0x271049[a5_0x56ef('0x19')]);return _0xc1537c[a5_0x56ef('0x1a')](a5_0x56ef('0x16'));}_0x3e54e7[a5_0x56ef('0x1b')](_0xa84d00,_0x25dbfc=>{if(_0x25dbfc){return _0x312f8f(_0x25dbfc);}_0x3e54e7[a5_0x56ef('0x15')](a5_0x56ef('0x1c'),{'msg':a5_0x56ef('0x1d')});_0xc1537c[a5_0x56ef('0x1a')](_0x3e54e7[a5_0x56ef('0x1e')]['returnTo']||'/');});})(_0x3e54e7,_0xc1537c,_0x312f8f);};exports[a5_0x56ef('0x1f')]=(_0x4e90b8,_0x2a9c4b)=>{_0x4e90b8[a5_0x56ef('0x1f')]();_0x2a9c4b[a5_0x56ef('0x1a')]('/');};exports[a5_0x56ef('0x20')]=(_0x495d8c,_0x5e5537)=>{if(_0x495d8c[a5_0x56ef('0x7')]){return _0x5e5537[a5_0x56ef('0x1a')]('/');}_0x5e5537[a5_0x56ef('0x8')]('account/signup',{'title':a5_0x56ef('0x21')});};exports['postSignup']=(_0x35c4b9,_0x1d45fd,_0x572238)=>{_0x35c4b9[a5_0x56ef('0xc')]('email',a5_0x56ef('0xd'))['isEmail']();_0x35c4b9['assert'](a5_0x56ef('0xf'),a5_0x56ef('0x22'))[a5_0x56ef('0x23')]({'min':0x4});_0x35c4b9[a5_0x56ef('0xc')](a5_0x56ef('0x24'),a5_0x56ef('0x25'))['equals'](_0x35c4b9['body'][a5_0x56ef('0xf')]);_0x35c4b9[a5_0x56ef('0x11')](a5_0x56ef('0x12'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x1a2cc6=_0x35c4b9[a5_0x56ef('0x14')]();if(_0x1a2cc6){_0x35c4b9['flash'](a5_0x56ef('0x26'),_0x1a2cc6);return _0x1d45fd[a5_0x56ef('0x1a')](a5_0x56ef('0x27'));}const _0x5876ad=new User_1['default']({'email':_0x35c4b9[a5_0x56ef('0x28')][a5_0x56ef('0x12')],'password':_0x35c4b9[a5_0x56ef('0x28')]['password']});User_1[a5_0x56ef('0x17')][a5_0x56ef('0x29')]({'email':_0x35c4b9[a5_0x56ef('0x28')][a5_0x56ef('0x12')]},(_0x407194,_0x2f03e6)=>{if(_0x407194){return _0x572238(_0x407194);}if(_0x2f03e6){_0x35c4b9[a5_0x56ef('0x15')]('errors',{'msg':a5_0x56ef('0x2a')});return _0x1d45fd[a5_0x56ef('0x1a')](a5_0x56ef('0x27'));}_0x5876ad[a5_0x56ef('0x2b')](_0x407194=>{if(_0x407194){return _0x572238(_0x407194);}_0x35c4b9[a5_0x56ef('0x1b')](_0x5876ad,_0x407194=>{if(_0x407194){return _0x572238(_0x407194);}_0x1d45fd[a5_0x56ef('0x1a')]('/');});});});};exports[a5_0x56ef('0x2c')]=(_0x35344b,_0x3438b3)=>{_0x3438b3[a5_0x56ef('0x8')]('account/profile',{'title':a5_0x56ef('0x2d')});};exports[a5_0x56ef('0x2e')]=(_0x413064,_0xe1e746,_0x184134)=>{_0x413064['assert']('email',a5_0x56ef('0x2f'))[a5_0x56ef('0xe')]();_0x413064[a5_0x56ef('0x11')](a5_0x56ef('0x12'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x4c89fa=_0x413064[a5_0x56ef('0x14')]();if(_0x4c89fa){_0x413064[a5_0x56ef('0x15')](a5_0x56ef('0x26'),_0x4c89fa);return _0xe1e746['redirect'](a5_0x56ef('0x30'));}User_1[a5_0x56ef('0x17')][a5_0x56ef('0x31')](_0x413064[a5_0x56ef('0x7')]['id'],(_0xf5155c,_0x56d4d7)=>{if(_0xf5155c){return _0x184134(_0xf5155c);}_0x56d4d7['email']=_0x413064[a5_0x56ef('0x28')][a5_0x56ef('0x12')]||'';_0x56d4d7[a5_0x56ef('0x32')][a5_0x56ef('0x33')]=_0x413064[a5_0x56ef('0x28')][a5_0x56ef('0x33')]||'';_0x56d4d7['profile'][a5_0x56ef('0x34')]=_0x413064[a5_0x56ef('0x28')]['gender']||'';_0x56d4d7[a5_0x56ef('0x32')][a5_0x56ef('0x35')]=_0x413064[a5_0x56ef('0x28')][a5_0x56ef('0x35')]||'';_0x56d4d7['profile']['website']=_0x413064['body'][a5_0x56ef('0x36')]||'';_0x56d4d7[a5_0x56ef('0x2b')](_0xf5155c=>{if(_0xf5155c){if(_0xf5155c[a5_0x56ef('0x37')]===0x2af8){_0x413064['flash'](a5_0x56ef('0x26'),{'msg':'The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.'});return _0xe1e746[a5_0x56ef('0x1a')](a5_0x56ef('0x30'));}return _0x184134(_0xf5155c);}_0x413064[a5_0x56ef('0x15')](a5_0x56ef('0x1c'),{'msg':a5_0x56ef('0x38')});_0xe1e746[a5_0x56ef('0x1a')]('/account');});});};exports[a5_0x56ef('0x39')]=(_0xf32118,_0x4a15dd,_0x1f0dc6)=>{_0xf32118[a5_0x56ef('0xc')](a5_0x56ef('0xf'),a5_0x56ef('0x22'))[a5_0x56ef('0x23')]({'min':0x4});_0xf32118[a5_0x56ef('0xc')]('confirmPassword',a5_0x56ef('0x25'))['equals'](_0xf32118[a5_0x56ef('0x28')][a5_0x56ef('0xf')]);const _0x31a6a1=_0xf32118[a5_0x56ef('0x14')]();if(_0x31a6a1){_0xf32118[a5_0x56ef('0x15')]('errors',_0x31a6a1);return _0x4a15dd['redirect'](a5_0x56ef('0x30'));}User_1[a5_0x56ef('0x17')]['findById'](_0xf32118['user']['id'],(_0x382dea,_0x5c8269)=>{if(_0x382dea){return _0x1f0dc6(_0x382dea);}_0x5c8269[a5_0x56ef('0xf')]=_0xf32118[a5_0x56ef('0x28')]['password'];_0x5c8269['save'](_0x382dea=>{if(_0x382dea){return _0x1f0dc6(_0x382dea);}_0xf32118[a5_0x56ef('0x15')]('success',{'msg':a5_0x56ef('0x3a')});_0x4a15dd[a5_0x56ef('0x1a')](a5_0x56ef('0x30'));});});};exports['postDeleteAccount']=(_0x42e2ee,_0x4c1f55,_0x538d36)=>{User_1['default'][a5_0x56ef('0x3b')]({'_id':_0x42e2ee[a5_0x56ef('0x7')]['id']},_0x1dcf5d=>{if(_0x1dcf5d){return _0x538d36(_0x1dcf5d);}_0x42e2ee['logout']();_0x42e2ee[a5_0x56ef('0x15')](a5_0x56ef('0x3c'),{'msg':a5_0x56ef('0x3d')});_0x4c1f55[a5_0x56ef('0x1a')]('/');});};exports[a5_0x56ef('0x3e')]=(_0x4b746f,_0x2f82d6,_0x2eb1cd)=>{const _0x240734=_0x4b746f[a5_0x56ef('0x3f')][a5_0x56ef('0x40')];User_1['default'][a5_0x56ef('0x31')](_0x4b746f[a5_0x56ef('0x7')]['id'],(_0x492658,_0x3a74b0)=>{if(_0x492658){return _0x2eb1cd(_0x492658);}_0x3a74b0[_0x240734]=undefined;_0x3a74b0['tokens']=_0x3a74b0[a5_0x56ef('0x41')][a5_0x56ef('0x42')](_0x57446c=>_0x57446c['kind']!==_0x240734);_0x3a74b0[a5_0x56ef('0x2b')](_0x492658=>{if(_0x492658){return _0x2eb1cd(_0x492658);}_0x4b746f[a5_0x56ef('0x15')](a5_0x56ef('0x3c'),{'msg':_0x240734+a5_0x56ef('0x43')});_0x2f82d6[a5_0x56ef('0x1a')](a5_0x56ef('0x30'));});});};exports[a5_0x56ef('0x44')]=(_0x350036,_0x45893b,_0x42fae4)=>{if(_0x350036[a5_0x56ef('0x45')]()){return _0x45893b[a5_0x56ef('0x1a')]('/');}User_1[a5_0x56ef('0x17')][a5_0x56ef('0x29')]({'passwordResetToken':_0x350036[a5_0x56ef('0x3f')][a5_0x56ef('0x46')]})['where']('passwordResetExpires')['gt'](Date['now']())['exec']((_0x41bc61,_0x434dfc)=>{if(_0x41bc61){return _0x42fae4(_0x41bc61);}if(!_0x434dfc){_0x350036[a5_0x56ef('0x15')](a5_0x56ef('0x26'),{'msg':a5_0x56ef('0x47')});return _0x45893b[a5_0x56ef('0x1a')](a5_0x56ef('0x48'));}_0x45893b['render'](a5_0x56ef('0x49'),{'title':a5_0x56ef('0x4a')});});};exports[a5_0x56ef('0x4b')]=(_0x51e656,_0x1219dc,_0x223d4e)=>{_0x51e656[a5_0x56ef('0xc')]('password',a5_0x56ef('0x4c'))[a5_0x56ef('0x23')]({'min':0x4});_0x51e656['assert'](a5_0x56ef('0x4d'),a5_0x56ef('0x4e'))['equals'](_0x51e656['body'][a5_0x56ef('0xf')]);const _0x1d70e2=_0x51e656['validationErrors']();if(_0x1d70e2){_0x51e656[a5_0x56ef('0x15')](a5_0x56ef('0x26'),_0x1d70e2);return _0x1219dc[a5_0x56ef('0x1a')](a5_0x56ef('0x4f'));}async_1[a5_0x56ef('0x17')][a5_0x56ef('0x50')]([function resetPassword(_0x5a36d5){User_1[a5_0x56ef('0x17')]['findOne']({'passwordResetToken':_0x51e656[a5_0x56ef('0x3f')][a5_0x56ef('0x46')]})['where'](a5_0x56ef('0x51'))['gt'](Date[a5_0x56ef('0x52')]())[a5_0x56ef('0x53')]((_0x1d2e2c,_0x3ce985)=>{if(_0x1d2e2c){return _0x223d4e(_0x1d2e2c);}if(!_0x3ce985){_0x51e656[a5_0x56ef('0x15')](a5_0x56ef('0x26'),{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x1219dc[a5_0x56ef('0x1a')](a5_0x56ef('0x4f'));}_0x3ce985[a5_0x56ef('0xf')]=_0x51e656[a5_0x56ef('0x28')][a5_0x56ef('0xf')];_0x3ce985['passwordResetToken']=undefined;_0x3ce985[a5_0x56ef('0x51')]=undefined;_0x3ce985[a5_0x56ef('0x2b')](_0x1d2e2c=>{if(_0x1d2e2c){return _0x223d4e(_0x1d2e2c);}_0x51e656['logIn'](_0x3ce985,_0x1d2e2c=>{_0x5a36d5(_0x1d2e2c,_0x3ce985);});});});},function sendResetPasswordEmail(_0x5da6d3,_0x2cba76){const _0x4f5043=nodemailer_1[a5_0x56ef('0x17')]['createTransport']({'service':a5_0x56ef('0x54'),'auth':{'user':process[a5_0x56ef('0x55')][a5_0x56ef('0x56')],'pass':process['env'][a5_0x56ef('0x57')]}});const _0x2ba43d={'to':_0x5da6d3[a5_0x56ef('0x12')],'from':a5_0x56ef('0x58'),'subject':a5_0x56ef('0x59'),'text':a5_0x56ef('0x5a')+_0x5da6d3['email']+a5_0x56ef('0x5b')};_0x4f5043['sendMail'](_0x2ba43d,_0x1cdaa3=>{_0x51e656[a5_0x56ef('0x15')](a5_0x56ef('0x1c'),{'msg':a5_0x56ef('0x5c')});_0x2cba76(_0x1cdaa3);});}],_0x2f4b97=>{if(_0x2f4b97){return _0x223d4e(_0x2f4b97);}_0x1219dc[a5_0x56ef('0x1a')]('/');});};exports[a5_0x56ef('0x5d')]=(_0x4d15e3,_0x8dd29c)=>{if(_0x4d15e3[a5_0x56ef('0x45')]()){return _0x8dd29c[a5_0x56ef('0x1a')]('/');}_0x8dd29c[a5_0x56ef('0x8')](a5_0x56ef('0x5e'),{'title':a5_0x56ef('0x5f')});};exports['postForgot']=(_0x467219,_0x24c5d5,_0x57d08c)=>{_0x467219[a5_0x56ef('0xc')]('email','Please\x20enter\x20a\x20valid\x20email\x20address.')[a5_0x56ef('0xe')]();_0x467219[a5_0x56ef('0x11')](a5_0x56ef('0x12'))[a5_0x56ef('0x13')]({'gmail_remove_dots':![]});const _0x301c79=_0x467219['validationErrors']();if(_0x301c79){_0x467219[a5_0x56ef('0x15')]('errors',_0x301c79);return _0x24c5d5['redirect'](a5_0x56ef('0x48'));}async_1['default']['waterfall']([function createRandomToken(_0x5b7f58){crypto_1[a5_0x56ef('0x17')][a5_0x56ef('0x60')](0x10,(_0x47ff61,_0x4c695e)=>{const _0x27d9af=_0x4c695e[a5_0x56ef('0x61')]('hex');_0x5b7f58(_0x47ff61,_0x27d9af);});},function setRandomToken(_0x491426,_0xa94830){User_1['default'][a5_0x56ef('0x29')]({'email':_0x467219['body'][a5_0x56ef('0x12')]},(_0x340ad1,_0x140b32)=>{if(_0x340ad1){return _0xa94830(_0x340ad1);}if(!_0x140b32){_0x467219[a5_0x56ef('0x15')](a5_0x56ef('0x26'),{'msg':a5_0x56ef('0x62')});return _0x24c5d5['redirect'](a5_0x56ef('0x48'));}_0x140b32[a5_0x56ef('0x63')]=_0x491426;_0x140b32['passwordResetExpires']=Date['now']()+0x36ee80;_0x140b32[a5_0x56ef('0x2b')](_0x340ad1=>{_0xa94830(_0x340ad1,_0x491426,_0x140b32);});});},function sendForgotPasswordEmail(_0xd872a2,_0x400ad4,_0x3dcaa3){const _0x5c909a=nodemailer_1['default'][a5_0x56ef('0x64')]({'service':'SendGrid','auth':{'user':process[a5_0x56ef('0x55')]['SENDGRID_USER'],'pass':process[a5_0x56ef('0x55')]['SENDGRID_PASSWORD']}});const _0x4dcaba={'to':_0x400ad4['email'],'from':a5_0x56ef('0x65'),'subject':'Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','text':'You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://'+_0x467219['headers']['host']+a5_0x56ef('0x66')+_0xd872a2+a5_0x56ef('0x67')};_0x5c909a[a5_0x56ef('0x68')](_0x4dcaba,_0x1bca57=>{_0x467219[a5_0x56ef('0x15')](a5_0x56ef('0x3c'),{'msg':a5_0x56ef('0x69')+_0x400ad4[a5_0x56ef('0x12')]+a5_0x56ef('0x6a')});_0x3dcaa3(_0x1bca57);});}],_0x222be4=>{if(_0x222be4){return _0x57d08c(_0x222be4);}_0x24c5d5[a5_0x56ef('0x1a')](a5_0x56ef('0x48'));});};
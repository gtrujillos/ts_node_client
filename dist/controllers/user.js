var a5_0x38da=['/reset/','sendMail','An\x20e-mail\x20has\x20been\x20sent\x20to\x20','__importDefault','__esModule','defineProperty','crypto','nodemailer','passport','express-validator','getLogin','user','redirect','render','account/login','Login','postLogin','assert','email','Email\x20is\x20not\x20valid','Password\x20cannot\x20be\x20blank','sanitize','normalizeEmail','flash','errors','/login','default','authenticate','local','message','logIn','success','Success!\x20You\x20are\x20logged\x20in.','logout','Create\x20Account','postSignup','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','confirmPassword','Passwords\x20do\x20not\x20match','equals','body','password','validationErrors','/signup','findOne','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','save','getAccount','account/profile','Account\x20Management','postUpdateProfile','Please\x20enter\x20a\x20valid\x20email\x20address.','isEmail','/account','findById','name','profile','gender','location','website','code','The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.','Profile\x20information\x20has\x20been\x20updated.','postUpdatePassword','postDeleteAccount','remove','info','Your\x20account\x20has\x20been\x20deleted.','getOauthUnlink','params','tokens','kind','\x20account\x20has\x20been\x20unlinked.','getReset','isAuthenticated','token','where','passwordResetExpires','now','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','account/reset','Password\x20Reset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','len','confirm','exec','passwordResetToken','createTransport','SENDGRID_USER','env','SENDGRID_PASSWORD','express-ts@starter.com','Your\x20password\x20has\x20been\x20changed','Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20','\x20has\x20just\x20been\x20changed.\x0a','Success!\x20Your\x20password\x20has\x20been\x20changed.','getForgot','account/forgot','Forgot\x20Password','postForgot','/forgot','waterfall','randomBytes','hex','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','host'];(function(_0x3fcbd6,_0x495f09){var _0x17e38a=function(_0x39aba0){while(--_0x39aba0){_0x3fcbd6['push'](_0x3fcbd6['shift']());}};_0x17e38a(++_0x495f09);}(a5_0x38da,0x141));var a5_0x4dfe=function(_0x3babb8,_0x5ef1d7){_0x3babb8=_0x3babb8-0x0;var _0x5d39de=a5_0x38da[_0x3babb8];return _0x5d39de;};'use strict';var __importDefault=this&&this[a5_0x4dfe('0x0')]||function(_0x30206e){return _0x30206e&&_0x30206e[a5_0x4dfe('0x1')]?_0x30206e:{'default':_0x30206e};};Object[a5_0x4dfe('0x2')](exports,'__esModule',{'value':!![]});const async_1=__importDefault(require('async'));const crypto_1=__importDefault(require(a5_0x4dfe('0x3')));const nodemailer_1=__importDefault(require(a5_0x4dfe('0x4')));const passport_1=__importDefault(require(a5_0x4dfe('0x5')));const User_1=__importDefault(require('../models/User'));const request=require(a5_0x4dfe('0x6'));exports[a5_0x4dfe('0x7')]=(_0x42b6e2,_0x5e9794)=>{if(_0x42b6e2[a5_0x4dfe('0x8')]){return _0x5e9794[a5_0x4dfe('0x9')]('/');}_0x5e9794[a5_0x4dfe('0xa')](a5_0x4dfe('0xb'),{'title':a5_0x4dfe('0xc')});};exports[a5_0x4dfe('0xd')]=(_0x2c1d6e,_0x558038,_0x3781f3)=>{_0x2c1d6e[a5_0x4dfe('0xe')](a5_0x4dfe('0xf'),a5_0x4dfe('0x10'))['isEmail']();_0x2c1d6e[a5_0x4dfe('0xe')]('password',a5_0x4dfe('0x11'))['notEmpty']();_0x2c1d6e[a5_0x4dfe('0x12')](a5_0x4dfe('0xf'))[a5_0x4dfe('0x13')]({'gmail_remove_dots':![]});const _0x392f1e=_0x2c1d6e['validationErrors']();if(_0x392f1e){_0x2c1d6e[a5_0x4dfe('0x14')](a5_0x4dfe('0x15'),_0x392f1e);return _0x558038[a5_0x4dfe('0x9')](a5_0x4dfe('0x16'));}passport_1[a5_0x4dfe('0x17')][a5_0x4dfe('0x18')](a5_0x4dfe('0x19'),(_0x5a171f,_0x13d285,_0x82727f)=>{if(_0x5a171f){return _0x3781f3(_0x5a171f);}if(!_0x13d285){_0x2c1d6e[a5_0x4dfe('0x14')]('errors',_0x82727f[a5_0x4dfe('0x1a')]);return _0x558038['redirect'](a5_0x4dfe('0x16'));}_0x2c1d6e[a5_0x4dfe('0x1b')](_0x13d285,_0x5a171f=>{if(_0x5a171f){return _0x3781f3(_0x5a171f);}_0x2c1d6e[a5_0x4dfe('0x14')](a5_0x4dfe('0x1c'),{'msg':a5_0x4dfe('0x1d')});_0x558038[a5_0x4dfe('0x9')](_0x2c1d6e['session']['returnTo']||'/');});})(_0x2c1d6e,_0x558038,_0x3781f3);};exports[a5_0x4dfe('0x1e')]=(_0x34be39,_0x36af74)=>{_0x34be39[a5_0x4dfe('0x1e')]();_0x36af74['redirect']('/');};exports['getSignup']=(_0x10c80b,_0x3b2701)=>{if(_0x10c80b[a5_0x4dfe('0x8')]){return _0x3b2701[a5_0x4dfe('0x9')]('/');}_0x3b2701[a5_0x4dfe('0xa')]('account/signup',{'title':a5_0x4dfe('0x1f')});};exports[a5_0x4dfe('0x20')]=(_0x2bedae,_0x33c62c,_0x12f3ec)=>{_0x2bedae[a5_0x4dfe('0xe')](a5_0x4dfe('0xf'),'Email\x20is\x20not\x20valid')['isEmail']();_0x2bedae['assert']('password',a5_0x4dfe('0x21'))['len']({'min':0x4});_0x2bedae[a5_0x4dfe('0xe')](a5_0x4dfe('0x22'),a5_0x4dfe('0x23'))[a5_0x4dfe('0x24')](_0x2bedae[a5_0x4dfe('0x25')][a5_0x4dfe('0x26')]);_0x2bedae[a5_0x4dfe('0x12')](a5_0x4dfe('0xf'))[a5_0x4dfe('0x13')]({'gmail_remove_dots':![]});const _0x5ea2b2=_0x2bedae[a5_0x4dfe('0x27')]();if(_0x5ea2b2){_0x2bedae[a5_0x4dfe('0x14')](a5_0x4dfe('0x15'),_0x5ea2b2);return _0x33c62c[a5_0x4dfe('0x9')](a5_0x4dfe('0x28'));}const _0x778c29=new User_1[(a5_0x4dfe('0x17'))]({});User_1['default'][a5_0x4dfe('0x29')]({'email':_0x2bedae[a5_0x4dfe('0x25')]['email']},(_0x4263a1,_0x320253)=>{if(_0x4263a1){return _0x12f3ec(_0x4263a1);}if(_0x320253){_0x2bedae[a5_0x4dfe('0x14')](a5_0x4dfe('0x15'),{'msg':a5_0x4dfe('0x2a')});return _0x33c62c['redirect'](a5_0x4dfe('0x28'));}_0x778c29[a5_0x4dfe('0x2b')](_0x4263a1=>{if(_0x4263a1){return _0x12f3ec(_0x4263a1);}_0x2bedae['logIn'](_0x778c29,_0x4263a1=>{if(_0x4263a1){return _0x12f3ec(_0x4263a1);}_0x33c62c[a5_0x4dfe('0x9')]('/');});});});};exports[a5_0x4dfe('0x2c')]=(_0x17bce6,_0x367f80)=>{_0x367f80[a5_0x4dfe('0xa')](a5_0x4dfe('0x2d'),{'title':a5_0x4dfe('0x2e')});};exports[a5_0x4dfe('0x2f')]=(_0x239161,_0x5a44d4,_0x22ba41)=>{_0x239161[a5_0x4dfe('0xe')](a5_0x4dfe('0xf'),a5_0x4dfe('0x30'))[a5_0x4dfe('0x31')]();_0x239161[a5_0x4dfe('0x12')](a5_0x4dfe('0xf'))[a5_0x4dfe('0x13')]({'gmail_remove_dots':![]});const _0x2cd3fd=_0x239161[a5_0x4dfe('0x27')]();if(_0x2cd3fd){_0x239161[a5_0x4dfe('0x14')](a5_0x4dfe('0x15'),_0x2cd3fd);return _0x5a44d4[a5_0x4dfe('0x9')](a5_0x4dfe('0x32'));}User_1['default'][a5_0x4dfe('0x33')](_0x239161[a5_0x4dfe('0x8')]['id'],(_0x12df06,_0x5edea6)=>{if(_0x12df06){return _0x22ba41(_0x12df06);}_0x5edea6[a5_0x4dfe('0xf')]=_0x239161['body']['email']||'';_0x5edea6['profile'][a5_0x4dfe('0x34')]=_0x239161['body']['name']||'';_0x5edea6[a5_0x4dfe('0x35')][a5_0x4dfe('0x36')]=_0x239161[a5_0x4dfe('0x25')]['gender']||'';_0x5edea6[a5_0x4dfe('0x35')][a5_0x4dfe('0x37')]=_0x239161[a5_0x4dfe('0x25')][a5_0x4dfe('0x37')]||'';_0x5edea6[a5_0x4dfe('0x35')][a5_0x4dfe('0x38')]=_0x239161[a5_0x4dfe('0x25')][a5_0x4dfe('0x38')]||'';_0x5edea6[a5_0x4dfe('0x2b')](_0x12df06=>{if(_0x12df06){if(_0x12df06[a5_0x4dfe('0x39')]===0x2af8){_0x239161[a5_0x4dfe('0x14')](a5_0x4dfe('0x15'),{'msg':a5_0x4dfe('0x3a')});return _0x5a44d4[a5_0x4dfe('0x9')](a5_0x4dfe('0x32'));}return _0x22ba41(_0x12df06);}_0x239161[a5_0x4dfe('0x14')](a5_0x4dfe('0x1c'),{'msg':a5_0x4dfe('0x3b')});_0x5a44d4['redirect']('/account');});});};exports[a5_0x4dfe('0x3c')]=(_0x4fc858,_0x5e8ff6,_0x5321e0)=>{_0x4fc858[a5_0x4dfe('0xe')](a5_0x4dfe('0x26'),a5_0x4dfe('0x21'))['len']({'min':0x4});_0x4fc858[a5_0x4dfe('0xe')](a5_0x4dfe('0x22'),a5_0x4dfe('0x23'))['equals'](_0x4fc858[a5_0x4dfe('0x25')]['password']);const _0x1a3fce=_0x4fc858[a5_0x4dfe('0x27')]();if(_0x1a3fce){_0x4fc858[a5_0x4dfe('0x14')](a5_0x4dfe('0x15'),_0x1a3fce);return _0x5e8ff6[a5_0x4dfe('0x9')](a5_0x4dfe('0x32'));}User_1[a5_0x4dfe('0x17')]['findById'](_0x4fc858[a5_0x4dfe('0x8')]['id'],(_0x5e036e,_0x370045)=>{if(_0x5e036e){return _0x5321e0(_0x5e036e);}_0x370045[a5_0x4dfe('0x26')]=_0x4fc858[a5_0x4dfe('0x25')][a5_0x4dfe('0x26')];_0x370045['save'](_0x5e036e=>{if(_0x5e036e){return _0x5321e0(_0x5e036e);}_0x4fc858[a5_0x4dfe('0x14')]('success',{'msg':'Password\x20has\x20been\x20changed.'});_0x5e8ff6['redirect'](a5_0x4dfe('0x32'));});});};exports[a5_0x4dfe('0x3d')]=(_0x340bce,_0x434487,_0x4a3e63)=>{User_1[a5_0x4dfe('0x17')][a5_0x4dfe('0x3e')]({'_id':_0x340bce[a5_0x4dfe('0x8')]['id']},_0x17793c=>{if(_0x17793c){return _0x4a3e63(_0x17793c);}_0x340bce[a5_0x4dfe('0x1e')]();_0x340bce[a5_0x4dfe('0x14')](a5_0x4dfe('0x3f'),{'msg':a5_0x4dfe('0x40')});_0x434487[a5_0x4dfe('0x9')]('/');});};exports[a5_0x4dfe('0x41')]=(_0x31f907,_0x169c38,_0x4f5b6c)=>{const _0x28e97d=_0x31f907[a5_0x4dfe('0x42')]['provider'];User_1['default'][a5_0x4dfe('0x33')](_0x31f907[a5_0x4dfe('0x8')]['id'],(_0x1a14b2,_0x571504)=>{if(_0x1a14b2){return _0x4f5b6c(_0x1a14b2);}_0x571504[_0x28e97d]=undefined;_0x571504[a5_0x4dfe('0x43')]=_0x571504['tokens']['filter'](_0x2bd316=>_0x2bd316[a5_0x4dfe('0x44')]!==_0x28e97d);_0x571504[a5_0x4dfe('0x2b')](_0x1a14b2=>{if(_0x1a14b2){return _0x4f5b6c(_0x1a14b2);}_0x31f907[a5_0x4dfe('0x14')](a5_0x4dfe('0x3f'),{'msg':_0x28e97d+a5_0x4dfe('0x45')});_0x169c38[a5_0x4dfe('0x9')](a5_0x4dfe('0x32'));});});};exports[a5_0x4dfe('0x46')]=(_0x495cca,_0x4c7470,_0x382075)=>{if(_0x495cca[a5_0x4dfe('0x47')]()){return _0x4c7470['redirect']('/');}User_1['default'][a5_0x4dfe('0x29')]({'passwordResetToken':_0x495cca[a5_0x4dfe('0x42')][a5_0x4dfe('0x48')]})[a5_0x4dfe('0x49')](a5_0x4dfe('0x4a'))['gt'](Date[a5_0x4dfe('0x4b')]())['exec']((_0x28ffa1,_0x5f29d4)=>{if(_0x28ffa1){return _0x382075(_0x28ffa1);}if(!_0x5f29d4){_0x495cca['flash'](a5_0x4dfe('0x15'),{'msg':a5_0x4dfe('0x4c')});return _0x4c7470[a5_0x4dfe('0x9')]('/forgot');}_0x4c7470[a5_0x4dfe('0xa')](a5_0x4dfe('0x4d'),{'title':a5_0x4dfe('0x4e')});});};exports['postReset']=(_0x553a4d,_0x2cd795,_0x42ec99)=>{_0x553a4d[a5_0x4dfe('0xe')](a5_0x4dfe('0x26'),a5_0x4dfe('0x4f'))[a5_0x4dfe('0x50')]({'min':0x4});_0x553a4d[a5_0x4dfe('0xe')](a5_0x4dfe('0x51'),'Passwords\x20must\x20match.')[a5_0x4dfe('0x24')](_0x553a4d['body']['password']);const _0x308332=_0x553a4d['validationErrors']();if(_0x308332){_0x553a4d[a5_0x4dfe('0x14')](a5_0x4dfe('0x15'),_0x308332);return _0x2cd795[a5_0x4dfe('0x9')]('back');}async_1[a5_0x4dfe('0x17')]['waterfall']([function resetPassword(_0x1a19ae){User_1[a5_0x4dfe('0x17')]['findOne']({'passwordResetToken':_0x553a4d[a5_0x4dfe('0x42')]['token']})[a5_0x4dfe('0x49')](a5_0x4dfe('0x4a'))['gt'](Date[a5_0x4dfe('0x4b')]())[a5_0x4dfe('0x52')]((_0x1831b7,_0x47e2bf)=>{if(_0x1831b7){return _0x42ec99(_0x1831b7);}if(!_0x47e2bf){_0x553a4d[a5_0x4dfe('0x14')](a5_0x4dfe('0x15'),{'msg':a5_0x4dfe('0x4c')});return _0x2cd795[a5_0x4dfe('0x9')]('back');}_0x47e2bf[a5_0x4dfe('0x26')]=_0x553a4d['body'][a5_0x4dfe('0x26')];_0x47e2bf[a5_0x4dfe('0x53')]=undefined;_0x47e2bf[a5_0x4dfe('0x4a')]=undefined;_0x47e2bf[a5_0x4dfe('0x2b')](_0x1831b7=>{if(_0x1831b7){return _0x42ec99(_0x1831b7);}_0x553a4d[a5_0x4dfe('0x1b')](_0x47e2bf,_0x1831b7=>{_0x1a19ae(_0x1831b7,_0x47e2bf);});});});},function sendResetPasswordEmail(_0x423e93,_0x3b2dc1){const _0x428b13=nodemailer_1['default'][a5_0x4dfe('0x54')]({'service':'SendGrid','auth':{'user':process['env'][a5_0x4dfe('0x55')],'pass':process[a5_0x4dfe('0x56')][a5_0x4dfe('0x57')]}});const _0x4072e0={'to':_0x423e93[a5_0x4dfe('0xf')],'from':a5_0x4dfe('0x58'),'subject':a5_0x4dfe('0x59'),'text':a5_0x4dfe('0x5a')+_0x423e93[a5_0x4dfe('0xf')]+a5_0x4dfe('0x5b')};_0x428b13['sendMail'](_0x4072e0,_0x3aa5d5=>{_0x553a4d[a5_0x4dfe('0x14')](a5_0x4dfe('0x1c'),{'msg':a5_0x4dfe('0x5c')});_0x3b2dc1(_0x3aa5d5);});}],_0x1f1f3c=>{if(_0x1f1f3c){return _0x42ec99(_0x1f1f3c);}_0x2cd795[a5_0x4dfe('0x9')]('/');});};exports[a5_0x4dfe('0x5d')]=(_0x4646fc,_0x29d2e5)=>{if(_0x4646fc[a5_0x4dfe('0x47')]()){return _0x29d2e5[a5_0x4dfe('0x9')]('/');}_0x29d2e5['render'](a5_0x4dfe('0x5e'),{'title':a5_0x4dfe('0x5f')});};exports[a5_0x4dfe('0x60')]=(_0xa4d8a7,_0x28f620,_0x39f049)=>{_0xa4d8a7['assert'](a5_0x4dfe('0xf'),a5_0x4dfe('0x30'))[a5_0x4dfe('0x31')]();_0xa4d8a7[a5_0x4dfe('0x12')](a5_0x4dfe('0xf'))[a5_0x4dfe('0x13')]({'gmail_remove_dots':![]});const _0x1ff597=_0xa4d8a7[a5_0x4dfe('0x27')]();if(_0x1ff597){_0xa4d8a7['flash'](a5_0x4dfe('0x15'),_0x1ff597);return _0x28f620[a5_0x4dfe('0x9')](a5_0x4dfe('0x61'));}async_1[a5_0x4dfe('0x17')][a5_0x4dfe('0x62')]([function createRandomToken(_0x49eb28){crypto_1[a5_0x4dfe('0x17')][a5_0x4dfe('0x63')](0x10,(_0x493d1d,_0x2a9012)=>{const _0x1d70d6=_0x2a9012['toString'](a5_0x4dfe('0x64'));_0x49eb28(_0x493d1d,_0x1d70d6);});},function setRandomToken(_0x116e41,_0x32d76d){User_1[a5_0x4dfe('0x17')]['findOne']({'email':_0xa4d8a7[a5_0x4dfe('0x25')][a5_0x4dfe('0xf')]},(_0x4a36d2,_0x8217d5)=>{if(_0x4a36d2){return _0x32d76d(_0x4a36d2);}if(!_0x8217d5){_0xa4d8a7['flash'](a5_0x4dfe('0x15'),{'msg':a5_0x4dfe('0x65')});return _0x28f620['redirect'](a5_0x4dfe('0x61'));}_0x8217d5[a5_0x4dfe('0x53')]=_0x116e41;_0x8217d5[a5_0x4dfe('0x4a')]=Date[a5_0x4dfe('0x4b')]()+0x36ee80;_0x8217d5[a5_0x4dfe('0x2b')](_0x4a36d2=>{_0x32d76d(_0x4a36d2,_0x116e41,_0x8217d5);});});},function sendForgotPasswordEmail(_0x9f9f46,_0x2eab04,_0x483978){const _0x58fb67=nodemailer_1[a5_0x4dfe('0x17')][a5_0x4dfe('0x54')]({'service':'SendGrid','auth':{'user':process[a5_0x4dfe('0x56')][a5_0x4dfe('0x55')],'pass':process[a5_0x4dfe('0x56')][a5_0x4dfe('0x57')]}});const _0x2a7aab={'to':_0x2eab04['email'],'from':'hackathon@starter.com','subject':'Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','text':'You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://'+_0xa4d8a7['headers'][a5_0x4dfe('0x66')]+a5_0x4dfe('0x67')+_0x9f9f46+'\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a'};_0x58fb67[a5_0x4dfe('0x68')](_0x2a7aab,_0x10d665=>{_0xa4d8a7[a5_0x4dfe('0x14')](a5_0x4dfe('0x3f'),{'msg':a5_0x4dfe('0x69')+_0x2eab04[a5_0x4dfe('0xf')]+'\x20with\x20further\x20instructions.'});_0x483978(_0x10d665);});}],_0x9c4108=>{if(_0x9c4108){return _0x39f049(_0x9c4108);}_0x28f620[a5_0x4dfe('0x9')](a5_0x4dfe('0x61'));});};
var a5_0x168f=['An\x20e-mail\x20has\x20been\x20sent\x20to\x20','\x20with\x20further\x20instructions.','__importDefault','defineProperty','async','crypto','passport','express-validator','getLogin','user','redirect','render','postLogin','assert','email','Email\x20is\x20not\x20valid','password','Password\x20cannot\x20be\x20blank','notEmpty','sanitize','normalizeEmail','flash','errors','/login','authenticate','local','logIn','Success!\x20You\x20are\x20logged\x20in.','session','returnTo','logout','account/signup','Create\x20Account','postSignup','isEmail','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','len','confirmPassword','Passwords\x20do\x20not\x20match','equals','default','findOne','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','save','getAccount','account/profile','Account\x20Management','postUpdateProfile','Please\x20enter\x20a\x20valid\x20email\x20address.','validationErrors','findById','gender','profile','location','body','website','code','The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.','/account','Profile\x20information\x20has\x20been\x20updated.','postUpdatePassword','success','Password\x20has\x20been\x20changed.','info','Your\x20account\x20has\x20been\x20deleted.','getOauthUnlink','params','filter','getReset','isAuthenticated','passwordResetExpires','now','exec','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','/forgot','account/reset','Password\x20Reset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','Passwords\x20must\x20match.','back','token','where','createTransport','SendGrid','env','SENDGRID_USER','express-ts@starter.com','Your\x20password\x20has\x20been\x20changed','\x20has\x20just\x20been\x20changed.\x0a','sendMail','Success!\x20Your\x20password\x20has\x20been\x20changed.','getForgot','postForgot','hex','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','passwordResetToken','SENDGRID_PASSWORD','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://','/reset/'];(function(_0x31de51,_0x41102c){var _0x166be7=function(_0x4d75e6){while(--_0x4d75e6){_0x31de51['push'](_0x31de51['shift']());}};_0x166be7(++_0x41102c);}(a5_0x168f,0xcc));var a5_0x37e2=function(_0x2e8293,_0x1f0cc1){_0x2e8293=_0x2e8293-0x0;var _0x19463e=a5_0x168f[_0x2e8293];return _0x19463e;};'use strict';var __importDefault=this&&this[a5_0x37e2('0x0')]||function(_0x28ec5c){return _0x28ec5c&&_0x28ec5c['__esModule']?_0x28ec5c:{'default':_0x28ec5c};};Object[a5_0x37e2('0x1')](exports,'__esModule',{'value':!![]});const async_1=__importDefault(require(a5_0x37e2('0x2')));const crypto_1=__importDefault(require(a5_0x37e2('0x3')));const nodemailer_1=__importDefault(require('nodemailer'));const passport_1=__importDefault(require(a5_0x37e2('0x4')));const User_1=__importDefault(require('../models/User'));const request=require(a5_0x37e2('0x5'));exports[a5_0x37e2('0x6')]=(_0x147b39,_0x4ad1eb)=>{if(_0x147b39[a5_0x37e2('0x7')]){return _0x4ad1eb[a5_0x37e2('0x8')]('/');}_0x4ad1eb[a5_0x37e2('0x9')]('account/login',{'title':'Login'});};exports[a5_0x37e2('0xa')]=(_0x4f9bbe,_0x128b0f,_0xe838b4)=>{_0x4f9bbe[a5_0x37e2('0xb')](a5_0x37e2('0xc'),a5_0x37e2('0xd'))['isEmail']();_0x4f9bbe[a5_0x37e2('0xb')](a5_0x37e2('0xe'),a5_0x37e2('0xf'))[a5_0x37e2('0x10')]();_0x4f9bbe[a5_0x37e2('0x11')]('email')[a5_0x37e2('0x12')]({'gmail_remove_dots':![]});const _0x554d44=_0x4f9bbe['validationErrors']();if(_0x554d44){_0x4f9bbe[a5_0x37e2('0x13')](a5_0x37e2('0x14'),_0x554d44);return _0x128b0f['redirect'](a5_0x37e2('0x15'));}passport_1['default'][a5_0x37e2('0x16')](a5_0x37e2('0x17'),(_0x4ebc8e,_0x3eb206,_0xc960ea)=>{if(_0x4ebc8e){return _0xe838b4(_0x4ebc8e);}if(!_0x3eb206){_0x4f9bbe[a5_0x37e2('0x13')](a5_0x37e2('0x14'),_0xc960ea['message']);return _0x128b0f['redirect'](a5_0x37e2('0x15'));}_0x4f9bbe[a5_0x37e2('0x18')](_0x3eb206,_0x4ebc8e=>{if(_0x4ebc8e){return _0xe838b4(_0x4ebc8e);}_0x4f9bbe['flash']('success',{'msg':a5_0x37e2('0x19')});_0x128b0f[a5_0x37e2('0x8')](_0x4f9bbe[a5_0x37e2('0x1a')][a5_0x37e2('0x1b')]||'/');});})(_0x4f9bbe,_0x128b0f,_0xe838b4);};exports['logout']=(_0x5c4eaa,_0xdf16c)=>{_0x5c4eaa[a5_0x37e2('0x1c')]();_0xdf16c[a5_0x37e2('0x8')]('/');};exports['getSignup']=(_0x4b5a6b,_0x446986)=>{if(_0x4b5a6b[a5_0x37e2('0x7')]){return _0x446986[a5_0x37e2('0x8')]('/');}_0x446986[a5_0x37e2('0x9')](a5_0x37e2('0x1d'),{'title':a5_0x37e2('0x1e')});};exports[a5_0x37e2('0x1f')]=(_0x1441ef,_0x2377a3,_0xab63cf)=>{_0x1441ef[a5_0x37e2('0xb')](a5_0x37e2('0xc'),'Email\x20is\x20not\x20valid')[a5_0x37e2('0x20')]();_0x1441ef[a5_0x37e2('0xb')]('password',a5_0x37e2('0x21'))[a5_0x37e2('0x22')]({'min':0x4});_0x1441ef[a5_0x37e2('0xb')](a5_0x37e2('0x23'),a5_0x37e2('0x24'))[a5_0x37e2('0x25')](_0x1441ef['body'][a5_0x37e2('0xe')]);_0x1441ef['sanitize']('email')[a5_0x37e2('0x12')]({'gmail_remove_dots':![]});const _0x43f4ff=_0x1441ef['validationErrors']();if(_0x43f4ff){_0x1441ef[a5_0x37e2('0x13')]('errors',_0x43f4ff);return _0x2377a3[a5_0x37e2('0x8')]('/signup');}const _0x1af208=new User_1[(a5_0x37e2('0x26'))]({});User_1[a5_0x37e2('0x26')][a5_0x37e2('0x27')]({'email':_0x1441ef['body']['email']},(_0x805b54,_0x501551)=>{if(_0x805b54){return _0xab63cf(_0x805b54);}if(_0x501551){_0x1441ef[a5_0x37e2('0x13')](a5_0x37e2('0x14'),{'msg':a5_0x37e2('0x28')});return _0x2377a3[a5_0x37e2('0x8')]('/signup');}_0x1af208[a5_0x37e2('0x29')](_0x805b54=>{if(_0x805b54){return _0xab63cf(_0x805b54);}_0x1441ef[a5_0x37e2('0x18')](_0x1af208,_0x805b54=>{if(_0x805b54){return _0xab63cf(_0x805b54);}_0x2377a3[a5_0x37e2('0x8')]('/');});});});};exports[a5_0x37e2('0x2a')]=(_0x2b85a5,_0x31b2a6)=>{_0x31b2a6[a5_0x37e2('0x9')](a5_0x37e2('0x2b'),{'title':a5_0x37e2('0x2c')});};exports[a5_0x37e2('0x2d')]=(_0x2bde44,_0x208706,_0x4bdb17)=>{_0x2bde44[a5_0x37e2('0xb')](a5_0x37e2('0xc'),a5_0x37e2('0x2e'))[a5_0x37e2('0x20')]();_0x2bde44[a5_0x37e2('0x11')]('email')[a5_0x37e2('0x12')]({'gmail_remove_dots':![]});const _0x49b83d=_0x2bde44[a5_0x37e2('0x2f')]();if(_0x49b83d){_0x2bde44[a5_0x37e2('0x13')]('errors',_0x49b83d);return _0x208706['redirect']('/account');}User_1[a5_0x37e2('0x26')][a5_0x37e2('0x30')](_0x2bde44[a5_0x37e2('0x7')]['id'],(_0x234fe6,_0x108313)=>{if(_0x234fe6){return _0x4bdb17(_0x234fe6);}_0x108313[a5_0x37e2('0xc')]=_0x2bde44['body']['email']||'';_0x108313['profile']['name']=_0x2bde44['body']['name']||'';_0x108313['profile'][a5_0x37e2('0x31')]=_0x2bde44['body'][a5_0x37e2('0x31')]||'';_0x108313[a5_0x37e2('0x32')][a5_0x37e2('0x33')]=_0x2bde44[a5_0x37e2('0x34')][a5_0x37e2('0x33')]||'';_0x108313[a5_0x37e2('0x32')][a5_0x37e2('0x35')]=_0x2bde44['body']['website']||'';_0x108313['save'](_0x234fe6=>{if(_0x234fe6){if(_0x234fe6[a5_0x37e2('0x36')]===0x2af8){_0x2bde44[a5_0x37e2('0x13')](a5_0x37e2('0x14'),{'msg':a5_0x37e2('0x37')});return _0x208706[a5_0x37e2('0x8')](a5_0x37e2('0x38'));}return _0x4bdb17(_0x234fe6);}_0x2bde44[a5_0x37e2('0x13')]('success',{'msg':a5_0x37e2('0x39')});_0x208706[a5_0x37e2('0x8')]('/account');});});};exports[a5_0x37e2('0x3a')]=(_0x4c0c7a,_0x44d8e4,_0x2ad008)=>{_0x4c0c7a[a5_0x37e2('0xb')](a5_0x37e2('0xe'),a5_0x37e2('0x21'))[a5_0x37e2('0x22')]({'min':0x4});_0x4c0c7a['assert']('confirmPassword',a5_0x37e2('0x24'))[a5_0x37e2('0x25')](_0x4c0c7a[a5_0x37e2('0x34')][a5_0x37e2('0xe')]);const _0x127d77=_0x4c0c7a['validationErrors']();if(_0x127d77){_0x4c0c7a[a5_0x37e2('0x13')](a5_0x37e2('0x14'),_0x127d77);return _0x44d8e4['redirect'](a5_0x37e2('0x38'));}User_1['default'][a5_0x37e2('0x30')](_0x4c0c7a['user']['id'],(_0x3d81ae,_0x3b4235)=>{if(_0x3d81ae){return _0x2ad008(_0x3d81ae);}_0x3b4235[a5_0x37e2('0xe')]=_0x4c0c7a[a5_0x37e2('0x34')]['password'];_0x3b4235['save'](_0x3d81ae=>{if(_0x3d81ae){return _0x2ad008(_0x3d81ae);}_0x4c0c7a[a5_0x37e2('0x13')](a5_0x37e2('0x3b'),{'msg':a5_0x37e2('0x3c')});_0x44d8e4['redirect']('/account');});});};exports['postDeleteAccount']=(_0x35e4fb,_0x57f5d0,_0x2ab022)=>{User_1['default']['remove']({'_id':_0x35e4fb[a5_0x37e2('0x7')]['id']},_0x5ee1c5=>{if(_0x5ee1c5){return _0x2ab022(_0x5ee1c5);}_0x35e4fb[a5_0x37e2('0x1c')]();_0x35e4fb[a5_0x37e2('0x13')](a5_0x37e2('0x3d'),{'msg':a5_0x37e2('0x3e')});_0x57f5d0['redirect']('/');});};exports[a5_0x37e2('0x3f')]=(_0x2b9046,_0x23a611,_0x1fd277)=>{const _0x296dc8=_0x2b9046[a5_0x37e2('0x40')]['provider'];User_1['default'][a5_0x37e2('0x30')](_0x2b9046[a5_0x37e2('0x7')]['id'],(_0x212841,_0x4c00a8)=>{if(_0x212841){return _0x1fd277(_0x212841);}_0x4c00a8[_0x296dc8]=undefined;_0x4c00a8['tokens']=_0x4c00a8['tokens'][a5_0x37e2('0x41')](_0x42ed10=>_0x42ed10['kind']!==_0x296dc8);_0x4c00a8[a5_0x37e2('0x29')](_0x212841=>{if(_0x212841){return _0x1fd277(_0x212841);}_0x2b9046[a5_0x37e2('0x13')]('info',{'msg':_0x296dc8+'\x20account\x20has\x20been\x20unlinked.'});_0x23a611['redirect']('/account');});});};exports[a5_0x37e2('0x42')]=(_0xe955fc,_0x52fea5,_0x23e7cb)=>{if(_0xe955fc[a5_0x37e2('0x43')]()){return _0x52fea5[a5_0x37e2('0x8')]('/');}User_1[a5_0x37e2('0x26')]['findOne']({'passwordResetToken':_0xe955fc[a5_0x37e2('0x40')]['token']})['where'](a5_0x37e2('0x44'))['gt'](Date[a5_0x37e2('0x45')]())[a5_0x37e2('0x46')]((_0x45e4e7,_0x13503c)=>{if(_0x45e4e7){return _0x23e7cb(_0x45e4e7);}if(!_0x13503c){_0xe955fc[a5_0x37e2('0x13')](a5_0x37e2('0x14'),{'msg':a5_0x37e2('0x47')});return _0x52fea5[a5_0x37e2('0x8')](a5_0x37e2('0x48'));}_0x52fea5['render'](a5_0x37e2('0x49'),{'title':a5_0x37e2('0x4a')});});};exports['postReset']=(_0x39e3ca,_0x4e6f6d,_0x35b799)=>{_0x39e3ca[a5_0x37e2('0xb')](a5_0x37e2('0xe'),a5_0x37e2('0x4b'))[a5_0x37e2('0x22')]({'min':0x4});_0x39e3ca['assert']('confirm',a5_0x37e2('0x4c'))[a5_0x37e2('0x25')](_0x39e3ca[a5_0x37e2('0x34')][a5_0x37e2('0xe')]);const _0x23d835=_0x39e3ca[a5_0x37e2('0x2f')]();if(_0x23d835){_0x39e3ca[a5_0x37e2('0x13')](a5_0x37e2('0x14'),_0x23d835);return _0x4e6f6d[a5_0x37e2('0x8')](a5_0x37e2('0x4d'));}async_1[a5_0x37e2('0x26')]['waterfall']([function resetPassword(_0x1ec35a){User_1[a5_0x37e2('0x26')]['findOne']({'passwordResetToken':_0x39e3ca[a5_0x37e2('0x40')][a5_0x37e2('0x4e')]})[a5_0x37e2('0x4f')]('passwordResetExpires')['gt'](Date['now']())[a5_0x37e2('0x46')]((_0x3d9a29,_0x4ebdde)=>{if(_0x3d9a29){return _0x35b799(_0x3d9a29);}if(!_0x4ebdde){_0x39e3ca[a5_0x37e2('0x13')]('errors',{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x4e6f6d[a5_0x37e2('0x8')](a5_0x37e2('0x4d'));}_0x4ebdde[a5_0x37e2('0xe')]=_0x39e3ca[a5_0x37e2('0x34')][a5_0x37e2('0xe')];_0x4ebdde['passwordResetToken']=undefined;_0x4ebdde[a5_0x37e2('0x44')]=undefined;_0x4ebdde[a5_0x37e2('0x29')](_0x3d9a29=>{if(_0x3d9a29){return _0x35b799(_0x3d9a29);}_0x39e3ca[a5_0x37e2('0x18')](_0x4ebdde,_0x3d9a29=>{_0x1ec35a(_0x3d9a29,_0x4ebdde);});});});},function sendResetPasswordEmail(_0x296a0d,_0x5bb536){const _0x5a4c95=nodemailer_1['default'][a5_0x37e2('0x50')]({'service':a5_0x37e2('0x51'),'auth':{'user':process[a5_0x37e2('0x52')][a5_0x37e2('0x53')],'pass':process['env']['SENDGRID_PASSWORD']}});const _0x1b27da={'to':_0x296a0d[a5_0x37e2('0xc')],'from':a5_0x37e2('0x54'),'subject':a5_0x37e2('0x55'),'text':'Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20'+_0x296a0d[a5_0x37e2('0xc')]+a5_0x37e2('0x56')};_0x5a4c95[a5_0x37e2('0x57')](_0x1b27da,_0x2a194d=>{_0x39e3ca[a5_0x37e2('0x13')](a5_0x37e2('0x3b'),{'msg':a5_0x37e2('0x58')});_0x5bb536(_0x2a194d);});}],_0x46748f=>{if(_0x46748f){return _0x35b799(_0x46748f);}_0x4e6f6d[a5_0x37e2('0x8')]('/');});};exports[a5_0x37e2('0x59')]=(_0x252f00,_0x57fdfe)=>{if(_0x252f00['isAuthenticated']()){return _0x57fdfe[a5_0x37e2('0x8')]('/');}_0x57fdfe['render']('account/forgot',{'title':'Forgot\x20Password'});};exports[a5_0x37e2('0x5a')]=(_0xe666b0,_0x5d7b37,_0xfe5a8d)=>{_0xe666b0[a5_0x37e2('0xb')](a5_0x37e2('0xc'),'Please\x20enter\x20a\x20valid\x20email\x20address.')[a5_0x37e2('0x20')]();_0xe666b0[a5_0x37e2('0x11')](a5_0x37e2('0xc'))[a5_0x37e2('0x12')]({'gmail_remove_dots':![]});const _0x2f43d7=_0xe666b0[a5_0x37e2('0x2f')]();if(_0x2f43d7){_0xe666b0[a5_0x37e2('0x13')]('errors',_0x2f43d7);return _0x5d7b37[a5_0x37e2('0x8')](a5_0x37e2('0x48'));}async_1[a5_0x37e2('0x26')]['waterfall']([function createRandomToken(_0x56b06d){crypto_1[a5_0x37e2('0x26')]['randomBytes'](0x10,(_0x5cb26e,_0x1b793d)=>{const _0x154e47=_0x1b793d['toString'](a5_0x37e2('0x5b'));_0x56b06d(_0x5cb26e,_0x154e47);});},function setRandomToken(_0x28b21d,_0x1e2fed){User_1[a5_0x37e2('0x26')][a5_0x37e2('0x27')]({'email':_0xe666b0[a5_0x37e2('0x34')][a5_0x37e2('0xc')]},(_0x4ce33c,_0x10cf5d)=>{if(_0x4ce33c){return _0x1e2fed(_0x4ce33c);}if(!_0x10cf5d){_0xe666b0[a5_0x37e2('0x13')]('errors',{'msg':a5_0x37e2('0x5c')});return _0x5d7b37['redirect'](a5_0x37e2('0x48'));}_0x10cf5d[a5_0x37e2('0x5d')]=_0x28b21d;_0x10cf5d[a5_0x37e2('0x44')]=Date[a5_0x37e2('0x45')]()+0x36ee80;_0x10cf5d['save'](_0x4ce33c=>{_0x1e2fed(_0x4ce33c,_0x28b21d,_0x10cf5d);});});},function sendForgotPasswordEmail(_0x2646c2,_0xf929a5,_0x556001){const _0x17889c=nodemailer_1[a5_0x37e2('0x26')][a5_0x37e2('0x50')]({'service':a5_0x37e2('0x51'),'auth':{'user':process[a5_0x37e2('0x52')]['SENDGRID_USER'],'pass':process[a5_0x37e2('0x52')][a5_0x37e2('0x5e')]}});const _0x35d133={'to':_0xf929a5[a5_0x37e2('0xc')],'from':a5_0x37e2('0x5f'),'subject':a5_0x37e2('0x60'),'text':a5_0x37e2('0x61')+_0xe666b0['headers']['host']+a5_0x37e2('0x62')+_0x2646c2+'\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a'};_0x17889c['sendMail'](_0x35d133,_0x5b98bf=>{_0xe666b0[a5_0x37e2('0x13')](a5_0x37e2('0x3d'),{'msg':a5_0x37e2('0x63')+_0xf929a5[a5_0x37e2('0xc')]+a5_0x37e2('0x64')});_0x556001(_0x5b98bf);});}],_0x1ae0c8=>{if(_0x1ae0c8){return _0xfe5a8d(_0x1ae0c8);}_0x5d7b37['redirect'](a5_0x37e2('0x48'));});};
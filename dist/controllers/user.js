var a5_0x26d0=['waterfall','randomBytes','toString','hex','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','passwordResetToken','createTransport','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://','headers','host','/reset/','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','An\x20e-mail\x20has\x20been\x20sent\x20to\x20','\x20with\x20further\x20instructions.','defineProperty','__esModule','async','crypto','nodemailer','passport','../models/User','getLogin','user','redirect','render','account/login','Login','postLogin','assert','isEmail','password','Password\x20cannot\x20be\x20blank','sanitize','email','normalizeEmail','flash','errors','default','authenticate','local','message','/login','logIn','success','Success!\x20You\x20are\x20logged\x20in.','returnTo','logout','account/signup','postSignup','Email\x20is\x20not\x20valid','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','len','confirmPassword','Passwords\x20do\x20not\x20match','equals','body','validationErrors','/signup','findOne','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','getAccount','account/profile','Account\x20Management','Please\x20enter\x20a\x20valid\x20email\x20address.','/account','findById','profile','name','gender','location','website','save','code','The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.','Password\x20has\x20been\x20changed.','postDeleteAccount','remove','info','Your\x20account\x20has\x20been\x20deleted.','params','tokens','kind','\x20account\x20has\x20been\x20unlinked.','isAuthenticated','passwordResetExpires','now','exec','account/reset','Password\x20Reset','postReset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','confirm','Passwords\x20must\x20match.','back','token','where','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','SendGrid','env','SENDGRID_USER','SENDGRID_PASSWORD','Your\x20password\x20has\x20been\x20changed','Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20','\x20has\x20just\x20been\x20changed.\x0a','sendMail','Success!\x20Your\x20password\x20has\x20been\x20changed.','account/forgot','Forgot\x20Password','postForgot','/forgot'];(function(_0x4e23c0,_0x5e63f8){var _0x5362a0=function(_0x170af4){while(--_0x170af4){_0x4e23c0['push'](_0x4e23c0['shift']());}};_0x5362a0(++_0x5e63f8);}(a5_0x26d0,0xf0));var a5_0x262b=function(_0x5e4c2a,_0x27135b){_0x5e4c2a=_0x5e4c2a-0x0;var _0x1434b2=a5_0x26d0[_0x5e4c2a];return _0x1434b2;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x2ad0b8){return _0x2ad0b8&&_0x2ad0b8['__esModule']?_0x2ad0b8:{'default':_0x2ad0b8};};Object[a5_0x262b('0x0')](exports,a5_0x262b('0x1'),{'value':!![]});const async_1=__importDefault(require(a5_0x262b('0x2')));const crypto_1=__importDefault(require(a5_0x262b('0x3')));const nodemailer_1=__importDefault(require(a5_0x262b('0x4')));const passport_1=__importDefault(require(a5_0x262b('0x5')));const User_1=__importDefault(require(a5_0x262b('0x6')));const request=require('express-validator');exports[a5_0x262b('0x7')]=(_0x35293c,_0x53f93a)=>{if(_0x35293c[a5_0x262b('0x8')]){return _0x53f93a[a5_0x262b('0x9')]('/');}_0x53f93a[a5_0x262b('0xa')](a5_0x262b('0xb'),{'title':a5_0x262b('0xc')});};exports[a5_0x262b('0xd')]=(_0x13c734,_0x574fca,_0x4978fa)=>{_0x13c734[a5_0x262b('0xe')]('email','Email\x20is\x20not\x20valid')[a5_0x262b('0xf')]();_0x13c734[a5_0x262b('0xe')](a5_0x262b('0x10'),a5_0x262b('0x11'))['notEmpty']();_0x13c734[a5_0x262b('0x12')](a5_0x262b('0x13'))[a5_0x262b('0x14')]({'gmail_remove_dots':![]});const _0x322a1a=_0x13c734['validationErrors']();if(_0x322a1a){_0x13c734[a5_0x262b('0x15')](a5_0x262b('0x16'),_0x322a1a);return _0x574fca[a5_0x262b('0x9')]('/login');}passport_1[a5_0x262b('0x17')][a5_0x262b('0x18')](a5_0x262b('0x19'),(_0x2af372,_0x455457,_0x4d5c32)=>{if(_0x2af372){return _0x4978fa(_0x2af372);}if(!_0x455457){_0x13c734['flash'](a5_0x262b('0x16'),_0x4d5c32[a5_0x262b('0x1a')]);return _0x574fca['redirect'](a5_0x262b('0x1b'));}_0x13c734[a5_0x262b('0x1c')](_0x455457,_0x2af372=>{if(_0x2af372){return _0x4978fa(_0x2af372);}_0x13c734[a5_0x262b('0x15')](a5_0x262b('0x1d'),{'msg':a5_0x262b('0x1e')});_0x574fca[a5_0x262b('0x9')](_0x13c734['session'][a5_0x262b('0x1f')]||'/');});})(_0x13c734,_0x574fca,_0x4978fa);};exports[a5_0x262b('0x20')]=(_0x5605ae,_0x50aa6d)=>{_0x5605ae[a5_0x262b('0x20')]();_0x50aa6d[a5_0x262b('0x9')]('/');};exports['getSignup']=(_0x2b8d15,_0x22a876)=>{if(_0x2b8d15[a5_0x262b('0x8')]){return _0x22a876['redirect']('/');}_0x22a876['render'](a5_0x262b('0x21'),{'title':'Create\x20Account'});};exports[a5_0x262b('0x22')]=(_0x2de471,_0x10f64b,_0x2cf99d)=>{_0x2de471[a5_0x262b('0xe')](a5_0x262b('0x13'),a5_0x262b('0x23'))['isEmail']();_0x2de471[a5_0x262b('0xe')](a5_0x262b('0x10'),a5_0x262b('0x24'))[a5_0x262b('0x25')]({'min':0x4});_0x2de471[a5_0x262b('0xe')](a5_0x262b('0x26'),a5_0x262b('0x27'))[a5_0x262b('0x28')](_0x2de471[a5_0x262b('0x29')][a5_0x262b('0x10')]);_0x2de471[a5_0x262b('0x12')](a5_0x262b('0x13'))[a5_0x262b('0x14')]({'gmail_remove_dots':![]});const _0x54cacc=_0x2de471[a5_0x262b('0x2a')]();if(_0x54cacc){_0x2de471[a5_0x262b('0x15')]('errors',_0x54cacc);return _0x10f64b[a5_0x262b('0x9')](a5_0x262b('0x2b'));}const _0x4f9258=new User_1['default']({});User_1[a5_0x262b('0x17')][a5_0x262b('0x2c')]({'email':_0x2de471['body']['email']},(_0x5b50c0,_0x58b786)=>{if(_0x5b50c0){return _0x2cf99d(_0x5b50c0);}if(_0x58b786){_0x2de471[a5_0x262b('0x15')]('errors',{'msg':a5_0x262b('0x2d')});return _0x10f64b[a5_0x262b('0x9')](a5_0x262b('0x2b'));}_0x4f9258['save'](_0x5b50c0=>{if(_0x5b50c0){return _0x2cf99d(_0x5b50c0);}_0x2de471[a5_0x262b('0x1c')](_0x4f9258,_0x5b50c0=>{if(_0x5b50c0){return _0x2cf99d(_0x5b50c0);}_0x10f64b[a5_0x262b('0x9')]('/');});});});};exports[a5_0x262b('0x2e')]=(_0x58ddb3,_0x366921)=>{_0x366921[a5_0x262b('0xa')](a5_0x262b('0x2f'),{'title':a5_0x262b('0x30')});};exports['postUpdateProfile']=(_0x33785f,_0x2c5516,_0x5e1b8e)=>{_0x33785f['assert']('email',a5_0x262b('0x31'))['isEmail']();_0x33785f['sanitize'](a5_0x262b('0x13'))['normalizeEmail']({'gmail_remove_dots':![]});const _0xbaa5d2=_0x33785f[a5_0x262b('0x2a')]();if(_0xbaa5d2){_0x33785f[a5_0x262b('0x15')](a5_0x262b('0x16'),_0xbaa5d2);return _0x2c5516[a5_0x262b('0x9')](a5_0x262b('0x32'));}User_1[a5_0x262b('0x17')][a5_0x262b('0x33')](_0x33785f['user']['id'],(_0x39f029,_0x5c6d6e)=>{if(_0x39f029){return _0x5e1b8e(_0x39f029);}_0x5c6d6e[a5_0x262b('0x13')]=_0x33785f['body']['email']||'';_0x5c6d6e[a5_0x262b('0x34')]['name']=_0x33785f[a5_0x262b('0x29')][a5_0x262b('0x35')]||'';_0x5c6d6e[a5_0x262b('0x34')][a5_0x262b('0x36')]=_0x33785f['body'][a5_0x262b('0x36')]||'';_0x5c6d6e[a5_0x262b('0x34')][a5_0x262b('0x37')]=_0x33785f[a5_0x262b('0x29')][a5_0x262b('0x37')]||'';_0x5c6d6e[a5_0x262b('0x34')][a5_0x262b('0x38')]=_0x33785f['body']['website']||'';_0x5c6d6e[a5_0x262b('0x39')](_0x39f029=>{if(_0x39f029){if(_0x39f029[a5_0x262b('0x3a')]===0x2af8){_0x33785f[a5_0x262b('0x15')]('errors',{'msg':a5_0x262b('0x3b')});return _0x2c5516[a5_0x262b('0x9')](a5_0x262b('0x32'));}return _0x5e1b8e(_0x39f029);}_0x33785f[a5_0x262b('0x15')](a5_0x262b('0x1d'),{'msg':'Profile\x20information\x20has\x20been\x20updated.'});_0x2c5516[a5_0x262b('0x9')](a5_0x262b('0x32'));});});};exports['postUpdatePassword']=(_0x48125b,_0x27082a,_0x163023)=>{_0x48125b[a5_0x262b('0xe')](a5_0x262b('0x10'),a5_0x262b('0x24'))[a5_0x262b('0x25')]({'min':0x4});_0x48125b[a5_0x262b('0xe')](a5_0x262b('0x26'),a5_0x262b('0x27'))[a5_0x262b('0x28')](_0x48125b[a5_0x262b('0x29')][a5_0x262b('0x10')]);const _0x16120b=_0x48125b[a5_0x262b('0x2a')]();if(_0x16120b){_0x48125b[a5_0x262b('0x15')]('errors',_0x16120b);return _0x27082a['redirect']('/account');}User_1[a5_0x262b('0x17')][a5_0x262b('0x33')](_0x48125b[a5_0x262b('0x8')]['id'],(_0x54fb8c,_0x428255)=>{if(_0x54fb8c){return _0x163023(_0x54fb8c);}_0x428255[a5_0x262b('0x10')]=_0x48125b[a5_0x262b('0x29')]['password'];_0x428255[a5_0x262b('0x39')](_0x54fb8c=>{if(_0x54fb8c){return _0x163023(_0x54fb8c);}_0x48125b[a5_0x262b('0x15')](a5_0x262b('0x1d'),{'msg':a5_0x262b('0x3c')});_0x27082a[a5_0x262b('0x9')]('/account');});});};exports[a5_0x262b('0x3d')]=(_0x2b58a0,_0x166534,_0x2498da)=>{User_1[a5_0x262b('0x17')][a5_0x262b('0x3e')]({'_id':_0x2b58a0['user']['id']},_0x2ccdf7=>{if(_0x2ccdf7){return _0x2498da(_0x2ccdf7);}_0x2b58a0[a5_0x262b('0x20')]();_0x2b58a0[a5_0x262b('0x15')](a5_0x262b('0x3f'),{'msg':a5_0x262b('0x40')});_0x166534['redirect']('/');});};exports['getOauthUnlink']=(_0x147b17,_0x3da8ab,_0x3677c1)=>{const _0x391ea9=_0x147b17[a5_0x262b('0x41')]['provider'];User_1[a5_0x262b('0x17')][a5_0x262b('0x33')](_0x147b17[a5_0x262b('0x8')]['id'],(_0x210a75,_0x93d528)=>{if(_0x210a75){return _0x3677c1(_0x210a75);}_0x93d528[_0x391ea9]=undefined;_0x93d528[a5_0x262b('0x42')]=_0x93d528['tokens']['filter'](_0x551712=>_0x551712[a5_0x262b('0x43')]!==_0x391ea9);_0x93d528['save'](_0x210a75=>{if(_0x210a75){return _0x3677c1(_0x210a75);}_0x147b17[a5_0x262b('0x15')]('info',{'msg':_0x391ea9+a5_0x262b('0x44')});_0x3da8ab[a5_0x262b('0x9')]('/account');});});};exports['getReset']=(_0x213e67,_0x38a66b,_0x42376a)=>{if(_0x213e67[a5_0x262b('0x45')]()){return _0x38a66b[a5_0x262b('0x9')]('/');}User_1[a5_0x262b('0x17')]['findOne']({'passwordResetToken':_0x213e67['params']['token']})['where'](a5_0x262b('0x46'))['gt'](Date[a5_0x262b('0x47')]())[a5_0x262b('0x48')]((_0x214c66,_0x32d251)=>{if(_0x214c66){return _0x42376a(_0x214c66);}if(!_0x32d251){_0x213e67['flash']('errors',{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x38a66b['redirect']('/forgot');}_0x38a66b[a5_0x262b('0xa')](a5_0x262b('0x49'),{'title':a5_0x262b('0x4a')});});};exports[a5_0x262b('0x4b')]=(_0x453fb0,_0x4344a8,_0x45c52c)=>{_0x453fb0[a5_0x262b('0xe')](a5_0x262b('0x10'),a5_0x262b('0x4c'))['len']({'min':0x4});_0x453fb0['assert'](a5_0x262b('0x4d'),a5_0x262b('0x4e'))[a5_0x262b('0x28')](_0x453fb0[a5_0x262b('0x29')]['password']);const _0x2a6465=_0x453fb0[a5_0x262b('0x2a')]();if(_0x2a6465){_0x453fb0['flash'](a5_0x262b('0x16'),_0x2a6465);return _0x4344a8['redirect'](a5_0x262b('0x4f'));}async_1[a5_0x262b('0x17')]['waterfall']([function resetPassword(_0x191992){User_1[a5_0x262b('0x17')][a5_0x262b('0x2c')]({'passwordResetToken':_0x453fb0[a5_0x262b('0x41')][a5_0x262b('0x50')]})[a5_0x262b('0x51')](a5_0x262b('0x46'))['gt'](Date[a5_0x262b('0x47')]())['exec']((_0x201fd5,_0x4f7c12)=>{if(_0x201fd5){return _0x45c52c(_0x201fd5);}if(!_0x4f7c12){_0x453fb0[a5_0x262b('0x15')](a5_0x262b('0x16'),{'msg':a5_0x262b('0x52')});return _0x4344a8[a5_0x262b('0x9')](a5_0x262b('0x4f'));}_0x4f7c12['password']=_0x453fb0[a5_0x262b('0x29')][a5_0x262b('0x10')];_0x4f7c12['passwordResetToken']=undefined;_0x4f7c12[a5_0x262b('0x46')]=undefined;_0x4f7c12[a5_0x262b('0x39')](_0x201fd5=>{if(_0x201fd5){return _0x45c52c(_0x201fd5);}_0x453fb0['logIn'](_0x4f7c12,_0x201fd5=>{_0x191992(_0x201fd5,_0x4f7c12);});});});},function sendResetPasswordEmail(_0x48c3c8,_0x28dd2e){const _0x5e720f=nodemailer_1[a5_0x262b('0x17')]['createTransport']({'service':a5_0x262b('0x53'),'auth':{'user':process[a5_0x262b('0x54')][a5_0x262b('0x55')],'pass':process[a5_0x262b('0x54')][a5_0x262b('0x56')]}});const _0x8c44e2={'to':_0x48c3c8[a5_0x262b('0x13')],'from':'express-ts@starter.com','subject':a5_0x262b('0x57'),'text':a5_0x262b('0x58')+_0x48c3c8[a5_0x262b('0x13')]+a5_0x262b('0x59')};_0x5e720f[a5_0x262b('0x5a')](_0x8c44e2,_0x587adf=>{_0x453fb0['flash']('success',{'msg':a5_0x262b('0x5b')});_0x28dd2e(_0x587adf);});}],_0x5e3b77=>{if(_0x5e3b77){return _0x45c52c(_0x5e3b77);}_0x4344a8[a5_0x262b('0x9')]('/');});};exports['getForgot']=(_0x4524a3,_0x3dc870)=>{if(_0x4524a3[a5_0x262b('0x45')]()){return _0x3dc870[a5_0x262b('0x9')]('/');}_0x3dc870[a5_0x262b('0xa')](a5_0x262b('0x5c'),{'title':a5_0x262b('0x5d')});};exports[a5_0x262b('0x5e')]=(_0x3b4f0b,_0x39b8e8,_0x42ee76)=>{_0x3b4f0b[a5_0x262b('0xe')]('email','Please\x20enter\x20a\x20valid\x20email\x20address.')[a5_0x262b('0xf')]();_0x3b4f0b[a5_0x262b('0x12')](a5_0x262b('0x13'))[a5_0x262b('0x14')]({'gmail_remove_dots':![]});const _0x359ad9=_0x3b4f0b[a5_0x262b('0x2a')]();if(_0x359ad9){_0x3b4f0b[a5_0x262b('0x15')](a5_0x262b('0x16'),_0x359ad9);return _0x39b8e8['redirect'](a5_0x262b('0x5f'));}async_1[a5_0x262b('0x17')][a5_0x262b('0x60')]([function createRandomToken(_0x392322){crypto_1[a5_0x262b('0x17')][a5_0x262b('0x61')](0x10,(_0x45f7df,_0x2b5490)=>{const _0x319e80=_0x2b5490[a5_0x262b('0x62')](a5_0x262b('0x63'));_0x392322(_0x45f7df,_0x319e80);});},function setRandomToken(_0x8c9b92,_0x520597){User_1[a5_0x262b('0x17')][a5_0x262b('0x2c')]({'email':_0x3b4f0b[a5_0x262b('0x29')][a5_0x262b('0x13')]},(_0x4147b4,_0x1c73ca)=>{if(_0x4147b4){return _0x520597(_0x4147b4);}if(!_0x1c73ca){_0x3b4f0b[a5_0x262b('0x15')](a5_0x262b('0x16'),{'msg':a5_0x262b('0x64')});return _0x39b8e8[a5_0x262b('0x9')]('/forgot');}_0x1c73ca[a5_0x262b('0x65')]=_0x8c9b92;_0x1c73ca[a5_0x262b('0x46')]=Date[a5_0x262b('0x47')]()+0x36ee80;_0x1c73ca[a5_0x262b('0x39')](_0x4147b4=>{_0x520597(_0x4147b4,_0x8c9b92,_0x1c73ca);});});},function sendForgotPasswordEmail(_0x1196d4,_0x15c756,_0x385fac){const _0x4a48c1=nodemailer_1[a5_0x262b('0x17')][a5_0x262b('0x66')]({'service':'SendGrid','auth':{'user':process[a5_0x262b('0x54')][a5_0x262b('0x55')],'pass':process[a5_0x262b('0x54')][a5_0x262b('0x56')]}});const _0x97afa2={'to':_0x15c756['email'],'from':a5_0x262b('0x67'),'subject':a5_0x262b('0x68'),'text':a5_0x262b('0x69')+_0x3b4f0b[a5_0x262b('0x6a')][a5_0x262b('0x6b')]+a5_0x262b('0x6c')+_0x1196d4+a5_0x262b('0x6d')};_0x4a48c1[a5_0x262b('0x5a')](_0x97afa2,_0xaaeabf=>{_0x3b4f0b[a5_0x262b('0x15')](a5_0x262b('0x3f'),{'msg':a5_0x262b('0x6e')+_0x15c756[a5_0x262b('0x13')]+a5_0x262b('0x6f')});_0x385fac(_0xaaeabf);});}],_0x24fd3e=>{if(_0x24fd3e){return _0x42ee76(_0x24fd3e);}_0x39b8e8[a5_0x262b('0x9')](a5_0x262b('0x5f'));});};
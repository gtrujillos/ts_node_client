var a5_0x462b=['local','flash','message','success','Success!\x20You\x20are\x20logged\x20in.','session','returnTo','logout','account/signup','Create\x20Account','email','confirmPassword','Passwords\x20do\x20not\x20match','equals','body','normalizeEmail','/signup','findOne','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','save','logIn','account/profile','Account\x20Management','postUpdateProfile','Please\x20enter\x20a\x20valid\x20email\x20address.','/account','findById','profile','name','gender','location','website','code','The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.','Profile\x20information\x20has\x20been\x20updated.','postUpdatePassword','len','Password\x20has\x20been\x20changed.','remove','Your\x20account\x20has\x20been\x20deleted.','getOauthUnlink','params','provider','tokens','kind','\x20account\x20has\x20been\x20unlinked.','isAuthenticated','token','now','exec','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','account/reset','Password\x20Reset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','confirm','Passwords\x20must\x20match.','back','where','passwordResetExpires','passwordResetToken','createTransport','SendGrid','SENDGRID_USER','SENDGRID_PASSWORD','express-ts@starter.com','Your\x20password\x20has\x20been\x20changed','\x20has\x20just\x20been\x20changed.\x0a','sendMail','Success!\x20Your\x20password\x20has\x20been\x20changed.','getForgot','account/forgot','Forgot\x20Password','postForgot','/forgot','randomBytes','toString','hex','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','env','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://','host','/reset/','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','info','__importDefault','__esModule','passport','getLogin','user','redirect','render','account/login','assert','Email\x20is\x20not\x20valid','isEmail','password','Password\x20cannot\x20be\x20blank','sanitize','validationErrors','errors','/login','default','authenticate'];(function(_0x566ea9,_0x2da093){var _0x311832=function(_0x24e621){while(--_0x24e621){_0x566ea9['push'](_0x566ea9['shift']());}};_0x311832(++_0x2da093);}(a5_0x462b,0x128));var a5_0x4691=function(_0x3b513c,_0x187b3f){_0x3b513c=_0x3b513c-0x0;var _0x4b8d83=a5_0x462b[_0x3b513c];return _0x4b8d83;};'use strict';var __importDefault=this&&this[a5_0x4691('0x0')]||function(_0x351f87){return _0x351f87&&_0x351f87[a5_0x4691('0x1')]?_0x351f87:{'default':_0x351f87};};Object['defineProperty'](exports,a5_0x4691('0x1'),{'value':!![]});const async_1=__importDefault(require('async'));const crypto_1=__importDefault(require('crypto'));const nodemailer_1=__importDefault(require('nodemailer'));const passport_1=__importDefault(require(a5_0x4691('0x2')));const User_1=__importDefault(require('../models/User'));const request=require('express-validator');exports[a5_0x4691('0x3')]=(_0x517726,_0x3b6ba1)=>{if(_0x517726[a5_0x4691('0x4')]){return _0x3b6ba1[a5_0x4691('0x5')]('/');}_0x3b6ba1[a5_0x4691('0x6')](a5_0x4691('0x7'),{'title':'Login'});};exports['postLogin']=(_0x3ed6a5,_0x221184,_0x4ccd73)=>{_0x3ed6a5[a5_0x4691('0x8')]('email',a5_0x4691('0x9'))[a5_0x4691('0xa')]();_0x3ed6a5[a5_0x4691('0x8')](a5_0x4691('0xb'),a5_0x4691('0xc'))['notEmpty']();_0x3ed6a5[a5_0x4691('0xd')]('email')['normalizeEmail']({'gmail_remove_dots':![]});const _0x2d15fa=_0x3ed6a5[a5_0x4691('0xe')]();if(_0x2d15fa){_0x3ed6a5['flash'](a5_0x4691('0xf'),_0x2d15fa);return _0x221184[a5_0x4691('0x5')](a5_0x4691('0x10'));}passport_1[a5_0x4691('0x11')][a5_0x4691('0x12')](a5_0x4691('0x13'),(_0x2739ff,_0x12388f,_0x4b9768)=>{if(_0x2739ff){return _0x4ccd73(_0x2739ff);}if(!_0x12388f){_0x3ed6a5[a5_0x4691('0x14')](a5_0x4691('0xf'),_0x4b9768[a5_0x4691('0x15')]);return _0x221184[a5_0x4691('0x5')](a5_0x4691('0x10'));}_0x3ed6a5['logIn'](_0x12388f,_0x2739ff=>{if(_0x2739ff){return _0x4ccd73(_0x2739ff);}_0x3ed6a5[a5_0x4691('0x14')](a5_0x4691('0x16'),{'msg':a5_0x4691('0x17')});_0x221184[a5_0x4691('0x5')](_0x3ed6a5[a5_0x4691('0x18')][a5_0x4691('0x19')]||'/');});})(_0x3ed6a5,_0x221184,_0x4ccd73);};exports[a5_0x4691('0x1a')]=(_0x504a92,_0x2953dd)=>{_0x504a92[a5_0x4691('0x1a')]();_0x2953dd[a5_0x4691('0x5')]('/');};exports['getSignup']=(_0xdfe7fe,_0x100b76)=>{if(_0xdfe7fe[a5_0x4691('0x4')]){return _0x100b76[a5_0x4691('0x5')]('/');}_0x100b76[a5_0x4691('0x6')](a5_0x4691('0x1b'),{'title':a5_0x4691('0x1c')});};exports['postSignup']=(_0xd37bf1,_0x4cd0a5,_0x564571)=>{_0xd37bf1[a5_0x4691('0x8')](a5_0x4691('0x1d'),a5_0x4691('0x9'))[a5_0x4691('0xa')]();_0xd37bf1[a5_0x4691('0x8')](a5_0x4691('0xb'),'Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long')['len']({'min':0x4});_0xd37bf1[a5_0x4691('0x8')](a5_0x4691('0x1e'),a5_0x4691('0x1f'))[a5_0x4691('0x20')](_0xd37bf1[a5_0x4691('0x21')][a5_0x4691('0xb')]);_0xd37bf1['sanitize'](a5_0x4691('0x1d'))[a5_0x4691('0x22')]({'gmail_remove_dots':![]});const _0x5578f0=_0xd37bf1[a5_0x4691('0xe')]();if(_0x5578f0){_0xd37bf1[a5_0x4691('0x14')](a5_0x4691('0xf'),_0x5578f0);return _0x4cd0a5['redirect'](a5_0x4691('0x23'));}const _0x572ce4=new User_1[(a5_0x4691('0x11'))]({});User_1[a5_0x4691('0x11')][a5_0x4691('0x24')]({'email':_0xd37bf1[a5_0x4691('0x21')][a5_0x4691('0x1d')]},(_0x300e3f,_0x481ceb)=>{if(_0x300e3f){return _0x564571(_0x300e3f);}if(_0x481ceb){_0xd37bf1[a5_0x4691('0x14')]('errors',{'msg':a5_0x4691('0x25')});return _0x4cd0a5[a5_0x4691('0x5')](a5_0x4691('0x23'));}_0x572ce4[a5_0x4691('0x26')](_0x300e3f=>{if(_0x300e3f){return _0x564571(_0x300e3f);}_0xd37bf1[a5_0x4691('0x27')](_0x572ce4,_0x300e3f=>{if(_0x300e3f){return _0x564571(_0x300e3f);}_0x4cd0a5[a5_0x4691('0x5')]('/');});});});};exports['getAccount']=(_0x3b1928,_0x4b9983)=>{_0x4b9983[a5_0x4691('0x6')](a5_0x4691('0x28'),{'title':a5_0x4691('0x29')});};exports[a5_0x4691('0x2a')]=(_0x273b27,_0x4100d5,_0x647d81)=>{_0x273b27['assert'](a5_0x4691('0x1d'),a5_0x4691('0x2b'))[a5_0x4691('0xa')]();_0x273b27['sanitize']('email')['normalizeEmail']({'gmail_remove_dots':![]});const _0x25eb4c=_0x273b27[a5_0x4691('0xe')]();if(_0x25eb4c){_0x273b27[a5_0x4691('0x14')](a5_0x4691('0xf'),_0x25eb4c);return _0x4100d5[a5_0x4691('0x5')](a5_0x4691('0x2c'));}User_1['default'][a5_0x4691('0x2d')](_0x273b27[a5_0x4691('0x4')]['id'],(_0x3fc3aa,_0x55785d)=>{if(_0x3fc3aa){return _0x647d81(_0x3fc3aa);}_0x55785d[a5_0x4691('0x1d')]=_0x273b27['body'][a5_0x4691('0x1d')]||'';_0x55785d[a5_0x4691('0x2e')]['name']=_0x273b27['body'][a5_0x4691('0x2f')]||'';_0x55785d[a5_0x4691('0x2e')][a5_0x4691('0x30')]=_0x273b27[a5_0x4691('0x21')]['gender']||'';_0x55785d['profile'][a5_0x4691('0x31')]=_0x273b27[a5_0x4691('0x21')][a5_0x4691('0x31')]||'';_0x55785d['profile'][a5_0x4691('0x32')]=_0x273b27[a5_0x4691('0x21')]['website']||'';_0x55785d[a5_0x4691('0x26')](_0x3fc3aa=>{if(_0x3fc3aa){if(_0x3fc3aa[a5_0x4691('0x33')]===0x2af8){_0x273b27[a5_0x4691('0x14')]('errors',{'msg':a5_0x4691('0x34')});return _0x4100d5[a5_0x4691('0x5')](a5_0x4691('0x2c'));}return _0x647d81(_0x3fc3aa);}_0x273b27[a5_0x4691('0x14')](a5_0x4691('0x16'),{'msg':a5_0x4691('0x35')});_0x4100d5[a5_0x4691('0x5')](a5_0x4691('0x2c'));});});};exports[a5_0x4691('0x36')]=(_0x183310,_0x475d71,_0x42e62f)=>{_0x183310[a5_0x4691('0x8')]('password','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long')[a5_0x4691('0x37')]({'min':0x4});_0x183310[a5_0x4691('0x8')](a5_0x4691('0x1e'),a5_0x4691('0x1f'))[a5_0x4691('0x20')](_0x183310['body'][a5_0x4691('0xb')]);const _0x5a35cd=_0x183310['validationErrors']();if(_0x5a35cd){_0x183310[a5_0x4691('0x14')](a5_0x4691('0xf'),_0x5a35cd);return _0x475d71[a5_0x4691('0x5')](a5_0x4691('0x2c'));}User_1['default'][a5_0x4691('0x2d')](_0x183310[a5_0x4691('0x4')]['id'],(_0x5c342c,_0x39e1ba)=>{if(_0x5c342c){return _0x42e62f(_0x5c342c);}_0x39e1ba[a5_0x4691('0xb')]=_0x183310[a5_0x4691('0x21')]['password'];_0x39e1ba[a5_0x4691('0x26')](_0x5c342c=>{if(_0x5c342c){return _0x42e62f(_0x5c342c);}_0x183310[a5_0x4691('0x14')](a5_0x4691('0x16'),{'msg':a5_0x4691('0x38')});_0x475d71[a5_0x4691('0x5')](a5_0x4691('0x2c'));});});};exports['postDeleteAccount']=(_0x957d28,_0x1ea1fb,_0x5382b2)=>{User_1[a5_0x4691('0x11')][a5_0x4691('0x39')]({'_id':_0x957d28[a5_0x4691('0x4')]['id']},_0x333553=>{if(_0x333553){return _0x5382b2(_0x333553);}_0x957d28[a5_0x4691('0x1a')]();_0x957d28[a5_0x4691('0x14')]('info',{'msg':a5_0x4691('0x3a')});_0x1ea1fb[a5_0x4691('0x5')]('/');});};exports[a5_0x4691('0x3b')]=(_0x561860,_0x2ebecc,_0x197480)=>{const _0x56d08b=_0x561860[a5_0x4691('0x3c')][a5_0x4691('0x3d')];User_1['default']['findById'](_0x561860['user']['id'],(_0x1dd87c,_0x250a14)=>{if(_0x1dd87c){return _0x197480(_0x1dd87c);}_0x250a14[_0x56d08b]=undefined;_0x250a14['tokens']=_0x250a14[a5_0x4691('0x3e')]['filter'](_0x4fed30=>_0x4fed30[a5_0x4691('0x3f')]!==_0x56d08b);_0x250a14[a5_0x4691('0x26')](_0x1dd87c=>{if(_0x1dd87c){return _0x197480(_0x1dd87c);}_0x561860[a5_0x4691('0x14')]('info',{'msg':_0x56d08b+a5_0x4691('0x40')});_0x2ebecc[a5_0x4691('0x5')](a5_0x4691('0x2c'));});});};exports['getReset']=(_0x15102f,_0x8ef7a8,_0x2276ed)=>{if(_0x15102f[a5_0x4691('0x41')]()){return _0x8ef7a8[a5_0x4691('0x5')]('/');}User_1[a5_0x4691('0x11')][a5_0x4691('0x24')]({'passwordResetToken':_0x15102f['params'][a5_0x4691('0x42')]})['where']('passwordResetExpires')['gt'](Date[a5_0x4691('0x43')]())[a5_0x4691('0x44')]((_0x29b5ea,_0x2d604f)=>{if(_0x29b5ea){return _0x2276ed(_0x29b5ea);}if(!_0x2d604f){_0x15102f['flash'](a5_0x4691('0xf'),{'msg':a5_0x4691('0x45')});return _0x8ef7a8['redirect']('/forgot');}_0x8ef7a8[a5_0x4691('0x6')](a5_0x4691('0x46'),{'title':a5_0x4691('0x47')});});};exports['postReset']=(_0x26444e,_0x5c7e2f,_0x3355bf)=>{_0x26444e[a5_0x4691('0x8')](a5_0x4691('0xb'),a5_0x4691('0x48'))[a5_0x4691('0x37')]({'min':0x4});_0x26444e[a5_0x4691('0x8')](a5_0x4691('0x49'),a5_0x4691('0x4a'))[a5_0x4691('0x20')](_0x26444e['body']['password']);const _0x1eaadc=_0x26444e[a5_0x4691('0xe')]();if(_0x1eaadc){_0x26444e[a5_0x4691('0x14')]('errors',_0x1eaadc);return _0x5c7e2f[a5_0x4691('0x5')](a5_0x4691('0x4b'));}async_1[a5_0x4691('0x11')]['waterfall']([function resetPassword(_0x536048){User_1[a5_0x4691('0x11')][a5_0x4691('0x24')]({'passwordResetToken':_0x26444e[a5_0x4691('0x3c')][a5_0x4691('0x42')]})[a5_0x4691('0x4c')](a5_0x4691('0x4d'))['gt'](Date[a5_0x4691('0x43')]())[a5_0x4691('0x44')]((_0xb87fa1,_0x343b20)=>{if(_0xb87fa1){return _0x3355bf(_0xb87fa1);}if(!_0x343b20){_0x26444e[a5_0x4691('0x14')](a5_0x4691('0xf'),{'msg':a5_0x4691('0x45')});return _0x5c7e2f[a5_0x4691('0x5')](a5_0x4691('0x4b'));}_0x343b20[a5_0x4691('0xb')]=_0x26444e['body'][a5_0x4691('0xb')];_0x343b20[a5_0x4691('0x4e')]=undefined;_0x343b20[a5_0x4691('0x4d')]=undefined;_0x343b20[a5_0x4691('0x26')](_0xb87fa1=>{if(_0xb87fa1){return _0x3355bf(_0xb87fa1);}_0x26444e[a5_0x4691('0x27')](_0x343b20,_0xb87fa1=>{_0x536048(_0xb87fa1,_0x343b20);});});});},function sendResetPasswordEmail(_0x50b037,_0x2e505a){const _0x46829c=nodemailer_1[a5_0x4691('0x11')][a5_0x4691('0x4f')]({'service':a5_0x4691('0x50'),'auth':{'user':process['env'][a5_0x4691('0x51')],'pass':process['env'][a5_0x4691('0x52')]}});const _0x2305dd={'to':_0x50b037[a5_0x4691('0x1d')],'from':a5_0x4691('0x53'),'subject':a5_0x4691('0x54'),'text':'Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20'+_0x50b037[a5_0x4691('0x1d')]+a5_0x4691('0x55')};_0x46829c[a5_0x4691('0x56')](_0x2305dd,_0x45bd1c=>{_0x26444e['flash']('success',{'msg':a5_0x4691('0x57')});_0x2e505a(_0x45bd1c);});}],_0x4bc83e=>{if(_0x4bc83e){return _0x3355bf(_0x4bc83e);}_0x5c7e2f[a5_0x4691('0x5')]('/');});};exports[a5_0x4691('0x58')]=(_0x4962d4,_0x2283af)=>{if(_0x4962d4[a5_0x4691('0x41')]()){return _0x2283af['redirect']('/');}_0x2283af[a5_0x4691('0x6')](a5_0x4691('0x59'),{'title':a5_0x4691('0x5a')});};exports[a5_0x4691('0x5b')]=(_0x836e5d,_0x30260f,_0x44b777)=>{_0x836e5d[a5_0x4691('0x8')]('email',a5_0x4691('0x2b'))[a5_0x4691('0xa')]();_0x836e5d[a5_0x4691('0xd')](a5_0x4691('0x1d'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x1bc0fb=_0x836e5d['validationErrors']();if(_0x1bc0fb){_0x836e5d[a5_0x4691('0x14')](a5_0x4691('0xf'),_0x1bc0fb);return _0x30260f[a5_0x4691('0x5')](a5_0x4691('0x5c'));}async_1['default']['waterfall']([function createRandomToken(_0x23be4d){crypto_1[a5_0x4691('0x11')][a5_0x4691('0x5d')](0x10,(_0x548fa1,_0x478d04)=>{const _0x11a801=_0x478d04[a5_0x4691('0x5e')](a5_0x4691('0x5f'));_0x23be4d(_0x548fa1,_0x11a801);});},function setRandomToken(_0x197a30,_0x1de091){User_1[a5_0x4691('0x11')][a5_0x4691('0x24')]({'email':_0x836e5d[a5_0x4691('0x21')][a5_0x4691('0x1d')]},(_0x3d089c,_0x4bdb9f)=>{if(_0x3d089c){return _0x1de091(_0x3d089c);}if(!_0x4bdb9f){_0x836e5d[a5_0x4691('0x14')](a5_0x4691('0xf'),{'msg':a5_0x4691('0x60')});return _0x30260f['redirect'](a5_0x4691('0x5c'));}_0x4bdb9f['passwordResetToken']=_0x197a30;_0x4bdb9f[a5_0x4691('0x4d')]=Date[a5_0x4691('0x43')]()+0x36ee80;_0x4bdb9f['save'](_0x3d089c=>{_0x1de091(_0x3d089c,_0x197a30,_0x4bdb9f);});});},function sendForgotPasswordEmail(_0x5e973c,_0x2c2e5d,_0x88c069){const _0x1c7f45=nodemailer_1[a5_0x4691('0x11')]['createTransport']({'service':a5_0x4691('0x50'),'auth':{'user':process['env'][a5_0x4691('0x51')],'pass':process[a5_0x4691('0x61')][a5_0x4691('0x52')]}});const _0x979e66={'to':_0x2c2e5d['email'],'from':a5_0x4691('0x62'),'subject':a5_0x4691('0x63'),'text':a5_0x4691('0x64')+_0x836e5d['headers'][a5_0x4691('0x65')]+a5_0x4691('0x66')+_0x5e973c+a5_0x4691('0x67')};_0x1c7f45[a5_0x4691('0x56')](_0x979e66,_0x33e2ad=>{_0x836e5d[a5_0x4691('0x14')](a5_0x4691('0x68'),{'msg':'An\x20e-mail\x20has\x20been\x20sent\x20to\x20'+_0x2c2e5d[a5_0x4691('0x1d')]+'\x20with\x20further\x20instructions.'});_0x88c069(_0x33e2ad);});}],_0x5179ae=>{if(_0x5179ae){return _0x44b777(_0x5179ae);}_0x30260f[a5_0x4691('0x5')](a5_0x4691('0x5c'));});};
var a5_0x3ade=['account/reset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','Passwords\x20must\x20match.','back','where','passwordResetExpires','passwordResetToken','SendGrid','env','SENDGRID_PASSWORD','express-ts@starter.com','Your\x20password\x20has\x20been\x20changed','Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20','\x20has\x20just\x20been\x20changed.\x0a','sendMail','getForgot','postForgot','/forgot','randomBytes','hex','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','createTransport','SENDGRID_USER','hackathon@starter.com','headers','host','/reset/','\x20with\x20further\x20instructions.','__importDefault','__esModule','async','passport','../models/User','express-validator','getLogin','user','redirect','render','Login','postLogin','assert','email','Email\x20is\x20not\x20valid','isEmail','password','Password\x20cannot\x20be\x20blank','notEmpty','sanitize','validationErrors','flash','/login','default','authenticate','errors','Success!\x20You\x20are\x20logged\x20in.','session','returnTo','logout','getSignup','account/signup','Create\x20Account','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','len','Passwords\x20do\x20not\x20match','equals','body','/signup','findOne','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','save','logIn','getAccount','postUpdateProfile','Please\x20enter\x20a\x20valid\x20email\x20address.','/account','profile','name','gender','location','website','code','success','Profile\x20information\x20has\x20been\x20updated.','postUpdatePassword','findById','Password\x20has\x20been\x20changed.','postDeleteAccount','remove','info','Your\x20account\x20has\x20been\x20deleted.','provider','tokens','filter','kind','getReset','isAuthenticated','params','token','exec','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'];(function(_0x4e17a1,_0xa7a136){var _0x5a3a66=function(_0x17b172){while(--_0x17b172){_0x4e17a1['push'](_0x4e17a1['shift']());}};_0x5a3a66(++_0xa7a136);}(a5_0x3ade,0xe4));var a5_0x105d=function(_0x3c95e0,_0xa3fb27){_0x3c95e0=_0x3c95e0-0x0;var _0x261f01=a5_0x3ade[_0x3c95e0];return _0x261f01;};'use strict';var __importDefault=this&&this[a5_0x105d('0x0')]||function(_0x58fdcf){return _0x58fdcf&&_0x58fdcf[a5_0x105d('0x1')]?_0x58fdcf:{'default':_0x58fdcf};};Object['defineProperty'](exports,a5_0x105d('0x1'),{'value':!![]});const async_1=__importDefault(require(a5_0x105d('0x2')));const crypto_1=__importDefault(require('crypto'));const nodemailer_1=__importDefault(require('nodemailer'));const passport_1=__importDefault(require(a5_0x105d('0x3')));const User_1=__importDefault(require(a5_0x105d('0x4')));const request=require(a5_0x105d('0x5'));exports[a5_0x105d('0x6')]=(_0x9a1e06,_0x29a20b)=>{if(_0x9a1e06[a5_0x105d('0x7')]){return _0x29a20b[a5_0x105d('0x8')]('/');}_0x29a20b[a5_0x105d('0x9')]('account/login',{'title':a5_0x105d('0xa')});};exports[a5_0x105d('0xb')]=(_0x1e3661,_0x34bcaf,_0x179e60)=>{_0x1e3661[a5_0x105d('0xc')](a5_0x105d('0xd'),a5_0x105d('0xe'))[a5_0x105d('0xf')]();_0x1e3661[a5_0x105d('0xc')](a5_0x105d('0x10'),a5_0x105d('0x11'))[a5_0x105d('0x12')]();_0x1e3661[a5_0x105d('0x13')]('email')['normalizeEmail']({'gmail_remove_dots':![]});const _0x4d6fc9=_0x1e3661[a5_0x105d('0x14')]();if(_0x4d6fc9){_0x1e3661[a5_0x105d('0x15')]('errors',_0x4d6fc9);return _0x34bcaf[a5_0x105d('0x8')](a5_0x105d('0x16'));}passport_1[a5_0x105d('0x17')][a5_0x105d('0x18')]('local',(_0x4bb3ca,_0xec301d,_0x1ba610)=>{if(_0x4bb3ca){return _0x179e60(_0x4bb3ca);}if(!_0xec301d){_0x1e3661[a5_0x105d('0x15')](a5_0x105d('0x19'),_0x1ba610['message']);return _0x34bcaf[a5_0x105d('0x8')]('/login');}_0x1e3661['logIn'](_0xec301d,_0x4bb3ca=>{if(_0x4bb3ca){return _0x179e60(_0x4bb3ca);}_0x1e3661[a5_0x105d('0x15')]('success',{'msg':a5_0x105d('0x1a')});_0x34bcaf[a5_0x105d('0x8')](_0x1e3661[a5_0x105d('0x1b')][a5_0x105d('0x1c')]||'/');});})(_0x1e3661,_0x34bcaf,_0x179e60);};exports[a5_0x105d('0x1d')]=(_0x44320d,_0x1de1e5)=>{_0x44320d['logout']();_0x1de1e5[a5_0x105d('0x8')]('/');};exports[a5_0x105d('0x1e')]=(_0x2a1865,_0x581d78)=>{if(_0x2a1865[a5_0x105d('0x7')]){return _0x581d78[a5_0x105d('0x8')]('/');}_0x581d78[a5_0x105d('0x9')](a5_0x105d('0x1f'),{'title':a5_0x105d('0x20')});};exports['postSignup']=(_0x203301,_0x11c34f,_0x4939e4)=>{_0x203301[a5_0x105d('0xc')](a5_0x105d('0xd'),a5_0x105d('0xe'))[a5_0x105d('0xf')]();_0x203301[a5_0x105d('0xc')](a5_0x105d('0x10'),a5_0x105d('0x21'))[a5_0x105d('0x22')]({'min':0x4});_0x203301[a5_0x105d('0xc')]('confirmPassword',a5_0x105d('0x23'))[a5_0x105d('0x24')](_0x203301[a5_0x105d('0x25')]['password']);_0x203301[a5_0x105d('0x13')](a5_0x105d('0xd'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x3c3774=_0x203301[a5_0x105d('0x14')]();if(_0x3c3774){_0x203301['flash'](a5_0x105d('0x19'),_0x3c3774);return _0x11c34f[a5_0x105d('0x8')](a5_0x105d('0x26'));}const _0x21ca98=new User_1['default']({'email':_0x203301[a5_0x105d('0x25')][a5_0x105d('0xd')],'password':_0x203301[a5_0x105d('0x25')][a5_0x105d('0x10')]});User_1[a5_0x105d('0x17')][a5_0x105d('0x27')]({'email':_0x203301[a5_0x105d('0x25')][a5_0x105d('0xd')]},(_0x23c09c,_0x56f839)=>{if(_0x23c09c){return _0x4939e4(_0x23c09c);}if(_0x56f839){_0x203301['flash'](a5_0x105d('0x19'),{'msg':a5_0x105d('0x28')});return _0x11c34f[a5_0x105d('0x8')]('/signup');}_0x21ca98[a5_0x105d('0x29')](_0x23c09c=>{if(_0x23c09c){return _0x4939e4(_0x23c09c);}_0x203301[a5_0x105d('0x2a')](_0x21ca98,_0x23c09c=>{if(_0x23c09c){return _0x4939e4(_0x23c09c);}_0x11c34f[a5_0x105d('0x8')]('/');});});});};exports[a5_0x105d('0x2b')]=(_0x313884,_0x3760ad)=>{_0x3760ad[a5_0x105d('0x9')]('account/profile',{'title':'Account\x20Management'});};exports[a5_0x105d('0x2c')]=(_0x1acbea,_0x147ed2,_0xd76c56)=>{_0x1acbea['assert']('email',a5_0x105d('0x2d'))['isEmail']();_0x1acbea[a5_0x105d('0x13')](a5_0x105d('0xd'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x4729ff=_0x1acbea[a5_0x105d('0x14')]();if(_0x4729ff){_0x1acbea[a5_0x105d('0x15')](a5_0x105d('0x19'),_0x4729ff);return _0x147ed2[a5_0x105d('0x8')](a5_0x105d('0x2e'));}User_1[a5_0x105d('0x17')]['findById'](_0x1acbea[a5_0x105d('0x7')]['id'],(_0x44ce2e,_0x5506ed)=>{if(_0x44ce2e){return _0xd76c56(_0x44ce2e);}_0x5506ed[a5_0x105d('0xd')]=_0x1acbea[a5_0x105d('0x25')]['email']||'';_0x5506ed[a5_0x105d('0x2f')][a5_0x105d('0x30')]=_0x1acbea['body'][a5_0x105d('0x30')]||'';_0x5506ed[a5_0x105d('0x2f')][a5_0x105d('0x31')]=_0x1acbea[a5_0x105d('0x25')]['gender']||'';_0x5506ed[a5_0x105d('0x2f')][a5_0x105d('0x32')]=_0x1acbea[a5_0x105d('0x25')][a5_0x105d('0x32')]||'';_0x5506ed[a5_0x105d('0x2f')]['website']=_0x1acbea[a5_0x105d('0x25')][a5_0x105d('0x33')]||'';_0x5506ed[a5_0x105d('0x29')](_0x44ce2e=>{if(_0x44ce2e){if(_0x44ce2e[a5_0x105d('0x34')]===0x2af8){_0x1acbea['flash'](a5_0x105d('0x19'),{'msg':'The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.'});return _0x147ed2[a5_0x105d('0x8')](a5_0x105d('0x2e'));}return _0xd76c56(_0x44ce2e);}_0x1acbea[a5_0x105d('0x15')](a5_0x105d('0x35'),{'msg':a5_0x105d('0x36')});_0x147ed2['redirect'](a5_0x105d('0x2e'));});});};exports[a5_0x105d('0x37')]=(_0x1f325b,_0x4e8ff9,_0x1e8e71)=>{_0x1f325b[a5_0x105d('0xc')](a5_0x105d('0x10'),a5_0x105d('0x21'))[a5_0x105d('0x22')]({'min':0x4});_0x1f325b[a5_0x105d('0xc')]('confirmPassword','Passwords\x20do\x20not\x20match')['equals'](_0x1f325b[a5_0x105d('0x25')][a5_0x105d('0x10')]);const _0x24802d=_0x1f325b['validationErrors']();if(_0x24802d){_0x1f325b['flash']('errors',_0x24802d);return _0x4e8ff9[a5_0x105d('0x8')](a5_0x105d('0x2e'));}User_1[a5_0x105d('0x17')][a5_0x105d('0x38')](_0x1f325b[a5_0x105d('0x7')]['id'],(_0xa64425,_0x2c8ba2)=>{if(_0xa64425){return _0x1e8e71(_0xa64425);}_0x2c8ba2[a5_0x105d('0x10')]=_0x1f325b[a5_0x105d('0x25')][a5_0x105d('0x10')];_0x2c8ba2[a5_0x105d('0x29')](_0xa64425=>{if(_0xa64425){return _0x1e8e71(_0xa64425);}_0x1f325b['flash'](a5_0x105d('0x35'),{'msg':a5_0x105d('0x39')});_0x4e8ff9[a5_0x105d('0x8')](a5_0x105d('0x2e'));});});};exports[a5_0x105d('0x3a')]=(_0x29c6a5,_0x33b48e,_0x307ecc)=>{User_1[a5_0x105d('0x17')][a5_0x105d('0x3b')]({'_id':_0x29c6a5[a5_0x105d('0x7')]['id']},_0x296af9=>{if(_0x296af9){return _0x307ecc(_0x296af9);}_0x29c6a5[a5_0x105d('0x1d')]();_0x29c6a5[a5_0x105d('0x15')](a5_0x105d('0x3c'),{'msg':a5_0x105d('0x3d')});_0x33b48e[a5_0x105d('0x8')]('/');});};exports['getOauthUnlink']=(_0x7588fd,_0x3989f8,_0x4c46a5)=>{const _0x2d3fd7=_0x7588fd['params'][a5_0x105d('0x3e')];User_1[a5_0x105d('0x17')][a5_0x105d('0x38')](_0x7588fd[a5_0x105d('0x7')]['id'],(_0x56c8c0,_0x48697a)=>{if(_0x56c8c0){return _0x4c46a5(_0x56c8c0);}_0x48697a[_0x2d3fd7]=undefined;_0x48697a['tokens']=_0x48697a[a5_0x105d('0x3f')][a5_0x105d('0x40')](_0x20fcab=>_0x20fcab[a5_0x105d('0x41')]!==_0x2d3fd7);_0x48697a['save'](_0x56c8c0=>{if(_0x56c8c0){return _0x4c46a5(_0x56c8c0);}_0x7588fd[a5_0x105d('0x15')](a5_0x105d('0x3c'),{'msg':_0x2d3fd7+'\x20account\x20has\x20been\x20unlinked.'});_0x3989f8[a5_0x105d('0x8')](a5_0x105d('0x2e'));});});};exports[a5_0x105d('0x42')]=(_0x356d00,_0x372079,_0x4af270)=>{if(_0x356d00[a5_0x105d('0x43')]()){return _0x372079[a5_0x105d('0x8')]('/');}User_1[a5_0x105d('0x17')][a5_0x105d('0x27')]({'passwordResetToken':_0x356d00[a5_0x105d('0x44')][a5_0x105d('0x45')]})['where']('passwordResetExpires')['gt'](Date['now']())[a5_0x105d('0x46')]((_0x9ddcd4,_0x5ecbf2)=>{if(_0x9ddcd4){return _0x4af270(_0x9ddcd4);}if(!_0x5ecbf2){_0x356d00['flash'](a5_0x105d('0x19'),{'msg':a5_0x105d('0x47')});return _0x372079[a5_0x105d('0x8')]('/forgot');}_0x372079[a5_0x105d('0x9')](a5_0x105d('0x48'),{'title':'Password\x20Reset'});});};exports['postReset']=(_0xfc4b7b,_0x51f636,_0x222354)=>{_0xfc4b7b[a5_0x105d('0xc')]('password',a5_0x105d('0x49'))['len']({'min':0x4});_0xfc4b7b[a5_0x105d('0xc')]('confirm',a5_0x105d('0x4a'))[a5_0x105d('0x24')](_0xfc4b7b[a5_0x105d('0x25')]['password']);const _0x235b06=_0xfc4b7b[a5_0x105d('0x14')]();if(_0x235b06){_0xfc4b7b[a5_0x105d('0x15')](a5_0x105d('0x19'),_0x235b06);return _0x51f636[a5_0x105d('0x8')](a5_0x105d('0x4b'));}async_1[a5_0x105d('0x17')]['waterfall']([function resetPassword(_0x31964d){User_1[a5_0x105d('0x17')]['findOne']({'passwordResetToken':_0xfc4b7b[a5_0x105d('0x44')][a5_0x105d('0x45')]})[a5_0x105d('0x4c')](a5_0x105d('0x4d'))['gt'](Date['now']())[a5_0x105d('0x46')]((_0x51dd1b,_0x1c1001)=>{if(_0x51dd1b){return _0x222354(_0x51dd1b);}if(!_0x1c1001){_0xfc4b7b[a5_0x105d('0x15')](a5_0x105d('0x19'),{'msg':a5_0x105d('0x47')});return _0x51f636[a5_0x105d('0x8')](a5_0x105d('0x4b'));}_0x1c1001[a5_0x105d('0x10')]=_0xfc4b7b['body'][a5_0x105d('0x10')];_0x1c1001[a5_0x105d('0x4e')]=undefined;_0x1c1001['passwordResetExpires']=undefined;_0x1c1001[a5_0x105d('0x29')](_0x51dd1b=>{if(_0x51dd1b){return _0x222354(_0x51dd1b);}_0xfc4b7b['logIn'](_0x1c1001,_0x51dd1b=>{_0x31964d(_0x51dd1b,_0x1c1001);});});});},function sendResetPasswordEmail(_0x375d6f,_0x98be70){const _0xfef0e9=nodemailer_1[a5_0x105d('0x17')]['createTransport']({'service':a5_0x105d('0x4f'),'auth':{'user':process[a5_0x105d('0x50')]['SENDGRID_USER'],'pass':process[a5_0x105d('0x50')][a5_0x105d('0x51')]}});const _0x5aa1f0={'to':_0x375d6f[a5_0x105d('0xd')],'from':a5_0x105d('0x52'),'subject':a5_0x105d('0x53'),'text':a5_0x105d('0x54')+_0x375d6f[a5_0x105d('0xd')]+a5_0x105d('0x55')};_0xfef0e9[a5_0x105d('0x56')](_0x5aa1f0,_0x5c28de=>{_0xfc4b7b[a5_0x105d('0x15')](a5_0x105d('0x35'),{'msg':'Success!\x20Your\x20password\x20has\x20been\x20changed.'});_0x98be70(_0x5c28de);});}],_0x58d193=>{if(_0x58d193){return _0x222354(_0x58d193);}_0x51f636['redirect']('/');});};exports[a5_0x105d('0x57')]=(_0x4c7307,_0x42f762)=>{if(_0x4c7307['isAuthenticated']()){return _0x42f762[a5_0x105d('0x8')]('/');}_0x42f762[a5_0x105d('0x9')]('account/forgot',{'title':'Forgot\x20Password'});};exports[a5_0x105d('0x58')]=(_0x19b9cd,_0x6c594a,_0x1ab5aa)=>{_0x19b9cd['assert'](a5_0x105d('0xd'),a5_0x105d('0x2d'))[a5_0x105d('0xf')]();_0x19b9cd[a5_0x105d('0x13')]('email')['normalizeEmail']({'gmail_remove_dots':![]});const _0x48a661=_0x19b9cd['validationErrors']();if(_0x48a661){_0x19b9cd[a5_0x105d('0x15')](a5_0x105d('0x19'),_0x48a661);return _0x6c594a['redirect'](a5_0x105d('0x59'));}async_1[a5_0x105d('0x17')]['waterfall']([function createRandomToken(_0x2844b4){crypto_1['default'][a5_0x105d('0x5a')](0x10,(_0x325ccd,_0x1af6a8)=>{const _0x419b47=_0x1af6a8['toString'](a5_0x105d('0x5b'));_0x2844b4(_0x325ccd,_0x419b47);});},function setRandomToken(_0x3b6232,_0x4ec509){User_1['default']['findOne']({'email':_0x19b9cd[a5_0x105d('0x25')][a5_0x105d('0xd')]},(_0x24e2cc,_0x4c32d2)=>{if(_0x24e2cc){return _0x4ec509(_0x24e2cc);}if(!_0x4c32d2){_0x19b9cd[a5_0x105d('0x15')](a5_0x105d('0x19'),{'msg':a5_0x105d('0x5c')});return _0x6c594a[a5_0x105d('0x8')](a5_0x105d('0x59'));}_0x4c32d2[a5_0x105d('0x4e')]=_0x3b6232;_0x4c32d2[a5_0x105d('0x4d')]=Date['now']()+0x36ee80;_0x4c32d2['save'](_0x24e2cc=>{_0x4ec509(_0x24e2cc,_0x3b6232,_0x4c32d2);});});},function sendForgotPasswordEmail(_0x5602d7,_0x3c7756,_0x1a9da4){const _0x2a30be=nodemailer_1['default'][a5_0x105d('0x5d')]({'service':a5_0x105d('0x4f'),'auth':{'user':process['env'][a5_0x105d('0x5e')],'pass':process[a5_0x105d('0x50')][a5_0x105d('0x51')]}});const _0x174142={'to':_0x3c7756[a5_0x105d('0xd')],'from':a5_0x105d('0x5f'),'subject':'Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','text':'You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://'+_0x19b9cd[a5_0x105d('0x60')][a5_0x105d('0x61')]+a5_0x105d('0x62')+_0x5602d7+'\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a'};_0x2a30be['sendMail'](_0x174142,_0x4c05b4=>{_0x19b9cd[a5_0x105d('0x15')](a5_0x105d('0x3c'),{'msg':'An\x20e-mail\x20has\x20been\x20sent\x20to\x20'+_0x3c7756['email']+a5_0x105d('0x63')});_0x1a9da4(_0x4c05b4);});}],_0x3e42c2=>{if(_0x3e42c2){return _0x1ab5aa(_0x3e42c2);}_0x6c594a['redirect'](a5_0x105d('0x59'));});};
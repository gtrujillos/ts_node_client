var a5_0x2364=['confirmPassword','equals','body','sanitize','/signup','findOne','save','getAccount','account/profile','Account\x20Management','postUpdateProfile','/account','findById','profile','name','gender','location','website','code','Password\x20has\x20been\x20changed.','postDeleteAccount','remove','info','getOauthUnlink','tokens','filter','kind','\x20account\x20has\x20been\x20unlinked.','getReset','isAuthenticated','params','where','passwordResetExpires','now','exec','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','/forgot','Password\x20Reset','postReset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','confirm','Passwords\x20must\x20match.','back','waterfall','token','passwordResetToken','createTransport','SendGrid','env','SENDGRID_PASSWORD','express-ts@starter.com','Your\x20password\x20has\x20been\x20changed','Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20','\x20has\x20just\x20been\x20changed.\x0a','account/forgot','postForgot','Please\x20enter\x20a\x20valid\x20email\x20address.','randomBytes','hex','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','hackathon@starter.com','headers','host','/reset/','sendMail','An\x20e-mail\x20has\x20been\x20sent\x20to\x20','\x20with\x20further\x20instructions.','__importDefault','__esModule','async','crypto','passport','../models/User','express-validator','getLogin','render','Login','postLogin','Email\x20is\x20not\x20valid','isEmail','assert','password','notEmpty','email','normalizeEmail','validationErrors','flash','redirect','default','local','errors','message','/login','logIn','success','Success!\x20You\x20are\x20logged\x20in.','session','logout','user','account/signup','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','len'];(function(_0x403cfa,_0x316ea5){var _0x46b9ad=function(_0x97d590){while(--_0x97d590){_0x403cfa['push'](_0x403cfa['shift']());}};_0x46b9ad(++_0x316ea5);}(a5_0x2364,0x10f));var a5_0x464e=function(_0x52eb20,_0x5137e2){_0x52eb20=_0x52eb20-0x0;var _0x27e799=a5_0x2364[_0x52eb20];return _0x27e799;};'use strict';var __importDefault=this&&this[a5_0x464e('0x0')]||function(_0x50e524){return _0x50e524&&_0x50e524[a5_0x464e('0x1')]?_0x50e524:{'default':_0x50e524};};Object['defineProperty'](exports,a5_0x464e('0x1'),{'value':!![]});const async_1=__importDefault(require(a5_0x464e('0x2')));const crypto_1=__importDefault(require(a5_0x464e('0x3')));const nodemailer_1=__importDefault(require('nodemailer'));const passport_1=__importDefault(require(a5_0x464e('0x4')));const User_1=__importDefault(require(a5_0x464e('0x5')));const request=require(a5_0x464e('0x6'));exports[a5_0x464e('0x7')]=(_0x19f4a8,_0x24291b)=>{if(_0x19f4a8['user']){return _0x24291b['redirect']('/');}_0x24291b[a5_0x464e('0x8')]('account/login',{'title':a5_0x464e('0x9')});};exports[a5_0x464e('0xa')]=(_0x2c71ba,_0x4a0147,_0xa3311)=>{_0x2c71ba['assert']('email',a5_0x464e('0xb'))[a5_0x464e('0xc')]();_0x2c71ba[a5_0x464e('0xd')](a5_0x464e('0xe'),'Password\x20cannot\x20be\x20blank')[a5_0x464e('0xf')]();_0x2c71ba['sanitize'](a5_0x464e('0x10'))[a5_0x464e('0x11')]({'gmail_remove_dots':![]});const _0x495fca=_0x2c71ba[a5_0x464e('0x12')]();if(_0x495fca){_0x2c71ba[a5_0x464e('0x13')]('errors',_0x495fca);return _0x4a0147[a5_0x464e('0x14')]('/login');}passport_1[a5_0x464e('0x15')]['authenticate'](a5_0x464e('0x16'),(_0x593cba,_0x2f8bf8,_0x48077a)=>{if(_0x593cba){return _0xa3311(_0x593cba);}if(!_0x2f8bf8){_0x2c71ba[a5_0x464e('0x13')](a5_0x464e('0x17'),_0x48077a[a5_0x464e('0x18')]);return _0x4a0147['redirect'](a5_0x464e('0x19'));}_0x2c71ba[a5_0x464e('0x1a')](_0x2f8bf8,_0x593cba=>{if(_0x593cba){return _0xa3311(_0x593cba);}_0x2c71ba[a5_0x464e('0x13')](a5_0x464e('0x1b'),{'msg':a5_0x464e('0x1c')});_0x4a0147['redirect'](_0x2c71ba[a5_0x464e('0x1d')]['returnTo']||'/');});})(_0x2c71ba,_0x4a0147,_0xa3311);};exports[a5_0x464e('0x1e')]=(_0x3c2206,_0x348fda)=>{_0x3c2206['logout']();_0x348fda['redirect']('/');};exports['getSignup']=(_0x52e5bb,_0x2ad2d7)=>{if(_0x52e5bb[a5_0x464e('0x1f')]){return _0x2ad2d7[a5_0x464e('0x14')]('/');}_0x2ad2d7[a5_0x464e('0x8')](a5_0x464e('0x20'),{'title':'Create\x20Account'});};exports['postSignup']=(_0xf46674,_0x1c65f6,_0x5318c2)=>{_0xf46674[a5_0x464e('0xd')](a5_0x464e('0x10'),'Email\x20is\x20not\x20valid')[a5_0x464e('0xc')]();_0xf46674[a5_0x464e('0xd')](a5_0x464e('0xe'),a5_0x464e('0x21'))[a5_0x464e('0x22')]({'min':0x4});_0xf46674['assert'](a5_0x464e('0x23'),'Passwords\x20do\x20not\x20match')[a5_0x464e('0x24')](_0xf46674[a5_0x464e('0x25')][a5_0x464e('0xe')]);_0xf46674[a5_0x464e('0x26')](a5_0x464e('0x10'))[a5_0x464e('0x11')]({'gmail_remove_dots':![]});const _0x40117a=_0xf46674[a5_0x464e('0x12')]();if(_0x40117a){_0xf46674[a5_0x464e('0x13')](a5_0x464e('0x17'),_0x40117a);return _0x1c65f6[a5_0x464e('0x14')](a5_0x464e('0x27'));}const _0xd89a9e=new User_1[(a5_0x464e('0x15'))]({});User_1[a5_0x464e('0x15')][a5_0x464e('0x28')]({'email':_0xf46674[a5_0x464e('0x25')][a5_0x464e('0x10')]},(_0x4c1df6,_0x2290a7)=>{if(_0x4c1df6){return _0x5318c2(_0x4c1df6);}if(_0x2290a7){_0xf46674[a5_0x464e('0x13')](a5_0x464e('0x17'),{'msg':'Account\x20with\x20that\x20email\x20address\x20already\x20exists.'});return _0x1c65f6[a5_0x464e('0x14')](a5_0x464e('0x27'));}_0xd89a9e[a5_0x464e('0x29')](_0x4c1df6=>{if(_0x4c1df6){return _0x5318c2(_0x4c1df6);}_0xf46674[a5_0x464e('0x1a')](_0xd89a9e,_0x4c1df6=>{if(_0x4c1df6){return _0x5318c2(_0x4c1df6);}_0x1c65f6['redirect']('/');});});});};exports[a5_0x464e('0x2a')]=(_0x1c8621,_0x199c86)=>{_0x199c86[a5_0x464e('0x8')](a5_0x464e('0x2b'),{'title':a5_0x464e('0x2c')});};exports[a5_0x464e('0x2d')]=(_0x12b86a,_0x5d322b,_0x614b0e)=>{_0x12b86a[a5_0x464e('0xd')](a5_0x464e('0x10'),'Please\x20enter\x20a\x20valid\x20email\x20address.')[a5_0x464e('0xc')]();_0x12b86a[a5_0x464e('0x26')]('email')[a5_0x464e('0x11')]({'gmail_remove_dots':![]});const _0x21577d=_0x12b86a[a5_0x464e('0x12')]();if(_0x21577d){_0x12b86a['flash']('errors',_0x21577d);return _0x5d322b['redirect'](a5_0x464e('0x2e'));}User_1[a5_0x464e('0x15')][a5_0x464e('0x2f')](_0x12b86a[a5_0x464e('0x1f')]['id'],(_0x574330,_0x43a233)=>{if(_0x574330){return _0x614b0e(_0x574330);}_0x43a233[a5_0x464e('0x10')]=_0x12b86a['body'][a5_0x464e('0x10')]||'';_0x43a233[a5_0x464e('0x30')][a5_0x464e('0x31')]=_0x12b86a[a5_0x464e('0x25')][a5_0x464e('0x31')]||'';_0x43a233['profile'][a5_0x464e('0x32')]=_0x12b86a['body'][a5_0x464e('0x32')]||'';_0x43a233[a5_0x464e('0x30')]['location']=_0x12b86a[a5_0x464e('0x25')][a5_0x464e('0x33')]||'';_0x43a233['profile'][a5_0x464e('0x34')]=_0x12b86a[a5_0x464e('0x25')][a5_0x464e('0x34')]||'';_0x43a233['save'](_0x574330=>{if(_0x574330){if(_0x574330[a5_0x464e('0x35')]===0x2af8){_0x12b86a[a5_0x464e('0x13')](a5_0x464e('0x17'),{'msg':'The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.'});return _0x5d322b[a5_0x464e('0x14')](a5_0x464e('0x2e'));}return _0x614b0e(_0x574330);}_0x12b86a[a5_0x464e('0x13')]('success',{'msg':'Profile\x20information\x20has\x20been\x20updated.'});_0x5d322b[a5_0x464e('0x14')](a5_0x464e('0x2e'));});});};exports['postUpdatePassword']=(_0x1acbe5,_0x48bdd4,_0x3ebe8b)=>{_0x1acbe5[a5_0x464e('0xd')](a5_0x464e('0xe'),a5_0x464e('0x21'))[a5_0x464e('0x22')]({'min':0x4});_0x1acbe5['assert'](a5_0x464e('0x23'),'Passwords\x20do\x20not\x20match')[a5_0x464e('0x24')](_0x1acbe5[a5_0x464e('0x25')][a5_0x464e('0xe')]);const _0x2fa90c=_0x1acbe5[a5_0x464e('0x12')]();if(_0x2fa90c){_0x1acbe5[a5_0x464e('0x13')](a5_0x464e('0x17'),_0x2fa90c);return _0x48bdd4['redirect']('/account');}User_1[a5_0x464e('0x15')]['findById'](_0x1acbe5['user']['id'],(_0x1e0868,_0x58c718)=>{if(_0x1e0868){return _0x3ebe8b(_0x1e0868);}_0x58c718[a5_0x464e('0xe')]=_0x1acbe5['body'][a5_0x464e('0xe')];_0x58c718[a5_0x464e('0x29')](_0x1e0868=>{if(_0x1e0868){return _0x3ebe8b(_0x1e0868);}_0x1acbe5[a5_0x464e('0x13')](a5_0x464e('0x1b'),{'msg':a5_0x464e('0x36')});_0x48bdd4[a5_0x464e('0x14')](a5_0x464e('0x2e'));});});};exports[a5_0x464e('0x37')]=(_0x25c0a2,_0x205dfe,_0x381632)=>{User_1['default'][a5_0x464e('0x38')]({'_id':_0x25c0a2[a5_0x464e('0x1f')]['id']},_0x2ca163=>{if(_0x2ca163){return _0x381632(_0x2ca163);}_0x25c0a2[a5_0x464e('0x1e')]();_0x25c0a2[a5_0x464e('0x13')](a5_0x464e('0x39'),{'msg':'Your\x20account\x20has\x20been\x20deleted.'});_0x205dfe[a5_0x464e('0x14')]('/');});};exports[a5_0x464e('0x3a')]=(_0x256853,_0x140934,_0x425840)=>{const _0x195ec9=_0x256853['params']['provider'];User_1[a5_0x464e('0x15')][a5_0x464e('0x2f')](_0x256853[a5_0x464e('0x1f')]['id'],(_0x5127f4,_0x16fc65)=>{if(_0x5127f4){return _0x425840(_0x5127f4);}_0x16fc65[_0x195ec9]=undefined;_0x16fc65['tokens']=_0x16fc65[a5_0x464e('0x3b')][a5_0x464e('0x3c')](_0x492e70=>_0x492e70[a5_0x464e('0x3d')]!==_0x195ec9);_0x16fc65[a5_0x464e('0x29')](_0x5127f4=>{if(_0x5127f4){return _0x425840(_0x5127f4);}_0x256853['flash'](a5_0x464e('0x39'),{'msg':_0x195ec9+a5_0x464e('0x3e')});_0x140934[a5_0x464e('0x14')]('/account');});});};exports[a5_0x464e('0x3f')]=(_0x3f2151,_0x34fa7a,_0x11bb6b)=>{if(_0x3f2151[a5_0x464e('0x40')]()){return _0x34fa7a['redirect']('/');}User_1['default'][a5_0x464e('0x28')]({'passwordResetToken':_0x3f2151[a5_0x464e('0x41')]['token']})[a5_0x464e('0x42')](a5_0x464e('0x43'))['gt'](Date[a5_0x464e('0x44')]())[a5_0x464e('0x45')]((_0x42e23f,_0x8bef2c)=>{if(_0x42e23f){return _0x11bb6b(_0x42e23f);}if(!_0x8bef2c){_0x3f2151['flash'](a5_0x464e('0x17'),{'msg':a5_0x464e('0x46')});return _0x34fa7a[a5_0x464e('0x14')](a5_0x464e('0x47'));}_0x34fa7a[a5_0x464e('0x8')]('account/reset',{'title':a5_0x464e('0x48')});});};exports[a5_0x464e('0x49')]=(_0x2f9111,_0x23a504,_0x5d3059)=>{_0x2f9111['assert'](a5_0x464e('0xe'),a5_0x464e('0x4a'))['len']({'min':0x4});_0x2f9111[a5_0x464e('0xd')](a5_0x464e('0x4b'),a5_0x464e('0x4c'))[a5_0x464e('0x24')](_0x2f9111[a5_0x464e('0x25')][a5_0x464e('0xe')]);const _0x36c517=_0x2f9111[a5_0x464e('0x12')]();if(_0x36c517){_0x2f9111[a5_0x464e('0x13')](a5_0x464e('0x17'),_0x36c517);return _0x23a504[a5_0x464e('0x14')](a5_0x464e('0x4d'));}async_1[a5_0x464e('0x15')][a5_0x464e('0x4e')]([function resetPassword(_0x136430){User_1['default']['findOne']({'passwordResetToken':_0x2f9111[a5_0x464e('0x41')][a5_0x464e('0x4f')]})['where']('passwordResetExpires')['gt'](Date[a5_0x464e('0x44')]())['exec']((_0x175f5b,_0x5c44e5)=>{if(_0x175f5b){return _0x5d3059(_0x175f5b);}if(!_0x5c44e5){_0x2f9111['flash'](a5_0x464e('0x17'),{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x23a504[a5_0x464e('0x14')](a5_0x464e('0x4d'));}_0x5c44e5['password']=_0x2f9111[a5_0x464e('0x25')][a5_0x464e('0xe')];_0x5c44e5[a5_0x464e('0x50')]=undefined;_0x5c44e5[a5_0x464e('0x43')]=undefined;_0x5c44e5[a5_0x464e('0x29')](_0x175f5b=>{if(_0x175f5b){return _0x5d3059(_0x175f5b);}_0x2f9111['logIn'](_0x5c44e5,_0x175f5b=>{_0x136430(_0x175f5b,_0x5c44e5);});});});},function sendResetPasswordEmail(_0x1230c8,_0x12bb0e){const _0x4fc4ad=nodemailer_1[a5_0x464e('0x15')][a5_0x464e('0x51')]({'service':a5_0x464e('0x52'),'auth':{'user':process['env']['SENDGRID_USER'],'pass':process[a5_0x464e('0x53')][a5_0x464e('0x54')]}});const _0x52bf33={'to':_0x1230c8[a5_0x464e('0x10')],'from':a5_0x464e('0x55'),'subject':a5_0x464e('0x56'),'text':a5_0x464e('0x57')+_0x1230c8[a5_0x464e('0x10')]+a5_0x464e('0x58')};_0x4fc4ad['sendMail'](_0x52bf33,_0x2ca57d=>{_0x2f9111[a5_0x464e('0x13')](a5_0x464e('0x1b'),{'msg':'Success!\x20Your\x20password\x20has\x20been\x20changed.'});_0x12bb0e(_0x2ca57d);});}],_0x436531=>{if(_0x436531){return _0x5d3059(_0x436531);}_0x23a504[a5_0x464e('0x14')]('/');});};exports['getForgot']=(_0x2ca5c0,_0x509710)=>{if(_0x2ca5c0[a5_0x464e('0x40')]()){return _0x509710['redirect']('/');}_0x509710[a5_0x464e('0x8')](a5_0x464e('0x59'),{'title':'Forgot\x20Password'});};exports[a5_0x464e('0x5a')]=(_0x14954c,_0x3eb62c,_0x1f54dc)=>{_0x14954c[a5_0x464e('0xd')](a5_0x464e('0x10'),a5_0x464e('0x5b'))[a5_0x464e('0xc')]();_0x14954c[a5_0x464e('0x26')](a5_0x464e('0x10'))[a5_0x464e('0x11')]({'gmail_remove_dots':![]});const _0x34cfb0=_0x14954c[a5_0x464e('0x12')]();if(_0x34cfb0){_0x14954c['flash']('errors',_0x34cfb0);return _0x3eb62c[a5_0x464e('0x14')]('/forgot');}async_1[a5_0x464e('0x15')][a5_0x464e('0x4e')]([function createRandomToken(_0x42689c){crypto_1[a5_0x464e('0x15')][a5_0x464e('0x5c')](0x10,(_0x27c6a7,_0x49219f)=>{const _0x2c39a7=_0x49219f['toString'](a5_0x464e('0x5d'));_0x42689c(_0x27c6a7,_0x2c39a7);});},function setRandomToken(_0x430b0f,_0x1ced18){User_1[a5_0x464e('0x15')][a5_0x464e('0x28')]({'email':_0x14954c['body'][a5_0x464e('0x10')]},(_0x1fa4a9,_0x216d40)=>{if(_0x1fa4a9){return _0x1ced18(_0x1fa4a9);}if(!_0x216d40){_0x14954c[a5_0x464e('0x13')](a5_0x464e('0x17'),{'msg':a5_0x464e('0x5e')});return _0x3eb62c[a5_0x464e('0x14')](a5_0x464e('0x47'));}_0x216d40[a5_0x464e('0x50')]=_0x430b0f;_0x216d40[a5_0x464e('0x43')]=Date['now']()+0x36ee80;_0x216d40['save'](_0x1fa4a9=>{_0x1ced18(_0x1fa4a9,_0x430b0f,_0x216d40);});});},function sendForgotPasswordEmail(_0x807f99,_0x9bfcfb,_0x4b1302){const _0x1be3be=nodemailer_1[a5_0x464e('0x15')][a5_0x464e('0x51')]({'service':'SendGrid','auth':{'user':process[a5_0x464e('0x53')]['SENDGRID_USER'],'pass':process[a5_0x464e('0x53')][a5_0x464e('0x54')]}});const _0x417c06={'to':_0x9bfcfb[a5_0x464e('0x10')],'from':a5_0x464e('0x5f'),'subject':'Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','text':'You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://'+_0x14954c[a5_0x464e('0x60')][a5_0x464e('0x61')]+a5_0x464e('0x62')+_0x807f99+'\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a'};_0x1be3be[a5_0x464e('0x63')](_0x417c06,_0x5dc433=>{_0x14954c['flash'](a5_0x464e('0x39'),{'msg':a5_0x464e('0x64')+_0x9bfcfb[a5_0x464e('0x10')]+a5_0x464e('0x65')});_0x4b1302(_0x5dc433);});}],_0x1c5934=>{if(_0x1c5934){return _0x1f54dc(_0x1c5934);}_0x3eb62c['redirect'](a5_0x464e('0x47'));});};
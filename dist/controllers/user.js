var a5_0x69fa=['SendGrid','SENDGRID_USER','env','SENDGRID_PASSWORD','Your\x20password\x20has\x20been\x20changed','Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20','\x20has\x20just\x20been\x20changed.\x0a','sendMail','account/forgot','Forgot\x20Password','postForgot','waterfall','randomBytes','hex','createTransport','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','headers','host','/reset/','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','An\x20e-mail\x20has\x20been\x20sent\x20to\x20','\x20with\x20further\x20instructions.','/forgot','__importDefault','__esModule','async','crypto','nodemailer','express-validator','getLogin','redirect','render','account/login','assert','Email\x20is\x20not\x20valid','isEmail','password','Password\x20cannot\x20be\x20blank','validationErrors','/login','authenticate','local','errors','message','logIn','flash','success','Success!\x20You\x20are\x20logged\x20in.','session','returnTo','logout','user','account/signup','Create\x20Account','email','len','confirmPassword','Passwords\x20do\x20not\x20match','body','sanitize','normalizeEmail','/signup','default','findOne','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','save','getAccount','account/profile','Account\x20Management','Please\x20enter\x20a\x20valid\x20email\x20address.','/account','findById','name','gender','profile','location','website','code','Profile\x20information\x20has\x20been\x20updated.','postUpdatePassword','Password\x20has\x20been\x20changed.','remove','info','Your\x20account\x20has\x20been\x20deleted.','getOauthUnlink','params','provider','tokens','filter','kind','\x20account\x20has\x20been\x20unlinked.','isAuthenticated','where','passwordResetExpires','now','exec','account/reset','Password\x20Reset','postReset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','Passwords\x20must\x20match.','equals','back','token','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','passwordResetToken'];(function(_0xe53a72,_0x276ca3){var _0x21b0eb=function(_0x4f8623){while(--_0x4f8623){_0xe53a72['push'](_0xe53a72['shift']());}};_0x21b0eb(++_0x276ca3);}(a5_0x69fa,0xee));var a5_0x5bf4=function(_0x458d88,_0x5798e7){_0x458d88=_0x458d88-0x0;var _0x482657=a5_0x69fa[_0x458d88];return _0x482657;};'use strict';var __importDefault=this&&this[a5_0x5bf4('0x0')]||function(_0x261107){return _0x261107&&_0x261107['__esModule']?_0x261107:{'default':_0x261107};};Object['defineProperty'](exports,a5_0x5bf4('0x1'),{'value':!![]});const async_1=__importDefault(require(a5_0x5bf4('0x2')));const crypto_1=__importDefault(require(a5_0x5bf4('0x3')));const nodemailer_1=__importDefault(require(a5_0x5bf4('0x4')));const passport_1=__importDefault(require('passport'));const User_1=__importDefault(require('../models/User'));const request=require(a5_0x5bf4('0x5'));exports[a5_0x5bf4('0x6')]=(_0x5c1bf4,_0x62798f)=>{if(_0x5c1bf4['user']){return _0x62798f[a5_0x5bf4('0x7')]('/');}_0x62798f[a5_0x5bf4('0x8')](a5_0x5bf4('0x9'),{'title':'Login'});};exports['postLogin']=(_0x258ddd,_0x2f0420,_0xefa26c)=>{_0x258ddd[a5_0x5bf4('0xa')]('email',a5_0x5bf4('0xb'))[a5_0x5bf4('0xc')]();_0x258ddd[a5_0x5bf4('0xa')](a5_0x5bf4('0xd'),a5_0x5bf4('0xe'))['notEmpty']();_0x258ddd['sanitize']('email')['normalizeEmail']({'gmail_remove_dots':![]});const _0xe25841=_0x258ddd[a5_0x5bf4('0xf')]();if(_0xe25841){_0x258ddd['flash']('errors',_0xe25841);return _0x2f0420[a5_0x5bf4('0x7')](a5_0x5bf4('0x10'));}passport_1['default'][a5_0x5bf4('0x11')](a5_0x5bf4('0x12'),(_0x5cf872,_0x5b9b6a,_0x559585)=>{if(_0x5cf872){return _0xefa26c(_0x5cf872);}if(!_0x5b9b6a){_0x258ddd['flash'](a5_0x5bf4('0x13'),_0x559585[a5_0x5bf4('0x14')]);return _0x2f0420[a5_0x5bf4('0x7')](a5_0x5bf4('0x10'));}_0x258ddd[a5_0x5bf4('0x15')](_0x5b9b6a,_0x5cf872=>{if(_0x5cf872){return _0xefa26c(_0x5cf872);}_0x258ddd[a5_0x5bf4('0x16')](a5_0x5bf4('0x17'),{'msg':a5_0x5bf4('0x18')});_0x2f0420[a5_0x5bf4('0x7')](_0x258ddd[a5_0x5bf4('0x19')][a5_0x5bf4('0x1a')]||'/');});})(_0x258ddd,_0x2f0420,_0xefa26c);};exports[a5_0x5bf4('0x1b')]=(_0x3a75d0,_0x25e5a2)=>{_0x3a75d0[a5_0x5bf4('0x1b')]();_0x25e5a2[a5_0x5bf4('0x7')]('/');};exports['getSignup']=(_0x51c92f,_0x2e66d3)=>{if(_0x51c92f[a5_0x5bf4('0x1c')]){return _0x2e66d3[a5_0x5bf4('0x7')]('/');}_0x2e66d3['render'](a5_0x5bf4('0x1d'),{'title':a5_0x5bf4('0x1e')});};exports['postSignup']=(_0x159227,_0x3e81af,_0x42a8fa)=>{_0x159227[a5_0x5bf4('0xa')](a5_0x5bf4('0x1f'),a5_0x5bf4('0xb'))['isEmail']();_0x159227[a5_0x5bf4('0xa')]('password','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long')[a5_0x5bf4('0x20')]({'min':0x4});_0x159227[a5_0x5bf4('0xa')](a5_0x5bf4('0x21'),a5_0x5bf4('0x22'))['equals'](_0x159227[a5_0x5bf4('0x23')]['password']);_0x159227[a5_0x5bf4('0x24')](a5_0x5bf4('0x1f'))[a5_0x5bf4('0x25')]({'gmail_remove_dots':![]});const _0x1b80aa=_0x159227['validationErrors']();if(_0x1b80aa){_0x159227[a5_0x5bf4('0x16')](a5_0x5bf4('0x13'),_0x1b80aa);return _0x3e81af['redirect'](a5_0x5bf4('0x26'));}const _0x45f792=new User_1[(a5_0x5bf4('0x27'))]({});User_1[a5_0x5bf4('0x27')][a5_0x5bf4('0x28')]({'email':_0x159227[a5_0x5bf4('0x23')][a5_0x5bf4('0x1f')]},(_0x50cdd2,_0x2183b7)=>{if(_0x50cdd2){return _0x42a8fa(_0x50cdd2);}if(_0x2183b7){_0x159227[a5_0x5bf4('0x16')](a5_0x5bf4('0x13'),{'msg':a5_0x5bf4('0x29')});return _0x3e81af[a5_0x5bf4('0x7')](a5_0x5bf4('0x26'));}_0x45f792[a5_0x5bf4('0x2a')](_0x50cdd2=>{if(_0x50cdd2){return _0x42a8fa(_0x50cdd2);}_0x159227[a5_0x5bf4('0x15')](_0x45f792,_0x50cdd2=>{if(_0x50cdd2){return _0x42a8fa(_0x50cdd2);}_0x3e81af[a5_0x5bf4('0x7')]('/');});});});};exports[a5_0x5bf4('0x2b')]=(_0x40c830,_0x304c28)=>{_0x304c28[a5_0x5bf4('0x8')](a5_0x5bf4('0x2c'),{'title':a5_0x5bf4('0x2d')});};exports['postUpdateProfile']=(_0x5582d3,_0x3cc196,_0x489897)=>{_0x5582d3[a5_0x5bf4('0xa')](a5_0x5bf4('0x1f'),a5_0x5bf4('0x2e'))[a5_0x5bf4('0xc')]();_0x5582d3['sanitize']('email')[a5_0x5bf4('0x25')]({'gmail_remove_dots':![]});const _0xa6377c=_0x5582d3[a5_0x5bf4('0xf')]();if(_0xa6377c){_0x5582d3[a5_0x5bf4('0x16')](a5_0x5bf4('0x13'),_0xa6377c);return _0x3cc196[a5_0x5bf4('0x7')](a5_0x5bf4('0x2f'));}User_1[a5_0x5bf4('0x27')][a5_0x5bf4('0x30')](_0x5582d3[a5_0x5bf4('0x1c')]['id'],(_0x46d0d0,_0x2aba6c)=>{if(_0x46d0d0){return _0x489897(_0x46d0d0);}_0x2aba6c[a5_0x5bf4('0x1f')]=_0x5582d3[a5_0x5bf4('0x23')]['email']||'';_0x2aba6c['profile'][a5_0x5bf4('0x31')]=_0x5582d3[a5_0x5bf4('0x23')][a5_0x5bf4('0x31')]||'';_0x2aba6c['profile'][a5_0x5bf4('0x32')]=_0x5582d3[a5_0x5bf4('0x23')][a5_0x5bf4('0x32')]||'';_0x2aba6c[a5_0x5bf4('0x33')][a5_0x5bf4('0x34')]=_0x5582d3['body'][a5_0x5bf4('0x34')]||'';_0x2aba6c[a5_0x5bf4('0x33')][a5_0x5bf4('0x35')]=_0x5582d3[a5_0x5bf4('0x23')]['website']||'';_0x2aba6c[a5_0x5bf4('0x2a')](_0x46d0d0=>{if(_0x46d0d0){if(_0x46d0d0[a5_0x5bf4('0x36')]===0x2af8){_0x5582d3[a5_0x5bf4('0x16')]('errors',{'msg':'The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.'});return _0x3cc196[a5_0x5bf4('0x7')]('/account');}return _0x489897(_0x46d0d0);}_0x5582d3[a5_0x5bf4('0x16')]('success',{'msg':a5_0x5bf4('0x37')});_0x3cc196['redirect'](a5_0x5bf4('0x2f'));});});};exports[a5_0x5bf4('0x38')]=(_0x5448c4,_0x1431fc,_0x5d2553)=>{_0x5448c4[a5_0x5bf4('0xa')](a5_0x5bf4('0xd'),'Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long')[a5_0x5bf4('0x20')]({'min':0x4});_0x5448c4[a5_0x5bf4('0xa')](a5_0x5bf4('0x21'),a5_0x5bf4('0x22'))['equals'](_0x5448c4[a5_0x5bf4('0x23')][a5_0x5bf4('0xd')]);const _0x11b329=_0x5448c4[a5_0x5bf4('0xf')]();if(_0x11b329){_0x5448c4[a5_0x5bf4('0x16')]('errors',_0x11b329);return _0x1431fc[a5_0x5bf4('0x7')]('/account');}User_1[a5_0x5bf4('0x27')]['findById'](_0x5448c4[a5_0x5bf4('0x1c')]['id'],(_0x3a8a12,_0x4b1524)=>{if(_0x3a8a12){return _0x5d2553(_0x3a8a12);}_0x4b1524[a5_0x5bf4('0xd')]=_0x5448c4[a5_0x5bf4('0x23')][a5_0x5bf4('0xd')];_0x4b1524[a5_0x5bf4('0x2a')](_0x3a8a12=>{if(_0x3a8a12){return _0x5d2553(_0x3a8a12);}_0x5448c4[a5_0x5bf4('0x16')](a5_0x5bf4('0x17'),{'msg':a5_0x5bf4('0x39')});_0x1431fc['redirect'](a5_0x5bf4('0x2f'));});});};exports['postDeleteAccount']=(_0x23c8b4,_0x5abda1,_0x511c10)=>{User_1['default'][a5_0x5bf4('0x3a')]({'_id':_0x23c8b4[a5_0x5bf4('0x1c')]['id']},_0x6b99e3=>{if(_0x6b99e3){return _0x511c10(_0x6b99e3);}_0x23c8b4[a5_0x5bf4('0x1b')]();_0x23c8b4[a5_0x5bf4('0x16')](a5_0x5bf4('0x3b'),{'msg':a5_0x5bf4('0x3c')});_0x5abda1[a5_0x5bf4('0x7')]('/');});};exports[a5_0x5bf4('0x3d')]=(_0x1bde93,_0x5c01cf,_0x562f70)=>{const _0x254827=_0x1bde93[a5_0x5bf4('0x3e')][a5_0x5bf4('0x3f')];User_1[a5_0x5bf4('0x27')]['findById'](_0x1bde93[a5_0x5bf4('0x1c')]['id'],(_0x1f5609,_0x532df5)=>{if(_0x1f5609){return _0x562f70(_0x1f5609);}_0x532df5[_0x254827]=undefined;_0x532df5[a5_0x5bf4('0x40')]=_0x532df5[a5_0x5bf4('0x40')][a5_0x5bf4('0x41')](_0x2776ac=>_0x2776ac[a5_0x5bf4('0x42')]!==_0x254827);_0x532df5[a5_0x5bf4('0x2a')](_0x1f5609=>{if(_0x1f5609){return _0x562f70(_0x1f5609);}_0x1bde93[a5_0x5bf4('0x16')](a5_0x5bf4('0x3b'),{'msg':_0x254827+a5_0x5bf4('0x43')});_0x5c01cf[a5_0x5bf4('0x7')](a5_0x5bf4('0x2f'));});});};exports['getReset']=(_0x416c24,_0x463551,_0x335ec1)=>{if(_0x416c24[a5_0x5bf4('0x44')]()){return _0x463551[a5_0x5bf4('0x7')]('/');}User_1['default'][a5_0x5bf4('0x28')]({'passwordResetToken':_0x416c24['params']['token']})[a5_0x5bf4('0x45')](a5_0x5bf4('0x46'))['gt'](Date[a5_0x5bf4('0x47')]())[a5_0x5bf4('0x48')]((_0x24e4dd,_0x509caf)=>{if(_0x24e4dd){return _0x335ec1(_0x24e4dd);}if(!_0x509caf){_0x416c24[a5_0x5bf4('0x16')](a5_0x5bf4('0x13'),{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x463551[a5_0x5bf4('0x7')]('/forgot');}_0x463551[a5_0x5bf4('0x8')](a5_0x5bf4('0x49'),{'title':a5_0x5bf4('0x4a')});});};exports[a5_0x5bf4('0x4b')]=(_0x5c9113,_0x199060,_0xaa915c)=>{_0x5c9113[a5_0x5bf4('0xa')](a5_0x5bf4('0xd'),a5_0x5bf4('0x4c'))[a5_0x5bf4('0x20')]({'min':0x4});_0x5c9113[a5_0x5bf4('0xa')]('confirm',a5_0x5bf4('0x4d'))[a5_0x5bf4('0x4e')](_0x5c9113[a5_0x5bf4('0x23')][a5_0x5bf4('0xd')]);const _0x36e52c=_0x5c9113[a5_0x5bf4('0xf')]();if(_0x36e52c){_0x5c9113[a5_0x5bf4('0x16')](a5_0x5bf4('0x13'),_0x36e52c);return _0x199060[a5_0x5bf4('0x7')](a5_0x5bf4('0x4f'));}async_1['default']['waterfall']([function resetPassword(_0x29f210){User_1[a5_0x5bf4('0x27')][a5_0x5bf4('0x28')]({'passwordResetToken':_0x5c9113['params'][a5_0x5bf4('0x50')]})['where']('passwordResetExpires')['gt'](Date[a5_0x5bf4('0x47')]())[a5_0x5bf4('0x48')]((_0x56d41b,_0x49aec5)=>{if(_0x56d41b){return _0xaa915c(_0x56d41b);}if(!_0x49aec5){_0x5c9113[a5_0x5bf4('0x16')](a5_0x5bf4('0x13'),{'msg':a5_0x5bf4('0x51')});return _0x199060['redirect'](a5_0x5bf4('0x4f'));}_0x49aec5[a5_0x5bf4('0xd')]=_0x5c9113[a5_0x5bf4('0x23')][a5_0x5bf4('0xd')];_0x49aec5[a5_0x5bf4('0x52')]=undefined;_0x49aec5[a5_0x5bf4('0x46')]=undefined;_0x49aec5[a5_0x5bf4('0x2a')](_0x56d41b=>{if(_0x56d41b){return _0xaa915c(_0x56d41b);}_0x5c9113[a5_0x5bf4('0x15')](_0x49aec5,_0x56d41b=>{_0x29f210(_0x56d41b,_0x49aec5);});});});},function sendResetPasswordEmail(_0x2d4c8d,_0x31404f){const _0x434e04=nodemailer_1['default']['createTransport']({'service':a5_0x5bf4('0x53'),'auth':{'user':process['env'][a5_0x5bf4('0x54')],'pass':process[a5_0x5bf4('0x55')][a5_0x5bf4('0x56')]}});const _0x40b4d7={'to':_0x2d4c8d[a5_0x5bf4('0x1f')],'from':'express-ts@starter.com','subject':a5_0x5bf4('0x57'),'text':a5_0x5bf4('0x58')+_0x2d4c8d[a5_0x5bf4('0x1f')]+a5_0x5bf4('0x59')};_0x434e04[a5_0x5bf4('0x5a')](_0x40b4d7,_0x56342e=>{_0x5c9113[a5_0x5bf4('0x16')]('success',{'msg':'Success!\x20Your\x20password\x20has\x20been\x20changed.'});_0x31404f(_0x56342e);});}],_0x38f22f=>{if(_0x38f22f){return _0xaa915c(_0x38f22f);}_0x199060[a5_0x5bf4('0x7')]('/');});};exports['getForgot']=(_0x3df82a,_0xff3886)=>{if(_0x3df82a['isAuthenticated']()){return _0xff3886[a5_0x5bf4('0x7')]('/');}_0xff3886[a5_0x5bf4('0x8')](a5_0x5bf4('0x5b'),{'title':a5_0x5bf4('0x5c')});};exports[a5_0x5bf4('0x5d')]=(_0x44f2f9,_0x31903f,_0x59a0d8)=>{_0x44f2f9[a5_0x5bf4('0xa')]('email',a5_0x5bf4('0x2e'))['isEmail']();_0x44f2f9['sanitize'](a5_0x5bf4('0x1f'))[a5_0x5bf4('0x25')]({'gmail_remove_dots':![]});const _0x195887=_0x44f2f9['validationErrors']();if(_0x195887){_0x44f2f9[a5_0x5bf4('0x16')](a5_0x5bf4('0x13'),_0x195887);return _0x31903f[a5_0x5bf4('0x7')]('/forgot');}async_1[a5_0x5bf4('0x27')][a5_0x5bf4('0x5e')]([function createRandomToken(_0x66a7bb){crypto_1[a5_0x5bf4('0x27')][a5_0x5bf4('0x5f')](0x10,(_0x15cf8e,_0x6587f3)=>{const _0x41c1b9=_0x6587f3['toString'](a5_0x5bf4('0x60'));_0x66a7bb(_0x15cf8e,_0x41c1b9);});},function setRandomToken(_0x6e77a1,_0x2e1de8){User_1[a5_0x5bf4('0x27')][a5_0x5bf4('0x28')]({'email':_0x44f2f9[a5_0x5bf4('0x23')][a5_0x5bf4('0x1f')]},(_0x18ae23,_0x4e4e81)=>{if(_0x18ae23){return _0x2e1de8(_0x18ae23);}if(!_0x4e4e81){_0x44f2f9[a5_0x5bf4('0x16')](a5_0x5bf4('0x13'),{'msg':'Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.'});return _0x31903f[a5_0x5bf4('0x7')]('/forgot');}_0x4e4e81[a5_0x5bf4('0x52')]=_0x6e77a1;_0x4e4e81[a5_0x5bf4('0x46')]=Date['now']()+0x36ee80;_0x4e4e81[a5_0x5bf4('0x2a')](_0x18ae23=>{_0x2e1de8(_0x18ae23,_0x6e77a1,_0x4e4e81);});});},function sendForgotPasswordEmail(_0x5d8d05,_0x504fb8,_0x512ca5){const _0x2985fb=nodemailer_1[a5_0x5bf4('0x27')][a5_0x5bf4('0x61')]({'service':a5_0x5bf4('0x53'),'auth':{'user':process[a5_0x5bf4('0x55')][a5_0x5bf4('0x54')],'pass':process[a5_0x5bf4('0x55')]['SENDGRID_PASSWORD']}});const _0x11ef85={'to':_0x504fb8[a5_0x5bf4('0x1f')],'from':a5_0x5bf4('0x62'),'subject':a5_0x5bf4('0x63'),'text':'You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://'+_0x44f2f9[a5_0x5bf4('0x64')][a5_0x5bf4('0x65')]+a5_0x5bf4('0x66')+_0x5d8d05+a5_0x5bf4('0x67')};_0x2985fb[a5_0x5bf4('0x5a')](_0x11ef85,_0x478ed0=>{_0x44f2f9[a5_0x5bf4('0x16')](a5_0x5bf4('0x3b'),{'msg':a5_0x5bf4('0x68')+_0x504fb8[a5_0x5bf4('0x1f')]+a5_0x5bf4('0x69')});_0x512ca5(_0x478ed0);});}],_0x1fe06b=>{if(_0x1fe06b){return _0x59a0d8(_0x1fe06b);}_0x31903f['redirect'](a5_0x5bf4('0x6a'));});};
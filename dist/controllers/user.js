var a5_0x5a5b=['SendGrid','env','SENDGRID_USER','Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20','Success!\x20Your\x20password\x20has\x20been\x20changed.','isAuthenticated','Forgot\x20Password','postForgot','/forgot','hex','SENDGRID_PASSWORD','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://','headers','host','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','sendMail','\x20with\x20further\x20instructions.','__esModule','async','nodemailer','passport','../models/User','express-validator','getLogin','user','render','account/login','Login','postLogin','assert','email','Email\x20is\x20not\x20valid','isEmail','notEmpty','sanitize','validationErrors','flash','errors','redirect','default','authenticate','local','message','/login','logIn','success','session','returnTo','logout','account/signup','Create\x20Account','postSignup','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','len','confirmPassword','equals','body','normalizeEmail','findOne','save','getAccount','account/profile','Account\x20Management','postUpdateProfile','Please\x20enter\x20a\x20valid\x20email\x20address.','/account','findById','name','profile','gender','location','website','code','The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.','postUpdatePassword','password','Password\x20has\x20been\x20changed.','postDeleteAccount','info','Your\x20account\x20has\x20been\x20deleted.','getOauthUnlink','params','provider','tokens','filter','kind','getReset','token','where','passwordResetExpires','now','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','account/reset','Password\x20Reset','postReset','confirm','Passwords\x20must\x20match.','back','waterfall','exec','passwordResetToken','createTransport'];(function(_0x23c5d9,_0x549539){var _0x568ab7=function(_0x29103f){while(--_0x29103f){_0x23c5d9['push'](_0x23c5d9['shift']());}};_0x568ab7(++_0x549539);}(a5_0x5a5b,0x7b));var a5_0x5ae2=function(_0x5efa33,_0x226714){_0x5efa33=_0x5efa33-0x0;var _0x57b909=a5_0x5a5b[_0x5efa33];return _0x57b909;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x366914){return _0x366914&&_0x366914['__esModule']?_0x366914:{'default':_0x366914};};Object['defineProperty'](exports,a5_0x5ae2('0x0'),{'value':!![]});const async_1=__importDefault(require(a5_0x5ae2('0x1')));const crypto_1=__importDefault(require('crypto'));const nodemailer_1=__importDefault(require(a5_0x5ae2('0x2')));const passport_1=__importDefault(require(a5_0x5ae2('0x3')));const User_1=__importDefault(require(a5_0x5ae2('0x4')));const request=require(a5_0x5ae2('0x5'));exports[a5_0x5ae2('0x6')]=(_0x148cc7,_0x376f31)=>{if(_0x148cc7[a5_0x5ae2('0x7')]){return _0x376f31['redirect']('/');}_0x376f31[a5_0x5ae2('0x8')](a5_0x5ae2('0x9'),{'title':a5_0x5ae2('0xa')});};exports[a5_0x5ae2('0xb')]=(_0x214082,_0x3d73c5,_0x392625)=>{_0x214082[a5_0x5ae2('0xc')](a5_0x5ae2('0xd'),a5_0x5ae2('0xe'))[a5_0x5ae2('0xf')]();_0x214082['assert']('password','Password\x20cannot\x20be\x20blank')[a5_0x5ae2('0x10')]();_0x214082[a5_0x5ae2('0x11')]('email')['normalizeEmail']({'gmail_remove_dots':![]});const _0x4696f6=_0x214082[a5_0x5ae2('0x12')]();if(_0x4696f6){_0x214082[a5_0x5ae2('0x13')](a5_0x5ae2('0x14'),_0x4696f6);return _0x3d73c5[a5_0x5ae2('0x15')]('/login');}passport_1[a5_0x5ae2('0x16')][a5_0x5ae2('0x17')](a5_0x5ae2('0x18'),(_0x418dee,_0x2c68dd,_0x1bc7aa)=>{if(_0x418dee){return _0x392625(_0x418dee);}if(!_0x2c68dd){_0x214082[a5_0x5ae2('0x13')](a5_0x5ae2('0x14'),_0x1bc7aa[a5_0x5ae2('0x19')]);return _0x3d73c5[a5_0x5ae2('0x15')](a5_0x5ae2('0x1a'));}_0x214082[a5_0x5ae2('0x1b')](_0x2c68dd,_0x418dee=>{if(_0x418dee){return _0x392625(_0x418dee);}_0x214082[a5_0x5ae2('0x13')](a5_0x5ae2('0x1c'),{'msg':'Success!\x20You\x20are\x20logged\x20in.'});_0x3d73c5[a5_0x5ae2('0x15')](_0x214082[a5_0x5ae2('0x1d')][a5_0x5ae2('0x1e')]||'/');});})(_0x214082,_0x3d73c5,_0x392625);};exports[a5_0x5ae2('0x1f')]=(_0x384f05,_0x33e2c1)=>{_0x384f05[a5_0x5ae2('0x1f')]();_0x33e2c1['redirect']('/');};exports['getSignup']=(_0x6702d8,_0xbf62f1)=>{if(_0x6702d8[a5_0x5ae2('0x7')]){return _0xbf62f1[a5_0x5ae2('0x15')]('/');}_0xbf62f1[a5_0x5ae2('0x8')](a5_0x5ae2('0x20'),{'title':a5_0x5ae2('0x21')});};exports[a5_0x5ae2('0x22')]=(_0x13389d,_0x2d8cac,_0x3c23c0)=>{_0x13389d['assert'](a5_0x5ae2('0xd'),a5_0x5ae2('0xe'))['isEmail']();_0x13389d[a5_0x5ae2('0xc')]('password',a5_0x5ae2('0x23'))[a5_0x5ae2('0x24')]({'min':0x4});_0x13389d[a5_0x5ae2('0xc')](a5_0x5ae2('0x25'),'Passwords\x20do\x20not\x20match')[a5_0x5ae2('0x26')](_0x13389d[a5_0x5ae2('0x27')]['password']);_0x13389d[a5_0x5ae2('0x11')]('email')[a5_0x5ae2('0x28')]({'gmail_remove_dots':![]});const _0x1e5cc6=_0x13389d[a5_0x5ae2('0x12')]();if(_0x1e5cc6){_0x13389d[a5_0x5ae2('0x13')](a5_0x5ae2('0x14'),_0x1e5cc6);return _0x2d8cac[a5_0x5ae2('0x15')]('/signup');}const _0x114b38=new User_1['default']({});User_1['default'][a5_0x5ae2('0x29')]({'email':_0x13389d[a5_0x5ae2('0x27')][a5_0x5ae2('0xd')]},(_0x15a0b6,_0x25d560)=>{if(_0x15a0b6){return _0x3c23c0(_0x15a0b6);}if(_0x25d560){_0x13389d[a5_0x5ae2('0x13')](a5_0x5ae2('0x14'),{'msg':'Account\x20with\x20that\x20email\x20address\x20already\x20exists.'});return _0x2d8cac[a5_0x5ae2('0x15')]('/signup');}_0x114b38[a5_0x5ae2('0x2a')](_0x15a0b6=>{if(_0x15a0b6){return _0x3c23c0(_0x15a0b6);}_0x13389d[a5_0x5ae2('0x1b')](_0x114b38,_0x15a0b6=>{if(_0x15a0b6){return _0x3c23c0(_0x15a0b6);}_0x2d8cac[a5_0x5ae2('0x15')]('/');});});});};exports[a5_0x5ae2('0x2b')]=(_0x5718b9,_0x37514e)=>{_0x37514e[a5_0x5ae2('0x8')](a5_0x5ae2('0x2c'),{'title':a5_0x5ae2('0x2d')});};exports[a5_0x5ae2('0x2e')]=(_0x969f6e,_0x327fb4,_0x26c23c)=>{_0x969f6e['assert']('email',a5_0x5ae2('0x2f'))['isEmail']();_0x969f6e[a5_0x5ae2('0x11')](a5_0x5ae2('0xd'))['normalizeEmail']({'gmail_remove_dots':![]});const _0xa5972b=_0x969f6e[a5_0x5ae2('0x12')]();if(_0xa5972b){_0x969f6e[a5_0x5ae2('0x13')](a5_0x5ae2('0x14'),_0xa5972b);return _0x327fb4[a5_0x5ae2('0x15')](a5_0x5ae2('0x30'));}User_1[a5_0x5ae2('0x16')][a5_0x5ae2('0x31')](_0x969f6e[a5_0x5ae2('0x7')]['id'],(_0x432fbc,_0xb43712)=>{if(_0x432fbc){return _0x26c23c(_0x432fbc);}_0xb43712[a5_0x5ae2('0xd')]=_0x969f6e[a5_0x5ae2('0x27')][a5_0x5ae2('0xd')]||'';_0xb43712['profile']['name']=_0x969f6e[a5_0x5ae2('0x27')][a5_0x5ae2('0x32')]||'';_0xb43712[a5_0x5ae2('0x33')][a5_0x5ae2('0x34')]=_0x969f6e[a5_0x5ae2('0x27')][a5_0x5ae2('0x34')]||'';_0xb43712[a5_0x5ae2('0x33')]['location']=_0x969f6e[a5_0x5ae2('0x27')][a5_0x5ae2('0x35')]||'';_0xb43712['profile'][a5_0x5ae2('0x36')]=_0x969f6e[a5_0x5ae2('0x27')][a5_0x5ae2('0x36')]||'';_0xb43712[a5_0x5ae2('0x2a')](_0x432fbc=>{if(_0x432fbc){if(_0x432fbc[a5_0x5ae2('0x37')]===0x2af8){_0x969f6e[a5_0x5ae2('0x13')](a5_0x5ae2('0x14'),{'msg':a5_0x5ae2('0x38')});return _0x327fb4[a5_0x5ae2('0x15')](a5_0x5ae2('0x30'));}return _0x26c23c(_0x432fbc);}_0x969f6e[a5_0x5ae2('0x13')](a5_0x5ae2('0x1c'),{'msg':'Profile\x20information\x20has\x20been\x20updated.'});_0x327fb4['redirect']('/account');});});};exports[a5_0x5ae2('0x39')]=(_0x169df7,_0x1d3f85,_0x279662)=>{_0x169df7[a5_0x5ae2('0xc')]('password',a5_0x5ae2('0x23'))[a5_0x5ae2('0x24')]({'min':0x4});_0x169df7[a5_0x5ae2('0xc')]('confirmPassword','Passwords\x20do\x20not\x20match')[a5_0x5ae2('0x26')](_0x169df7[a5_0x5ae2('0x27')][a5_0x5ae2('0x3a')]);const _0x5424e8=_0x169df7[a5_0x5ae2('0x12')]();if(_0x5424e8){_0x169df7[a5_0x5ae2('0x13')](a5_0x5ae2('0x14'),_0x5424e8);return _0x1d3f85[a5_0x5ae2('0x15')](a5_0x5ae2('0x30'));}User_1[a5_0x5ae2('0x16')][a5_0x5ae2('0x31')](_0x169df7[a5_0x5ae2('0x7')]['id'],(_0x1c4ce4,_0x2be9e3)=>{if(_0x1c4ce4){return _0x279662(_0x1c4ce4);}_0x2be9e3['password']=_0x169df7[a5_0x5ae2('0x27')][a5_0x5ae2('0x3a')];_0x2be9e3[a5_0x5ae2('0x2a')](_0x1c4ce4=>{if(_0x1c4ce4){return _0x279662(_0x1c4ce4);}_0x169df7[a5_0x5ae2('0x13')]('success',{'msg':a5_0x5ae2('0x3b')});_0x1d3f85[a5_0x5ae2('0x15')](a5_0x5ae2('0x30'));});});};exports[a5_0x5ae2('0x3c')]=(_0x3344b6,_0x468b8b,_0x5822b1)=>{User_1[a5_0x5ae2('0x16')]['remove']({'_id':_0x3344b6[a5_0x5ae2('0x7')]['id']},_0x40b757=>{if(_0x40b757){return _0x5822b1(_0x40b757);}_0x3344b6[a5_0x5ae2('0x1f')]();_0x3344b6[a5_0x5ae2('0x13')](a5_0x5ae2('0x3d'),{'msg':a5_0x5ae2('0x3e')});_0x468b8b[a5_0x5ae2('0x15')]('/');});};exports[a5_0x5ae2('0x3f')]=(_0x61c259,_0xb5a98c,_0x2d6212)=>{const _0x5457ad=_0x61c259[a5_0x5ae2('0x40')][a5_0x5ae2('0x41')];User_1['default'][a5_0x5ae2('0x31')](_0x61c259[a5_0x5ae2('0x7')]['id'],(_0x3e35fb,_0x2e377b)=>{if(_0x3e35fb){return _0x2d6212(_0x3e35fb);}_0x2e377b[_0x5457ad]=undefined;_0x2e377b[a5_0x5ae2('0x42')]=_0x2e377b[a5_0x5ae2('0x42')][a5_0x5ae2('0x43')](_0x47b17d=>_0x47b17d[a5_0x5ae2('0x44')]!==_0x5457ad);_0x2e377b['save'](_0x3e35fb=>{if(_0x3e35fb){return _0x2d6212(_0x3e35fb);}_0x61c259[a5_0x5ae2('0x13')]('info',{'msg':_0x5457ad+'\x20account\x20has\x20been\x20unlinked.'});_0xb5a98c[a5_0x5ae2('0x15')](a5_0x5ae2('0x30'));});});};exports[a5_0x5ae2('0x45')]=(_0x4519fb,_0xee2b1b,_0x597836)=>{if(_0x4519fb['isAuthenticated']()){return _0xee2b1b['redirect']('/');}User_1[a5_0x5ae2('0x16')][a5_0x5ae2('0x29')]({'passwordResetToken':_0x4519fb[a5_0x5ae2('0x40')][a5_0x5ae2('0x46')]})[a5_0x5ae2('0x47')](a5_0x5ae2('0x48'))['gt'](Date[a5_0x5ae2('0x49')]())['exec']((_0x5d3541,_0x22bfd8)=>{if(_0x5d3541){return _0x597836(_0x5d3541);}if(!_0x22bfd8){_0x4519fb[a5_0x5ae2('0x13')]('errors',{'msg':a5_0x5ae2('0x4a')});return _0xee2b1b['redirect']('/forgot');}_0xee2b1b[a5_0x5ae2('0x8')](a5_0x5ae2('0x4b'),{'title':a5_0x5ae2('0x4c')});});};exports[a5_0x5ae2('0x4d')]=(_0x11632d,_0xf8208a,_0x240d2e)=>{_0x11632d[a5_0x5ae2('0xc')](a5_0x5ae2('0x3a'),'Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.')[a5_0x5ae2('0x24')]({'min':0x4});_0x11632d['assert'](a5_0x5ae2('0x4e'),a5_0x5ae2('0x4f'))['equals'](_0x11632d[a5_0x5ae2('0x27')][a5_0x5ae2('0x3a')]);const _0x469e10=_0x11632d[a5_0x5ae2('0x12')]();if(_0x469e10){_0x11632d[a5_0x5ae2('0x13')](a5_0x5ae2('0x14'),_0x469e10);return _0xf8208a[a5_0x5ae2('0x15')](a5_0x5ae2('0x50'));}async_1[a5_0x5ae2('0x16')][a5_0x5ae2('0x51')]([function resetPassword(_0xbf1d55){User_1[a5_0x5ae2('0x16')]['findOne']({'passwordResetToken':_0x11632d['params'][a5_0x5ae2('0x46')]})[a5_0x5ae2('0x47')](a5_0x5ae2('0x48'))['gt'](Date[a5_0x5ae2('0x49')]())[a5_0x5ae2('0x52')]((_0x572557,_0x4e815d)=>{if(_0x572557){return _0x240d2e(_0x572557);}if(!_0x4e815d){_0x11632d[a5_0x5ae2('0x13')]('errors',{'msg':a5_0x5ae2('0x4a')});return _0xf8208a[a5_0x5ae2('0x15')](a5_0x5ae2('0x50'));}_0x4e815d[a5_0x5ae2('0x3a')]=_0x11632d[a5_0x5ae2('0x27')]['password'];_0x4e815d[a5_0x5ae2('0x53')]=undefined;_0x4e815d[a5_0x5ae2('0x48')]=undefined;_0x4e815d[a5_0x5ae2('0x2a')](_0x572557=>{if(_0x572557){return _0x240d2e(_0x572557);}_0x11632d[a5_0x5ae2('0x1b')](_0x4e815d,_0x572557=>{_0xbf1d55(_0x572557,_0x4e815d);});});});},function sendResetPasswordEmail(_0x59260e,_0x45113b){const _0x1e65fa=nodemailer_1['default'][a5_0x5ae2('0x54')]({'service':a5_0x5ae2('0x55'),'auth':{'user':process[a5_0x5ae2('0x56')][a5_0x5ae2('0x57')],'pass':process[a5_0x5ae2('0x56')]['SENDGRID_PASSWORD']}});const _0x52f450={'to':_0x59260e['email'],'from':'express-ts@starter.com','subject':'Your\x20password\x20has\x20been\x20changed','text':a5_0x5ae2('0x58')+_0x59260e[a5_0x5ae2('0xd')]+'\x20has\x20just\x20been\x20changed.\x0a'};_0x1e65fa['sendMail'](_0x52f450,_0x2c605f=>{_0x11632d['flash'](a5_0x5ae2('0x1c'),{'msg':a5_0x5ae2('0x59')});_0x45113b(_0x2c605f);});}],_0x332330=>{if(_0x332330){return _0x240d2e(_0x332330);}_0xf8208a[a5_0x5ae2('0x15')]('/');});};exports['getForgot']=(_0x18f74b,_0x34ede7)=>{if(_0x18f74b[a5_0x5ae2('0x5a')]()){return _0x34ede7['redirect']('/');}_0x34ede7[a5_0x5ae2('0x8')]('account/forgot',{'title':a5_0x5ae2('0x5b')});};exports[a5_0x5ae2('0x5c')]=(_0x16c87e,_0x125a88,_0x25fc39)=>{_0x16c87e['assert']('email','Please\x20enter\x20a\x20valid\x20email\x20address.')[a5_0x5ae2('0xf')]();_0x16c87e[a5_0x5ae2('0x11')]('email')['normalizeEmail']({'gmail_remove_dots':![]});const _0x1fe7af=_0x16c87e[a5_0x5ae2('0x12')]();if(_0x1fe7af){_0x16c87e[a5_0x5ae2('0x13')]('errors',_0x1fe7af);return _0x125a88['redirect'](a5_0x5ae2('0x5d'));}async_1['default'][a5_0x5ae2('0x51')]([function createRandomToken(_0x129690){crypto_1[a5_0x5ae2('0x16')]['randomBytes'](0x10,(_0x447e7d,_0x28c7d8)=>{const _0x4ac99e=_0x28c7d8['toString'](a5_0x5ae2('0x5e'));_0x129690(_0x447e7d,_0x4ac99e);});},function setRandomToken(_0x532622,_0x4262a9){User_1[a5_0x5ae2('0x16')][a5_0x5ae2('0x29')]({'email':_0x16c87e['body'][a5_0x5ae2('0xd')]},(_0x35278b,_0x367c55)=>{if(_0x35278b){return _0x4262a9(_0x35278b);}if(!_0x367c55){_0x16c87e[a5_0x5ae2('0x13')](a5_0x5ae2('0x14'),{'msg':'Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.'});return _0x125a88['redirect'](a5_0x5ae2('0x5d'));}_0x367c55[a5_0x5ae2('0x53')]=_0x532622;_0x367c55[a5_0x5ae2('0x48')]=Date[a5_0x5ae2('0x49')]()+0x36ee80;_0x367c55['save'](_0x35278b=>{_0x4262a9(_0x35278b,_0x532622,_0x367c55);});});},function sendForgotPasswordEmail(_0x5ba98b,_0x495eef,_0x38201b){const _0x1326b3=nodemailer_1[a5_0x5ae2('0x16')]['createTransport']({'service':a5_0x5ae2('0x55'),'auth':{'user':process[a5_0x5ae2('0x56')][a5_0x5ae2('0x57')],'pass':process[a5_0x5ae2('0x56')][a5_0x5ae2('0x5f')]}});const _0x4ae313={'to':_0x495eef[a5_0x5ae2('0xd')],'from':a5_0x5ae2('0x60'),'subject':a5_0x5ae2('0x61'),'text':a5_0x5ae2('0x62')+_0x16c87e[a5_0x5ae2('0x63')][a5_0x5ae2('0x64')]+'/reset/'+_0x5ba98b+a5_0x5ae2('0x65')};_0x1326b3[a5_0x5ae2('0x66')](_0x4ae313,_0x2421bc=>{_0x16c87e[a5_0x5ae2('0x13')](a5_0x5ae2('0x3d'),{'msg':'An\x20e-mail\x20has\x20been\x20sent\x20to\x20'+_0x495eef[a5_0x5ae2('0xd')]+a5_0x5ae2('0x67')});_0x38201b(_0x2421bc);});}],_0x289dde=>{if(_0x289dde){return _0x25fc39(_0x289dde);}_0x125a88[a5_0x5ae2('0x15')](a5_0x5ae2('0x5d'));});};
var a5_0x48ab=['Forgot\x20Password','waterfall','randomBytes','toString','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','SENDGRID_USER','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://','headers','/reset/','__esModule','defineProperty','async','passport','express-validator','redirect','account/login','Login','postLogin','assert','email','Email\x20is\x20not\x20valid','isEmail','password','Password\x20cannot\x20be\x20blank','notEmpty','sanitize','normalizeEmail','validationErrors','flash','errors','/login','authenticate','local','logIn','logout','getSignup','user','render','account/signup','Create\x20Account','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','confirmPassword','Passwords\x20do\x20not\x20match','equals','/signup','default','findOne','body','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','save','getAccount','account/profile','Account\x20Management','postUpdateProfile','Please\x20enter\x20a\x20valid\x20email\x20address.','/account','profile','name','location','website','code','The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.','success','len','findById','Password\x20has\x20been\x20changed.','postDeleteAccount','info','getOauthUnlink','params','tokens','filter','kind','token','passwordResetExpires','now','exec','/forgot','Password\x20Reset','postReset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','confirm','Passwords\x20must\x20match.','back','where','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','passwordResetToken','createTransport','SendGrid','env','SENDGRID_PASSWORD','Your\x20password\x20has\x20been\x20changed','Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20','\x20has\x20just\x20been\x20changed.\x0a','sendMail','Success!\x20Your\x20password\x20has\x20been\x20changed.','isAuthenticated','account/forgot'];(function(_0x106765,_0x1277b7){var _0x19f13e=function(_0x426e33){while(--_0x426e33){_0x106765['push'](_0x106765['shift']());}};_0x19f13e(++_0x1277b7);}(a5_0x48ab,0x137));var a5_0x555e=function(_0x50b579,_0x1a4950){_0x50b579=_0x50b579-0x0;var _0x2267d5=a5_0x48ab[_0x50b579];return _0x2267d5;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x2e664b){return _0x2e664b&&_0x2e664b[a5_0x555e('0x0')]?_0x2e664b:{'default':_0x2e664b};};Object[a5_0x555e('0x1')](exports,'__esModule',{'value':!![]});const async_1=__importDefault(require(a5_0x555e('0x2')));const crypto_1=__importDefault(require('crypto'));const nodemailer_1=__importDefault(require('nodemailer'));const passport_1=__importDefault(require(a5_0x555e('0x3')));const User_1=__importDefault(require('../models/User'));const request=require(a5_0x555e('0x4'));exports['getLogin']=(_0x517424,_0x1e5e39)=>{if(_0x517424['user']){return _0x1e5e39[a5_0x555e('0x5')]('/');}_0x1e5e39['render'](a5_0x555e('0x6'),{'title':a5_0x555e('0x7')});};exports[a5_0x555e('0x8')]=(_0x34e1ad,_0x5372ab,_0x30875f)=>{_0x34e1ad[a5_0x555e('0x9')](a5_0x555e('0xa'),a5_0x555e('0xb'))[a5_0x555e('0xc')]();_0x34e1ad[a5_0x555e('0x9')](a5_0x555e('0xd'),a5_0x555e('0xe'))[a5_0x555e('0xf')]();_0x34e1ad[a5_0x555e('0x10')](a5_0x555e('0xa'))[a5_0x555e('0x11')]({'gmail_remove_dots':![]});const _0x2a6f4d=_0x34e1ad[a5_0x555e('0x12')]();if(_0x2a6f4d){_0x34e1ad[a5_0x555e('0x13')](a5_0x555e('0x14'),_0x2a6f4d);return _0x5372ab['redirect'](a5_0x555e('0x15'));}passport_1['default'][a5_0x555e('0x16')](a5_0x555e('0x17'),(_0x286500,_0xa55bd7,_0x212fac)=>{if(_0x286500){return _0x30875f(_0x286500);}if(!_0xa55bd7){_0x34e1ad[a5_0x555e('0x13')](a5_0x555e('0x14'),_0x212fac['message']);return _0x5372ab[a5_0x555e('0x5')]('/login');}_0x34e1ad[a5_0x555e('0x18')](_0xa55bd7,_0x286500=>{if(_0x286500){return _0x30875f(_0x286500);}_0x34e1ad['flash']('success',{'msg':'Success!\x20You\x20are\x20logged\x20in.'});_0x5372ab[a5_0x555e('0x5')](_0x34e1ad['session']['returnTo']||'/');});})(_0x34e1ad,_0x5372ab,_0x30875f);};exports[a5_0x555e('0x19')]=(_0x142474,_0x2e15e2)=>{_0x142474['logout']();_0x2e15e2[a5_0x555e('0x5')]('/');};exports[a5_0x555e('0x1a')]=(_0x258915,_0x453c5d)=>{if(_0x258915[a5_0x555e('0x1b')]){return _0x453c5d['redirect']('/');}_0x453c5d[a5_0x555e('0x1c')](a5_0x555e('0x1d'),{'title':a5_0x555e('0x1e')});};exports['postSignup']=(_0x5d8161,_0x156127,_0x1542fd)=>{_0x5d8161[a5_0x555e('0x9')](a5_0x555e('0xa'),a5_0x555e('0xb'))['isEmail']();_0x5d8161[a5_0x555e('0x9')](a5_0x555e('0xd'),a5_0x555e('0x1f'))['len']({'min':0x4});_0x5d8161['assert'](a5_0x555e('0x20'),a5_0x555e('0x21'))[a5_0x555e('0x22')](_0x5d8161['body'][a5_0x555e('0xd')]);_0x5d8161[a5_0x555e('0x10')](a5_0x555e('0xa'))[a5_0x555e('0x11')]({'gmail_remove_dots':![]});const _0x1ec8a8=_0x5d8161['validationErrors']();if(_0x1ec8a8){_0x5d8161[a5_0x555e('0x13')]('errors',_0x1ec8a8);return _0x156127[a5_0x555e('0x5')](a5_0x555e('0x23'));}const _0x51de9a=new User_1[(a5_0x555e('0x24'))]({});User_1[a5_0x555e('0x24')][a5_0x555e('0x25')]({'email':_0x5d8161[a5_0x555e('0x26')][a5_0x555e('0xa')]},(_0x3c6307,_0x14e836)=>{if(_0x3c6307){return _0x1542fd(_0x3c6307);}if(_0x14e836){_0x5d8161[a5_0x555e('0x13')](a5_0x555e('0x14'),{'msg':a5_0x555e('0x27')});return _0x156127[a5_0x555e('0x5')](a5_0x555e('0x23'));}_0x51de9a[a5_0x555e('0x28')](_0x3c6307=>{if(_0x3c6307){return _0x1542fd(_0x3c6307);}_0x5d8161[a5_0x555e('0x18')](_0x51de9a,_0x3c6307=>{if(_0x3c6307){return _0x1542fd(_0x3c6307);}_0x156127['redirect']('/');});});});};exports[a5_0x555e('0x29')]=(_0x5e8210,_0x2dd810)=>{_0x2dd810[a5_0x555e('0x1c')](a5_0x555e('0x2a'),{'title':a5_0x555e('0x2b')});};exports[a5_0x555e('0x2c')]=(_0x5d40f5,_0x4e04e8,_0x41ecbf)=>{_0x5d40f5[a5_0x555e('0x9')](a5_0x555e('0xa'),a5_0x555e('0x2d'))['isEmail']();_0x5d40f5[a5_0x555e('0x10')](a5_0x555e('0xa'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x24472b=_0x5d40f5['validationErrors']();if(_0x24472b){_0x5d40f5[a5_0x555e('0x13')](a5_0x555e('0x14'),_0x24472b);return _0x4e04e8[a5_0x555e('0x5')](a5_0x555e('0x2e'));}User_1[a5_0x555e('0x24')]['findById'](_0x5d40f5[a5_0x555e('0x1b')]['id'],(_0x250583,_0x29404c)=>{if(_0x250583){return _0x41ecbf(_0x250583);}_0x29404c[a5_0x555e('0xa')]=_0x5d40f5[a5_0x555e('0x26')][a5_0x555e('0xa')]||'';_0x29404c[a5_0x555e('0x2f')][a5_0x555e('0x30')]=_0x5d40f5[a5_0x555e('0x26')][a5_0x555e('0x30')]||'';_0x29404c[a5_0x555e('0x2f')]['gender']=_0x5d40f5[a5_0x555e('0x26')]['gender']||'';_0x29404c[a5_0x555e('0x2f')]['location']=_0x5d40f5[a5_0x555e('0x26')][a5_0x555e('0x31')]||'';_0x29404c[a5_0x555e('0x2f')][a5_0x555e('0x32')]=_0x5d40f5[a5_0x555e('0x26')][a5_0x555e('0x32')]||'';_0x29404c[a5_0x555e('0x28')](_0x250583=>{if(_0x250583){if(_0x250583[a5_0x555e('0x33')]===0x2af8){_0x5d40f5[a5_0x555e('0x13')](a5_0x555e('0x14'),{'msg':a5_0x555e('0x34')});return _0x4e04e8['redirect'](a5_0x555e('0x2e'));}return _0x41ecbf(_0x250583);}_0x5d40f5[a5_0x555e('0x13')](a5_0x555e('0x35'),{'msg':'Profile\x20information\x20has\x20been\x20updated.'});_0x4e04e8[a5_0x555e('0x5')](a5_0x555e('0x2e'));});});};exports['postUpdatePassword']=(_0x1ceca5,_0x47d9f1,_0x51d765)=>{_0x1ceca5[a5_0x555e('0x9')](a5_0x555e('0xd'),a5_0x555e('0x1f'))[a5_0x555e('0x36')]({'min':0x4});_0x1ceca5[a5_0x555e('0x9')](a5_0x555e('0x20'),'Passwords\x20do\x20not\x20match')[a5_0x555e('0x22')](_0x1ceca5[a5_0x555e('0x26')][a5_0x555e('0xd')]);const _0x14fc0d=_0x1ceca5[a5_0x555e('0x12')]();if(_0x14fc0d){_0x1ceca5[a5_0x555e('0x13')]('errors',_0x14fc0d);return _0x47d9f1[a5_0x555e('0x5')](a5_0x555e('0x2e'));}User_1[a5_0x555e('0x24')][a5_0x555e('0x37')](_0x1ceca5[a5_0x555e('0x1b')]['id'],(_0x53b70e,_0x3f7df5)=>{if(_0x53b70e){return _0x51d765(_0x53b70e);}_0x3f7df5[a5_0x555e('0xd')]=_0x1ceca5[a5_0x555e('0x26')][a5_0x555e('0xd')];_0x3f7df5[a5_0x555e('0x28')](_0x53b70e=>{if(_0x53b70e){return _0x51d765(_0x53b70e);}_0x1ceca5[a5_0x555e('0x13')](a5_0x555e('0x35'),{'msg':a5_0x555e('0x38')});_0x47d9f1[a5_0x555e('0x5')](a5_0x555e('0x2e'));});});};exports[a5_0x555e('0x39')]=(_0x52189f,_0x304a1,_0xb2d355)=>{User_1[a5_0x555e('0x24')]['remove']({'_id':_0x52189f[a5_0x555e('0x1b')]['id']},_0x247348=>{if(_0x247348){return _0xb2d355(_0x247348);}_0x52189f[a5_0x555e('0x19')]();_0x52189f[a5_0x555e('0x13')](a5_0x555e('0x3a'),{'msg':'Your\x20account\x20has\x20been\x20deleted.'});_0x304a1[a5_0x555e('0x5')]('/');});};exports[a5_0x555e('0x3b')]=(_0x412d03,_0x273c48,_0xec6ccf)=>{const _0x30aac0=_0x412d03[a5_0x555e('0x3c')]['provider'];User_1[a5_0x555e('0x24')]['findById'](_0x412d03['user']['id'],(_0x4b4352,_0x26a858)=>{if(_0x4b4352){return _0xec6ccf(_0x4b4352);}_0x26a858[_0x30aac0]=undefined;_0x26a858[a5_0x555e('0x3d')]=_0x26a858[a5_0x555e('0x3d')][a5_0x555e('0x3e')](_0x491cb4=>_0x491cb4[a5_0x555e('0x3f')]!==_0x30aac0);_0x26a858['save'](_0x4b4352=>{if(_0x4b4352){return _0xec6ccf(_0x4b4352);}_0x412d03[a5_0x555e('0x13')](a5_0x555e('0x3a'),{'msg':_0x30aac0+'\x20account\x20has\x20been\x20unlinked.'});_0x273c48[a5_0x555e('0x5')](a5_0x555e('0x2e'));});});};exports['getReset']=(_0x5a87bf,_0x5b238e,_0x4c469a)=>{if(_0x5a87bf['isAuthenticated']()){return _0x5b238e['redirect']('/');}User_1['default'][a5_0x555e('0x25')]({'passwordResetToken':_0x5a87bf['params'][a5_0x555e('0x40')]})['where'](a5_0x555e('0x41'))['gt'](Date[a5_0x555e('0x42')]())[a5_0x555e('0x43')]((_0x302a52,_0x27f3a8)=>{if(_0x302a52){return _0x4c469a(_0x302a52);}if(!_0x27f3a8){_0x5a87bf['flash'](a5_0x555e('0x14'),{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x5b238e['redirect'](a5_0x555e('0x44'));}_0x5b238e[a5_0x555e('0x1c')]('account/reset',{'title':a5_0x555e('0x45')});});};exports[a5_0x555e('0x46')]=(_0x410840,_0x4be11a,_0x45a558)=>{_0x410840[a5_0x555e('0x9')](a5_0x555e('0xd'),a5_0x555e('0x47'))[a5_0x555e('0x36')]({'min':0x4});_0x410840[a5_0x555e('0x9')](a5_0x555e('0x48'),a5_0x555e('0x49'))['equals'](_0x410840[a5_0x555e('0x26')][a5_0x555e('0xd')]);const _0x363df5=_0x410840[a5_0x555e('0x12')]();if(_0x363df5){_0x410840[a5_0x555e('0x13')]('errors',_0x363df5);return _0x4be11a[a5_0x555e('0x5')](a5_0x555e('0x4a'));}async_1[a5_0x555e('0x24')]['waterfall']([function resetPassword(_0x19f2c0){User_1[a5_0x555e('0x24')]['findOne']({'passwordResetToken':_0x410840[a5_0x555e('0x3c')][a5_0x555e('0x40')]})[a5_0x555e('0x4b')](a5_0x555e('0x41'))['gt'](Date[a5_0x555e('0x42')]())[a5_0x555e('0x43')]((_0x21469f,_0x115337)=>{if(_0x21469f){return _0x45a558(_0x21469f);}if(!_0x115337){_0x410840[a5_0x555e('0x13')](a5_0x555e('0x14'),{'msg':a5_0x555e('0x4c')});return _0x4be11a['redirect'](a5_0x555e('0x4a'));}_0x115337[a5_0x555e('0xd')]=_0x410840[a5_0x555e('0x26')][a5_0x555e('0xd')];_0x115337[a5_0x555e('0x4d')]=undefined;_0x115337[a5_0x555e('0x41')]=undefined;_0x115337[a5_0x555e('0x28')](_0x21469f=>{if(_0x21469f){return _0x45a558(_0x21469f);}_0x410840['logIn'](_0x115337,_0x21469f=>{_0x19f2c0(_0x21469f,_0x115337);});});});},function sendResetPasswordEmail(_0x2c8103,_0xbafda1){const _0x5c0df1=nodemailer_1[a5_0x555e('0x24')][a5_0x555e('0x4e')]({'service':a5_0x555e('0x4f'),'auth':{'user':process['env']['SENDGRID_USER'],'pass':process[a5_0x555e('0x50')][a5_0x555e('0x51')]}});const _0x11ddfd={'to':_0x2c8103[a5_0x555e('0xa')],'from':'express-ts@starter.com','subject':a5_0x555e('0x52'),'text':a5_0x555e('0x53')+_0x2c8103[a5_0x555e('0xa')]+a5_0x555e('0x54')};_0x5c0df1[a5_0x555e('0x55')](_0x11ddfd,_0x46bc53=>{_0x410840[a5_0x555e('0x13')](a5_0x555e('0x35'),{'msg':a5_0x555e('0x56')});_0xbafda1(_0x46bc53);});}],_0x564cfb=>{if(_0x564cfb){return _0x45a558(_0x564cfb);}_0x4be11a['redirect']('/');});};exports['getForgot']=(_0x55839b,_0x215601)=>{if(_0x55839b[a5_0x555e('0x57')]()){return _0x215601[a5_0x555e('0x5')]('/');}_0x215601[a5_0x555e('0x1c')](a5_0x555e('0x58'),{'title':a5_0x555e('0x59')});};exports['postForgot']=(_0x192cba,_0x3da3f5,_0x33e682)=>{_0x192cba['assert'](a5_0x555e('0xa'),a5_0x555e('0x2d'))[a5_0x555e('0xc')]();_0x192cba[a5_0x555e('0x10')](a5_0x555e('0xa'))[a5_0x555e('0x11')]({'gmail_remove_dots':![]});const _0x3b440a=_0x192cba[a5_0x555e('0x12')]();if(_0x3b440a){_0x192cba[a5_0x555e('0x13')](a5_0x555e('0x14'),_0x3b440a);return _0x3da3f5[a5_0x555e('0x5')](a5_0x555e('0x44'));}async_1[a5_0x555e('0x24')][a5_0x555e('0x5a')]([function createRandomToken(_0x114603){crypto_1['default'][a5_0x555e('0x5b')](0x10,(_0x4cc3ae,_0x240796)=>{const _0x52f377=_0x240796[a5_0x555e('0x5c')]('hex');_0x114603(_0x4cc3ae,_0x52f377);});},function setRandomToken(_0xdaf863,_0x3036e5){User_1[a5_0x555e('0x24')]['findOne']({'email':_0x192cba['body']['email']},(_0x16222c,_0x281f63)=>{if(_0x16222c){return _0x3036e5(_0x16222c);}if(!_0x281f63){_0x192cba[a5_0x555e('0x13')]('errors',{'msg':a5_0x555e('0x5d')});return _0x3da3f5[a5_0x555e('0x5')](a5_0x555e('0x44'));}_0x281f63[a5_0x555e('0x4d')]=_0xdaf863;_0x281f63['passwordResetExpires']=Date[a5_0x555e('0x42')]()+0x36ee80;_0x281f63[a5_0x555e('0x28')](_0x16222c=>{_0x3036e5(_0x16222c,_0xdaf863,_0x281f63);});});},function sendForgotPasswordEmail(_0x33bb2c,_0xcce875,_0x4eca0b){const _0x5f0a0a=nodemailer_1[a5_0x555e('0x24')][a5_0x555e('0x4e')]({'service':a5_0x555e('0x4f'),'auth':{'user':process[a5_0x555e('0x50')][a5_0x555e('0x5e')],'pass':process['env']['SENDGRID_PASSWORD']}});const _0x6cbaa0={'to':_0xcce875[a5_0x555e('0xa')],'from':a5_0x555e('0x5f'),'subject':a5_0x555e('0x60'),'text':a5_0x555e('0x61')+_0x192cba[a5_0x555e('0x62')]['host']+a5_0x555e('0x63')+_0x33bb2c+'\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a'};_0x5f0a0a[a5_0x555e('0x55')](_0x6cbaa0,_0xf7f2de=>{_0x192cba['flash'](a5_0x555e('0x3a'),{'msg':'An\x20e-mail\x20has\x20been\x20sent\x20to\x20'+_0xcce875[a5_0x555e('0xa')]+'\x20with\x20further\x20instructions.'});_0x4eca0b(_0xf7f2de);});}],_0x232b5f=>{if(_0x232b5f){return _0x33e682(_0x232b5f);}_0x3da3f5[a5_0x555e('0x5')](a5_0x555e('0x44'));});};
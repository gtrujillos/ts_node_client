var a5_0x4c36=['now','exec','/forgot','account/reset','Password\x20Reset','postReset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','confirm','Passwords\x20must\x20match.','back','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','logIn','createTransport','SendGrid','env','SENDGRID_USER','SENDGRID_PASSWORD','express-ts@starter.com','Your\x20password\x20has\x20been\x20changed','Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20','sendMail','Success!\x20Your\x20password\x20has\x20been\x20changed.','normalizeEmail','waterfall','randomBytes','hex','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','passwordResetToken','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','host','/reset/','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','An\x20e-mail\x20has\x20been\x20sent\x20to\x20','__esModule','async','nodemailer','user','redirect','render','account/login','Login','postLogin','email','Email\x20is\x20not\x20valid','isEmail','assert','password','notEmpty','sanitize','validationErrors','flash','errors','/login','default','authenticate','message','success','Success!\x20You\x20are\x20logged\x20in.','session','returnTo','logout','getSignup','Create\x20Account','postSignup','len','confirmPassword','Passwords\x20do\x20not\x20match','equals','body','/signup','findOne','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','save','getAccount','account/profile','Account\x20Management','postUpdateProfile','Please\x20enter\x20a\x20valid\x20email\x20address.','/account','findById','profile','name','gender','location','website','code','Profile\x20information\x20has\x20been\x20updated.','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','Password\x20has\x20been\x20changed.','postDeleteAccount','info','Your\x20account\x20has\x20been\x20deleted.','getOauthUnlink','params','provider','tokens','kind','\x20account\x20has\x20been\x20unlinked.','isAuthenticated','token','where','passwordResetExpires'];(function(_0x9f33f7,_0x1668a4){var _0x1ab90b=function(_0x40d38a){while(--_0x40d38a){_0x9f33f7['push'](_0x9f33f7['shift']());}};_0x1ab90b(++_0x1668a4);}(a5_0x4c36,0xf0));var a5_0x27ad=function(_0x2baf41,_0x1a0dbe){_0x2baf41=_0x2baf41-0x0;var _0x56970c=a5_0x4c36[_0x2baf41];return _0x56970c;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x2076d3){return _0x2076d3&&_0x2076d3['__esModule']?_0x2076d3:{'default':_0x2076d3};};Object['defineProperty'](exports,a5_0x27ad('0x0'),{'value':!![]});const async_1=__importDefault(require(a5_0x27ad('0x1')));const crypto_1=__importDefault(require('crypto'));const nodemailer_1=__importDefault(require(a5_0x27ad('0x2')));const passport_1=__importDefault(require('passport'));const User_1=__importDefault(require('../models/User'));const request=require('express-validator');exports['getLogin']=(_0x45de3e,_0x4ae174)=>{if(_0x45de3e[a5_0x27ad('0x3')]){return _0x4ae174[a5_0x27ad('0x4')]('/');}_0x4ae174[a5_0x27ad('0x5')](a5_0x27ad('0x6'),{'title':a5_0x27ad('0x7')});};exports[a5_0x27ad('0x8')]=(_0x515b12,_0xc83253,_0x283f04)=>{_0x515b12['assert'](a5_0x27ad('0x9'),a5_0x27ad('0xa'))[a5_0x27ad('0xb')]();_0x515b12[a5_0x27ad('0xc')](a5_0x27ad('0xd'),'Password\x20cannot\x20be\x20blank')[a5_0x27ad('0xe')]();_0x515b12[a5_0x27ad('0xf')]('email')['normalizeEmail']({'gmail_remove_dots':![]});const _0x3bda51=_0x515b12[a5_0x27ad('0x10')]();if(_0x3bda51){_0x515b12[a5_0x27ad('0x11')](a5_0x27ad('0x12'),_0x3bda51);return _0xc83253[a5_0x27ad('0x4')](a5_0x27ad('0x13'));}passport_1[a5_0x27ad('0x14')][a5_0x27ad('0x15')]('local',(_0x2b88c1,_0x5b38fa,_0x2f46ff)=>{if(_0x2b88c1){return _0x283f04(_0x2b88c1);}if(!_0x5b38fa){_0x515b12['flash'](a5_0x27ad('0x12'),_0x2f46ff[a5_0x27ad('0x16')]);return _0xc83253[a5_0x27ad('0x4')]('/login');}_0x515b12['logIn'](_0x5b38fa,_0x2b88c1=>{if(_0x2b88c1){return _0x283f04(_0x2b88c1);}_0x515b12['flash'](a5_0x27ad('0x17'),{'msg':a5_0x27ad('0x18')});_0xc83253[a5_0x27ad('0x4')](_0x515b12[a5_0x27ad('0x19')][a5_0x27ad('0x1a')]||'/');});})(_0x515b12,_0xc83253,_0x283f04);};exports[a5_0x27ad('0x1b')]=(_0x28bab8,_0x3f3bb7)=>{_0x28bab8['logout']();_0x3f3bb7[a5_0x27ad('0x4')]('/');};exports[a5_0x27ad('0x1c')]=(_0x30ce17,_0x1d3c22)=>{if(_0x30ce17[a5_0x27ad('0x3')]){return _0x1d3c22[a5_0x27ad('0x4')]('/');}_0x1d3c22['render']('account/signup',{'title':a5_0x27ad('0x1d')});};exports[a5_0x27ad('0x1e')]=(_0x151d09,_0x2385e2,_0x1a3620)=>{_0x151d09[a5_0x27ad('0xc')](a5_0x27ad('0x9'),a5_0x27ad('0xa'))[a5_0x27ad('0xb')]();_0x151d09[a5_0x27ad('0xc')](a5_0x27ad('0xd'),'Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long')[a5_0x27ad('0x1f')]({'min':0x4});_0x151d09[a5_0x27ad('0xc')](a5_0x27ad('0x20'),a5_0x27ad('0x21'))[a5_0x27ad('0x22')](_0x151d09[a5_0x27ad('0x23')][a5_0x27ad('0xd')]);_0x151d09[a5_0x27ad('0xf')](a5_0x27ad('0x9'))['normalizeEmail']({'gmail_remove_dots':![]});const _0xeb86a9=_0x151d09[a5_0x27ad('0x10')]();if(_0xeb86a9){_0x151d09['flash'](a5_0x27ad('0x12'),_0xeb86a9);return _0x2385e2[a5_0x27ad('0x4')](a5_0x27ad('0x24'));}const _0x59e007=new User_1[(a5_0x27ad('0x14'))]({});User_1[a5_0x27ad('0x14')][a5_0x27ad('0x25')]({'email':_0x151d09[a5_0x27ad('0x23')]['email']},(_0x4be235,_0x287810)=>{if(_0x4be235){return _0x1a3620(_0x4be235);}if(_0x287810){_0x151d09[a5_0x27ad('0x11')](a5_0x27ad('0x12'),{'msg':a5_0x27ad('0x26')});return _0x2385e2['redirect'](a5_0x27ad('0x24'));}_0x59e007[a5_0x27ad('0x27')](_0x4be235=>{if(_0x4be235){return _0x1a3620(_0x4be235);}_0x151d09['logIn'](_0x59e007,_0x4be235=>{if(_0x4be235){return _0x1a3620(_0x4be235);}_0x2385e2['redirect']('/');});});});};exports[a5_0x27ad('0x28')]=(_0x1e3875,_0x28e057)=>{_0x28e057['render'](a5_0x27ad('0x29'),{'title':a5_0x27ad('0x2a')});};exports[a5_0x27ad('0x2b')]=(_0x212986,_0x2cb17d,_0x9436e3)=>{_0x212986['assert']('email',a5_0x27ad('0x2c'))[a5_0x27ad('0xb')]();_0x212986['sanitize'](a5_0x27ad('0x9'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x5ca1b2=_0x212986['validationErrors']();if(_0x5ca1b2){_0x212986[a5_0x27ad('0x11')]('errors',_0x5ca1b2);return _0x2cb17d[a5_0x27ad('0x4')](a5_0x27ad('0x2d'));}User_1[a5_0x27ad('0x14')][a5_0x27ad('0x2e')](_0x212986[a5_0x27ad('0x3')]['id'],(_0x36f853,_0x3c15d4)=>{if(_0x36f853){return _0x9436e3(_0x36f853);}_0x3c15d4[a5_0x27ad('0x9')]=_0x212986['body'][a5_0x27ad('0x9')]||'';_0x3c15d4[a5_0x27ad('0x2f')][a5_0x27ad('0x30')]=_0x212986['body'][a5_0x27ad('0x30')]||'';_0x3c15d4[a5_0x27ad('0x2f')][a5_0x27ad('0x31')]=_0x212986[a5_0x27ad('0x23')]['gender']||'';_0x3c15d4['profile'][a5_0x27ad('0x32')]=_0x212986[a5_0x27ad('0x23')][a5_0x27ad('0x32')]||'';_0x3c15d4[a5_0x27ad('0x2f')][a5_0x27ad('0x33')]=_0x212986['body']['website']||'';_0x3c15d4['save'](_0x36f853=>{if(_0x36f853){if(_0x36f853[a5_0x27ad('0x34')]===0x2af8){_0x212986[a5_0x27ad('0x11')]('errors',{'msg':'The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.'});return _0x2cb17d[a5_0x27ad('0x4')](a5_0x27ad('0x2d'));}return _0x9436e3(_0x36f853);}_0x212986[a5_0x27ad('0x11')](a5_0x27ad('0x17'),{'msg':a5_0x27ad('0x35')});_0x2cb17d[a5_0x27ad('0x4')](a5_0x27ad('0x2d'));});});};exports['postUpdatePassword']=(_0x53f408,_0x344bb0,_0x1d4830)=>{_0x53f408[a5_0x27ad('0xc')](a5_0x27ad('0xd'),a5_0x27ad('0x36'))[a5_0x27ad('0x1f')]({'min':0x4});_0x53f408['assert'](a5_0x27ad('0x20'),'Passwords\x20do\x20not\x20match')[a5_0x27ad('0x22')](_0x53f408[a5_0x27ad('0x23')][a5_0x27ad('0xd')]);const _0x4107ba=_0x53f408[a5_0x27ad('0x10')]();if(_0x4107ba){_0x53f408[a5_0x27ad('0x11')](a5_0x27ad('0x12'),_0x4107ba);return _0x344bb0[a5_0x27ad('0x4')](a5_0x27ad('0x2d'));}User_1['default']['findById'](_0x53f408['user']['id'],(_0x304bae,_0x34be72)=>{if(_0x304bae){return _0x1d4830(_0x304bae);}_0x34be72['password']=_0x53f408[a5_0x27ad('0x23')][a5_0x27ad('0xd')];_0x34be72[a5_0x27ad('0x27')](_0x304bae=>{if(_0x304bae){return _0x1d4830(_0x304bae);}_0x53f408['flash'](a5_0x27ad('0x17'),{'msg':a5_0x27ad('0x37')});_0x344bb0[a5_0x27ad('0x4')](a5_0x27ad('0x2d'));});});};exports[a5_0x27ad('0x38')]=(_0x207a9d,_0x3839ad,_0x295edd)=>{User_1[a5_0x27ad('0x14')]['remove']({'_id':_0x207a9d[a5_0x27ad('0x3')]['id']},_0x3b5bfa=>{if(_0x3b5bfa){return _0x295edd(_0x3b5bfa);}_0x207a9d[a5_0x27ad('0x1b')]();_0x207a9d[a5_0x27ad('0x11')](a5_0x27ad('0x39'),{'msg':a5_0x27ad('0x3a')});_0x3839ad['redirect']('/');});};exports[a5_0x27ad('0x3b')]=(_0x24ae8a,_0x5b6509,_0x1e13f6)=>{const _0x235e99=_0x24ae8a[a5_0x27ad('0x3c')][a5_0x27ad('0x3d')];User_1[a5_0x27ad('0x14')][a5_0x27ad('0x2e')](_0x24ae8a[a5_0x27ad('0x3')]['id'],(_0x32bf89,_0x35272e)=>{if(_0x32bf89){return _0x1e13f6(_0x32bf89);}_0x35272e[_0x235e99]=undefined;_0x35272e['tokens']=_0x35272e[a5_0x27ad('0x3e')]['filter'](_0x43034f=>_0x43034f[a5_0x27ad('0x3f')]!==_0x235e99);_0x35272e[a5_0x27ad('0x27')](_0x32bf89=>{if(_0x32bf89){return _0x1e13f6(_0x32bf89);}_0x24ae8a[a5_0x27ad('0x11')](a5_0x27ad('0x39'),{'msg':_0x235e99+a5_0x27ad('0x40')});_0x5b6509[a5_0x27ad('0x4')](a5_0x27ad('0x2d'));});});};exports['getReset']=(_0xbfcbff,_0x4cda3e,_0x19c22f)=>{if(_0xbfcbff[a5_0x27ad('0x41')]()){return _0x4cda3e[a5_0x27ad('0x4')]('/');}User_1[a5_0x27ad('0x14')][a5_0x27ad('0x25')]({'passwordResetToken':_0xbfcbff['params'][a5_0x27ad('0x42')]})[a5_0x27ad('0x43')](a5_0x27ad('0x44'))['gt'](Date[a5_0x27ad('0x45')]())[a5_0x27ad('0x46')]((_0x29f3d0,_0x52e781)=>{if(_0x29f3d0){return _0x19c22f(_0x29f3d0);}if(!_0x52e781){_0xbfcbff[a5_0x27ad('0x11')]('errors',{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x4cda3e['redirect'](a5_0x27ad('0x47'));}_0x4cda3e[a5_0x27ad('0x5')](a5_0x27ad('0x48'),{'title':a5_0x27ad('0x49')});});};exports[a5_0x27ad('0x4a')]=(_0x29e5b,_0x3c269c,_0x9499b8)=>{_0x29e5b[a5_0x27ad('0xc')]('password',a5_0x27ad('0x4b'))['len']({'min':0x4});_0x29e5b[a5_0x27ad('0xc')](a5_0x27ad('0x4c'),a5_0x27ad('0x4d'))[a5_0x27ad('0x22')](_0x29e5b['body'][a5_0x27ad('0xd')]);const _0x5844a3=_0x29e5b[a5_0x27ad('0x10')]();if(_0x5844a3){_0x29e5b[a5_0x27ad('0x11')](a5_0x27ad('0x12'),_0x5844a3);return _0x3c269c[a5_0x27ad('0x4')](a5_0x27ad('0x4e'));}async_1[a5_0x27ad('0x14')]['waterfall']([function resetPassword(_0x203205){User_1[a5_0x27ad('0x14')]['findOne']({'passwordResetToken':_0x29e5b[a5_0x27ad('0x3c')][a5_0x27ad('0x42')]})['where'](a5_0x27ad('0x44'))['gt'](Date[a5_0x27ad('0x45')]())['exec']((_0xd01a7a,_0x3c5014)=>{if(_0xd01a7a){return _0x9499b8(_0xd01a7a);}if(!_0x3c5014){_0x29e5b[a5_0x27ad('0x11')]('errors',{'msg':a5_0x27ad('0x4f')});return _0x3c269c[a5_0x27ad('0x4')]('back');}_0x3c5014[a5_0x27ad('0xd')]=_0x29e5b[a5_0x27ad('0x23')][a5_0x27ad('0xd')];_0x3c5014['passwordResetToken']=undefined;_0x3c5014[a5_0x27ad('0x44')]=undefined;_0x3c5014[a5_0x27ad('0x27')](_0xd01a7a=>{if(_0xd01a7a){return _0x9499b8(_0xd01a7a);}_0x29e5b[a5_0x27ad('0x50')](_0x3c5014,_0xd01a7a=>{_0x203205(_0xd01a7a,_0x3c5014);});});});},function sendResetPasswordEmail(_0x11749e,_0x2b04a8){const _0x32367e=nodemailer_1[a5_0x27ad('0x14')][a5_0x27ad('0x51')]({'service':a5_0x27ad('0x52'),'auth':{'user':process[a5_0x27ad('0x53')][a5_0x27ad('0x54')],'pass':process['env'][a5_0x27ad('0x55')]}});const _0x27801d={'to':_0x11749e[a5_0x27ad('0x9')],'from':a5_0x27ad('0x56'),'subject':a5_0x27ad('0x57'),'text':a5_0x27ad('0x58')+_0x11749e[a5_0x27ad('0x9')]+'\x20has\x20just\x20been\x20changed.\x0a'};_0x32367e[a5_0x27ad('0x59')](_0x27801d,_0x195632=>{_0x29e5b[a5_0x27ad('0x11')](a5_0x27ad('0x17'),{'msg':a5_0x27ad('0x5a')});_0x2b04a8(_0x195632);});}],_0x173166=>{if(_0x173166){return _0x9499b8(_0x173166);}_0x3c269c[a5_0x27ad('0x4')]('/');});};exports['getForgot']=(_0x5638e6,_0x150076)=>{if(_0x5638e6[a5_0x27ad('0x41')]()){return _0x150076[a5_0x27ad('0x4')]('/');}_0x150076[a5_0x27ad('0x5')]('account/forgot',{'title':'Forgot\x20Password'});};exports['postForgot']=(_0x23a25e,_0x29c996,_0x405012)=>{_0x23a25e[a5_0x27ad('0xc')]('email','Please\x20enter\x20a\x20valid\x20email\x20address.')[a5_0x27ad('0xb')]();_0x23a25e['sanitize'](a5_0x27ad('0x9'))[a5_0x27ad('0x5b')]({'gmail_remove_dots':![]});const _0x31c943=_0x23a25e[a5_0x27ad('0x10')]();if(_0x31c943){_0x23a25e[a5_0x27ad('0x11')]('errors',_0x31c943);return _0x29c996[a5_0x27ad('0x4')](a5_0x27ad('0x47'));}async_1[a5_0x27ad('0x14')][a5_0x27ad('0x5c')]([function createRandomToken(_0x3e3f6b){crypto_1[a5_0x27ad('0x14')][a5_0x27ad('0x5d')](0x10,(_0x35e7e7,_0x10ddfb)=>{const _0x4c2fdd=_0x10ddfb['toString'](a5_0x27ad('0x5e'));_0x3e3f6b(_0x35e7e7,_0x4c2fdd);});},function setRandomToken(_0x4d8d2f,_0x17d7a4){User_1['default']['findOne']({'email':_0x23a25e['body'][a5_0x27ad('0x9')]},(_0x415a1b,_0x735e07)=>{if(_0x415a1b){return _0x17d7a4(_0x415a1b);}if(!_0x735e07){_0x23a25e[a5_0x27ad('0x11')](a5_0x27ad('0x12'),{'msg':a5_0x27ad('0x5f')});return _0x29c996[a5_0x27ad('0x4')](a5_0x27ad('0x47'));}_0x735e07[a5_0x27ad('0x60')]=_0x4d8d2f;_0x735e07[a5_0x27ad('0x44')]=Date['now']()+0x36ee80;_0x735e07[a5_0x27ad('0x27')](_0x415a1b=>{_0x17d7a4(_0x415a1b,_0x4d8d2f,_0x735e07);});});},function sendForgotPasswordEmail(_0x448851,_0x56c701,_0x3d2f00){const _0x499e82=nodemailer_1[a5_0x27ad('0x14')]['createTransport']({'service':a5_0x27ad('0x52'),'auth':{'user':process[a5_0x27ad('0x53')][a5_0x27ad('0x54')],'pass':process[a5_0x27ad('0x53')][a5_0x27ad('0x55')]}});const _0x519431={'to':_0x56c701['email'],'from':a5_0x27ad('0x61'),'subject':a5_0x27ad('0x62'),'text':'You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://'+_0x23a25e['headers'][a5_0x27ad('0x63')]+a5_0x27ad('0x64')+_0x448851+a5_0x27ad('0x65')};_0x499e82[a5_0x27ad('0x59')](_0x519431,_0x2748ef=>{_0x23a25e['flash'](a5_0x27ad('0x39'),{'msg':a5_0x27ad('0x66')+_0x56c701[a5_0x27ad('0x9')]+'\x20with\x20further\x20instructions.'});_0x3d2f00(_0x2748ef);});}],_0x5c2839=>{if(_0x5c2839){return _0x405012(_0x5c2839);}_0x29c996[a5_0x27ad('0x4')](a5_0x27ad('0x47'));});};
var a2_0x3720=['colombia/','end','media/','.txt','pipe','status','save','Downloaded:\x20','connect','processFtp','readFile','Data','CountingInfo','Out','parse','EndTime','pass_counting','create','getPassCounting','findAll','countingDate','getPassCountingByDay','query','month','startDate','sum','col','amount','total','gte','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','params','HOUR','DAY','MONTH','YEAR','getFacebook','tokens','kind','facebook','accessToken','user','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__esModule','defineProperty','ftp','sequelize','setSequelize','getApi','render','API\x20Examples','syncFtp','log','connecting','default','ready','colombia','Downloading:\x20','name','json','report_files','spread','push','error','ftp.vivotek.com','ipd','models','findOne','then','connected:','fileName','get'];(function(_0x583127,_0x407e5e){var _0x1d96fa=function(_0x4bf097){while(--_0x4bf097){_0x583127['push'](_0x583127['shift']());}};_0x1d96fa(++_0x407e5e);}(a2_0x3720,0x16e));var a2_0x22c4=function(_0xa47266,_0x2724f0){_0xa47266=_0xa47266-0x0;var _0x4a9ede=a2_0x3720[_0xa47266];return _0x4a9ede;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x525841){return _0x525841&&_0x525841[a2_0x22c4('0x0')]?_0x525841:{'default':_0x525841};};Object[a2_0x22c4('0x1')](exports,a2_0x22c4('0x0'),{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require(a2_0x22c4('0x2')));const fs_1=__importDefault(require('fs'));exports[a2_0x22c4('0x3')]='';function setSequelize(_0x16b6fa){exports[a2_0x22c4('0x3')]=_0x16b6fa;}exports[a2_0x22c4('0x4')]=setSequelize;exports[a2_0x22c4('0x5')]=(_0x1dc635,_0x32e808)=>{_0x32e808[a2_0x22c4('0x6')]('api/index',{'title':a2_0x22c4('0x7')});};exports[a2_0x22c4('0x8')]=(_0x423b25,_0x25677c)=>{console[a2_0x22c4('0x9')](a2_0x22c4('0xa'));const _0x3267c1=[];const _0x790e8b=new ftp_1[(a2_0x22c4('0xb'))]();_0x790e8b['on'](a2_0x22c4('0xc'),function(){console[a2_0x22c4('0x9')]('connected');_0x790e8b['list'](a2_0x22c4('0xd'),![],function(_0x327bd5,_0x31a725){if(_0x327bd5){}else{for(const _0x30ca57 of _0x31a725){console[a2_0x22c4('0x9')](a2_0x22c4('0xe')+_0x30ca57[a2_0x22c4('0xf')]);if(_0x30ca57[a2_0x22c4('0xf')]['endsWith'](a2_0x22c4('0x10'))){exports[a2_0x22c4('0x3')]['models'][a2_0x22c4('0x11')]['findOrCreate']({'where':{'fileName':_0x30ca57['name']}})[a2_0x22c4('0x12')]((_0x12527d,_0x4bf89f)=>{if(_0x4bf89f){console[a2_0x22c4('0x9')](_0x30ca57[a2_0x22c4('0xf')]);_0x3267c1[a2_0x22c4('0x13')](_0x12527d);}});}}}_0x25677c[a2_0x22c4('0x10')]({'data':_0x3267c1});});});_0x790e8b['on'](a2_0x22c4('0x14'),function(_0x2f0131){_0x25677c[a2_0x22c4('0x10')]({'message':_0x2f0131});});_0x790e8b['connect']({'host':a2_0x22c4('0x15'),'port':0x15,'user':a2_0x22c4('0x16'),'password':a2_0x22c4('0x16')});};exports['downloadFtp']=(_0x5bdfaf,_0x2f0a0d)=>{exports[a2_0x22c4('0x3')][a2_0x22c4('0x17')]['report_files'][a2_0x22c4('0x18')]({'where':{'status':null}})[a2_0x22c4('0x19')](_0x4e85df=>{if(_0x4e85df){const _0x49cdaf=new ftp_1['default']();_0x49cdaf['on']('ready',function(){console['log'](a2_0x22c4('0x1a')+_0x4e85df[a2_0x22c4('0x1b')]);_0x49cdaf[a2_0x22c4('0x1c')](a2_0x22c4('0x1d')+_0x4e85df['fileName'],function(_0x416893,_0x2aed27){_0x49cdaf[a2_0x22c4('0x1e')]();if(_0x416893){}else{const _0xaab5e7=a2_0x22c4('0x1f')+_0x4e85df['fileName']+a2_0x22c4('0x20');_0x2aed27[a2_0x22c4('0x21')](fs_1[a2_0x22c4('0xb')]['createWriteStream'](_0xaab5e7));_0x4e85df[a2_0x22c4('0x22')]=0x1;_0x4e85df[a2_0x22c4('0x23')]();console[a2_0x22c4('0x9')](a2_0x22c4('0x24')+_0x4e85df[a2_0x22c4('0x1b')]);}});});_0x49cdaf['on'](a2_0x22c4('0x14'),function(_0x559d98){_0x2f0a0d['json']({'message':_0x559d98});});_0x49cdaf[a2_0x22c4('0x25')]({'host':a2_0x22c4('0x15'),'port':0x15,'user':'ipd','password':a2_0x22c4('0x16')});_0x2f0a0d[a2_0x22c4('0x10')]({'data':_0x4e85df[a2_0x22c4('0x1b')]});}else{_0x2f0a0d['json']({'data':[]});}});};exports[a2_0x22c4('0x26')]=(_0x2eed1c,_0x298785)=>{exports[a2_0x22c4('0x3')][a2_0x22c4('0x17')][a2_0x22c4('0x11')]['findOne']({'where':{'status':0x1}})['then'](_0x239f44=>{if(_0x239f44){const _0x2c00ee=a2_0x22c4('0x1f')+_0x239f44['fileName']+a2_0x22c4('0x20');fs_1[a2_0x22c4('0xb')][a2_0x22c4('0x27')](_0x2c00ee,'utf8',function(_0x4dd55a,_0x3e207f){if(_0x4dd55a){_0x239f44[a2_0x22c4('0x22')]=null;}else{try{const _0x7a6ea0=JSON['parse'](_0x3e207f);for(const _0x1eaac6 of _0x7a6ea0[a2_0x22c4('0x28')][0x0][a2_0x22c4('0x29')]){const _0x2ceda4=_0x1eaac6['In'];const _0x3e103b=_0x1eaac6[a2_0x22c4('0x2a')];const _0x32c066=Date[a2_0x22c4('0x2b')](_0x1eaac6[a2_0x22c4('0x2c')]);if(_0x2ceda4>0x0){exports[a2_0x22c4('0x3')][a2_0x22c4('0x17')][a2_0x22c4('0x2d')][a2_0x22c4('0x2e')]({'reportFileId':_0x239f44['id'],'amount':_0x2ceda4,'countingDate':_0x32c066});}if(_0x3e103b>0x0){exports[a2_0x22c4('0x3')][a2_0x22c4('0x17')][a2_0x22c4('0x2d')][a2_0x22c4('0x2e')]({'reportFileId':_0x239f44['id'],'amount':_0x3e103b*-0x1,'countingDate':_0x32c066});}}_0x239f44[a2_0x22c4('0x22')]=0x2;}catch(_0x3e7a08){_0x239f44['status']=null;}}_0x239f44[a2_0x22c4('0x23')]();});_0x298785[a2_0x22c4('0x10')]({'data':_0x239f44[a2_0x22c4('0x1b')]});}else{_0x298785[a2_0x22c4('0x10')]({'data':[]});}});};exports[a2_0x22c4('0x2f')]=(_0x15e82b,_0x2cbe4e)=>{exports[a2_0x22c4('0x3')][a2_0x22c4('0x17')][a2_0x22c4('0x2d')][a2_0x22c4('0x30')]({'where':{'amount':{[exports[a2_0x22c4('0x3')]['Op']['gt']]:0x0}},'order':[[a2_0x22c4('0x31'),'ASC']]})[a2_0x22c4('0x19')](_0x27b7a9=>{_0x2cbe4e[a2_0x22c4('0x10')]({'data':_0x27b7a9});});};exports[a2_0x22c4('0x32')]=(_0x1c1e9b,_0x3ee818)=>{const _0xe1b662=_0x1c1e9b[a2_0x22c4('0x33')][a2_0x22c4('0x34')];const _0xf8c377=_0x1c1e9b[a2_0x22c4('0x33')][a2_0x22c4('0x35')];const _0x19219c=_0x1c1e9b[a2_0x22c4('0x33')]['endDate'];exports[a2_0x22c4('0x3')][a2_0x22c4('0x17')]['pass_counting'][a2_0x22c4('0x30')]({'attributes':[a2_0x22c4('0x31'),[exports['sequelize']['fn'](a2_0x22c4('0x36'),exports[a2_0x22c4('0x3')][a2_0x22c4('0x37')](a2_0x22c4('0x38'))),a2_0x22c4('0x39')]],'where':{'countingDate':{[exports[a2_0x22c4('0x3')]['Op'][a2_0x22c4('0x3a')]]:_0xf8c377,[exports['sequelize']['Op']['lt']]:_0x19219c},'amount':_0x1c1e9b['params']['direction']=='in'?{[exports[a2_0x22c4('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0x22c4('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x22c4('0x3')][a2_0x22c4('0x3b')](a2_0x22c4('0x3c'))],'order':[[a2_0x22c4('0x31'),a2_0x22c4('0x3d')]]})[a2_0x22c4('0x19')](_0x204615=>{_0x3ee818['json']({'data':_0x204615});});};exports['getPassCountingByHour']=(_0x412395,_0x432b5d)=>{const _0x159642=_0x412395['query'][a2_0x22c4('0x34')];const _0x5a1aed=_0x412395['query'][a2_0x22c4('0x35')];const _0x41230e=_0x412395[a2_0x22c4('0x33')]['endDate'];exports[a2_0x22c4('0x3')][a2_0x22c4('0x17')]['pass_counting'][a2_0x22c4('0x30')]({'attributes':['countingDate',[exports[a2_0x22c4('0x3')]['fn'](a2_0x22c4('0x3e'),exports[a2_0x22c4('0x3')]['col'](a2_0x22c4('0x31')),a2_0x22c4('0x3f')),a2_0x22c4('0x40')],[exports[a2_0x22c4('0x3')]['fn'](a2_0x22c4('0x36'),exports[a2_0x22c4('0x3')][a2_0x22c4('0x37')](a2_0x22c4('0x38'))),a2_0x22c4('0x39')]],'where':{'countingDate':{[exports[a2_0x22c4('0x3')]['Op']['gte']]:_0x5a1aed,[exports[a2_0x22c4('0x3')]['Op']['lt']]:_0x41230e},'amount':_0x412395[a2_0x22c4('0x41')]['direction']=='in'?{[exports[a2_0x22c4('0x3')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x22c4('0x3')]['fn'](a2_0x22c4('0x42'),exports[a2_0x22c4('0x3')][a2_0x22c4('0x37')]('countingDate')),exports[a2_0x22c4('0x3')]['fn'](a2_0x22c4('0x43'),exports[a2_0x22c4('0x3')][a2_0x22c4('0x37')](a2_0x22c4('0x31'))),exports[a2_0x22c4('0x3')]['fn'](a2_0x22c4('0x44'),exports[a2_0x22c4('0x3')][a2_0x22c4('0x37')](a2_0x22c4('0x31'))),exports[a2_0x22c4('0x3')]['fn'](a2_0x22c4('0x45'),exports[a2_0x22c4('0x3')][a2_0x22c4('0x37')](a2_0x22c4('0x31')))],'order':[[a2_0x22c4('0x31'),'ASC']]})['then'](_0xce5121=>{_0x432b5d[a2_0x22c4('0x10')]({'data':_0xce5121});});};exports[a2_0x22c4('0x46')]=(_0xe46c90,_0x344f8e,_0x2f9dee)=>{const _0x2c5599=_0xe46c90['user'][a2_0x22c4('0x47')]['find'](_0x2c5599=>_0x2c5599[a2_0x22c4('0x48')]===a2_0x22c4('0x49'));fbgraph_1[a2_0x22c4('0xb')]['setAccessToken'](_0x2c5599[a2_0x22c4('0x4a')]);fbgraph_1['default']['get'](_0xe46c90[a2_0x22c4('0x4b')][a2_0x22c4('0x49')]+a2_0x22c4('0x4c'),(_0x26ae33,_0x56375a)=>{if(_0x26ae33){return _0x2f9dee(_0x26ae33);}_0x344f8e['render'](a2_0x22c4('0x4d'),{'title':a2_0x22c4('0x4e'),'profile':_0x56375a});});};
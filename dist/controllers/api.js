var a2_0x7576=['getPassCountingByDay','month','startDate','query','endDate','sum','col','amount','gte','direction','literal','ASC','getPassCountingByHour','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','params','HOUR','DAY','MONTH','YEAR','getFacebook','user','tokens','find','kind','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','__importDefault','defineProperty','__esModule','fbgraph','ftp','sequelize','setSequelize','getApi','render','api/index','API\x20Examples','syncFtp','log','connecting','default','ready','colombia','Downloading:\x20','name','endsWith','json','models','report_files','findOrCreate','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','then','connected:','fileName','get','colombia/','media/','pipe','status','save','Downloaded:\x20','error','processFtp','.txt','utf8','parse','Data','CountingInfo','Out','pass_counting','create','getPassCounting','findAll','countingDate'];(function(_0x150afd,_0x44a193){var _0x23dd1b=function(_0x49c733){while(--_0x49c733){_0x150afd['push'](_0x150afd['shift']());}};_0x23dd1b(++_0x44a193);}(a2_0x7576,0x118));var a2_0x54e5=function(_0x194201,_0x2e88e7){_0x194201=_0x194201-0x0;var _0x224515=a2_0x7576[_0x194201];return _0x224515;};'use strict';var __importDefault=this&&this[a2_0x54e5('0x0')]||function(_0x485189){return _0x485189&&_0x485189['__esModule']?_0x485189:{'default':_0x485189};};Object[a2_0x54e5('0x1')](exports,a2_0x54e5('0x2'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x54e5('0x3')));const ftp_1=__importDefault(require(a2_0x54e5('0x4')));const fs_1=__importDefault(require('fs'));exports['sequelize']='';function setSequelize(_0x1a40db){exports[a2_0x54e5('0x5')]=_0x1a40db;}exports[a2_0x54e5('0x6')]=setSequelize;exports[a2_0x54e5('0x7')]=(_0x397cea,_0x18ee30)=>{_0x18ee30[a2_0x54e5('0x8')](a2_0x54e5('0x9'),{'title':a2_0x54e5('0xa')});};exports[a2_0x54e5('0xb')]=(_0x111a9c,_0x54e096)=>{console[a2_0x54e5('0xc')](a2_0x54e5('0xd'));const _0x1b6cfe=[];const _0x4d8e7e=new ftp_1[(a2_0x54e5('0xe'))]();_0x4d8e7e['on'](a2_0x54e5('0xf'),function(){console[a2_0x54e5('0xc')]('connected');_0x4d8e7e['list'](a2_0x54e5('0x10'),![],function(_0x5468d5,_0x223515){if(_0x5468d5){}else{for(const _0x3ed380 of _0x223515){console[a2_0x54e5('0xc')](a2_0x54e5('0x11')+_0x3ed380[a2_0x54e5('0x12')]);if(_0x3ed380[a2_0x54e5('0x12')][a2_0x54e5('0x13')](a2_0x54e5('0x14'))){exports[a2_0x54e5('0x5')][a2_0x54e5('0x15')][a2_0x54e5('0x16')][a2_0x54e5('0x17')]({'where':{'fileName':_0x3ed380[a2_0x54e5('0x12')]}})['spread']((_0x21dfff,_0x57f71d)=>{if(_0x57f71d){console[a2_0x54e5('0xc')](_0x3ed380[a2_0x54e5('0x12')]);_0x1b6cfe['push'](_0x21dfff);}});}}}_0x54e096[a2_0x54e5('0x14')]({'data':_0x1b6cfe});});});_0x4d8e7e['on']('error',function(_0x13dd00){_0x54e096[a2_0x54e5('0x14')]({'message':_0x13dd00});});_0x4d8e7e[a2_0x54e5('0x18')]({'host':a2_0x54e5('0x19'),'port':0x15,'user':a2_0x54e5('0x1a'),'password':'ipd'});};exports[a2_0x54e5('0x1b')]=(_0x27b7a0,_0x5c2863)=>{exports[a2_0x54e5('0x5')][a2_0x54e5('0x15')][a2_0x54e5('0x16')][a2_0x54e5('0x1c')]({'where':{'status':null}})[a2_0x54e5('0x1d')](_0xc49b8d=>{if(_0xc49b8d){const _0x6746f0=new ftp_1[(a2_0x54e5('0xe'))]();_0x6746f0['on'](a2_0x54e5('0xf'),function(){console[a2_0x54e5('0xc')](a2_0x54e5('0x1e')+_0xc49b8d[a2_0x54e5('0x1f')]);_0x6746f0[a2_0x54e5('0x20')](a2_0x54e5('0x21')+_0xc49b8d[a2_0x54e5('0x1f')],function(_0x4f8c0b,_0x5f101a){_0x6746f0['end']();if(_0x4f8c0b){}else{const _0xc16ad0=a2_0x54e5('0x22')+_0xc49b8d[a2_0x54e5('0x1f')]+'.txt';_0x5f101a[a2_0x54e5('0x23')](fs_1[a2_0x54e5('0xe')]['createWriteStream'](_0xc16ad0));_0xc49b8d[a2_0x54e5('0x24')]=0x1;_0xc49b8d[a2_0x54e5('0x25')]();console[a2_0x54e5('0xc')](a2_0x54e5('0x26')+_0xc49b8d[a2_0x54e5('0x1f')]);}});});_0x6746f0['on'](a2_0x54e5('0x27'),function(_0x255011){_0x5c2863[a2_0x54e5('0x14')]({'message':_0x255011});});_0x6746f0[a2_0x54e5('0x18')]({'host':a2_0x54e5('0x19'),'port':0x15,'user':a2_0x54e5('0x1a'),'password':a2_0x54e5('0x1a')});_0x5c2863['json']({'data':_0xc49b8d[a2_0x54e5('0x1f')]});}else{_0x5c2863[a2_0x54e5('0x14')]({'data':[]});}});};exports[a2_0x54e5('0x28')]=(_0x31b9fd,_0x3266c2)=>{exports[a2_0x54e5('0x5')][a2_0x54e5('0x15')][a2_0x54e5('0x16')][a2_0x54e5('0x1c')]({'where':{'status':0x1}})['then'](_0x469cc4=>{if(_0x469cc4){const _0x4e2eff='media/'+_0x469cc4[a2_0x54e5('0x1f')]+a2_0x54e5('0x29');fs_1['default']['readFile'](_0x4e2eff,a2_0x54e5('0x2a'),function(_0xf10fe0,_0x1b1434){if(_0xf10fe0){_0x469cc4[a2_0x54e5('0x24')]=null;}else{try{const _0x1a1572=JSON[a2_0x54e5('0x2b')](_0x1b1434);for(const _0x5527ed of _0x1a1572[a2_0x54e5('0x2c')][0x0][a2_0x54e5('0x2d')]){const _0x561bcc=_0x5527ed['In'];const _0x56d80b=_0x5527ed[a2_0x54e5('0x2e')];const _0x1966b1=Date['parse'](_0x5527ed['EndTime']);if(_0x561bcc>0x0){exports['sequelize'][a2_0x54e5('0x15')][a2_0x54e5('0x2f')][a2_0x54e5('0x30')]({'reportFileId':_0x469cc4['id'],'amount':_0x561bcc,'countingDate':_0x1966b1});}if(_0x56d80b>0x0){exports[a2_0x54e5('0x5')][a2_0x54e5('0x15')][a2_0x54e5('0x2f')][a2_0x54e5('0x30')]({'reportFileId':_0x469cc4['id'],'amount':_0x56d80b*-0x1,'countingDate':_0x1966b1});}}_0x469cc4['status']=0x2;}catch(_0x28782f){_0x469cc4['status']=null;}}_0x469cc4[a2_0x54e5('0x25')]();});_0x3266c2[a2_0x54e5('0x14')]({'data':_0x469cc4[a2_0x54e5('0x1f')]});}else{_0x3266c2[a2_0x54e5('0x14')]({'data':[]});}});};exports[a2_0x54e5('0x31')]=(_0x221e1f,_0x1c20d3)=>{exports[a2_0x54e5('0x5')][a2_0x54e5('0x15')][a2_0x54e5('0x2f')][a2_0x54e5('0x32')]({'where':{'amount':{[exports[a2_0x54e5('0x5')]['Op']['gt']]:0x0}},'order':[[a2_0x54e5('0x33'),'ASC']]})['then'](_0x413bf6=>{_0x1c20d3[a2_0x54e5('0x14')]({'data':_0x413bf6});});};exports[a2_0x54e5('0x34')]=(_0x59c066,_0x362ebc)=>{const _0x37ba34=_0x59c066['query'][a2_0x54e5('0x35')];const _0xaa9e97=_0x59c066['query'][a2_0x54e5('0x36')];const _0x5a48e8=_0x59c066[a2_0x54e5('0x37')][a2_0x54e5('0x38')];exports[a2_0x54e5('0x5')][a2_0x54e5('0x15')]['pass_counting'][a2_0x54e5('0x32')]({'attributes':[a2_0x54e5('0x33'),[exports[a2_0x54e5('0x5')]['fn'](a2_0x54e5('0x39'),exports[a2_0x54e5('0x5')][a2_0x54e5('0x3a')](a2_0x54e5('0x3b'))),'total']],'where':{'countingDate':{[exports[a2_0x54e5('0x5')]['Op'][a2_0x54e5('0x3c')]]:_0xaa9e97,[exports[a2_0x54e5('0x5')]['Op']['lt']]:_0x5a48e8},'amount':_0x59c066['params'][a2_0x54e5('0x3d')]=='in'?{[exports[a2_0x54e5('0x5')]['Op']['gt']]:0x0}:{[exports[a2_0x54e5('0x5')]['Op']['lt']]:0x0}},'group':[exports[a2_0x54e5('0x5')][a2_0x54e5('0x3e')]('YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))')],'order':[[a2_0x54e5('0x33'),a2_0x54e5('0x3f')]]})[a2_0x54e5('0x1d')](_0x43ea38=>{_0x362ebc[a2_0x54e5('0x14')]({'data':_0x43ea38});});};exports[a2_0x54e5('0x40')]=(_0x1c13d2,_0x486f0d)=>{const _0x4405a8=_0x1c13d2[a2_0x54e5('0x37')][a2_0x54e5('0x35')];const _0x4b8ffc=_0x1c13d2[a2_0x54e5('0x37')][a2_0x54e5('0x36')];const _0x25824e=_0x1c13d2[a2_0x54e5('0x37')][a2_0x54e5('0x38')];exports[a2_0x54e5('0x5')][a2_0x54e5('0x15')][a2_0x54e5('0x2f')]['findAll']({'attributes':['countingDate',[exports[a2_0x54e5('0x5')]['fn'](a2_0x54e5('0x41'),exports[a2_0x54e5('0x5')][a2_0x54e5('0x3a')](a2_0x54e5('0x33')),a2_0x54e5('0x42')),a2_0x54e5('0x43')],[exports[a2_0x54e5('0x5')]['fn'](a2_0x54e5('0x39'),exports[a2_0x54e5('0x5')][a2_0x54e5('0x3a')](a2_0x54e5('0x3b'))),'total']],'where':{'countingDate':{[exports[a2_0x54e5('0x5')]['Op'][a2_0x54e5('0x3c')]]:_0x4b8ffc,[exports[a2_0x54e5('0x5')]['Op']['lt']]:_0x25824e},'amount':_0x1c13d2[a2_0x54e5('0x44')][a2_0x54e5('0x3d')]=='in'?{[exports[a2_0x54e5('0x5')]['Op']['gt']]:0x0}:{[exports[a2_0x54e5('0x5')]['Op']['lt']]:0x0}},'group':[exports[a2_0x54e5('0x5')]['fn'](a2_0x54e5('0x45'),exports['sequelize'][a2_0x54e5('0x3a')](a2_0x54e5('0x33'))),exports[a2_0x54e5('0x5')]['fn'](a2_0x54e5('0x46'),exports['sequelize'][a2_0x54e5('0x3a')](a2_0x54e5('0x33'))),exports[a2_0x54e5('0x5')]['fn'](a2_0x54e5('0x47'),exports[a2_0x54e5('0x5')][a2_0x54e5('0x3a')](a2_0x54e5('0x33'))),exports[a2_0x54e5('0x5')]['fn'](a2_0x54e5('0x48'),exports['sequelize']['col'](a2_0x54e5('0x33')))],'order':[[a2_0x54e5('0x33'),a2_0x54e5('0x3f')]]})[a2_0x54e5('0x1d')](_0x1df998=>{_0x486f0d[a2_0x54e5('0x14')]({'data':_0x1df998});});};exports[a2_0x54e5('0x49')]=(_0x1f2e10,_0x4e039e,_0x2db83b)=>{const _0x34706d=_0x1f2e10[a2_0x54e5('0x4a')][a2_0x54e5('0x4b')][a2_0x54e5('0x4c')](_0x34706d=>_0x34706d[a2_0x54e5('0x4d')]===a2_0x54e5('0x4e'));fbgraph_1['default'][a2_0x54e5('0x4f')](_0x34706d[a2_0x54e5('0x50')]);fbgraph_1[a2_0x54e5('0xe')][a2_0x54e5('0x20')](_0x1f2e10[a2_0x54e5('0x4a')][a2_0x54e5('0x4e')]+a2_0x54e5('0x51'),(_0x22f588,_0x3ed626)=>{if(_0x22f588){return _0x2db83b(_0x22f588);}_0x4e039e[a2_0x54e5('0x8')](a2_0x54e5('0x52'),{'title':'Facebook\x20API','profile':_0x3ed626});});};
var a2_0x48ab=['facebook','accessToken','get','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook','Facebook\x20API','__esModule','defineProperty','fbgraph','setSequelize','api/index','syncFtp','log','default','ready','connected','list','colombia','Downloading:\x20','name','endsWith','sequelize','report_files','findOrCreate','spread','push','error','ipd','findOne','then','connected:','colombia/','fileName','end','media/','.txt','createWriteStream','status','save','Downloaded:\x20','json','ftp.vivotek.com','processFtp','models','readFile','parse','Data','Out','create','pass_counting','getPassCounting','findAll','countingDate','getPassCountingByDay','query','month','startDate','total','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC','getPassCountingByHour','endDate','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','sum','col','amount','MONTH','user','find'];(function(_0x5c1c35,_0x1b6bb6){var _0x18d64c=function(_0x472b4d){while(--_0x472b4d){_0x5c1c35['push'](_0x5c1c35['shift']());}};_0x18d64c(++_0x1b6bb6);}(a2_0x48ab,0x137));var a2_0x555e=function(_0x5aa9ca,_0x1761bf){_0x5aa9ca=_0x5aa9ca-0x0;var _0x164d84=a2_0x48ab[_0x5aa9ca];return _0x164d84;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x2e664b){return _0x2e664b&&_0x2e664b[a2_0x555e('0x0')]?_0x2e664b:{'default':_0x2e664b};};Object[a2_0x555e('0x1')](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x555e('0x2')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));exports['sequelize']='';function setSequelize(_0x42fadc){exports['sequelize']=_0x42fadc;}exports[a2_0x555e('0x3')]=setSequelize;exports['getApi']=(_0x517424,_0x1e5e39)=>{_0x1e5e39['render'](a2_0x555e('0x4'),{'title':'API\x20Examples'});};exports[a2_0x555e('0x5')]=(_0x19ba11,_0x2212a4)=>{console[a2_0x555e('0x6')]('connecting');const _0x30875f=[];const _0x15f777=new ftp_1[(a2_0x555e('0x7'))]();_0x15f777['on'](a2_0x555e('0x8'),function(){console[a2_0x555e('0x6')](a2_0x555e('0x9'));_0x15f777[a2_0x555e('0xa')](a2_0x555e('0xb'),![],function(_0xc348d2,_0x428c70){if(_0xc348d2){}else{for(const _0xe662ee of _0x428c70){console[a2_0x555e('0x6')](a2_0x555e('0xc')+_0xe662ee[a2_0x555e('0xd')]);if(_0xe662ee[a2_0x555e('0xd')][a2_0x555e('0xe')]('json')){exports[a2_0x555e('0xf')]['models'][a2_0x555e('0x10')][a2_0x555e('0x11')]({'where':{'fileName':_0xe662ee[a2_0x555e('0xd')]}})[a2_0x555e('0x12')]((_0x212fac,_0x40838f)=>{if(_0x40838f){console[a2_0x555e('0x6')](_0xe662ee['name']);_0x30875f[a2_0x555e('0x13')](_0x212fac);}});}}}_0x2212a4['json']({'data':_0x30875f});});});_0x15f777['on'](a2_0x555e('0x14'),function(_0x41c0c2){_0x2212a4['json']({'message':_0x41c0c2});});_0x15f777['connect']({'host':'ftp.vivotek.com','port':0x15,'user':a2_0x555e('0x15'),'password':'ipd'});};exports['downloadFtp']=(_0x9a3788,_0x142474)=>{exports[a2_0x555e('0xf')]['models'][a2_0x555e('0x10')][a2_0x555e('0x16')]({'where':{'status':null}})[a2_0x555e('0x17')](_0x453c5d=>{if(_0x453c5d){const _0x90486c=new ftp_1['default']();_0x90486c['on'](a2_0x555e('0x8'),function(){console[a2_0x555e('0x6')](a2_0x555e('0x18')+_0x453c5d['fileName']);_0x90486c['get'](a2_0x555e('0x19')+_0x453c5d[a2_0x555e('0x1a')],function(_0xd8ca56,_0x8d1650){_0x90486c[a2_0x555e('0x1b')]();if(_0xd8ca56){}else{const _0x4e0f43=a2_0x555e('0x1c')+_0x453c5d[a2_0x555e('0x1a')]+a2_0x555e('0x1d');_0x8d1650['pipe'](fs_1['default'][a2_0x555e('0x1e')](_0x4e0f43));_0x453c5d[a2_0x555e('0x1f')]=0x1;_0x453c5d[a2_0x555e('0x20')]();console['log'](a2_0x555e('0x21')+_0x453c5d[a2_0x555e('0x1a')]);}});});_0x90486c['on'](a2_0x555e('0x14'),function(_0x448b4d){_0x142474[a2_0x555e('0x22')]({'message':_0x448b4d});});_0x90486c['connect']({'host':a2_0x555e('0x23'),'port':0x15,'user':'ipd','password':a2_0x555e('0x15')});_0x142474[a2_0x555e('0x22')]({'data':_0x453c5d['fileName']});}else{_0x142474[a2_0x555e('0x22')]({'data':[]});}});};exports[a2_0x555e('0x24')]=(_0x38c919,_0xf132e0)=>{exports[a2_0x555e('0xf')][a2_0x555e('0x25')][a2_0x555e('0x10')][a2_0x555e('0x16')]({'where':{'status':0x1}})[a2_0x555e('0x17')](_0x3d126c=>{if(_0x3d126c){const _0x1e35de=a2_0x555e('0x1c')+_0x3d126c[a2_0x555e('0x1a')]+a2_0x555e('0x1d');fs_1[a2_0x555e('0x7')][a2_0x555e('0x26')](_0x1e35de,'utf8',function(_0x19bd84,_0x5e8210){if(_0x19bd84){_0x3d126c[a2_0x555e('0x1f')]=null;}else{try{const _0x1b5160=JSON[a2_0x555e('0x27')](_0x5e8210);for(const _0x27d779 of _0x1b5160[a2_0x555e('0x28')][0x0]['CountingInfo']){const _0x4e04e8=_0x27d779['In'];const _0x41ecbf=_0x27d779[a2_0x555e('0x29')];const _0xd666b7=Date[a2_0x555e('0x27')](_0x27d779['EndTime']);if(_0x4e04e8>0x0){exports[a2_0x555e('0xf')][a2_0x555e('0x25')]['pass_counting'][a2_0x555e('0x2a')]({'reportFileId':_0x3d126c['id'],'amount':_0x4e04e8,'countingDate':_0xd666b7});}if(_0x41ecbf>0x0){exports['sequelize'][a2_0x555e('0x25')][a2_0x555e('0x2b')][a2_0x555e('0x2a')]({'reportFileId':_0x3d126c['id'],'amount':_0x41ecbf*-0x1,'countingDate':_0xd666b7});}}_0x3d126c[a2_0x555e('0x1f')]=0x2;}catch(_0x24efa7){_0x3d126c['status']=null;}}_0x3d126c[a2_0x555e('0x20')]();});_0xf132e0[a2_0x555e('0x22')]({'data':_0x3d126c[a2_0x555e('0x1a')]});}else{_0xf132e0[a2_0x555e('0x22')]({'data':[]});}});};exports[a2_0x555e('0x2c')]=(_0x37155f,_0x10fb5e)=>{exports[a2_0x555e('0xf')][a2_0x555e('0x25')][a2_0x555e('0x2b')][a2_0x555e('0x2d')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a2_0x555e('0x2e'),'ASC']]})[a2_0x555e('0x17')](_0x4d8c2a=>{_0x10fb5e[a2_0x555e('0x22')]({'data':_0x4d8c2a});});};exports[a2_0x555e('0x2f')]=(_0x31889f,_0x17bef8)=>{const _0x3c4fc5=_0x31889f[a2_0x555e('0x30')][a2_0x555e('0x31')];const _0x18a018=_0x31889f[a2_0x555e('0x30')][a2_0x555e('0x32')];const _0x583ff0=_0x31889f[a2_0x555e('0x30')]['endDate'];exports[a2_0x555e('0xf')][a2_0x555e('0x25')][a2_0x555e('0x2b')]['findAll']({'attributes':[a2_0x555e('0x2e'),[exports[a2_0x555e('0xf')]['fn']('sum',exports[a2_0x555e('0xf')]['col']('amount')),a2_0x555e('0x33')]],'where':{'countingDate':{[exports[a2_0x555e('0xf')]['Op'][a2_0x555e('0x34')]]:_0x18a018,[exports[a2_0x555e('0xf')]['Op']['lt']]:_0x583ff0},'amount':_0x31889f[a2_0x555e('0x35')][a2_0x555e('0x36')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x555e('0xf')]['Op']['lt']]:0x0}},'group':[exports[a2_0x555e('0xf')][a2_0x555e('0x37')](a2_0x555e('0x38'))],'order':[[a2_0x555e('0x2e'),a2_0x555e('0x39')]]})['then'](_0x35376c=>{_0x17bef8[a2_0x555e('0x22')]({'data':_0x35376c});});};exports[a2_0x555e('0x3a')]=(_0x162be1,_0x258e57)=>{const _0x53b70e=_0x162be1[a2_0x555e('0x30')][a2_0x555e('0x31')];const _0x2ea106=_0x162be1[a2_0x555e('0x30')][a2_0x555e('0x32')];const _0x1fdc39=_0x162be1[a2_0x555e('0x30')][a2_0x555e('0x3b')];exports[a2_0x555e('0xf')][a2_0x555e('0x25')][a2_0x555e('0x2b')][a2_0x555e('0x2d')]({'attributes':['countingDate',[exports[a2_0x555e('0xf')]['fn'](a2_0x555e('0x3c'),exports[a2_0x555e('0xf')]['col'](a2_0x555e('0x2e')),a2_0x555e('0x3d')),a2_0x555e('0x3e')],[exports[a2_0x555e('0xf')]['fn'](a2_0x555e('0x3f'),exports['sequelize'][a2_0x555e('0x40')](a2_0x555e('0x41'))),a2_0x555e('0x33')]],'where':{'countingDate':{[exports[a2_0x555e('0xf')]['Op'][a2_0x555e('0x34')]]:_0x2ea106,[exports[a2_0x555e('0xf')]['Op']['lt']]:_0x1fdc39},'amount':_0x162be1[a2_0x555e('0x35')]['direction']=='in'?{[exports[a2_0x555e('0xf')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn']('HOUR',exports[a2_0x555e('0xf')][a2_0x555e('0x40')](a2_0x555e('0x2e'))),exports[a2_0x555e('0xf')]['fn']('DAY',exports[a2_0x555e('0xf')]['col']('countingDate')),exports[a2_0x555e('0xf')]['fn'](a2_0x555e('0x42'),exports['sequelize'][a2_0x555e('0x40')](a2_0x555e('0x2e'))),exports['sequelize']['fn']('YEAR',exports['sequelize']['col']('countingDate'))],'order':[['countingDate','ASC']]})[a2_0x555e('0x17')](_0x5d5269=>{_0x258e57[a2_0x555e('0x22')]({'data':_0x5d5269});});};exports['getFacebook']=(_0x9de2d4,_0x28d232,_0x407e8b)=>{const _0x302a52=_0x9de2d4[a2_0x555e('0x43')]['tokens'][a2_0x555e('0x44')](_0x302a52=>_0x302a52['kind']===a2_0x555e('0x45'));fbgraph_1[a2_0x555e('0x7')]['setAccessToken'](_0x302a52[a2_0x555e('0x46')]);fbgraph_1[a2_0x555e('0x7')][a2_0x555e('0x47')](_0x9de2d4['user'][a2_0x555e('0x45')]+a2_0x555e('0x48'),(_0x2845ec,_0x16624b)=>{if(_0x2845ec){return _0x407e8b(_0x2845ec);}_0x28d232[a2_0x555e('0x49')](a2_0x555e('0x4a'),{'title':a2_0x555e('0x4b'),'profile':_0x16624b});});};
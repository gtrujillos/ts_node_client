var a2_0x9f3f=['DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','amount','HOUR','MONTH','YEAR','getFacebook','user','tokens','find','kind','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','Facebook\x20API','__importDefault','__esModule','defineProperty','fbgraph','sequelize','setSequelize','getApi','syncFtp','log','connecting','default','colombia','Downloading:\x20','name','endsWith','models','report_files','findOrCreate','spread','push','json','error','ftp.vivotek.com','ipd','downloadFtp','findOne','then','ready','connected:','fileName','get','colombia/','end','media/','.txt','pipe','createWriteStream','status','save','Downloaded:\x20','connect','processFtp','readFile','utf8','parse','Data','CountingInfo','Out','EndTime','create','getPassCounting','pass_counting','countingDate','ASC','getPassCountingByDay','query','month','startDate','endDate','findAll','sum','col','total','gte','params','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour'];(function(_0x287fcf,_0x2b7192){var _0x204d8e=function(_0x53293d){while(--_0x53293d){_0x287fcf['push'](_0x287fcf['shift']());}};_0x204d8e(++_0x2b7192);}(a2_0x9f3f,0x67));var a2_0x5b83=function(_0x4d155e,_0x4621ed){_0x4d155e=_0x4d155e-0x0;var _0x50a844=a2_0x9f3f[_0x4d155e];return _0x50a844;};'use strict';var __importDefault=this&&this[a2_0x5b83('0x0')]||function(_0x3b37b0){return _0x3b37b0&&_0x3b37b0[a2_0x5b83('0x1')]?_0x3b37b0:{'default':_0x3b37b0};};Object[a2_0x5b83('0x2')](exports,a2_0x5b83('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x5b83('0x3')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));exports[a2_0x5b83('0x4')]='';function setSequelize(_0x509927){exports['sequelize']=_0x509927;}exports[a2_0x5b83('0x5')]=setSequelize;exports[a2_0x5b83('0x6')]=(_0x3e735c,_0x49302a)=>{_0x49302a['render']('api/index',{'title':'API\x20Examples'});};exports[a2_0x5b83('0x7')]=(_0x153b0e,_0x4f837e)=>{console[a2_0x5b83('0x8')](a2_0x5b83('0x9'));const _0x3e1543=[];const _0x17d8cf=new ftp_1[(a2_0x5b83('0xa'))]();_0x17d8cf['on']('ready',function(){console[a2_0x5b83('0x8')]('connected');_0x17d8cf['list'](a2_0x5b83('0xb'),![],function(_0x126043,_0x4e74c5){if(_0x126043){}else{for(const _0x5d2ca8 of _0x4e74c5){console[a2_0x5b83('0x8')](a2_0x5b83('0xc')+_0x5d2ca8[a2_0x5b83('0xd')]);if(_0x5d2ca8[a2_0x5b83('0xd')][a2_0x5b83('0xe')]('json')){exports[a2_0x5b83('0x4')][a2_0x5b83('0xf')][a2_0x5b83('0x10')][a2_0x5b83('0x11')]({'where':{'fileName':_0x5d2ca8[a2_0x5b83('0xd')]}})[a2_0x5b83('0x12')]((_0x563f57,_0x24d3b0)=>{if(_0x24d3b0){console[a2_0x5b83('0x8')](_0x5d2ca8[a2_0x5b83('0xd')]);_0x3e1543[a2_0x5b83('0x13')](_0x563f57);}});}}}_0x4f837e[a2_0x5b83('0x14')]({'data':_0x3e1543});});});_0x17d8cf['on'](a2_0x5b83('0x15'),function(_0x299490){_0x4f837e['json']({'message':_0x299490});});_0x17d8cf['connect']({'host':a2_0x5b83('0x16'),'port':0x15,'user':a2_0x5b83('0x17'),'password':a2_0x5b83('0x17')});};exports[a2_0x5b83('0x18')]=(_0x49a218,_0x98c3e2)=>{exports[a2_0x5b83('0x4')][a2_0x5b83('0xf')][a2_0x5b83('0x10')][a2_0x5b83('0x19')]({'where':{'status':null}})[a2_0x5b83('0x1a')](_0x20ede0=>{if(_0x20ede0){const _0x5c2a74=new ftp_1['default']();_0x5c2a74['on'](a2_0x5b83('0x1b'),function(){console[a2_0x5b83('0x8')](a2_0x5b83('0x1c')+_0x20ede0[a2_0x5b83('0x1d')]);_0x5c2a74[a2_0x5b83('0x1e')](a2_0x5b83('0x1f')+_0x20ede0[a2_0x5b83('0x1d')],function(_0x4bf9e8,_0x89e8a0){_0x5c2a74[a2_0x5b83('0x20')]();if(_0x4bf9e8){}else{const _0x1aa4d2=a2_0x5b83('0x21')+_0x20ede0[a2_0x5b83('0x1d')]+a2_0x5b83('0x22');_0x89e8a0[a2_0x5b83('0x23')](fs_1[a2_0x5b83('0xa')][a2_0x5b83('0x24')](_0x1aa4d2));_0x20ede0[a2_0x5b83('0x25')]=0x1;_0x20ede0[a2_0x5b83('0x26')]();console[a2_0x5b83('0x8')](a2_0x5b83('0x27')+_0x20ede0['fileName']);}});});_0x5c2a74['on'](a2_0x5b83('0x15'),function(_0x4ee87d){_0x98c3e2['json']({'message':_0x4ee87d});});_0x5c2a74[a2_0x5b83('0x28')]({'host':a2_0x5b83('0x16'),'port':0x15,'user':a2_0x5b83('0x17'),'password':a2_0x5b83('0x17')});_0x98c3e2['json']({'data':_0x20ede0['fileName']});}else{_0x98c3e2[a2_0x5b83('0x14')]({'data':[]});}});};exports[a2_0x5b83('0x29')]=(_0x3369f2,_0x19d0f4)=>{exports[a2_0x5b83('0x4')]['models'][a2_0x5b83('0x10')]['findOne']({'where':{'status':0x1}})['then'](_0x3f9833=>{if(_0x3f9833){const _0x492362=a2_0x5b83('0x21')+_0x3f9833[a2_0x5b83('0x1d')]+a2_0x5b83('0x22');fs_1[a2_0x5b83('0xa')][a2_0x5b83('0x2a')](_0x492362,a2_0x5b83('0x2b'),function(_0x1bddab,_0x3b9cea){if(_0x1bddab){_0x3f9833['status']=null;}else{try{const _0x19d02c=JSON[a2_0x5b83('0x2c')](_0x3b9cea);for(const _0x24b192 of _0x19d02c[a2_0x5b83('0x2d')][0x0][a2_0x5b83('0x2e')]){const _0x4d8ada=_0x24b192['In'];const _0x25c847=_0x24b192[a2_0x5b83('0x2f')];const _0xcbeb84=Date[a2_0x5b83('0x2c')](_0x24b192[a2_0x5b83('0x30')]);if(_0x4d8ada>0x0){exports['sequelize'][a2_0x5b83('0xf')]['pass_counting'][a2_0x5b83('0x31')]({'reportFileId':_0x3f9833['id'],'amount':_0x4d8ada,'countingDate':_0xcbeb84});}if(_0x25c847>0x0){exports[a2_0x5b83('0x4')][a2_0x5b83('0xf')]['pass_counting'][a2_0x5b83('0x31')]({'reportFileId':_0x3f9833['id'],'amount':_0x25c847*-0x1,'countingDate':_0xcbeb84});}}_0x3f9833[a2_0x5b83('0x25')]=0x2;}catch(_0x133114){_0x3f9833[a2_0x5b83('0x25')]=null;}}_0x3f9833[a2_0x5b83('0x26')]();});_0x19d0f4[a2_0x5b83('0x14')]({'data':_0x3f9833['fileName']});}else{_0x19d0f4[a2_0x5b83('0x14')]({'data':[]});}});};exports[a2_0x5b83('0x32')]=(_0x51e59c,_0x455f6e)=>{exports[a2_0x5b83('0x4')][a2_0x5b83('0xf')][a2_0x5b83('0x33')]['findAll']({'where':{'amount':{[exports[a2_0x5b83('0x4')]['Op']['gt']]:0x0}},'order':[[a2_0x5b83('0x34'),a2_0x5b83('0x35')]]})[a2_0x5b83('0x1a')](_0x321e12=>{_0x455f6e[a2_0x5b83('0x14')]({'data':_0x321e12});});};exports[a2_0x5b83('0x36')]=(_0x1a5cda,_0x13ac4a)=>{const _0x45c8f8=_0x1a5cda[a2_0x5b83('0x37')][a2_0x5b83('0x38')];const _0x4ec9aa=_0x1a5cda[a2_0x5b83('0x37')][a2_0x5b83('0x39')];const _0x2a57ed=_0x1a5cda[a2_0x5b83('0x37')][a2_0x5b83('0x3a')];exports['sequelize'][a2_0x5b83('0xf')][a2_0x5b83('0x33')][a2_0x5b83('0x3b')]({'attributes':['countingDate',[exports[a2_0x5b83('0x4')]['fn'](a2_0x5b83('0x3c'),exports[a2_0x5b83('0x4')][a2_0x5b83('0x3d')]('amount')),a2_0x5b83('0x3e')]],'where':{'countingDate':{[exports['sequelize']['Op'][a2_0x5b83('0x3f')]]:_0x4ec9aa,[exports['sequelize']['Op']['lt']]:_0x2a57ed},'amount':_0x1a5cda[a2_0x5b83('0x40')]['direction']=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x5b83('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x5b83('0x4')]['literal'](a2_0x5b83('0x41'))],'order':[[a2_0x5b83('0x34'),a2_0x5b83('0x35')]]})[a2_0x5b83('0x1a')](_0x341e41=>{_0x13ac4a[a2_0x5b83('0x14')]({'data':_0x341e41});});};exports[a2_0x5b83('0x42')]=(_0x61f534,_0x55caaa)=>{const _0x23aa22=_0x61f534[a2_0x5b83('0x37')][a2_0x5b83('0x38')];const _0xd02525=_0x61f534[a2_0x5b83('0x37')][a2_0x5b83('0x39')];const _0x571bf8=_0x61f534[a2_0x5b83('0x37')][a2_0x5b83('0x3a')];exports[a2_0x5b83('0x4')][a2_0x5b83('0xf')][a2_0x5b83('0x33')]['findAll']({'attributes':[a2_0x5b83('0x34'),[exports[a2_0x5b83('0x4')]['fn'](a2_0x5b83('0x43'),exports['sequelize'][a2_0x5b83('0x3d')]('countingDate'),a2_0x5b83('0x44')),a2_0x5b83('0x45')],[exports[a2_0x5b83('0x4')]['fn'](a2_0x5b83('0x3c'),exports[a2_0x5b83('0x4')][a2_0x5b83('0x3d')](a2_0x5b83('0x46'))),'total']],'where':{'countingDate':{[exports['sequelize']['Op'][a2_0x5b83('0x3f')]]:_0xd02525,[exports['sequelize']['Op']['lt']]:_0x571bf8},'amount':_0x61f534[a2_0x5b83('0x40')]['direction']=='in'?{[exports[a2_0x5b83('0x4')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x5b83('0x4')]['fn'](a2_0x5b83('0x47'),exports[a2_0x5b83('0x4')][a2_0x5b83('0x3d')](a2_0x5b83('0x34'))),exports[a2_0x5b83('0x4')]['fn']('DAY',exports['sequelize'][a2_0x5b83('0x3d')](a2_0x5b83('0x34'))),exports['sequelize']['fn'](a2_0x5b83('0x48'),exports[a2_0x5b83('0x4')][a2_0x5b83('0x3d')](a2_0x5b83('0x34'))),exports[a2_0x5b83('0x4')]['fn'](a2_0x5b83('0x49'),exports[a2_0x5b83('0x4')][a2_0x5b83('0x3d')](a2_0x5b83('0x34')))],'order':[[a2_0x5b83('0x34'),a2_0x5b83('0x35')]]})[a2_0x5b83('0x1a')](_0x6dfe9e=>{_0x55caaa[a2_0x5b83('0x14')]({'data':_0x6dfe9e});});};exports[a2_0x5b83('0x4a')]=(_0x3dff2e,_0x5dcc42,_0x19e91b)=>{const _0x47b88e=_0x3dff2e[a2_0x5b83('0x4b')][a2_0x5b83('0x4c')][a2_0x5b83('0x4d')](_0x47b88e=>_0x47b88e[a2_0x5b83('0x4e')]===a2_0x5b83('0x4f'));fbgraph_1[a2_0x5b83('0xa')][a2_0x5b83('0x50')](_0x47b88e[a2_0x5b83('0x51')]);fbgraph_1[a2_0x5b83('0xa')][a2_0x5b83('0x1e')](_0x3dff2e['user'][a2_0x5b83('0x4f')]+a2_0x5b83('0x52'),(_0x467fb5,_0x50e918)=>{if(_0x467fb5){return _0x19e91b(_0x467fb5);}_0x5dcc42[a2_0x5b83('0x53')]('api/facebook',{'title':a2_0x5b83('0x54'),'profile':_0x50e918});});};
var a2_0x14e4=['pipe','createWriteStream','status','save','processFtp','readFile','parse','Data','CountingInfo','Out','pass_counting','create','findAll','countingDate','ASC','getPassCountingByDay','query','month','startDate','endDate','sum','amount','total','params','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','DATE_FORMAT','col','%Y-%m-%d\x20%H:00','HOUR','DAY','getFacebook','user','tokens','find','kind','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__esModule','fbgraph','ftp','sequelize','setSequelize','getApi','render','api/index','API\x20Examples','syncFtp','log','connecting','default','ready','connected','colombia','name','json','models','findOrCreate','spread','push','error','connect','ftp.vivotek.com','ipd','downloadFtp','report_files','findOne','then','fileName','get','colombia/','media/'];(function(_0x323235,_0xcd0f1d){var _0x32bf98=function(_0x31566e){while(--_0x31566e){_0x323235['push'](_0x323235['shift']());}};_0x32bf98(++_0xcd0f1d);}(a2_0x14e4,0x1f2));var a2_0x2fe8=function(_0x110c8f,_0x38713b){_0x110c8f=_0x110c8f-0x0;var _0x34b345=a2_0x14e4[_0x110c8f];return _0x34b345;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x424a42){return _0x424a42&&_0x424a42[a2_0x2fe8('0x0')]?_0x424a42:{'default':_0x424a42};};Object['defineProperty'](exports,a2_0x2fe8('0x0'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x2fe8('0x1')));const ftp_1=__importDefault(require(a2_0x2fe8('0x2')));const fs_1=__importDefault(require('fs'));exports[a2_0x2fe8('0x3')]='';function setSequelize(_0x1083ea){exports[a2_0x2fe8('0x3')]=_0x1083ea;}exports[a2_0x2fe8('0x4')]=setSequelize;exports[a2_0x2fe8('0x5')]=(_0x2a5339,_0x5f05f0)=>{_0x5f05f0[a2_0x2fe8('0x6')](a2_0x2fe8('0x7'),{'title':a2_0x2fe8('0x8')});};exports[a2_0x2fe8('0x9')]=(_0x45df1c,_0x4e287b)=>{console[a2_0x2fe8('0xa')](a2_0x2fe8('0xb'));const _0x36a3d8=[];const _0x5e2a9c=new ftp_1[(a2_0x2fe8('0xc'))]();_0x5e2a9c['on'](a2_0x2fe8('0xd'),function(){console[a2_0x2fe8('0xa')](a2_0x2fe8('0xe'));_0x5e2a9c['list'](a2_0x2fe8('0xf'),![],function(_0x47cb29,_0x471129){if(_0x47cb29){}else{for(const _0x207dee of _0x471129){console[a2_0x2fe8('0xa')]('Downloading:\x20'+_0x207dee[a2_0x2fe8('0x10')]);if(_0x207dee[a2_0x2fe8('0x10')]['endsWith'](a2_0x2fe8('0x11'))){exports[a2_0x2fe8('0x3')][a2_0x2fe8('0x12')]['report_files'][a2_0x2fe8('0x13')]({'where':{'fileName':_0x207dee[a2_0x2fe8('0x10')]}})[a2_0x2fe8('0x14')]((_0x1cb1cf,_0x4843af)=>{if(_0x4843af){console[a2_0x2fe8('0xa')](_0x207dee[a2_0x2fe8('0x10')]);_0x36a3d8[a2_0x2fe8('0x15')](_0x1cb1cf);}});}}}_0x4e287b['json']({'data':_0x36a3d8});});});_0x5e2a9c['on'](a2_0x2fe8('0x16'),function(_0x5dc247){_0x4e287b['json']({'message':_0x5dc247});});_0x5e2a9c[a2_0x2fe8('0x17')]({'host':a2_0x2fe8('0x18'),'port':0x15,'user':a2_0x2fe8('0x19'),'password':a2_0x2fe8('0x19')});};exports[a2_0x2fe8('0x1a')]=(_0x2363a0,_0x4ddb35)=>{exports[a2_0x2fe8('0x3')]['models'][a2_0x2fe8('0x1b')][a2_0x2fe8('0x1c')]({'where':{'status':null}})[a2_0x2fe8('0x1d')](_0x2dc57a=>{if(_0x2dc57a){const _0x51ef88=new ftp_1[(a2_0x2fe8('0xc'))]();_0x51ef88['on'](a2_0x2fe8('0xd'),function(){console[a2_0x2fe8('0xa')]('connected:'+_0x2dc57a[a2_0x2fe8('0x1e')]);_0x51ef88[a2_0x2fe8('0x1f')](a2_0x2fe8('0x20')+_0x2dc57a[a2_0x2fe8('0x1e')],function(_0xd033f8,_0x4534bd){_0x51ef88['end']();if(_0xd033f8){}else{const _0x13e309=a2_0x2fe8('0x21')+_0x2dc57a[a2_0x2fe8('0x1e')]+'.txt';_0x4534bd[a2_0x2fe8('0x22')](fs_1[a2_0x2fe8('0xc')][a2_0x2fe8('0x23')](_0x13e309));_0x2dc57a[a2_0x2fe8('0x24')]=0x1;_0x2dc57a[a2_0x2fe8('0x25')]();console[a2_0x2fe8('0xa')]('Downloaded:\x20'+_0x2dc57a[a2_0x2fe8('0x1e')]);}});});_0x51ef88['on'](a2_0x2fe8('0x16'),function(_0x57635d){_0x4ddb35[a2_0x2fe8('0x11')]({'message':_0x57635d});});_0x51ef88[a2_0x2fe8('0x17')]({'host':a2_0x2fe8('0x18'),'port':0x15,'user':a2_0x2fe8('0x19'),'password':'ipd'});_0x4ddb35[a2_0x2fe8('0x11')]({'data':_0x2dc57a[a2_0x2fe8('0x1e')]});}else{_0x4ddb35[a2_0x2fe8('0x11')]({'data':[]});}});};exports[a2_0x2fe8('0x26')]=(_0x3e4e73,_0x514f1b)=>{exports[a2_0x2fe8('0x3')][a2_0x2fe8('0x12')][a2_0x2fe8('0x1b')][a2_0x2fe8('0x1c')]({'where':{'status':0x1}})[a2_0x2fe8('0x1d')](_0x6479c8=>{if(_0x6479c8){const _0x2351c9=a2_0x2fe8('0x21')+_0x6479c8[a2_0x2fe8('0x1e')]+'.txt';fs_1[a2_0x2fe8('0xc')][a2_0x2fe8('0x27')](_0x2351c9,'utf8',function(_0x29cdfb,_0x30c1ba){if(_0x29cdfb){_0x6479c8[a2_0x2fe8('0x24')]=null;}else{try{const _0x1986ab=JSON[a2_0x2fe8('0x28')](_0x30c1ba);for(const _0x481122 of _0x1986ab[a2_0x2fe8('0x29')][0x0][a2_0x2fe8('0x2a')]){const _0x36d86a=_0x481122['In'];const _0x1dae60=_0x481122[a2_0x2fe8('0x2b')];const _0x1b98ad=Date['parse'](_0x481122['EndTime']);if(_0x36d86a>0x0){exports[a2_0x2fe8('0x3')][a2_0x2fe8('0x12')]['pass_counting']['create']({'reportFileId':_0x6479c8['id'],'amount':_0x36d86a,'countingDate':_0x1b98ad});}if(_0x1dae60>0x0){exports[a2_0x2fe8('0x3')]['models'][a2_0x2fe8('0x2c')][a2_0x2fe8('0x2d')]({'reportFileId':_0x6479c8['id'],'amount':_0x1dae60*-0x1,'countingDate':_0x1b98ad});}}_0x6479c8[a2_0x2fe8('0x24')]=0x2;}catch(_0x1b223e){_0x6479c8['status']=null;}}_0x6479c8[a2_0x2fe8('0x25')]();});_0x514f1b[a2_0x2fe8('0x11')]({'data':_0x6479c8['fileName']});}else{_0x514f1b['json']({'data':[]});}});};exports['getPassCounting']=(_0x5698f5,_0x5bb435)=>{exports[a2_0x2fe8('0x3')]['models']['pass_counting'][a2_0x2fe8('0x2e')]({'where':{'amount':{[exports[a2_0x2fe8('0x3')]['Op']['gt']]:0x0}},'order':[[a2_0x2fe8('0x2f'),a2_0x2fe8('0x30')]]})[a2_0x2fe8('0x1d')](_0x1a5d80=>{_0x5bb435['json']({'data':_0x1a5d80});});};exports[a2_0x2fe8('0x31')]=(_0x2c5fa5,_0x1370f7)=>{const _0x1e202f=_0x2c5fa5[a2_0x2fe8('0x32')][a2_0x2fe8('0x33')];const _0x220b42=_0x2c5fa5[a2_0x2fe8('0x32')][a2_0x2fe8('0x34')];const _0x439a6d=_0x2c5fa5[a2_0x2fe8('0x32')][a2_0x2fe8('0x35')];exports[a2_0x2fe8('0x3')][a2_0x2fe8('0x12')][a2_0x2fe8('0x2c')][a2_0x2fe8('0x2e')]({'attributes':['countingDate',[exports['sequelize']['fn'](a2_0x2fe8('0x36'),exports[a2_0x2fe8('0x3')]['col'](a2_0x2fe8('0x37'))),a2_0x2fe8('0x38')]],'where':{'countingDate':{[exports[a2_0x2fe8('0x3')]['Op']['gte']]:_0x220b42,[exports['sequelize']['Op']['lt']]:_0x439a6d},'amount':_0x2c5fa5[a2_0x2fe8('0x39')][a2_0x2fe8('0x3a')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x2fe8('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x2fe8('0x3')]['literal'](a2_0x2fe8('0x3b'))],'order':[['countingDate',a2_0x2fe8('0x30')]]})[a2_0x2fe8('0x1d')](_0x2f2610=>{_0x1370f7[a2_0x2fe8('0x11')]({'data':_0x2f2610});});};exports['getPassCountingByHour']=(_0x34a79c,_0x38b40c)=>{const _0x2a97c1=_0x34a79c['query']['month'];const _0x108c26=_0x34a79c[a2_0x2fe8('0x32')][a2_0x2fe8('0x34')];const _0x15876d=_0x34a79c['query'][a2_0x2fe8('0x35')];exports[a2_0x2fe8('0x3')][a2_0x2fe8('0x12')][a2_0x2fe8('0x2c')][a2_0x2fe8('0x2e')]({'attributes':[a2_0x2fe8('0x2f'),[exports[a2_0x2fe8('0x3')]['fn'](a2_0x2fe8('0x3c'),exports[a2_0x2fe8('0x3')][a2_0x2fe8('0x3d')]('countingDate'),a2_0x2fe8('0x3e')),'countingDateShort'],[exports['sequelize']['fn']('sum',exports[a2_0x2fe8('0x3')][a2_0x2fe8('0x3d')]('amount')),a2_0x2fe8('0x38')]],'where':{'countingDate':{[exports[a2_0x2fe8('0x3')]['Op']['gte']]:_0x108c26,[exports[a2_0x2fe8('0x3')]['Op']['lt']]:_0x15876d},'amount':_0x34a79c[a2_0x2fe8('0x39')][a2_0x2fe8('0x3a')]=='in'?{[exports[a2_0x2fe8('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0x2fe8('0x3')]['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a2_0x2fe8('0x3f'),exports[a2_0x2fe8('0x3')][a2_0x2fe8('0x3d')](a2_0x2fe8('0x2f'))),exports['sequelize']['fn'](a2_0x2fe8('0x40'),exports[a2_0x2fe8('0x3')][a2_0x2fe8('0x3d')]('countingDate')),exports[a2_0x2fe8('0x3')]['fn']('MONTH',exports[a2_0x2fe8('0x3')][a2_0x2fe8('0x3d')](a2_0x2fe8('0x2f'))),exports['sequelize']['fn']('YEAR',exports[a2_0x2fe8('0x3')]['col'](a2_0x2fe8('0x2f')))],'order':[[a2_0x2fe8('0x2f'),a2_0x2fe8('0x30')]]})[a2_0x2fe8('0x1d')](_0x31d1e7=>{_0x38b40c[a2_0x2fe8('0x11')]({'data':_0x31d1e7});});};exports[a2_0x2fe8('0x41')]=(_0x2346d0,_0x5dba96,_0x5d20bc)=>{const _0x178923=_0x2346d0[a2_0x2fe8('0x42')][a2_0x2fe8('0x43')][a2_0x2fe8('0x44')](_0x178923=>_0x178923[a2_0x2fe8('0x45')]===a2_0x2fe8('0x46'));fbgraph_1[a2_0x2fe8('0xc')][a2_0x2fe8('0x47')](_0x178923[a2_0x2fe8('0x48')]);fbgraph_1[a2_0x2fe8('0xc')][a2_0x2fe8('0x1f')](_0x2346d0[a2_0x2fe8('0x42')][a2_0x2fe8('0x46')]+a2_0x2fe8('0x49'),(_0x4ce2f0,_0x2b7ad8)=>{if(_0x4ce2f0){return _0x5d20bc(_0x4ce2f0);}_0x5dba96[a2_0x2fe8('0x6')](a2_0x2fe8('0x4a'),{'title':a2_0x2fe8('0x4b'),'profile':_0x2b7ad8});});};
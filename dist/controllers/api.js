var a2_0x492b=['getApi','render','API\x20Examples','syncFtp','log','default','ready','connected','list','Downloading:\x20','name','endsWith','json','models','report_files','spread','push','error','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','then','fileName','get','colombia/','end','media/','.txt','pipe','createWriteStream','status','Downloaded:\x20','processFtp','readFile','parse','Data','CountingInfo','EndTime','pass_counting','save','findAll','query','month','endDate','countingDate','col','amount','total','gte','params','direction','literal','ASC','startDate','%Y-%m-%d\x20%H:00','countingDateShort','sum','HOUR','DAY','MONTH','YEAR','getFacebook','find','kind','setAccessToken','user','facebook','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','__importDefault','defineProperty','__esModule','fbgraph','ftp','sequelize','setSequelize'];(function(_0x3ed2ad,_0x311070){var _0x159de8=function(_0x34a1c1){while(--_0x34a1c1){_0x3ed2ad['push'](_0x3ed2ad['shift']());}};_0x159de8(++_0x311070);}(a2_0x492b,0x95));var a2_0x1228=function(_0x404e71,_0x282c4e){_0x404e71=_0x404e71-0x0;var _0xa698a2=a2_0x492b[_0x404e71];return _0xa698a2;};'use strict';var __importDefault=this&&this[a2_0x1228('0x0')]||function(_0x16beb2){return _0x16beb2&&_0x16beb2['__esModule']?_0x16beb2:{'default':_0x16beb2};};Object[a2_0x1228('0x1')](exports,a2_0x1228('0x2'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x1228('0x3')));const ftp_1=__importDefault(require(a2_0x1228('0x4')));const fs_1=__importDefault(require('fs'));exports[a2_0x1228('0x5')]='';function setSequelize(_0xb5e73e){exports['sequelize']=_0xb5e73e;}exports[a2_0x1228('0x6')]=setSequelize;exports[a2_0x1228('0x7')]=(_0x4a3b28,_0x4319e0)=>{_0x4319e0[a2_0x1228('0x8')]('api/index',{'title':a2_0x1228('0x9')});};exports[a2_0x1228('0xa')]=(_0x25b510,_0x2e85f4)=>{console[a2_0x1228('0xb')]('connecting');const _0x39eccb=[];const _0x541226=new ftp_1[(a2_0x1228('0xc'))]();_0x541226['on'](a2_0x1228('0xd'),function(){console[a2_0x1228('0xb')](a2_0x1228('0xe'));_0x541226[a2_0x1228('0xf')]('colombia',![],function(_0x45d5a3,_0x4376c8){if(_0x45d5a3){}else{for(const _0x2d1d38 of _0x4376c8){console[a2_0x1228('0xb')](a2_0x1228('0x10')+_0x2d1d38['name']);if(_0x2d1d38[a2_0x1228('0x11')][a2_0x1228('0x12')](a2_0x1228('0x13'))){exports[a2_0x1228('0x5')][a2_0x1228('0x14')][a2_0x1228('0x15')]['findOrCreate']({'where':{'fileName':_0x2d1d38[a2_0x1228('0x11')]}})[a2_0x1228('0x16')]((_0x59f01c,_0x549c92)=>{if(_0x549c92){console[a2_0x1228('0xb')](_0x2d1d38[a2_0x1228('0x11')]);_0x39eccb[a2_0x1228('0x17')](_0x59f01c);}});}}}_0x2e85f4['json']({'data':_0x39eccb});});});_0x541226['on'](a2_0x1228('0x18'),function(_0x3dde55){_0x2e85f4[a2_0x1228('0x13')]({'message':_0x3dde55});});_0x541226[a2_0x1228('0x19')]({'host':a2_0x1228('0x1a'),'port':0x15,'user':'ipd','password':a2_0x1228('0x1b')});};exports[a2_0x1228('0x1c')]=(_0x5d4d70,_0x27b387)=>{exports[a2_0x1228('0x5')][a2_0x1228('0x14')]['report_files'][a2_0x1228('0x1d')]({'where':{'status':null}})[a2_0x1228('0x1e')](_0x4c5f4f=>{if(_0x4c5f4f){const _0x50f685=new ftp_1['default']();_0x50f685['on'](a2_0x1228('0xd'),function(){console[a2_0x1228('0xb')]('connected:'+_0x4c5f4f[a2_0x1228('0x1f')]);_0x50f685[a2_0x1228('0x20')](a2_0x1228('0x21')+_0x4c5f4f[a2_0x1228('0x1f')],function(_0x439433,_0x28b7f6){_0x50f685[a2_0x1228('0x22')]();if(_0x439433){}else{const _0x111f4a=a2_0x1228('0x23')+_0x4c5f4f[a2_0x1228('0x1f')]+a2_0x1228('0x24');_0x28b7f6[a2_0x1228('0x25')](fs_1['default'][a2_0x1228('0x26')](_0x111f4a));_0x4c5f4f[a2_0x1228('0x27')]=0x1;_0x4c5f4f['save']();console[a2_0x1228('0xb')](a2_0x1228('0x28')+_0x4c5f4f[a2_0x1228('0x1f')]);}});});_0x50f685['on'](a2_0x1228('0x18'),function(_0x4928c5){_0x27b387[a2_0x1228('0x13')]({'message':_0x4928c5});});_0x50f685['connect']({'host':a2_0x1228('0x1a'),'port':0x15,'user':a2_0x1228('0x1b'),'password':a2_0x1228('0x1b')});_0x27b387[a2_0x1228('0x13')]({'data':_0x4c5f4f[a2_0x1228('0x1f')]});}else{_0x27b387[a2_0x1228('0x13')]({'data':[]});}});};exports[a2_0x1228('0x29')]=(_0x5e7d29,_0x5f59be)=>{exports[a2_0x1228('0x5')]['models'][a2_0x1228('0x15')][a2_0x1228('0x1d')]({'where':{'status':0x1}})[a2_0x1228('0x1e')](_0x19e0be=>{if(_0x19e0be){const _0x384df5=a2_0x1228('0x23')+_0x19e0be[a2_0x1228('0x1f')]+a2_0x1228('0x24');fs_1['default'][a2_0x1228('0x2a')](_0x384df5,'utf8',function(_0x3b0663,_0x33eb9e){if(_0x3b0663){_0x19e0be[a2_0x1228('0x27')]=null;}else{try{const _0x314e64=JSON[a2_0x1228('0x2b')](_0x33eb9e);for(const _0x4b6130 of _0x314e64[a2_0x1228('0x2c')][0x0][a2_0x1228('0x2d')]){const _0x2456b2=_0x4b6130['In'];const _0x31fe6a=_0x4b6130['Out'];const _0x553d07=Date[a2_0x1228('0x2b')](_0x4b6130[a2_0x1228('0x2e')]);if(_0x2456b2>0x0){exports['sequelize']['models'][a2_0x1228('0x2f')]['create']({'reportFileId':_0x19e0be['id'],'amount':_0x2456b2,'countingDate':_0x553d07});}if(_0x31fe6a>0x0){exports['sequelize'][a2_0x1228('0x14')][a2_0x1228('0x2f')]['create']({'reportFileId':_0x19e0be['id'],'amount':_0x31fe6a*-0x1,'countingDate':_0x553d07});}}_0x19e0be[a2_0x1228('0x27')]=0x2;}catch(_0x11e27e){_0x19e0be[a2_0x1228('0x27')]=null;}}_0x19e0be[a2_0x1228('0x30')]();});_0x5f59be['json']({'data':_0x19e0be[a2_0x1228('0x1f')]});}else{_0x5f59be['json']({'data':[]});}});};exports['getPassCounting']=(_0x4999d1,_0x2bc7df)=>{exports[a2_0x1228('0x5')]['models'][a2_0x1228('0x2f')][a2_0x1228('0x31')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[['countingDate','ASC']]})[a2_0x1228('0x1e')](_0x52613e=>{_0x2bc7df[a2_0x1228('0x13')]({'data':_0x52613e});});};exports['getPassCountingByDay']=(_0xaf383e,_0x352014)=>{const _0x1f026d=_0xaf383e[a2_0x1228('0x32')][a2_0x1228('0x33')];const _0x49a438=_0xaf383e[a2_0x1228('0x32')]['startDate'];const _0xb19551=_0xaf383e[a2_0x1228('0x32')][a2_0x1228('0x34')];exports[a2_0x1228('0x5')][a2_0x1228('0x14')][a2_0x1228('0x2f')]['findAll']({'attributes':[a2_0x1228('0x35'),[exports[a2_0x1228('0x5')]['fn']('sum',exports['sequelize'][a2_0x1228('0x36')](a2_0x1228('0x37'))),a2_0x1228('0x38')]],'where':{'countingDate':{[exports[a2_0x1228('0x5')]['Op'][a2_0x1228('0x39')]]:_0x49a438,[exports[a2_0x1228('0x5')]['Op']['lt']]:_0xb19551},'amount':_0xaf383e[a2_0x1228('0x3a')][a2_0x1228('0x3b')]=='in'?{[exports[a2_0x1228('0x5')]['Op']['gt']]:0x0}:{[exports[a2_0x1228('0x5')]['Op']['lt']]:0x0}},'group':[exports[a2_0x1228('0x5')][a2_0x1228('0x3c')]('YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))')],'order':[[a2_0x1228('0x35'),a2_0x1228('0x3d')]]})[a2_0x1228('0x1e')](_0x3b53be=>{_0x352014['json']({'data':_0x3b53be});});};exports['getPassCountingByHour']=(_0x248891,_0x2b18a2)=>{const _0x2fc233=_0x248891['query'][a2_0x1228('0x33')];const _0x5dfda8=_0x248891[a2_0x1228('0x32')][a2_0x1228('0x3e')];const _0x2fc217=_0x248891[a2_0x1228('0x32')][a2_0x1228('0x34')];exports['sequelize'][a2_0x1228('0x14')][a2_0x1228('0x2f')][a2_0x1228('0x31')]({'attributes':[a2_0x1228('0x35'),[exports[a2_0x1228('0x5')]['fn']('DATE_FORMAT',exports[a2_0x1228('0x5')][a2_0x1228('0x36')](a2_0x1228('0x35')),a2_0x1228('0x3f')),a2_0x1228('0x40')],[exports[a2_0x1228('0x5')]['fn'](a2_0x1228('0x41'),exports[a2_0x1228('0x5')][a2_0x1228('0x36')]('amount')),a2_0x1228('0x38')]],'where':{'countingDate':{[exports['sequelize']['Op']['gte']]:_0x5dfda8,[exports[a2_0x1228('0x5')]['Op']['lt']]:_0x2fc217},'amount':_0x248891[a2_0x1228('0x3a')]['direction']=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x1228('0x5')]['Op']['lt']]:0x0}},'group':[exports[a2_0x1228('0x5')]['fn'](a2_0x1228('0x42'),exports[a2_0x1228('0x5')][a2_0x1228('0x36')](a2_0x1228('0x35'))),exports[a2_0x1228('0x5')]['fn'](a2_0x1228('0x43'),exports[a2_0x1228('0x5')][a2_0x1228('0x36')](a2_0x1228('0x35'))),exports['sequelize']['fn'](a2_0x1228('0x44'),exports[a2_0x1228('0x5')]['col'](a2_0x1228('0x35'))),exports['sequelize']['fn'](a2_0x1228('0x45'),exports[a2_0x1228('0x5')][a2_0x1228('0x36')](a2_0x1228('0x35')))],'order':[[a2_0x1228('0x35'),a2_0x1228('0x3d')]]})[a2_0x1228('0x1e')](_0x3b8d8c=>{_0x2b18a2[a2_0x1228('0x13')]({'data':_0x3b8d8c});});};exports[a2_0x1228('0x46')]=(_0x439147,_0x2bfe78,_0x1bbdb8)=>{const _0x52d50a=_0x439147['user']['tokens'][a2_0x1228('0x47')](_0x52d50a=>_0x52d50a[a2_0x1228('0x48')]==='facebook');fbgraph_1[a2_0x1228('0xc')][a2_0x1228('0x49')](_0x52d50a['accessToken']);fbgraph_1['default'][a2_0x1228('0x20')](_0x439147[a2_0x1228('0x4a')][a2_0x1228('0x4b')]+a2_0x1228('0x4c'),(_0x40b388,_0x4120d1)=>{if(_0x40b388){return _0x1bbdb8(_0x40b388);}_0x2bfe78[a2_0x1228('0x8')](a2_0x1228('0x4d'),{'title':'Facebook\x20API','profile':_0x4120d1});});};
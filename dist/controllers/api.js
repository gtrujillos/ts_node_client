var a2_0x222e=['createWriteStream','save','Downloaded:\x20','processFtp','media/','readFile','utf8','status','parse','Data','CountingInfo','Out','EndTime','pass_counting','create','getPassCounting','countingDate','ASC','getPassCountingByDay','query','month','startDate','endDate','findAll','sum','col','amount','total','gte','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','DATE_FORMAT','countingDateShort','HOUR','MONTH','YEAR','user','tokens','facebook','setAccessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','Facebook\x20API','__importDefault','__esModule','defineProperty','fbgraph','sequelize','setSequelize','getApi','render','API\x20Examples','syncFtp','log','default','ready','connected','list','name','json','report_files','findOrCreate','push','error','connect','ftp.vivotek.com','ipd','downloadFtp','models','findOne','then','connected:','fileName','get','colombia/','.txt','pipe'];(function(_0xba2cc0,_0x257da8){var _0x24f772=function(_0x294a77){while(--_0x294a77){_0xba2cc0['push'](_0xba2cc0['shift']());}};_0x24f772(++_0x257da8);}(a2_0x222e,0xc5));var a2_0x7a3b=function(_0x14f1e2,_0x341649){_0x14f1e2=_0x14f1e2-0x0;var _0x300111=a2_0x222e[_0x14f1e2];return _0x300111;};'use strict';var __importDefault=this&&this[a2_0x7a3b('0x0')]||function(_0x338a72){return _0x338a72&&_0x338a72[a2_0x7a3b('0x1')]?_0x338a72:{'default':_0x338a72};};Object[a2_0x7a3b('0x2')](exports,a2_0x7a3b('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x7a3b('0x3')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));exports[a2_0x7a3b('0x4')]='';function setSequelize(_0x52d57a){exports[a2_0x7a3b('0x4')]=_0x52d57a;}exports[a2_0x7a3b('0x5')]=setSequelize;exports[a2_0x7a3b('0x6')]=(_0x668abb,_0x1473c8)=>{_0x1473c8[a2_0x7a3b('0x7')]('api/index',{'title':a2_0x7a3b('0x8')});};exports[a2_0x7a3b('0x9')]=(_0x37acba,_0x1e9877)=>{console[a2_0x7a3b('0xa')]('connecting');const _0x558e89=[];const _0x560cf1=new ftp_1[(a2_0x7a3b('0xb'))]();_0x560cf1['on'](a2_0x7a3b('0xc'),function(){console[a2_0x7a3b('0xa')](a2_0x7a3b('0xd'));_0x560cf1[a2_0x7a3b('0xe')]('colombia',![],function(_0x47e78d,_0x1a5cb9){if(_0x47e78d){}else{for(const _0x25e31e of _0x1a5cb9){console[a2_0x7a3b('0xa')]('Downloading:\x20'+_0x25e31e[a2_0x7a3b('0xf')]);if(_0x25e31e[a2_0x7a3b('0xf')]['endsWith'](a2_0x7a3b('0x10'))){exports[a2_0x7a3b('0x4')]['models'][a2_0x7a3b('0x11')][a2_0x7a3b('0x12')]({'where':{'fileName':_0x25e31e[a2_0x7a3b('0xf')]}})['spread']((_0x2f7a0c,_0x23982f)=>{if(_0x23982f){console[a2_0x7a3b('0xa')](_0x25e31e[a2_0x7a3b('0xf')]);_0x558e89[a2_0x7a3b('0x13')](_0x2f7a0c);}});}}}_0x1e9877[a2_0x7a3b('0x10')]({'data':_0x558e89});});});_0x560cf1['on'](a2_0x7a3b('0x14'),function(_0x1e961d){_0x1e9877['json']({'message':_0x1e961d});});_0x560cf1[a2_0x7a3b('0x15')]({'host':a2_0x7a3b('0x16'),'port':0x15,'user':'ipd','password':a2_0x7a3b('0x17')});};exports[a2_0x7a3b('0x18')]=(_0x3a34e4,_0xc22553)=>{exports['sequelize'][a2_0x7a3b('0x19')][a2_0x7a3b('0x11')][a2_0x7a3b('0x1a')]({'where':{'status':null}})[a2_0x7a3b('0x1b')](_0x833c14=>{if(_0x833c14){const _0x23be38=new ftp_1[(a2_0x7a3b('0xb'))]();_0x23be38['on'](a2_0x7a3b('0xc'),function(){console[a2_0x7a3b('0xa')](a2_0x7a3b('0x1c')+_0x833c14[a2_0x7a3b('0x1d')]);_0x23be38[a2_0x7a3b('0x1e')](a2_0x7a3b('0x1f')+_0x833c14[a2_0x7a3b('0x1d')],function(_0x527c37,_0x5ba943){_0x23be38['end']();if(_0x527c37){}else{const _0x4ed64e='media/'+_0x833c14[a2_0x7a3b('0x1d')]+a2_0x7a3b('0x20');_0x5ba943[a2_0x7a3b('0x21')](fs_1[a2_0x7a3b('0xb')][a2_0x7a3b('0x22')](_0x4ed64e));_0x833c14['status']=0x1;_0x833c14[a2_0x7a3b('0x23')]();console[a2_0x7a3b('0xa')](a2_0x7a3b('0x24')+_0x833c14['fileName']);}});});_0x23be38['on'](a2_0x7a3b('0x14'),function(_0x4a8787){_0xc22553['json']({'message':_0x4a8787});});_0x23be38[a2_0x7a3b('0x15')]({'host':a2_0x7a3b('0x16'),'port':0x15,'user':a2_0x7a3b('0x17'),'password':'ipd'});_0xc22553[a2_0x7a3b('0x10')]({'data':_0x833c14['fileName']});}else{_0xc22553[a2_0x7a3b('0x10')]({'data':[]});}});};exports[a2_0x7a3b('0x25')]=(_0x18cec3,_0x2b6b53)=>{exports[a2_0x7a3b('0x4')][a2_0x7a3b('0x19')][a2_0x7a3b('0x11')][a2_0x7a3b('0x1a')]({'where':{'status':0x1}})[a2_0x7a3b('0x1b')](_0x4020ee=>{if(_0x4020ee){const _0x15561b=a2_0x7a3b('0x26')+_0x4020ee[a2_0x7a3b('0x1d')]+a2_0x7a3b('0x20');fs_1['default'][a2_0x7a3b('0x27')](_0x15561b,a2_0x7a3b('0x28'),function(_0x4c799f,_0x20e6c3){if(_0x4c799f){_0x4020ee[a2_0x7a3b('0x29')]=null;}else{try{const _0x5d9d20=JSON[a2_0x7a3b('0x2a')](_0x20e6c3);for(const _0x1b7cf4 of _0x5d9d20[a2_0x7a3b('0x2b')][0x0][a2_0x7a3b('0x2c')]){const _0x59683d=_0x1b7cf4['In'];const _0x440e69=_0x1b7cf4[a2_0x7a3b('0x2d')];const _0x622d46=Date[a2_0x7a3b('0x2a')](_0x1b7cf4[a2_0x7a3b('0x2e')]);if(_0x59683d>0x0){exports[a2_0x7a3b('0x4')]['models'][a2_0x7a3b('0x2f')]['create']({'reportFileId':_0x4020ee['id'],'amount':_0x59683d,'countingDate':_0x622d46});}if(_0x440e69>0x0){exports[a2_0x7a3b('0x4')][a2_0x7a3b('0x19')][a2_0x7a3b('0x2f')][a2_0x7a3b('0x30')]({'reportFileId':_0x4020ee['id'],'amount':_0x440e69*-0x1,'countingDate':_0x622d46});}}_0x4020ee[a2_0x7a3b('0x29')]=0x2;}catch(_0x1c7010){_0x4020ee[a2_0x7a3b('0x29')]=null;}}_0x4020ee[a2_0x7a3b('0x23')]();});_0x2b6b53[a2_0x7a3b('0x10')]({'data':_0x4020ee[a2_0x7a3b('0x1d')]});}else{_0x2b6b53[a2_0x7a3b('0x10')]({'data':[]});}});};exports[a2_0x7a3b('0x31')]=(_0x3cfb74,_0x4c9a61)=>{exports[a2_0x7a3b('0x4')][a2_0x7a3b('0x19')]['pass_counting']['findAll']({'where':{'amount':{[exports[a2_0x7a3b('0x4')]['Op']['gt']]:0x0}},'order':[[a2_0x7a3b('0x32'),a2_0x7a3b('0x33')]]})[a2_0x7a3b('0x1b')](_0x1dd2e1=>{_0x4c9a61[a2_0x7a3b('0x10')]({'data':_0x1dd2e1});});};exports[a2_0x7a3b('0x34')]=(_0x1a0c0c,_0x44b2ce)=>{const _0x455fc4=_0x1a0c0c[a2_0x7a3b('0x35')][a2_0x7a3b('0x36')];const _0x427de9=_0x1a0c0c['query'][a2_0x7a3b('0x37')];const _0x5b915c=_0x1a0c0c[a2_0x7a3b('0x35')][a2_0x7a3b('0x38')];exports[a2_0x7a3b('0x4')][a2_0x7a3b('0x19')][a2_0x7a3b('0x2f')][a2_0x7a3b('0x39')]({'attributes':['countingDate',[exports[a2_0x7a3b('0x4')]['fn'](a2_0x7a3b('0x3a'),exports[a2_0x7a3b('0x4')][a2_0x7a3b('0x3b')](a2_0x7a3b('0x3c'))),a2_0x7a3b('0x3d')]],'where':{'countingDate':{[exports[a2_0x7a3b('0x4')]['Op'][a2_0x7a3b('0x3e')]]:_0x427de9,[exports[a2_0x7a3b('0x4')]['Op']['lt']]:_0x5b915c},'amount':_0x1a0c0c['params'][a2_0x7a3b('0x3f')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x7a3b('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x7a3b('0x4')]['literal'](a2_0x7a3b('0x40'))],'order':[[a2_0x7a3b('0x32'),a2_0x7a3b('0x33')]]})[a2_0x7a3b('0x1b')](_0x1eff38=>{_0x44b2ce[a2_0x7a3b('0x10')]({'data':_0x1eff38});});};exports[a2_0x7a3b('0x41')]=(_0x5d952a,_0x4d3ca5)=>{const _0x994f24=_0x5d952a['query']['month'];const _0x28892e=_0x5d952a[a2_0x7a3b('0x35')]['startDate'];const _0x544275=_0x5d952a['query'][a2_0x7a3b('0x38')];exports['sequelize']['models'][a2_0x7a3b('0x2f')][a2_0x7a3b('0x39')]({'attributes':['countingDate',[exports['sequelize']['fn'](a2_0x7a3b('0x42'),exports[a2_0x7a3b('0x4')][a2_0x7a3b('0x3b')](a2_0x7a3b('0x32')),'%Y-%m-%d\x20%H:00'),a2_0x7a3b('0x43')],[exports[a2_0x7a3b('0x4')]['fn'](a2_0x7a3b('0x3a'),exports[a2_0x7a3b('0x4')][a2_0x7a3b('0x3b')](a2_0x7a3b('0x3c'))),'total']],'where':{'countingDate':{[exports[a2_0x7a3b('0x4')]['Op'][a2_0x7a3b('0x3e')]]:_0x28892e,[exports[a2_0x7a3b('0x4')]['Op']['lt']]:_0x544275},'amount':_0x5d952a['params'][a2_0x7a3b('0x3f')]=='in'?{[exports[a2_0x7a3b('0x4')]['Op']['gt']]:0x0}:{[exports[a2_0x7a3b('0x4')]['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a2_0x7a3b('0x44'),exports[a2_0x7a3b('0x4')][a2_0x7a3b('0x3b')](a2_0x7a3b('0x32'))),exports[a2_0x7a3b('0x4')]['fn']('DAY',exports[a2_0x7a3b('0x4')][a2_0x7a3b('0x3b')]('countingDate')),exports[a2_0x7a3b('0x4')]['fn'](a2_0x7a3b('0x45'),exports[a2_0x7a3b('0x4')][a2_0x7a3b('0x3b')](a2_0x7a3b('0x32'))),exports['sequelize']['fn'](a2_0x7a3b('0x46'),exports[a2_0x7a3b('0x4')]['col'](a2_0x7a3b('0x32')))],'order':[['countingDate',a2_0x7a3b('0x33')]]})[a2_0x7a3b('0x1b')](_0x37dc86=>{_0x4d3ca5[a2_0x7a3b('0x10')]({'data':_0x37dc86});});};exports['getFacebook']=(_0x3d04dc,_0x4cb674,_0x4db2ca)=>{const _0x456b46=_0x3d04dc[a2_0x7a3b('0x47')][a2_0x7a3b('0x48')]['find'](_0x456b46=>_0x456b46['kind']===a2_0x7a3b('0x49'));fbgraph_1[a2_0x7a3b('0xb')][a2_0x7a3b('0x4a')](_0x456b46['accessToken']);fbgraph_1['default']['get'](_0x3d04dc[a2_0x7a3b('0x47')][a2_0x7a3b('0x49')]+a2_0x7a3b('0x4b'),(_0x5b06c6,_0x2b174a)=>{if(_0x5b06c6){return _0x4db2ca(_0x5b06c6);}_0x4cb674[a2_0x7a3b('0x7')]('api/facebook',{'title':a2_0x7a3b('0x4c'),'profile':_0x2b174a});});};
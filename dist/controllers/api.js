var a2_0x5e4f=['.txt','pipe','default','status','save','Downloaded:\x20','readFile','utf8','parse','Data','Out','EndTime','pass_counting','create','getPassCounting','findAll','countingDate','ASC','getPassCountingByDay','query','month','startDate','sum','col','amount','total','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','endDate','DATE_FORMAT','countingDateShort','HOUR','YEAR','getFacebook','tokens','find','kind','facebook','accessToken','get','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','__esModule','defineProperty','ftp','sequelize','setSequelize','getApi','render','api/index','syncFtp','log','connecting','ready','connected','list','colombia','Downloading:\x20','name','json','models','spread','push','error','ftp.vivotek.com','ipd','downloadFtp','report_files','findOne','then','connected:','fileName','end','media/'];(function(_0x28935b,_0x4410ce){var _0x33f255=function(_0x1a9b1a){while(--_0x1a9b1a){_0x28935b['push'](_0x28935b['shift']());}};_0x33f255(++_0x4410ce);}(a2_0x5e4f,0x11f));var a2_0x4d87=function(_0x589f7e,_0x199a91){_0x589f7e=_0x589f7e-0x0;var _0x4053b2=a2_0x5e4f[_0x589f7e];return _0x4053b2;};'use strict';var __importDefault=this&&this[a2_0x4d87('0x0')]||function(_0x43e767){return _0x43e767&&_0x43e767[a2_0x4d87('0x1')]?_0x43e767:{'default':_0x43e767};};Object[a2_0x4d87('0x2')](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require(a2_0x4d87('0x3')));const fs_1=__importDefault(require('fs'));exports[a2_0x4d87('0x4')]='';function setSequelize(_0x43aaa7){exports[a2_0x4d87('0x4')]=_0x43aaa7;}exports[a2_0x4d87('0x5')]=setSequelize;exports[a2_0x4d87('0x6')]=(_0x4b959e,_0x50073e)=>{_0x50073e[a2_0x4d87('0x7')](a2_0x4d87('0x8'),{'title':'API\x20Examples'});};exports[a2_0x4d87('0x9')]=(_0x3ea36f,_0x348e88)=>{console[a2_0x4d87('0xa')](a2_0x4d87('0xb'));const _0x68e2a8=[];const _0x206b82=new ftp_1['default']();_0x206b82['on'](a2_0x4d87('0xc'),function(){console[a2_0x4d87('0xa')](a2_0x4d87('0xd'));_0x206b82[a2_0x4d87('0xe')](a2_0x4d87('0xf'),![],function(_0xa46f29,_0x7f7ca7){if(_0xa46f29){}else{for(const _0x2f01ca of _0x7f7ca7){console[a2_0x4d87('0xa')](a2_0x4d87('0x10')+_0x2f01ca[a2_0x4d87('0x11')]);if(_0x2f01ca['name']['endsWith'](a2_0x4d87('0x12'))){exports[a2_0x4d87('0x4')][a2_0x4d87('0x13')]['report_files']['findOrCreate']({'where':{'fileName':_0x2f01ca[a2_0x4d87('0x11')]}})[a2_0x4d87('0x14')]((_0x5d2c38,_0x49b241)=>{if(_0x49b241){console[a2_0x4d87('0xa')](_0x2f01ca[a2_0x4d87('0x11')]);_0x68e2a8[a2_0x4d87('0x15')](_0x5d2c38);}});}}}_0x348e88[a2_0x4d87('0x12')]({'data':_0x68e2a8});});});_0x206b82['on'](a2_0x4d87('0x16'),function(_0x22f434){_0x348e88[a2_0x4d87('0x12')]({'message':_0x22f434});});_0x206b82['connect']({'host':a2_0x4d87('0x17'),'port':0x15,'user':a2_0x4d87('0x18'),'password':a2_0x4d87('0x18')});};exports[a2_0x4d87('0x19')]=(_0x3ab905,_0x4628e9)=>{exports['sequelize'][a2_0x4d87('0x13')][a2_0x4d87('0x1a')][a2_0x4d87('0x1b')]({'where':{'status':null}})[a2_0x4d87('0x1c')](_0x19a157=>{if(_0x19a157){const _0x47d18b=new ftp_1['default']();_0x47d18b['on']('ready',function(){console[a2_0x4d87('0xa')](a2_0x4d87('0x1d')+_0x19a157[a2_0x4d87('0x1e')]);_0x47d18b['get']('colombia/'+_0x19a157[a2_0x4d87('0x1e')],function(_0x16e628,_0x1209e0){_0x47d18b[a2_0x4d87('0x1f')]();if(_0x16e628){}else{const _0x23d977=a2_0x4d87('0x20')+_0x19a157[a2_0x4d87('0x1e')]+a2_0x4d87('0x21');_0x1209e0[a2_0x4d87('0x22')](fs_1[a2_0x4d87('0x23')]['createWriteStream'](_0x23d977));_0x19a157[a2_0x4d87('0x24')]=0x1;_0x19a157[a2_0x4d87('0x25')]();console[a2_0x4d87('0xa')](a2_0x4d87('0x26')+_0x19a157['fileName']);}});});_0x47d18b['on'](a2_0x4d87('0x16'),function(_0x29b079){_0x4628e9[a2_0x4d87('0x12')]({'message':_0x29b079});});_0x47d18b['connect']({'host':a2_0x4d87('0x17'),'port':0x15,'user':a2_0x4d87('0x18'),'password':a2_0x4d87('0x18')});_0x4628e9[a2_0x4d87('0x12')]({'data':_0x19a157[a2_0x4d87('0x1e')]});}else{_0x4628e9['json']({'data':[]});}});};exports['processFtp']=(_0x515a74,_0x2ad1fa)=>{exports[a2_0x4d87('0x4')][a2_0x4d87('0x13')][a2_0x4d87('0x1a')][a2_0x4d87('0x1b')]({'where':{'status':0x1}})[a2_0x4d87('0x1c')](_0x359093=>{if(_0x359093){const _0x3ca2b5=a2_0x4d87('0x20')+_0x359093['fileName']+a2_0x4d87('0x21');fs_1['default'][a2_0x4d87('0x27')](_0x3ca2b5,a2_0x4d87('0x28'),function(_0x11a977,_0x5a11dd){if(_0x11a977){_0x359093[a2_0x4d87('0x24')]=null;}else{try{const _0x5e6111=JSON[a2_0x4d87('0x29')](_0x5a11dd);for(const _0xa85687 of _0x5e6111[a2_0x4d87('0x2a')][0x0]['CountingInfo']){const _0x591d1b=_0xa85687['In'];const _0x465c5b=_0xa85687[a2_0x4d87('0x2b')];const _0x35af69=Date[a2_0x4d87('0x29')](_0xa85687[a2_0x4d87('0x2c')]);if(_0x591d1b>0x0){exports[a2_0x4d87('0x4')][a2_0x4d87('0x13')][a2_0x4d87('0x2d')][a2_0x4d87('0x2e')]({'reportFileId':_0x359093['id'],'amount':_0x591d1b,'countingDate':_0x35af69});}if(_0x465c5b>0x0){exports[a2_0x4d87('0x4')]['models'][a2_0x4d87('0x2d')][a2_0x4d87('0x2e')]({'reportFileId':_0x359093['id'],'amount':_0x465c5b*-0x1,'countingDate':_0x35af69});}}_0x359093[a2_0x4d87('0x24')]=0x2;}catch(_0x285390){_0x359093[a2_0x4d87('0x24')]=null;}}_0x359093[a2_0x4d87('0x25')]();});_0x2ad1fa[a2_0x4d87('0x12')]({'data':_0x359093[a2_0x4d87('0x1e')]});}else{_0x2ad1fa[a2_0x4d87('0x12')]({'data':[]});}});};exports[a2_0x4d87('0x2f')]=(_0x58f5a2,_0x18643f)=>{exports[a2_0x4d87('0x4')][a2_0x4d87('0x13')][a2_0x4d87('0x2d')][a2_0x4d87('0x30')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a2_0x4d87('0x31'),a2_0x4d87('0x32')]]})[a2_0x4d87('0x1c')](_0x59486c=>{_0x18643f[a2_0x4d87('0x12')]({'data':_0x59486c});});};exports[a2_0x4d87('0x33')]=(_0x612a46,_0x1f2b1f)=>{const _0x1953ef=_0x612a46[a2_0x4d87('0x34')][a2_0x4d87('0x35')];const _0x4e9d5a=_0x612a46[a2_0x4d87('0x34')][a2_0x4d87('0x36')];const _0x392d32=_0x612a46[a2_0x4d87('0x34')]['endDate'];exports['sequelize'][a2_0x4d87('0x13')][a2_0x4d87('0x2d')][a2_0x4d87('0x30')]({'attributes':[a2_0x4d87('0x31'),[exports[a2_0x4d87('0x4')]['fn'](a2_0x4d87('0x37'),exports[a2_0x4d87('0x4')][a2_0x4d87('0x38')](a2_0x4d87('0x39'))),a2_0x4d87('0x3a')]],'where':{'countingDate':{[exports[a2_0x4d87('0x4')]['Op'][a2_0x4d87('0x3b')]]:_0x4e9d5a,[exports[a2_0x4d87('0x4')]['Op']['lt']]:_0x392d32},'amount':_0x612a46[a2_0x4d87('0x3c')][a2_0x4d87('0x3d')]=='in'?{[exports[a2_0x4d87('0x4')]['Op']['gt']]:0x0}:{[exports[a2_0x4d87('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x4d87('0x4')][a2_0x4d87('0x3e')](a2_0x4d87('0x3f'))],'order':[[a2_0x4d87('0x31'),'ASC']]})[a2_0x4d87('0x1c')](_0x5691cf=>{_0x1f2b1f[a2_0x4d87('0x12')]({'data':_0x5691cf});});};exports[a2_0x4d87('0x40')]=(_0x121971,_0x38c0c4)=>{const _0x5f2c0c=_0x121971[a2_0x4d87('0x34')][a2_0x4d87('0x35')];const _0x47867d=_0x121971[a2_0x4d87('0x34')][a2_0x4d87('0x36')];const _0x9d3e3a=_0x121971['query'][a2_0x4d87('0x41')];exports[a2_0x4d87('0x4')][a2_0x4d87('0x13')][a2_0x4d87('0x2d')]['findAll']({'attributes':[a2_0x4d87('0x31'),[exports[a2_0x4d87('0x4')]['fn'](a2_0x4d87('0x42'),exports[a2_0x4d87('0x4')][a2_0x4d87('0x38')]('countingDate'),'%Y-%m-%d\x20%H:00'),a2_0x4d87('0x43')],[exports[a2_0x4d87('0x4')]['fn']('sum',exports[a2_0x4d87('0x4')][a2_0x4d87('0x38')](a2_0x4d87('0x39'))),a2_0x4d87('0x3a')]],'where':{'countingDate':{[exports['sequelize']['Op'][a2_0x4d87('0x3b')]]:_0x47867d,[exports[a2_0x4d87('0x4')]['Op']['lt']]:_0x9d3e3a},'amount':_0x121971[a2_0x4d87('0x3c')]['direction']=='in'?{[exports[a2_0x4d87('0x4')]['Op']['gt']]:0x0}:{[exports[a2_0x4d87('0x4')]['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a2_0x4d87('0x44'),exports[a2_0x4d87('0x4')]['col'](a2_0x4d87('0x31'))),exports[a2_0x4d87('0x4')]['fn']('DAY',exports[a2_0x4d87('0x4')][a2_0x4d87('0x38')](a2_0x4d87('0x31'))),exports[a2_0x4d87('0x4')]['fn']('MONTH',exports[a2_0x4d87('0x4')][a2_0x4d87('0x38')]('countingDate')),exports[a2_0x4d87('0x4')]['fn'](a2_0x4d87('0x45'),exports['sequelize']['col']('countingDate'))],'order':[['countingDate',a2_0x4d87('0x32')]]})[a2_0x4d87('0x1c')](_0x1c83f7=>{_0x38c0c4[a2_0x4d87('0x12')]({'data':_0x1c83f7});});};exports[a2_0x4d87('0x46')]=(_0x24bc6c,_0x26d97d,_0x59c08a)=>{const _0x5f4f17=_0x24bc6c['user'][a2_0x4d87('0x47')][a2_0x4d87('0x48')](_0x5f4f17=>_0x5f4f17[a2_0x4d87('0x49')]===a2_0x4d87('0x4a'));fbgraph_1[a2_0x4d87('0x23')]['setAccessToken'](_0x5f4f17[a2_0x4d87('0x4b')]);fbgraph_1[a2_0x4d87('0x23')][a2_0x4d87('0x4c')](_0x24bc6c['user'][a2_0x4d87('0x4a')]+a2_0x4d87('0x4d'),(_0x35d5c3,_0x152e24)=>{if(_0x35d5c3){return _0x59c08a(_0x35d5c3);}_0x26d97d[a2_0x4d87('0x7')](a2_0x4d87('0x4e'),{'title':a2_0x4d87('0x4f'),'profile':_0x152e24});});};
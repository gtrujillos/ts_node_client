var a2_0x2a22=['getPassCountingByHour','startDate','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','gte','HOUR','DAY','getFacebook','user','kind','facebook','setAccessToken','accessToken','get','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','Facebook\x20API','__importDefault','__esModule','defineProperty','fbgraph','ftp','sequelize','setSequelize','getApi','api/index','API\x20Examples','connecting','default','log','list','colombia','name','endsWith','report_files','findOrCreate','spread','push','json','error','connect','ipd','downloadFtp','findOne','then','ready','connected:','fileName','media/','createWriteStream','status','save','Downloaded:\x20','ftp.vivotek.com','processFtp','.txt','utf8','Data','Out','parse','EndTime','models','pass_counting','create','getPassCounting','findAll','countingDate','ASC','getPassCountingByDay','month','query','endDate','sum','col','amount','total','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))'];(function(_0x4b0a0e,_0x3362cc){var _0x59ef57=function(_0x330a83){while(--_0x330a83){_0x4b0a0e['push'](_0x4b0a0e['shift']());}};_0x59ef57(++_0x3362cc);}(a2_0x2a22,0x19c));var a2_0x25c1=function(_0x5ec686,_0x50dbae){_0x5ec686=_0x5ec686-0x0;var _0x30ef6f=a2_0x2a22[_0x5ec686];return _0x30ef6f;};'use strict';var __importDefault=this&&this[a2_0x25c1('0x0')]||function(_0x9b59bb){return _0x9b59bb&&_0x9b59bb[a2_0x25c1('0x1')]?_0x9b59bb:{'default':_0x9b59bb};};Object[a2_0x25c1('0x2')](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x25c1('0x3')));const ftp_1=__importDefault(require(a2_0x25c1('0x4')));const fs_1=__importDefault(require('fs'));exports[a2_0x25c1('0x5')]='';function setSequelize(_0xf66111){exports[a2_0x25c1('0x5')]=_0xf66111;}exports[a2_0x25c1('0x6')]=setSequelize;exports[a2_0x25c1('0x7')]=(_0x1b86c1,_0x30ca4a)=>{_0x30ca4a['render'](a2_0x25c1('0x8'),{'title':a2_0x25c1('0x9')});};exports['syncFtp']=(_0x5cab5e,_0x3a4ff0)=>{console['log'](a2_0x25c1('0xa'));const _0x275c63=[];const _0x3ab3d4=new ftp_1[(a2_0x25c1('0xb'))]();_0x3ab3d4['on']('ready',function(){console[a2_0x25c1('0xc')]('connected');_0x3ab3d4[a2_0x25c1('0xd')](a2_0x25c1('0xe'),![],function(_0xc2f682,_0x54eb68){if(_0xc2f682){}else{for(const _0x407936 of _0x54eb68){console['log']('Downloading:\x20'+_0x407936[a2_0x25c1('0xf')]);if(_0x407936['name'][a2_0x25c1('0x10')]('json')){exports[a2_0x25c1('0x5')]['models'][a2_0x25c1('0x11')][a2_0x25c1('0x12')]({'where':{'fileName':_0x407936['name']}})[a2_0x25c1('0x13')]((_0x380382,_0x451592)=>{if(_0x451592){console[a2_0x25c1('0xc')](_0x407936[a2_0x25c1('0xf')]);_0x275c63[a2_0x25c1('0x14')](_0x380382);}});}}}_0x3a4ff0[a2_0x25c1('0x15')]({'data':_0x275c63});});});_0x3ab3d4['on'](a2_0x25c1('0x16'),function(_0x4522b2){_0x3a4ff0[a2_0x25c1('0x15')]({'message':_0x4522b2});});_0x3ab3d4[a2_0x25c1('0x17')]({'host':'ftp.vivotek.com','port':0x15,'user':a2_0x25c1('0x18'),'password':a2_0x25c1('0x18')});};exports[a2_0x25c1('0x19')]=(_0x5c80af,_0x18ffbb)=>{exports[a2_0x25c1('0x5')]['models']['report_files'][a2_0x25c1('0x1a')]({'where':{'status':null}})[a2_0x25c1('0x1b')](_0x509bae=>{if(_0x509bae){const _0x2e4409=new ftp_1['default']();_0x2e4409['on'](a2_0x25c1('0x1c'),function(){console[a2_0x25c1('0xc')](a2_0x25c1('0x1d')+_0x509bae[a2_0x25c1('0x1e')]);_0x2e4409['get']('colombia/'+_0x509bae[a2_0x25c1('0x1e')],function(_0x5476d2,_0x33dd5f){_0x2e4409['end']();if(_0x5476d2){}else{const _0x38254b=a2_0x25c1('0x1f')+_0x509bae[a2_0x25c1('0x1e')]+'.txt';_0x33dd5f['pipe'](fs_1['default'][a2_0x25c1('0x20')](_0x38254b));_0x509bae[a2_0x25c1('0x21')]=0x1;_0x509bae[a2_0x25c1('0x22')]();console['log'](a2_0x25c1('0x23')+_0x509bae['fileName']);}});});_0x2e4409['on'](a2_0x25c1('0x16'),function(_0x315569){_0x18ffbb[a2_0x25c1('0x15')]({'message':_0x315569});});_0x2e4409[a2_0x25c1('0x17')]({'host':a2_0x25c1('0x24'),'port':0x15,'user':'ipd','password':'ipd'});_0x18ffbb[a2_0x25c1('0x15')]({'data':_0x509bae['fileName']});}else{_0x18ffbb[a2_0x25c1('0x15')]({'data':[]});}});};exports[a2_0x25c1('0x25')]=(_0x4ff1de,_0x59da39)=>{exports[a2_0x25c1('0x5')]['models'][a2_0x25c1('0x11')][a2_0x25c1('0x1a')]({'where':{'status':0x1}})[a2_0x25c1('0x1b')](_0x27f988=>{if(_0x27f988){const _0x2c439b=a2_0x25c1('0x1f')+_0x27f988[a2_0x25c1('0x1e')]+a2_0x25c1('0x26');fs_1['default']['readFile'](_0x2c439b,a2_0x25c1('0x27'),function(_0x1a4567,_0x1ae022){if(_0x1a4567){_0x27f988[a2_0x25c1('0x21')]=null;}else{try{const _0x4a60e3=JSON['parse'](_0x1ae022);for(const _0x504ce9 of _0x4a60e3[a2_0x25c1('0x28')][0x0]['CountingInfo']){const _0x5e2c7a=_0x504ce9['In'];const _0x4430c5=_0x504ce9[a2_0x25c1('0x29')];const _0x2e42fa=Date[a2_0x25c1('0x2a')](_0x504ce9[a2_0x25c1('0x2b')]);if(_0x5e2c7a>0x0){exports[a2_0x25c1('0x5')][a2_0x25c1('0x2c')][a2_0x25c1('0x2d')][a2_0x25c1('0x2e')]({'reportFileId':_0x27f988['id'],'amount':_0x5e2c7a,'countingDate':_0x2e42fa});}if(_0x4430c5>0x0){exports[a2_0x25c1('0x5')][a2_0x25c1('0x2c')][a2_0x25c1('0x2d')][a2_0x25c1('0x2e')]({'reportFileId':_0x27f988['id'],'amount':_0x4430c5*-0x1,'countingDate':_0x2e42fa});}}_0x27f988['status']=0x2;}catch(_0x3ad6e0){_0x27f988[a2_0x25c1('0x21')]=null;}}_0x27f988[a2_0x25c1('0x22')]();});_0x59da39[a2_0x25c1('0x15')]({'data':_0x27f988[a2_0x25c1('0x1e')]});}else{_0x59da39[a2_0x25c1('0x15')]({'data':[]});}});};exports[a2_0x25c1('0x2f')]=(_0x2b6bc6,_0x3dc67b)=>{exports[a2_0x25c1('0x5')]['models'][a2_0x25c1('0x2d')][a2_0x25c1('0x30')]({'where':{'amount':{[exports[a2_0x25c1('0x5')]['Op']['gt']]:0x0}},'order':[[a2_0x25c1('0x31'),a2_0x25c1('0x32')]]})[a2_0x25c1('0x1b')](_0x58108b=>{_0x3dc67b['json']({'data':_0x58108b});});};exports[a2_0x25c1('0x33')]=(_0x17af33,_0x5be3de)=>{const _0x2b483d=_0x17af33['query'][a2_0x25c1('0x34')];const _0x560e4=_0x17af33[a2_0x25c1('0x35')]['startDate'];const _0x14ca94=_0x17af33[a2_0x25c1('0x35')][a2_0x25c1('0x36')];exports[a2_0x25c1('0x5')][a2_0x25c1('0x2c')][a2_0x25c1('0x2d')][a2_0x25c1('0x30')]({'attributes':[a2_0x25c1('0x31'),[exports[a2_0x25c1('0x5')]['fn'](a2_0x25c1('0x37'),exports[a2_0x25c1('0x5')][a2_0x25c1('0x38')](a2_0x25c1('0x39'))),a2_0x25c1('0x3a')]],'where':{'countingDate':{[exports[a2_0x25c1('0x5')]['Op']['gte']]:_0x560e4,[exports['sequelize']['Op']['lt']]:_0x14ca94},'amount':_0x17af33['params'][a2_0x25c1('0x3b')]=='in'?{[exports[a2_0x25c1('0x5')]['Op']['gt']]:0x0}:{[exports[a2_0x25c1('0x5')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a2_0x25c1('0x3c')](a2_0x25c1('0x3d'))],'order':[[a2_0x25c1('0x31'),a2_0x25c1('0x32')]]})[a2_0x25c1('0x1b')](_0x1ff8d5=>{_0x5be3de['json']({'data':_0x1ff8d5});});};exports[a2_0x25c1('0x3e')]=(_0x3eef0a,_0x494a8f)=>{const _0xe4a559=_0x3eef0a['query']['month'];const _0x43da09=_0x3eef0a[a2_0x25c1('0x35')][a2_0x25c1('0x3f')];const _0xc76ec8=_0x3eef0a[a2_0x25c1('0x35')][a2_0x25c1('0x36')];exports['sequelize']['models'][a2_0x25c1('0x2d')][a2_0x25c1('0x30')]({'attributes':[a2_0x25c1('0x31'),[exports[a2_0x25c1('0x5')]['fn'](a2_0x25c1('0x40'),exports[a2_0x25c1('0x5')][a2_0x25c1('0x38')]('countingDate'),a2_0x25c1('0x41')),a2_0x25c1('0x42')],[exports[a2_0x25c1('0x5')]['fn'](a2_0x25c1('0x37'),exports[a2_0x25c1('0x5')][a2_0x25c1('0x38')](a2_0x25c1('0x39'))),a2_0x25c1('0x3a')]],'where':{'countingDate':{[exports[a2_0x25c1('0x5')]['Op'][a2_0x25c1('0x43')]]:_0x43da09,[exports[a2_0x25c1('0x5')]['Op']['lt']]:_0xc76ec8},'amount':_0x3eef0a['params'][a2_0x25c1('0x3b')]=='in'?{[exports[a2_0x25c1('0x5')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a2_0x25c1('0x44'),exports[a2_0x25c1('0x5')][a2_0x25c1('0x38')](a2_0x25c1('0x31'))),exports['sequelize']['fn'](a2_0x25c1('0x45'),exports['sequelize'][a2_0x25c1('0x38')](a2_0x25c1('0x31'))),exports['sequelize']['fn']('MONTH',exports[a2_0x25c1('0x5')][a2_0x25c1('0x38')](a2_0x25c1('0x31'))),exports[a2_0x25c1('0x5')]['fn']('YEAR',exports[a2_0x25c1('0x5')][a2_0x25c1('0x38')](a2_0x25c1('0x31')))],'order':[[a2_0x25c1('0x31'),'ASC']]})['then'](_0x2b1add=>{_0x494a8f[a2_0x25c1('0x15')]({'data':_0x2b1add});});};exports[a2_0x25c1('0x46')]=(_0x154c42,_0x2a9a61,_0x50ed52)=>{const _0x2bb232=_0x154c42[a2_0x25c1('0x47')]['tokens']['find'](_0x2bb232=>_0x2bb232[a2_0x25c1('0x48')]===a2_0x25c1('0x49'));fbgraph_1['default'][a2_0x25c1('0x4a')](_0x2bb232[a2_0x25c1('0x4b')]);fbgraph_1[a2_0x25c1('0xb')][a2_0x25c1('0x4c')](_0x154c42[a2_0x25c1('0x47')][a2_0x25c1('0x49')]+a2_0x25c1('0x4d'),(_0x410194,_0x6bd455)=>{if(_0x410194){return _0x50ed52(_0x410194);}_0x2a9a61['render']('api/facebook',{'title':a2_0x25c1('0x4e'),'profile':_0x6bd455});});};
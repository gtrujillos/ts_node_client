var a2_0x382d=['downloadFtp','findOne','connected:','get','colombia/','media/','fileName','.txt','createWriteStream','status','save','Downloaded:\x20','connect','ipd','then','readFile','utf8','parse','Data','Out','EndTime','create','findAll','countingDate','ASC','query','month','startDate','endDate','sum','col','total','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','%Y-%m-%d\x20%H:00','countingDateShort','amount','gte','HOUR','DAY','MONTH','YEAR','getFacebook','user','tokens','find','kind','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook','__importDefault','defineProperty','fbgraph','ftp','sequelize','setSequelize','getApi','api/index','API\x20Examples','syncFtp','log','connecting','default','ready','connected','list','Downloading:\x20','endsWith','json','models','report_files','findOrCreate','name','spread','push','ftp.vivotek.com'];(function(_0x1073eb,_0xbe4be7){var _0x4e4b37=function(_0x505db6){while(--_0x505db6){_0x1073eb['push'](_0x1073eb['shift']());}};_0x4e4b37(++_0xbe4be7);}(a2_0x382d,0x88));var a2_0x4145=function(_0xfcc7,_0x11a913){_0xfcc7=_0xfcc7-0x0;var _0x100e04=a2_0x382d[_0xfcc7];return _0x100e04;};'use strict';var __importDefault=this&&this[a2_0x4145('0x0')]||function(_0x279f9d){return _0x279f9d&&_0x279f9d['__esModule']?_0x279f9d:{'default':_0x279f9d};};Object[a2_0x4145('0x1')](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x4145('0x2')));const ftp_1=__importDefault(require(a2_0x4145('0x3')));const fs_1=__importDefault(require('fs'));exports[a2_0x4145('0x4')]='';function setSequelize(_0x38ef17){exports['sequelize']=_0x38ef17;}exports[a2_0x4145('0x5')]=setSequelize;exports[a2_0x4145('0x6')]=(_0x1ffa0e,_0x4259ca)=>{_0x4259ca['render'](a2_0x4145('0x7'),{'title':a2_0x4145('0x8')});};exports[a2_0x4145('0x9')]=(_0x59d334,_0x19fb44)=>{console[a2_0x4145('0xa')](a2_0x4145('0xb'));const _0x51a07e=[];const _0x5f26a3=new ftp_1[(a2_0x4145('0xc'))]();_0x5f26a3['on'](a2_0x4145('0xd'),function(){console[a2_0x4145('0xa')](a2_0x4145('0xe'));_0x5f26a3[a2_0x4145('0xf')]('colombia',![],function(_0x59cf77,_0x4bcd22){if(_0x59cf77){}else{for(const _0x2bf9d8 of _0x4bcd22){console['log'](a2_0x4145('0x10')+_0x2bf9d8['name']);if(_0x2bf9d8['name'][a2_0x4145('0x11')](a2_0x4145('0x12'))){exports[a2_0x4145('0x4')][a2_0x4145('0x13')][a2_0x4145('0x14')][a2_0x4145('0x15')]({'where':{'fileName':_0x2bf9d8[a2_0x4145('0x16')]}})[a2_0x4145('0x17')]((_0x38afbb,_0xf66b4c)=>{if(_0xf66b4c){console[a2_0x4145('0xa')](_0x2bf9d8[a2_0x4145('0x16')]);_0x51a07e[a2_0x4145('0x18')](_0x38afbb);}});}}}_0x19fb44['json']({'data':_0x51a07e});});});_0x5f26a3['on']('error',function(_0x3ea6f3){_0x19fb44['json']({'message':_0x3ea6f3});});_0x5f26a3['connect']({'host':a2_0x4145('0x19'),'port':0x15,'user':'ipd','password':'ipd'});};exports[a2_0x4145('0x1a')]=(_0x4968f4,_0x5e7206)=>{exports['sequelize']['models'][a2_0x4145('0x14')][a2_0x4145('0x1b')]({'where':{'status':null}})['then'](_0x3b378e=>{if(_0x3b378e){const _0x420f9e=new ftp_1[(a2_0x4145('0xc'))]();_0x420f9e['on'](a2_0x4145('0xd'),function(){console[a2_0x4145('0xa')](a2_0x4145('0x1c')+_0x3b378e['fileName']);_0x420f9e[a2_0x4145('0x1d')](a2_0x4145('0x1e')+_0x3b378e['fileName'],function(_0xc6ec1d,_0x30c239){_0x420f9e['end']();if(_0xc6ec1d){}else{const _0x13892d=a2_0x4145('0x1f')+_0x3b378e[a2_0x4145('0x20')]+a2_0x4145('0x21');_0x30c239['pipe'](fs_1[a2_0x4145('0xc')][a2_0x4145('0x22')](_0x13892d));_0x3b378e[a2_0x4145('0x23')]=0x1;_0x3b378e[a2_0x4145('0x24')]();console['log'](a2_0x4145('0x25')+_0x3b378e[a2_0x4145('0x20')]);}});});_0x420f9e['on']('error',function(_0x732e84){_0x5e7206['json']({'message':_0x732e84});});_0x420f9e[a2_0x4145('0x26')]({'host':'ftp.vivotek.com','port':0x15,'user':a2_0x4145('0x27'),'password':a2_0x4145('0x27')});_0x5e7206[a2_0x4145('0x12')]({'data':_0x3b378e['fileName']});}else{_0x5e7206[a2_0x4145('0x12')]({'data':[]});}});};exports['processFtp']=(_0x2e3b90,_0x5619e3)=>{exports[a2_0x4145('0x4')][a2_0x4145('0x13')]['report_files'][a2_0x4145('0x1b')]({'where':{'status':0x1}})[a2_0x4145('0x28')](_0x5bd8ee=>{if(_0x5bd8ee){const _0x125bf4=a2_0x4145('0x1f')+_0x5bd8ee[a2_0x4145('0x20')]+a2_0x4145('0x21');fs_1[a2_0x4145('0xc')][a2_0x4145('0x29')](_0x125bf4,a2_0x4145('0x2a'),function(_0x5cf063,_0x56ee5e){if(_0x5cf063){_0x5bd8ee[a2_0x4145('0x23')]=null;}else{try{const _0xff9a65=JSON[a2_0x4145('0x2b')](_0x56ee5e);for(const _0x29b9f9 of _0xff9a65[a2_0x4145('0x2c')][0x0]['CountingInfo']){const _0xb9492c=_0x29b9f9['In'];const _0xa08452=_0x29b9f9[a2_0x4145('0x2d')];const _0x21a9fa=Date[a2_0x4145('0x2b')](_0x29b9f9[a2_0x4145('0x2e')]);if(_0xb9492c>0x0){exports[a2_0x4145('0x4')][a2_0x4145('0x13')]['pass_counting'][a2_0x4145('0x2f')]({'reportFileId':_0x5bd8ee['id'],'amount':_0xb9492c,'countingDate':_0x21a9fa});}if(_0xa08452>0x0){exports['sequelize']['models']['pass_counting'][a2_0x4145('0x2f')]({'reportFileId':_0x5bd8ee['id'],'amount':_0xa08452*-0x1,'countingDate':_0x21a9fa});}}_0x5bd8ee[a2_0x4145('0x23')]=0x2;}catch(_0x75f753){_0x5bd8ee[a2_0x4145('0x23')]=null;}}_0x5bd8ee[a2_0x4145('0x24')]();});_0x5619e3[a2_0x4145('0x12')]({'data':_0x5bd8ee[a2_0x4145('0x20')]});}else{_0x5619e3[a2_0x4145('0x12')]({'data':[]});}});};exports['getPassCounting']=(_0x2fd886,_0x5ace1a)=>{exports[a2_0x4145('0x4')][a2_0x4145('0x13')]['pass_counting'][a2_0x4145('0x30')]({'where':{'amount':{[exports[a2_0x4145('0x4')]['Op']['gt']]:0x0}},'order':[[a2_0x4145('0x31'),a2_0x4145('0x32')]]})[a2_0x4145('0x28')](_0x54e422=>{_0x5ace1a[a2_0x4145('0x12')]({'data':_0x54e422});});};exports['getPassCountingByDay']=(_0x2a1204,_0x50e658)=>{const _0x40c61e=_0x2a1204[a2_0x4145('0x33')][a2_0x4145('0x34')];const _0x5077b6=_0x2a1204[a2_0x4145('0x33')][a2_0x4145('0x35')];const _0x207020=_0x2a1204[a2_0x4145('0x33')][a2_0x4145('0x36')];exports[a2_0x4145('0x4')][a2_0x4145('0x13')]['pass_counting'][a2_0x4145('0x30')]({'attributes':[a2_0x4145('0x31'),[exports[a2_0x4145('0x4')]['fn'](a2_0x4145('0x37'),exports[a2_0x4145('0x4')][a2_0x4145('0x38')]('amount')),a2_0x4145('0x39')]],'where':{'countingDate':{[exports[a2_0x4145('0x4')]['Op']['gte']]:_0x5077b6,[exports['sequelize']['Op']['lt']]:_0x207020},'amount':_0x2a1204[a2_0x4145('0x3a')][a2_0x4145('0x3b')]=='in'?{[exports[a2_0x4145('0x4')]['Op']['gt']]:0x0}:{[exports[a2_0x4145('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x4145('0x4')][a2_0x4145('0x3c')](a2_0x4145('0x3d'))],'order':[[a2_0x4145('0x31'),'ASC']]})[a2_0x4145('0x28')](_0x5e9da4=>{_0x50e658['json']({'data':_0x5e9da4});});};exports['getPassCountingByHour']=(_0x1799dd,_0x3feed5)=>{const _0x28b9f2=_0x1799dd['query'][a2_0x4145('0x34')];const _0x29bcb6=_0x1799dd[a2_0x4145('0x33')]['startDate'];const _0x13c130=_0x1799dd[a2_0x4145('0x33')][a2_0x4145('0x36')];exports['sequelize'][a2_0x4145('0x13')]['pass_counting'][a2_0x4145('0x30')]({'attributes':[a2_0x4145('0x31'),[exports[a2_0x4145('0x4')]['fn']('DATE_FORMAT',exports[a2_0x4145('0x4')][a2_0x4145('0x38')]('countingDate'),a2_0x4145('0x3e')),a2_0x4145('0x3f')],[exports[a2_0x4145('0x4')]['fn'](a2_0x4145('0x37'),exports['sequelize']['col'](a2_0x4145('0x40'))),a2_0x4145('0x39')]],'where':{'countingDate':{[exports['sequelize']['Op'][a2_0x4145('0x41')]]:_0x29bcb6,[exports['sequelize']['Op']['lt']]:_0x13c130},'amount':_0x1799dd[a2_0x4145('0x3a')]['direction']=='in'?{[exports[a2_0x4145('0x4')]['Op']['gt']]:0x0}:{[exports[a2_0x4145('0x4')]['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a2_0x4145('0x42'),exports[a2_0x4145('0x4')][a2_0x4145('0x38')](a2_0x4145('0x31'))),exports[a2_0x4145('0x4')]['fn'](a2_0x4145('0x43'),exports[a2_0x4145('0x4')][a2_0x4145('0x38')]('countingDate')),exports['sequelize']['fn'](a2_0x4145('0x44'),exports[a2_0x4145('0x4')]['col'](a2_0x4145('0x31'))),exports[a2_0x4145('0x4')]['fn'](a2_0x4145('0x45'),exports[a2_0x4145('0x4')][a2_0x4145('0x38')](a2_0x4145('0x31')))],'order':[[a2_0x4145('0x31'),a2_0x4145('0x32')]]})[a2_0x4145('0x28')](_0x2bca13=>{_0x3feed5[a2_0x4145('0x12')]({'data':_0x2bca13});});};exports[a2_0x4145('0x46')]=(_0x13e93c,_0x1bf70f,_0xd9827d)=>{const _0x215b3e=_0x13e93c[a2_0x4145('0x47')][a2_0x4145('0x48')][a2_0x4145('0x49')](_0x215b3e=>_0x215b3e[a2_0x4145('0x4a')]===a2_0x4145('0x4b'));fbgraph_1[a2_0x4145('0xc')][a2_0x4145('0x4c')](_0x215b3e[a2_0x4145('0x4d')]);fbgraph_1[a2_0x4145('0xc')][a2_0x4145('0x1d')](_0x13e93c[a2_0x4145('0x47')]['facebook']+a2_0x4145('0x4e'),(_0x479e71,_0x5bdd65)=>{if(_0x479e71){return _0xd9827d(_0x479e71);}_0x1bf70f[a2_0x4145('0x4f')](a2_0x4145('0x50'),{'title':'Facebook\x20API','profile':_0x5bdd65});});};
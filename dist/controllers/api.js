var a2_0x15bf=['fileName','end','media/','.txt','pipe','createWriteStream','status','save','Downloaded:\x20','processFtp','findOne','utf8','parse','Data','CountingInfo','EndTime','create','getPassCounting','findAll','countingDate','ASC','getPassCountingByDay','query','month','endDate','sum','col','amount','gte','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','pass_counting','DATE_FORMAT','%Y-%m-%d\x20%H:00','total','params','HOUR','DAY','MONTH','YEAR','getFacebook','tokens','find','kind','facebook','setAccessToken','accessToken','user','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','__importDefault','__esModule','defineProperty','fbgraph','ftp','sequelize','getApi','render','api/index','API\x20Examples','syncFtp','log','default','ready','connected','colombia','Downloading:\x20','name','endsWith','json','models','report_files','findOrCreate','spread','error','connect','ftp.vivotek.com','ipd','downloadFtp','then','get','colombia/'];(function(_0x21b5af,_0x43ba94){var _0xe0c62b=function(_0xc1bbe1){while(--_0xc1bbe1){_0x21b5af['push'](_0x21b5af['shift']());}};_0xe0c62b(++_0x43ba94);}(a2_0x15bf,0x130));var a2_0x4099=function(_0x32a0e8,_0x21abfa){_0x32a0e8=_0x32a0e8-0x0;var _0x189b52=a2_0x15bf[_0x32a0e8];return _0x189b52;};'use strict';var __importDefault=this&&this[a2_0x4099('0x0')]||function(_0x5ae7c9){return _0x5ae7c9&&_0x5ae7c9[a2_0x4099('0x1')]?_0x5ae7c9:{'default':_0x5ae7c9};};Object[a2_0x4099('0x2')](exports,a2_0x4099('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x4099('0x3')));const ftp_1=__importDefault(require(a2_0x4099('0x4')));const fs_1=__importDefault(require('fs'));exports[a2_0x4099('0x5')]='';function setSequelize(_0x1aefd8){exports[a2_0x4099('0x5')]=_0x1aefd8;}exports['setSequelize']=setSequelize;exports[a2_0x4099('0x6')]=(_0xc2baff,_0x4ddd4b)=>{_0x4ddd4b[a2_0x4099('0x7')](a2_0x4099('0x8'),{'title':a2_0x4099('0x9')});};exports[a2_0x4099('0xa')]=(_0x183caa,_0x44ba48)=>{console[a2_0x4099('0xb')]('connecting');const _0x2987c5=[];const _0x454f2a=new ftp_1[(a2_0x4099('0xc'))]();_0x454f2a['on'](a2_0x4099('0xd'),function(){console[a2_0x4099('0xb')](a2_0x4099('0xe'));_0x454f2a['list'](a2_0x4099('0xf'),![],function(_0x374c3d,_0x262b02){if(_0x374c3d){}else{for(const _0x3c4db2 of _0x262b02){console[a2_0x4099('0xb')](a2_0x4099('0x10')+_0x3c4db2[a2_0x4099('0x11')]);if(_0x3c4db2[a2_0x4099('0x11')][a2_0x4099('0x12')](a2_0x4099('0x13'))){exports[a2_0x4099('0x5')][a2_0x4099('0x14')][a2_0x4099('0x15')][a2_0x4099('0x16')]({'where':{'fileName':_0x3c4db2[a2_0x4099('0x11')]}})[a2_0x4099('0x17')]((_0x9bb611,_0x3cacf7)=>{if(_0x3cacf7){console[a2_0x4099('0xb')](_0x3c4db2[a2_0x4099('0x11')]);_0x2987c5['push'](_0x9bb611);}});}}}_0x44ba48[a2_0x4099('0x13')]({'data':_0x2987c5});});});_0x454f2a['on'](a2_0x4099('0x18'),function(_0x336dc3){_0x44ba48['json']({'message':_0x336dc3});});_0x454f2a[a2_0x4099('0x19')]({'host':a2_0x4099('0x1a'),'port':0x15,'user':a2_0x4099('0x1b'),'password':a2_0x4099('0x1b')});};exports[a2_0x4099('0x1c')]=(_0x538a0a,_0x278626)=>{exports[a2_0x4099('0x5')][a2_0x4099('0x14')][a2_0x4099('0x15')]['findOne']({'where':{'status':null}})[a2_0x4099('0x1d')](_0x434d97=>{if(_0x434d97){const _0x467a6c=new ftp_1[(a2_0x4099('0xc'))]();_0x467a6c['on']('ready',function(){console['log']('connected:'+_0x434d97['fileName']);_0x467a6c[a2_0x4099('0x1e')](a2_0x4099('0x1f')+_0x434d97[a2_0x4099('0x20')],function(_0x5e797a,_0x355af0){_0x467a6c[a2_0x4099('0x21')]();if(_0x5e797a){}else{const _0x5f1e7e=a2_0x4099('0x22')+_0x434d97[a2_0x4099('0x20')]+a2_0x4099('0x23');_0x355af0[a2_0x4099('0x24')](fs_1[a2_0x4099('0xc')][a2_0x4099('0x25')](_0x5f1e7e));_0x434d97[a2_0x4099('0x26')]=0x1;_0x434d97[a2_0x4099('0x27')]();console[a2_0x4099('0xb')](a2_0x4099('0x28')+_0x434d97[a2_0x4099('0x20')]);}});});_0x467a6c['on'](a2_0x4099('0x18'),function(_0x47f44a){_0x278626[a2_0x4099('0x13')]({'message':_0x47f44a});});_0x467a6c[a2_0x4099('0x19')]({'host':a2_0x4099('0x1a'),'port':0x15,'user':a2_0x4099('0x1b'),'password':a2_0x4099('0x1b')});_0x278626[a2_0x4099('0x13')]({'data':_0x434d97[a2_0x4099('0x20')]});}else{_0x278626['json']({'data':[]});}});};exports[a2_0x4099('0x29')]=(_0x177de2,_0x1d8861)=>{exports['sequelize'][a2_0x4099('0x14')][a2_0x4099('0x15')][a2_0x4099('0x2a')]({'where':{'status':0x1}})[a2_0x4099('0x1d')](_0x27d29a=>{if(_0x27d29a){const _0x185d7e=a2_0x4099('0x22')+_0x27d29a[a2_0x4099('0x20')]+a2_0x4099('0x23');fs_1[a2_0x4099('0xc')]['readFile'](_0x185d7e,a2_0x4099('0x2b'),function(_0x219ada,_0x298602){if(_0x219ada){_0x27d29a[a2_0x4099('0x26')]=null;}else{try{const _0x3275b1=JSON[a2_0x4099('0x2c')](_0x298602);for(const _0x47405f of _0x3275b1[a2_0x4099('0x2d')][0x0][a2_0x4099('0x2e')]){const _0x3342bb=_0x47405f['In'];const _0x3583b0=_0x47405f['Out'];const _0x316493=Date[a2_0x4099('0x2c')](_0x47405f[a2_0x4099('0x2f')]);if(_0x3342bb>0x0){exports[a2_0x4099('0x5')][a2_0x4099('0x14')]['pass_counting'][a2_0x4099('0x30')]({'reportFileId':_0x27d29a['id'],'amount':_0x3342bb,'countingDate':_0x316493});}if(_0x3583b0>0x0){exports[a2_0x4099('0x5')]['models']['pass_counting']['create']({'reportFileId':_0x27d29a['id'],'amount':_0x3583b0*-0x1,'countingDate':_0x316493});}}_0x27d29a[a2_0x4099('0x26')]=0x2;}catch(_0xfb0c8){_0x27d29a[a2_0x4099('0x26')]=null;}}_0x27d29a[a2_0x4099('0x27')]();});_0x1d8861['json']({'data':_0x27d29a[a2_0x4099('0x20')]});}else{_0x1d8861[a2_0x4099('0x13')]({'data':[]});}});};exports[a2_0x4099('0x31')]=(_0x1c7f72,_0x27b9e2)=>{exports[a2_0x4099('0x5')][a2_0x4099('0x14')]['pass_counting'][a2_0x4099('0x32')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a2_0x4099('0x33'),a2_0x4099('0x34')]]})[a2_0x4099('0x1d')](_0x4ef4ab=>{_0x27b9e2[a2_0x4099('0x13')]({'data':_0x4ef4ab});});};exports[a2_0x4099('0x35')]=(_0xbbb05f,_0x46cfe2)=>{const _0x58f36d=_0xbbb05f[a2_0x4099('0x36')][a2_0x4099('0x37')];const _0x59e326=_0xbbb05f['query']['startDate'];const _0xb2e9d4=_0xbbb05f[a2_0x4099('0x36')][a2_0x4099('0x38')];exports['sequelize']['models']['pass_counting'][a2_0x4099('0x32')]({'attributes':[a2_0x4099('0x33'),[exports[a2_0x4099('0x5')]['fn'](a2_0x4099('0x39'),exports[a2_0x4099('0x5')][a2_0x4099('0x3a')](a2_0x4099('0x3b'))),'total']],'where':{'countingDate':{[exports[a2_0x4099('0x5')]['Op'][a2_0x4099('0x3c')]]:_0x59e326,[exports[a2_0x4099('0x5')]['Op']['lt']]:_0xb2e9d4},'amount':_0xbbb05f['params'][a2_0x4099('0x3d')]=='in'?{[exports[a2_0x4099('0x5')]['Op']['gt']]:0x0}:{[exports[a2_0x4099('0x5')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a2_0x4099('0x3e')](a2_0x4099('0x3f'))],'order':[[a2_0x4099('0x33'),a2_0x4099('0x34')]]})['then'](_0x1e9be2=>{_0x46cfe2[a2_0x4099('0x13')]({'data':_0x1e9be2});});};exports[a2_0x4099('0x40')]=(_0x41b25e,_0x3f24fb)=>{const _0x2f6bf7=_0x41b25e[a2_0x4099('0x36')]['month'];const _0x26e7cd=_0x41b25e[a2_0x4099('0x36')]['startDate'];const _0x1a44a8=_0x41b25e['query']['endDate'];exports[a2_0x4099('0x5')]['models'][a2_0x4099('0x41')]['findAll']({'attributes':[a2_0x4099('0x33'),[exports[a2_0x4099('0x5')]['fn'](a2_0x4099('0x42'),exports[a2_0x4099('0x5')][a2_0x4099('0x3a')]('countingDate'),a2_0x4099('0x43')),'countingDateShort'],[exports[a2_0x4099('0x5')]['fn']('sum',exports[a2_0x4099('0x5')][a2_0x4099('0x3a')](a2_0x4099('0x3b'))),a2_0x4099('0x44')]],'where':{'countingDate':{[exports[a2_0x4099('0x5')]['Op']['gte']]:_0x26e7cd,[exports[a2_0x4099('0x5')]['Op']['lt']]:_0x1a44a8},'amount':_0x41b25e[a2_0x4099('0x45')][a2_0x4099('0x3d')]=='in'?{[exports[a2_0x4099('0x5')]['Op']['gt']]:0x0}:{[exports[a2_0x4099('0x5')]['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a2_0x4099('0x46'),exports[a2_0x4099('0x5')][a2_0x4099('0x3a')](a2_0x4099('0x33'))),exports[a2_0x4099('0x5')]['fn'](a2_0x4099('0x47'),exports['sequelize'][a2_0x4099('0x3a')](a2_0x4099('0x33'))),exports['sequelize']['fn'](a2_0x4099('0x48'),exports[a2_0x4099('0x5')][a2_0x4099('0x3a')](a2_0x4099('0x33'))),exports['sequelize']['fn'](a2_0x4099('0x49'),exports[a2_0x4099('0x5')][a2_0x4099('0x3a')](a2_0x4099('0x33')))],'order':[[a2_0x4099('0x33'),'ASC']]})['then'](_0x381bdb=>{_0x3f24fb['json']({'data':_0x381bdb});});};exports[a2_0x4099('0x4a')]=(_0x1072bf,_0x5594f9,_0x411d41)=>{const _0x572711=_0x1072bf['user'][a2_0x4099('0x4b')][a2_0x4099('0x4c')](_0x572711=>_0x572711[a2_0x4099('0x4d')]===a2_0x4099('0x4e'));fbgraph_1[a2_0x4099('0xc')][a2_0x4099('0x4f')](_0x572711[a2_0x4099('0x50')]);fbgraph_1['default'][a2_0x4099('0x1e')](_0x1072bf[a2_0x4099('0x51')][a2_0x4099('0x4e')]+a2_0x4099('0x52'),(_0x7b1080,_0x1c80c2)=>{if(_0x7b1080){return _0x411d41(_0x7b1080);}_0x5594f9[a2_0x4099('0x7')](a2_0x4099('0x53'),{'title':'Facebook\x20API','profile':_0x1c80c2});});};
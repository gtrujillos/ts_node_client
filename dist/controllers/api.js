var a2_0x2408=['setAccessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','fbgraph','sequelize','setSequelize','getApi','render','api/index','log','ready','connected','colombia','Downloading:\x20','name','endsWith','json','report_files','findOrCreate','push','error','ftp.vivotek.com','ipd','downloadFtp','findOne','get','fileName','end','media/','.txt','pipe','default','createWriteStream','status','save','Downloaded:\x20','connect','models','then','readFile','utf8','Data','CountingInfo','parse','EndTime','pass_counting','create','findAll','getPassCountingByDay','query','month','startDate','endDate','countingDate','sum','col','total','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC','getPassCountingByHour','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','amount','HOUR','DAY','MONTH','YEAR','getFacebook','user','tokens','find','kind','facebook'];(function(_0x2fbeca,_0x302170){var _0x1ae02f=function(_0x1066ee){while(--_0x1066ee){_0x2fbeca['push'](_0x2fbeca['shift']());}};_0x1ae02f(++_0x302170);}(a2_0x2408,0x1d7));var a2_0x1514=function(_0x5892e7,_0xd5e16f){_0x5892e7=_0x5892e7-0x0;var _0x35ff47=a2_0x2408[_0x5892e7];return _0x35ff47;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x58fff6){return _0x58fff6&&_0x58fff6['__esModule']?_0x58fff6:{'default':_0x58fff6};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x1514('0x0')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));exports['sequelize']='';function setSequelize(_0x4a933a){exports[a2_0x1514('0x1')]=_0x4a933a;}exports[a2_0x1514('0x2')]=setSequelize;exports[a2_0x1514('0x3')]=(_0x1fe41b,_0x114474)=>{_0x114474[a2_0x1514('0x4')](a2_0x1514('0x5'),{'title':'API\x20Examples'});};exports['syncFtp']=(_0x4e9545,_0x455a12)=>{console[a2_0x1514('0x6')]('connecting');const _0x400dfb=[];const _0x2343bf=new ftp_1['default']();_0x2343bf['on'](a2_0x1514('0x7'),function(){console['log'](a2_0x1514('0x8'));_0x2343bf['list'](a2_0x1514('0x9'),![],function(_0x403edc,_0x493298){if(_0x403edc){}else{for(const _0x5697bd of _0x493298){console[a2_0x1514('0x6')](a2_0x1514('0xa')+_0x5697bd[a2_0x1514('0xb')]);if(_0x5697bd['name'][a2_0x1514('0xc')](a2_0x1514('0xd'))){exports['sequelize']['models'][a2_0x1514('0xe')][a2_0x1514('0xf')]({'where':{'fileName':_0x5697bd[a2_0x1514('0xb')]}})['spread']((_0x230988,_0x159f09)=>{if(_0x159f09){console[a2_0x1514('0x6')](_0x5697bd[a2_0x1514('0xb')]);_0x400dfb[a2_0x1514('0x10')](_0x230988);}});}}}_0x455a12[a2_0x1514('0xd')]({'data':_0x400dfb});});});_0x2343bf['on'](a2_0x1514('0x11'),function(_0x29ffe8){_0x455a12[a2_0x1514('0xd')]({'message':_0x29ffe8});});_0x2343bf['connect']({'host':a2_0x1514('0x12'),'port':0x15,'user':a2_0x1514('0x13'),'password':a2_0x1514('0x13')});};exports[a2_0x1514('0x14')]=(_0x4da96f,_0x174929)=>{exports[a2_0x1514('0x1')]['models'][a2_0x1514('0xe')][a2_0x1514('0x15')]({'where':{'status':null}})['then'](_0x4435b9=>{if(_0x4435b9){const _0x36a6af=new ftp_1['default']();_0x36a6af['on']('ready',function(){console[a2_0x1514('0x6')]('connected:'+_0x4435b9['fileName']);_0x36a6af[a2_0x1514('0x16')]('colombia/'+_0x4435b9[a2_0x1514('0x17')],function(_0x7f46d4,_0xb47c8e){_0x36a6af[a2_0x1514('0x18')]();if(_0x7f46d4){}else{const _0xdc11cc=a2_0x1514('0x19')+_0x4435b9[a2_0x1514('0x17')]+a2_0x1514('0x1a');_0xb47c8e[a2_0x1514('0x1b')](fs_1[a2_0x1514('0x1c')][a2_0x1514('0x1d')](_0xdc11cc));_0x4435b9[a2_0x1514('0x1e')]=0x1;_0x4435b9[a2_0x1514('0x1f')]();console[a2_0x1514('0x6')](a2_0x1514('0x20')+_0x4435b9[a2_0x1514('0x17')]);}});});_0x36a6af['on'](a2_0x1514('0x11'),function(_0x4ba8db){_0x174929[a2_0x1514('0xd')]({'message':_0x4ba8db});});_0x36a6af[a2_0x1514('0x21')]({'host':a2_0x1514('0x12'),'port':0x15,'user':a2_0x1514('0x13'),'password':a2_0x1514('0x13')});_0x174929[a2_0x1514('0xd')]({'data':_0x4435b9[a2_0x1514('0x17')]});}else{_0x174929[a2_0x1514('0xd')]({'data':[]});}});};exports['processFtp']=(_0x40cb43,_0x421f3e)=>{exports['sequelize'][a2_0x1514('0x22')]['report_files'][a2_0x1514('0x15')]({'where':{'status':0x1}})[a2_0x1514('0x23')](_0x991401=>{if(_0x991401){const _0x202126=a2_0x1514('0x19')+_0x991401[a2_0x1514('0x17')]+'.txt';fs_1[a2_0x1514('0x1c')][a2_0x1514('0x24')](_0x202126,a2_0x1514('0x25'),function(_0x3ee851,_0x3d2e1b){if(_0x3ee851){_0x991401[a2_0x1514('0x1e')]=null;}else{try{const _0x2a4b32=JSON['parse'](_0x3d2e1b);for(const _0x6c7345 of _0x2a4b32[a2_0x1514('0x26')][0x0][a2_0x1514('0x27')]){const _0x7ca145=_0x6c7345['In'];const _0x521e7e=_0x6c7345['Out'];const _0x1c2274=Date[a2_0x1514('0x28')](_0x6c7345[a2_0x1514('0x29')]);if(_0x7ca145>0x0){exports[a2_0x1514('0x1')]['models'][a2_0x1514('0x2a')][a2_0x1514('0x2b')]({'reportFileId':_0x991401['id'],'amount':_0x7ca145,'countingDate':_0x1c2274});}if(_0x521e7e>0x0){exports[a2_0x1514('0x1')][a2_0x1514('0x22')][a2_0x1514('0x2a')]['create']({'reportFileId':_0x991401['id'],'amount':_0x521e7e*-0x1,'countingDate':_0x1c2274});}}_0x991401[a2_0x1514('0x1e')]=0x2;}catch(_0x407785){_0x991401[a2_0x1514('0x1e')]=null;}}_0x991401[a2_0x1514('0x1f')]();});_0x421f3e[a2_0x1514('0xd')]({'data':_0x991401['fileName']});}else{_0x421f3e[a2_0x1514('0xd')]({'data':[]});}});};exports['getPassCounting']=(_0x333315,_0x1e77c7)=>{exports[a2_0x1514('0x1')][a2_0x1514('0x22')][a2_0x1514('0x2a')][a2_0x1514('0x2c')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[['countingDate','ASC']]})[a2_0x1514('0x23')](_0x46c84d=>{_0x1e77c7[a2_0x1514('0xd')]({'data':_0x46c84d});});};exports[a2_0x1514('0x2d')]=(_0xc0aaee,_0x3a8074)=>{const _0x2f5f59=_0xc0aaee[a2_0x1514('0x2e')][a2_0x1514('0x2f')];const _0x2a6145=_0xc0aaee[a2_0x1514('0x2e')][a2_0x1514('0x30')];const _0x26133b=_0xc0aaee[a2_0x1514('0x2e')][a2_0x1514('0x31')];exports['sequelize'][a2_0x1514('0x22')][a2_0x1514('0x2a')]['findAll']({'attributes':[a2_0x1514('0x32'),[exports[a2_0x1514('0x1')]['fn'](a2_0x1514('0x33'),exports['sequelize'][a2_0x1514('0x34')]('amount')),a2_0x1514('0x35')]],'where':{'countingDate':{[exports[a2_0x1514('0x1')]['Op'][a2_0x1514('0x36')]]:_0x2a6145,[exports['sequelize']['Op']['lt']]:_0x26133b},'amount':_0xc0aaee[a2_0x1514('0x37')][a2_0x1514('0x38')]=='in'?{[exports[a2_0x1514('0x1')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x1514('0x1')][a2_0x1514('0x39')](a2_0x1514('0x3a'))],'order':[[a2_0x1514('0x32'),a2_0x1514('0x3b')]]})[a2_0x1514('0x23')](_0x25f054=>{_0x3a8074[a2_0x1514('0xd')]({'data':_0x25f054});});};exports[a2_0x1514('0x3c')]=(_0x5e1e77,_0x52c62b)=>{const _0x2907a3=_0x5e1e77[a2_0x1514('0x2e')][a2_0x1514('0x2f')];const _0x2f014b=_0x5e1e77['query'][a2_0x1514('0x30')];const _0x32549c=_0x5e1e77[a2_0x1514('0x2e')][a2_0x1514('0x31')];exports[a2_0x1514('0x1')]['models']['pass_counting'][a2_0x1514('0x2c')]({'attributes':['countingDate',[exports[a2_0x1514('0x1')]['fn'](a2_0x1514('0x3d'),exports[a2_0x1514('0x1')][a2_0x1514('0x34')](a2_0x1514('0x32')),a2_0x1514('0x3e')),a2_0x1514('0x3f')],[exports[a2_0x1514('0x1')]['fn']('sum',exports[a2_0x1514('0x1')][a2_0x1514('0x34')](a2_0x1514('0x40'))),a2_0x1514('0x35')]],'where':{'countingDate':{[exports[a2_0x1514('0x1')]['Op'][a2_0x1514('0x36')]]:_0x2f014b,[exports[a2_0x1514('0x1')]['Op']['lt']]:_0x32549c},'amount':_0x5e1e77[a2_0x1514('0x37')]['direction']=='in'?{[exports[a2_0x1514('0x1')]['Op']['gt']]:0x0}:{[exports[a2_0x1514('0x1')]['Op']['lt']]:0x0}},'group':[exports[a2_0x1514('0x1')]['fn'](a2_0x1514('0x41'),exports[a2_0x1514('0x1')][a2_0x1514('0x34')](a2_0x1514('0x32'))),exports[a2_0x1514('0x1')]['fn'](a2_0x1514('0x42'),exports[a2_0x1514('0x1')][a2_0x1514('0x34')](a2_0x1514('0x32'))),exports[a2_0x1514('0x1')]['fn'](a2_0x1514('0x43'),exports[a2_0x1514('0x1')][a2_0x1514('0x34')](a2_0x1514('0x32'))),exports[a2_0x1514('0x1')]['fn'](a2_0x1514('0x44'),exports['sequelize'][a2_0x1514('0x34')](a2_0x1514('0x32')))],'order':[[a2_0x1514('0x32'),a2_0x1514('0x3b')]]})['then'](_0x1b38ad=>{_0x52c62b['json']({'data':_0x1b38ad});});};exports[a2_0x1514('0x45')]=(_0x36375f,_0x1f99f9,_0x3009e0)=>{const _0x5434e8=_0x36375f[a2_0x1514('0x46')][a2_0x1514('0x47')][a2_0x1514('0x48')](_0x5434e8=>_0x5434e8[a2_0x1514('0x49')]===a2_0x1514('0x4a'));fbgraph_1['default'][a2_0x1514('0x4b')](_0x5434e8['accessToken']);fbgraph_1[a2_0x1514('0x1c')][a2_0x1514('0x16')](_0x36375f[a2_0x1514('0x46')][a2_0x1514('0x4a')]+a2_0x1514('0x4c'),(_0x358424,_0x2a331d)=>{if(_0x358424){return _0x3009e0(_0x358424);}_0x1f99f9[a2_0x1514('0x4')](a2_0x1514('0x4d'),{'title':'Facebook\x20API','profile':_0x2a331d});});};
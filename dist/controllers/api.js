var a2_0x1a30=['getPassCountingByHour','startDate','col','countingDateShort','gte','HOUR','DAY','YEAR','getFacebook','user','tokens','find','kind','facebook','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','__esModule','defineProperty','fbgraph','ftp','sequelize','setSequelize','getApi','render','api/index','API\x20Examples','connecting','default','log','connected','list','colombia','Downloading:\x20','name','endsWith','json','models','report_files','spread','push','connect','ipd','downloadFtp','then','ready','fileName','get','colombia/','end','media/','.txt','pipe','createWriteStream','save','error','ftp.vivotek.com','status','parse','Data','CountingInfo','EndTime','pass_counting','create','getPassCounting','findAll','countingDate','month','query','endDate','sum','amount','total','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))'];(function(_0x42effd,_0x3e71b9){var _0x38d80c=function(_0x294634){while(--_0x294634){_0x42effd['push'](_0x42effd['shift']());}};_0x38d80c(++_0x3e71b9);}(a2_0x1a30,0xff));var a2_0x3f9e=function(_0x2bddb8,_0x55eeb1){_0x2bddb8=_0x2bddb8-0x0;var _0x5e7ee7=a2_0x1a30[_0x2bddb8];return _0x5e7ee7;};'use strict';var __importDefault=this&&this[a2_0x3f9e('0x0')]||function(_0x2c6a5c){return _0x2c6a5c&&_0x2c6a5c[a2_0x3f9e('0x1')]?_0x2c6a5c:{'default':_0x2c6a5c};};Object[a2_0x3f9e('0x2')](exports,a2_0x3f9e('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x3f9e('0x3')));const ftp_1=__importDefault(require(a2_0x3f9e('0x4')));const fs_1=__importDefault(require('fs'));exports[a2_0x3f9e('0x5')]='';function setSequelize(_0x4eeaf0){exports[a2_0x3f9e('0x5')]=_0x4eeaf0;}exports[a2_0x3f9e('0x6')]=setSequelize;exports[a2_0x3f9e('0x7')]=(_0x5e9dbc,_0x28a7e4)=>{_0x28a7e4[a2_0x3f9e('0x8')](a2_0x3f9e('0x9'),{'title':a2_0x3f9e('0xa')});};exports['syncFtp']=(_0x4b7a00,_0xee0578)=>{console['log'](a2_0x3f9e('0xb'));const _0x59fba5=[];const _0x4a0d3f=new ftp_1[(a2_0x3f9e('0xc'))]();_0x4a0d3f['on']('ready',function(){console[a2_0x3f9e('0xd')](a2_0x3f9e('0xe'));_0x4a0d3f[a2_0x3f9e('0xf')](a2_0x3f9e('0x10'),![],function(_0x5cbe4f,_0x31cc99){if(_0x5cbe4f){}else{for(const _0x46819e of _0x31cc99){console[a2_0x3f9e('0xd')](a2_0x3f9e('0x11')+_0x46819e[a2_0x3f9e('0x12')]);if(_0x46819e[a2_0x3f9e('0x12')][a2_0x3f9e('0x13')](a2_0x3f9e('0x14'))){exports[a2_0x3f9e('0x5')][a2_0x3f9e('0x15')][a2_0x3f9e('0x16')]['findOrCreate']({'where':{'fileName':_0x46819e[a2_0x3f9e('0x12')]}})[a2_0x3f9e('0x17')]((_0x230c94,_0x36bf00)=>{if(_0x36bf00){console['log'](_0x46819e[a2_0x3f9e('0x12')]);_0x59fba5[a2_0x3f9e('0x18')](_0x230c94);}});}}}_0xee0578['json']({'data':_0x59fba5});});});_0x4a0d3f['on']('error',function(_0x559312){_0xee0578[a2_0x3f9e('0x14')]({'message':_0x559312});});_0x4a0d3f[a2_0x3f9e('0x19')]({'host':'ftp.vivotek.com','port':0x15,'user':a2_0x3f9e('0x1a'),'password':'ipd'});};exports[a2_0x3f9e('0x1b')]=(_0x5a0c1c,_0x13d595)=>{exports[a2_0x3f9e('0x5')][a2_0x3f9e('0x15')][a2_0x3f9e('0x16')]['findOne']({'where':{'status':null}})[a2_0x3f9e('0x1c')](_0x14c036=>{if(_0x14c036){const _0xce9fd1=new ftp_1['default']();_0xce9fd1['on'](a2_0x3f9e('0x1d'),function(){console[a2_0x3f9e('0xd')]('connected:'+_0x14c036[a2_0x3f9e('0x1e')]);_0xce9fd1[a2_0x3f9e('0x1f')](a2_0x3f9e('0x20')+_0x14c036['fileName'],function(_0xf4ce95,_0x23c1cd){_0xce9fd1[a2_0x3f9e('0x21')]();if(_0xf4ce95){}else{const _0xb04eb6=a2_0x3f9e('0x22')+_0x14c036[a2_0x3f9e('0x1e')]+a2_0x3f9e('0x23');_0x23c1cd[a2_0x3f9e('0x24')](fs_1[a2_0x3f9e('0xc')][a2_0x3f9e('0x25')](_0xb04eb6));_0x14c036['status']=0x1;_0x14c036[a2_0x3f9e('0x26')]();console['log']('Downloaded:\x20'+_0x14c036[a2_0x3f9e('0x1e')]);}});});_0xce9fd1['on'](a2_0x3f9e('0x27'),function(_0x7c3948){_0x13d595[a2_0x3f9e('0x14')]({'message':_0x7c3948});});_0xce9fd1['connect']({'host':a2_0x3f9e('0x28'),'port':0x15,'user':'ipd','password':a2_0x3f9e('0x1a')});_0x13d595['json']({'data':_0x14c036[a2_0x3f9e('0x1e')]});}else{_0x13d595[a2_0x3f9e('0x14')]({'data':[]});}});};exports['processFtp']=(_0x434550,_0x3fa552)=>{exports[a2_0x3f9e('0x5')]['models'][a2_0x3f9e('0x16')]['findOne']({'where':{'status':0x1}})['then'](_0x1de080=>{if(_0x1de080){const _0x4bb214=a2_0x3f9e('0x22')+_0x1de080[a2_0x3f9e('0x1e')]+'.txt';fs_1[a2_0x3f9e('0xc')]['readFile'](_0x4bb214,'utf8',function(_0x2ab43e,_0x165170){if(_0x2ab43e){_0x1de080[a2_0x3f9e('0x29')]=null;}else{try{const _0x245289=JSON[a2_0x3f9e('0x2a')](_0x165170);for(const _0x54cf9f of _0x245289[a2_0x3f9e('0x2b')][0x0][a2_0x3f9e('0x2c')]){const _0x454a2f=_0x54cf9f['In'];const _0x1f66c3=_0x54cf9f['Out'];const _0x437624=Date[a2_0x3f9e('0x2a')](_0x54cf9f[a2_0x3f9e('0x2d')]);if(_0x454a2f>0x0){exports['sequelize'][a2_0x3f9e('0x15')][a2_0x3f9e('0x2e')][a2_0x3f9e('0x2f')]({'reportFileId':_0x1de080['id'],'amount':_0x454a2f,'countingDate':_0x437624});}if(_0x1f66c3>0x0){exports[a2_0x3f9e('0x5')]['models'][a2_0x3f9e('0x2e')][a2_0x3f9e('0x2f')]({'reportFileId':_0x1de080['id'],'amount':_0x1f66c3*-0x1,'countingDate':_0x437624});}}_0x1de080['status']=0x2;}catch(_0x1e01c7){_0x1de080[a2_0x3f9e('0x29')]=null;}}_0x1de080['save']();});_0x3fa552['json']({'data':_0x1de080[a2_0x3f9e('0x1e')]});}else{_0x3fa552[a2_0x3f9e('0x14')]({'data':[]});}});};exports[a2_0x3f9e('0x30')]=(_0x5286a0,_0x564793)=>{exports['sequelize'][a2_0x3f9e('0x15')][a2_0x3f9e('0x2e')][a2_0x3f9e('0x31')]({'where':{'amount':{[exports[a2_0x3f9e('0x5')]['Op']['gt']]:0x0}},'order':[[a2_0x3f9e('0x32'),'ASC']]})[a2_0x3f9e('0x1c')](_0x36f2a5=>{_0x564793['json']({'data':_0x36f2a5});});};exports['getPassCountingByDay']=(_0xff98f6,_0x18b77f)=>{const _0x2d1808=_0xff98f6['query'][a2_0x3f9e('0x33')];const _0x1f60fd=_0xff98f6[a2_0x3f9e('0x34')]['startDate'];const _0x441a05=_0xff98f6[a2_0x3f9e('0x34')][a2_0x3f9e('0x35')];exports['sequelize']['models']['pass_counting'][a2_0x3f9e('0x31')]({'attributes':['countingDate',[exports['sequelize']['fn'](a2_0x3f9e('0x36'),exports[a2_0x3f9e('0x5')]['col'](a2_0x3f9e('0x37'))),a2_0x3f9e('0x38')]],'where':{'countingDate':{[exports[a2_0x3f9e('0x5')]['Op']['gte']]:_0x1f60fd,[exports[a2_0x3f9e('0x5')]['Op']['lt']]:_0x441a05},'amount':_0xff98f6[a2_0x3f9e('0x39')][a2_0x3f9e('0x3a')]=='in'?{[exports[a2_0x3f9e('0x5')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports['sequelize'][a2_0x3f9e('0x3b')](a2_0x3f9e('0x3c'))],'order':[[a2_0x3f9e('0x32'),'ASC']]})[a2_0x3f9e('0x1c')](_0x1703f5=>{_0x18b77f[a2_0x3f9e('0x14')]({'data':_0x1703f5});});};exports[a2_0x3f9e('0x3d')]=(_0x3069f0,_0x557133)=>{const _0x24d0c7=_0x3069f0['query'][a2_0x3f9e('0x33')];const _0x212c81=_0x3069f0[a2_0x3f9e('0x34')][a2_0x3f9e('0x3e')];const _0x56caac=_0x3069f0[a2_0x3f9e('0x34')][a2_0x3f9e('0x35')];exports[a2_0x3f9e('0x5')][a2_0x3f9e('0x15')]['pass_counting'][a2_0x3f9e('0x31')]({'attributes':['countingDate',[exports[a2_0x3f9e('0x5')]['fn']('DATE_FORMAT',exports[a2_0x3f9e('0x5')][a2_0x3f9e('0x3f')](a2_0x3f9e('0x32')),'%Y-%m-%d\x20%H:00'),a2_0x3f9e('0x40')],[exports['sequelize']['fn'](a2_0x3f9e('0x36'),exports[a2_0x3f9e('0x5')][a2_0x3f9e('0x3f')](a2_0x3f9e('0x37'))),a2_0x3f9e('0x38')]],'where':{'countingDate':{[exports[a2_0x3f9e('0x5')]['Op'][a2_0x3f9e('0x41')]]:_0x212c81,[exports[a2_0x3f9e('0x5')]['Op']['lt']]:_0x56caac},'amount':_0x3069f0[a2_0x3f9e('0x39')][a2_0x3f9e('0x3a')]=='in'?{[exports[a2_0x3f9e('0x5')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x3f9e('0x5')]['fn'](a2_0x3f9e('0x42'),exports[a2_0x3f9e('0x5')]['col'](a2_0x3f9e('0x32'))),exports[a2_0x3f9e('0x5')]['fn'](a2_0x3f9e('0x43'),exports['sequelize'][a2_0x3f9e('0x3f')]('countingDate')),exports['sequelize']['fn']('MONTH',exports[a2_0x3f9e('0x5')][a2_0x3f9e('0x3f')]('countingDate')),exports[a2_0x3f9e('0x5')]['fn'](a2_0x3f9e('0x44'),exports['sequelize']['col'](a2_0x3f9e('0x32')))],'order':[[a2_0x3f9e('0x32'),'ASC']]})[a2_0x3f9e('0x1c')](_0x205233=>{_0x557133[a2_0x3f9e('0x14')]({'data':_0x205233});});};exports[a2_0x3f9e('0x45')]=(_0x16e7c0,_0x272019,_0x61af69)=>{const _0x56b485=_0x16e7c0[a2_0x3f9e('0x46')][a2_0x3f9e('0x47')][a2_0x3f9e('0x48')](_0x56b485=>_0x56b485[a2_0x3f9e('0x49')]===a2_0x3f9e('0x4a'));fbgraph_1[a2_0x3f9e('0xc')]['setAccessToken'](_0x56b485[a2_0x3f9e('0x4b')]);fbgraph_1['default']['get'](_0x16e7c0[a2_0x3f9e('0x46')][a2_0x3f9e('0x4a')]+a2_0x3f9e('0x4c'),(_0x59a8b4,_0x11d461)=>{if(_0x59a8b4){return _0x61af69(_0x59a8b4);}_0x272019[a2_0x3f9e('0x8')](a2_0x3f9e('0x4d'),{'title':a2_0x3f9e('0x4e'),'profile':_0x11d461});});};
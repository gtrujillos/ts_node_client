var a2_0x264c=['Out','EndTime','create','save','getPassCounting','findAll','countingDate','getPassCountingByDay','query','month','startDate','pass_counting','col','amount','total','gte','params','direction','literal','ASC','getPassCountingByHour','endDate','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','sum','HOUR','DAY','MONTH','YEAR','getFacebook','tokens','find','kind','facebook','setAccessToken','user','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__esModule','defineProperty','ftp','sequelize','setSequelize','getApi','render','api/index','API\x20Examples','syncFtp','log','connecting','default','connected','list','colombia','Downloading:\x20','name','endsWith','json','report_files','findOrCreate','spread','push','error','connect','ftp.vivotek.com','ipd','downloadFtp','models','findOne','then','connected:','fileName','get','colombia/','end','media/','.txt','pipe','createWriteStream','status','Downloaded:\x20','processFtp','readFile','utf8','parse','Data','CountingInfo'];(function(_0x323c07,_0x5b638e){var _0x25ddd1=function(_0xcb9399){while(--_0xcb9399){_0x323c07['push'](_0x323c07['shift']());}};_0x25ddd1(++_0x5b638e);}(a2_0x264c,0xda));var a2_0x1c9d=function(_0x2ec4bc,_0x253d6e){_0x2ec4bc=_0x2ec4bc-0x0;var _0x13d076=a2_0x264c[_0x2ec4bc];return _0x13d076;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x4c9c7d){return _0x4c9c7d&&_0x4c9c7d[a2_0x1c9d('0x0')]?_0x4c9c7d:{'default':_0x4c9c7d};};Object[a2_0x1c9d('0x1')](exports,a2_0x1c9d('0x0'),{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require(a2_0x1c9d('0x2')));const fs_1=__importDefault(require('fs'));exports[a2_0x1c9d('0x3')]='';function setSequelize(_0x5985d7){exports[a2_0x1c9d('0x3')]=_0x5985d7;}exports[a2_0x1c9d('0x4')]=setSequelize;exports[a2_0x1c9d('0x5')]=(_0x56ea69,_0x593372)=>{_0x593372[a2_0x1c9d('0x6')](a2_0x1c9d('0x7'),{'title':a2_0x1c9d('0x8')});};exports[a2_0x1c9d('0x9')]=(_0x18e3c4,_0x236ccd)=>{console[a2_0x1c9d('0xa')](a2_0x1c9d('0xb'));const _0x3ccbc6=[];const _0x4bc729=new ftp_1[(a2_0x1c9d('0xc'))]();_0x4bc729['on']('ready',function(){console[a2_0x1c9d('0xa')](a2_0x1c9d('0xd'));_0x4bc729[a2_0x1c9d('0xe')](a2_0x1c9d('0xf'),![],function(_0xdfe9c1,_0x1fd8c8){if(_0xdfe9c1){}else{for(const _0x58a32f of _0x1fd8c8){console[a2_0x1c9d('0xa')](a2_0x1c9d('0x10')+_0x58a32f['name']);if(_0x58a32f[a2_0x1c9d('0x11')][a2_0x1c9d('0x12')](a2_0x1c9d('0x13'))){exports[a2_0x1c9d('0x3')]['models'][a2_0x1c9d('0x14')][a2_0x1c9d('0x15')]({'where':{'fileName':_0x58a32f[a2_0x1c9d('0x11')]}})[a2_0x1c9d('0x16')]((_0x2f864e,_0x174427)=>{if(_0x174427){console['log'](_0x58a32f[a2_0x1c9d('0x11')]);_0x3ccbc6[a2_0x1c9d('0x17')](_0x2f864e);}});}}}_0x236ccd[a2_0x1c9d('0x13')]({'data':_0x3ccbc6});});});_0x4bc729['on'](a2_0x1c9d('0x18'),function(_0x46d2c2){_0x236ccd[a2_0x1c9d('0x13')]({'message':_0x46d2c2});});_0x4bc729[a2_0x1c9d('0x19')]({'host':a2_0x1c9d('0x1a'),'port':0x15,'user':a2_0x1c9d('0x1b'),'password':'ipd'});};exports[a2_0x1c9d('0x1c')]=(_0x38008f,_0x34651b)=>{exports[a2_0x1c9d('0x3')][a2_0x1c9d('0x1d')][a2_0x1c9d('0x14')][a2_0x1c9d('0x1e')]({'where':{'status':null}})[a2_0x1c9d('0x1f')](_0x360056=>{if(_0x360056){const _0x3a0967=new ftp_1[(a2_0x1c9d('0xc'))]();_0x3a0967['on']('ready',function(){console[a2_0x1c9d('0xa')](a2_0x1c9d('0x20')+_0x360056[a2_0x1c9d('0x21')]);_0x3a0967[a2_0x1c9d('0x22')](a2_0x1c9d('0x23')+_0x360056[a2_0x1c9d('0x21')],function(_0x48a959,_0x8a631f){_0x3a0967[a2_0x1c9d('0x24')]();if(_0x48a959){}else{const _0x46611a=a2_0x1c9d('0x25')+_0x360056[a2_0x1c9d('0x21')]+a2_0x1c9d('0x26');_0x8a631f[a2_0x1c9d('0x27')](fs_1[a2_0x1c9d('0xc')][a2_0x1c9d('0x28')](_0x46611a));_0x360056[a2_0x1c9d('0x29')]=0x1;_0x360056['save']();console['log'](a2_0x1c9d('0x2a')+_0x360056[a2_0x1c9d('0x21')]);}});});_0x3a0967['on'](a2_0x1c9d('0x18'),function(_0x3bc985){_0x34651b[a2_0x1c9d('0x13')]({'message':_0x3bc985});});_0x3a0967[a2_0x1c9d('0x19')]({'host':'ftp.vivotek.com','port':0x15,'user':'ipd','password':a2_0x1c9d('0x1b')});_0x34651b[a2_0x1c9d('0x13')]({'data':_0x360056['fileName']});}else{_0x34651b[a2_0x1c9d('0x13')]({'data':[]});}});};exports[a2_0x1c9d('0x2b')]=(_0x36654c,_0x215949)=>{exports[a2_0x1c9d('0x3')][a2_0x1c9d('0x1d')][a2_0x1c9d('0x14')]['findOne']({'where':{'status':0x1}})[a2_0x1c9d('0x1f')](_0x59029c=>{if(_0x59029c){const _0x4746c2='media/'+_0x59029c[a2_0x1c9d('0x21')]+a2_0x1c9d('0x26');fs_1[a2_0x1c9d('0xc')][a2_0x1c9d('0x2c')](_0x4746c2,a2_0x1c9d('0x2d'),function(_0x4d5331,_0x1f7483){if(_0x4d5331){_0x59029c['status']=null;}else{try{const _0x121301=JSON[a2_0x1c9d('0x2e')](_0x1f7483);for(const _0x33fd38 of _0x121301[a2_0x1c9d('0x2f')][0x0][a2_0x1c9d('0x30')]){const _0x58b1a3=_0x33fd38['In'];const _0xf66ab2=_0x33fd38[a2_0x1c9d('0x31')];const _0x422ba8=Date[a2_0x1c9d('0x2e')](_0x33fd38[a2_0x1c9d('0x32')]);if(_0x58b1a3>0x0){exports[a2_0x1c9d('0x3')]['models']['pass_counting'][a2_0x1c9d('0x33')]({'reportFileId':_0x59029c['id'],'amount':_0x58b1a3,'countingDate':_0x422ba8});}if(_0xf66ab2>0x0){exports[a2_0x1c9d('0x3')][a2_0x1c9d('0x1d')]['pass_counting'][a2_0x1c9d('0x33')]({'reportFileId':_0x59029c['id'],'amount':_0xf66ab2*-0x1,'countingDate':_0x422ba8});}}_0x59029c[a2_0x1c9d('0x29')]=0x2;}catch(_0x264aed){_0x59029c[a2_0x1c9d('0x29')]=null;}}_0x59029c[a2_0x1c9d('0x34')]();});_0x215949[a2_0x1c9d('0x13')]({'data':_0x59029c[a2_0x1c9d('0x21')]});}else{_0x215949[a2_0x1c9d('0x13')]({'data':[]});}});};exports[a2_0x1c9d('0x35')]=(_0x3cc595,_0x4445d0)=>{exports[a2_0x1c9d('0x3')][a2_0x1c9d('0x1d')]['pass_counting'][a2_0x1c9d('0x36')]({'where':{'amount':{[exports[a2_0x1c9d('0x3')]['Op']['gt']]:0x0}},'order':[[a2_0x1c9d('0x37'),'ASC']]})['then'](_0x257f67=>{_0x4445d0[a2_0x1c9d('0x13')]({'data':_0x257f67});});};exports[a2_0x1c9d('0x38')]=(_0x1f2b4b,_0x4b6892)=>{const _0x315ae0=_0x1f2b4b[a2_0x1c9d('0x39')][a2_0x1c9d('0x3a')];const _0x49fa73=_0x1f2b4b[a2_0x1c9d('0x39')][a2_0x1c9d('0x3b')];const _0x194525=_0x1f2b4b[a2_0x1c9d('0x39')]['endDate'];exports[a2_0x1c9d('0x3')][a2_0x1c9d('0x1d')][a2_0x1c9d('0x3c')][a2_0x1c9d('0x36')]({'attributes':[a2_0x1c9d('0x37'),[exports[a2_0x1c9d('0x3')]['fn']('sum',exports[a2_0x1c9d('0x3')][a2_0x1c9d('0x3d')](a2_0x1c9d('0x3e'))),a2_0x1c9d('0x3f')]],'where':{'countingDate':{[exports[a2_0x1c9d('0x3')]['Op'][a2_0x1c9d('0x40')]]:_0x49fa73,[exports[a2_0x1c9d('0x3')]['Op']['lt']]:_0x194525},'amount':_0x1f2b4b[a2_0x1c9d('0x41')][a2_0x1c9d('0x42')]=='in'?{[exports[a2_0x1c9d('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0x1c9d('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x1c9d('0x3')][a2_0x1c9d('0x43')]('YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))')],'order':[[a2_0x1c9d('0x37'),a2_0x1c9d('0x44')]]})['then'](_0x3c759f=>{_0x4b6892['json']({'data':_0x3c759f});});};exports[a2_0x1c9d('0x45')]=(_0x52ebc0,_0x14c333)=>{const _0xc7580c=_0x52ebc0['query'][a2_0x1c9d('0x3a')];const _0x288875=_0x52ebc0[a2_0x1c9d('0x39')][a2_0x1c9d('0x3b')];const _0x516dac=_0x52ebc0[a2_0x1c9d('0x39')][a2_0x1c9d('0x46')];exports[a2_0x1c9d('0x3')]['models']['pass_counting'][a2_0x1c9d('0x36')]({'attributes':[a2_0x1c9d('0x37'),[exports[a2_0x1c9d('0x3')]['fn'](a2_0x1c9d('0x47'),exports[a2_0x1c9d('0x3')]['col']('countingDate'),a2_0x1c9d('0x48')),a2_0x1c9d('0x49')],[exports[a2_0x1c9d('0x3')]['fn'](a2_0x1c9d('0x4a'),exports['sequelize'][a2_0x1c9d('0x3d')](a2_0x1c9d('0x3e'))),'total']],'where':{'countingDate':{[exports[a2_0x1c9d('0x3')]['Op'][a2_0x1c9d('0x40')]]:_0x288875,[exports[a2_0x1c9d('0x3')]['Op']['lt']]:_0x516dac},'amount':_0x52ebc0[a2_0x1c9d('0x41')][a2_0x1c9d('0x42')]=='in'?{[exports[a2_0x1c9d('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0x1c9d('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x1c9d('0x3')]['fn'](a2_0x1c9d('0x4b'),exports['sequelize']['col'](a2_0x1c9d('0x37'))),exports[a2_0x1c9d('0x3')]['fn'](a2_0x1c9d('0x4c'),exports[a2_0x1c9d('0x3')]['col'](a2_0x1c9d('0x37'))),exports[a2_0x1c9d('0x3')]['fn'](a2_0x1c9d('0x4d'),exports[a2_0x1c9d('0x3')][a2_0x1c9d('0x3d')]('countingDate')),exports[a2_0x1c9d('0x3')]['fn'](a2_0x1c9d('0x4e'),exports[a2_0x1c9d('0x3')]['col'](a2_0x1c9d('0x37')))],'order':[['countingDate',a2_0x1c9d('0x44')]]})['then'](_0x30a1cd=>{_0x14c333['json']({'data':_0x30a1cd});});};exports[a2_0x1c9d('0x4f')]=(_0x5c5f60,_0x58919,_0x12e0f1)=>{const _0x2db9ce=_0x5c5f60['user'][a2_0x1c9d('0x50')][a2_0x1c9d('0x51')](_0x2db9ce=>_0x2db9ce[a2_0x1c9d('0x52')]===a2_0x1c9d('0x53'));fbgraph_1[a2_0x1c9d('0xc')][a2_0x1c9d('0x54')](_0x2db9ce['accessToken']);fbgraph_1['default'][a2_0x1c9d('0x22')](_0x5c5f60[a2_0x1c9d('0x55')][a2_0x1c9d('0x53')]+a2_0x1c9d('0x56'),(_0x44e65f,_0x31e82d)=>{if(_0x44e65f){return _0x12e0f1(_0x44e65f);}_0x58919[a2_0x1c9d('0x6')](a2_0x1c9d('0x57'),{'title':a2_0x1c9d('0x58'),'profile':_0x31e82d});});};
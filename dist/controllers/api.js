var a2_0x572e=['getPassCountingByHour','%Y-%m-%d\x20%H:00','countingDateShort','sum','amount','HOUR','DAY','getFacebook','user','tokens','find','kind','facebook','setAccessToken','get','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook','Facebook\x20API','__importDefault','__esModule','fbgraph','sequelize','setSequelize','getApi','API\x20Examples','log','connecting','default','connected','list','colombia','Downloading:\x20','name','endsWith','json','models','report_files','findOrCreate','spread','push','error','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','then','ready','connected:','fileName','media/','.txt','status','save','Downloaded:\x20','processFtp','readFile','utf8','parse','Data','CountingInfo','Out','EndTime','pass_counting','getPassCounting','findAll','countingDate','getPassCountingByDay','query','month','startDate','endDate','col','total','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC'];(function(_0x13accf,_0x3fb2f3){var _0x4d84ea=function(_0x5a0135){while(--_0x5a0135){_0x13accf['push'](_0x13accf['shift']());}};_0x4d84ea(++_0x3fb2f3);}(a2_0x572e,0x1a8));var a2_0xf05a=function(_0x162860,_0x1f0c98){_0x162860=_0x162860-0x0;var _0x30526c=a2_0x572e[_0x162860];return _0x30526c;};'use strict';var __importDefault=this&&this[a2_0xf05a('0x0')]||function(_0x203859){return _0x203859&&_0x203859[a2_0xf05a('0x1')]?_0x203859:{'default':_0x203859};};Object['defineProperty'](exports,a2_0xf05a('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0xf05a('0x2')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));exports['sequelize']='';function setSequelize(_0x55e3a5){exports[a2_0xf05a('0x3')]=_0x55e3a5;}exports[a2_0xf05a('0x4')]=setSequelize;exports[a2_0xf05a('0x5')]=(_0xe9167c,_0x2995da)=>{_0x2995da['render']('api/index',{'title':a2_0xf05a('0x6')});};exports['syncFtp']=(_0xd0a045,_0x506b55)=>{console[a2_0xf05a('0x7')](a2_0xf05a('0x8'));const _0x2cfdeb=[];const _0x2380f8=new ftp_1[(a2_0xf05a('0x9'))]();_0x2380f8['on']('ready',function(){console[a2_0xf05a('0x7')](a2_0xf05a('0xa'));_0x2380f8[a2_0xf05a('0xb')](a2_0xf05a('0xc'),![],function(_0x12a7df,_0x2a1bd7){if(_0x12a7df){}else{for(const _0x501a82 of _0x2a1bd7){console[a2_0xf05a('0x7')](a2_0xf05a('0xd')+_0x501a82[a2_0xf05a('0xe')]);if(_0x501a82[a2_0xf05a('0xe')][a2_0xf05a('0xf')](a2_0xf05a('0x10'))){exports[a2_0xf05a('0x3')][a2_0xf05a('0x11')][a2_0xf05a('0x12')][a2_0xf05a('0x13')]({'where':{'fileName':_0x501a82['name']}})[a2_0xf05a('0x14')]((_0x420043,_0x2fce86)=>{if(_0x2fce86){console[a2_0xf05a('0x7')](_0x501a82['name']);_0x2cfdeb[a2_0xf05a('0x15')](_0x420043);}});}}}_0x506b55['json']({'data':_0x2cfdeb});});});_0x2380f8['on'](a2_0xf05a('0x16'),function(_0x19e922){_0x506b55[a2_0xf05a('0x10')]({'message':_0x19e922});});_0x2380f8[a2_0xf05a('0x17')]({'host':a2_0xf05a('0x18'),'port':0x15,'user':a2_0xf05a('0x19'),'password':a2_0xf05a('0x19')});};exports[a2_0xf05a('0x1a')]=(_0x524a98,_0x47788e)=>{exports['sequelize'][a2_0xf05a('0x11')][a2_0xf05a('0x12')][a2_0xf05a('0x1b')]({'where':{'status':null}})[a2_0xf05a('0x1c')](_0x1f7481=>{if(_0x1f7481){const _0x181507=new ftp_1[(a2_0xf05a('0x9'))]();_0x181507['on'](a2_0xf05a('0x1d'),function(){console[a2_0xf05a('0x7')](a2_0xf05a('0x1e')+_0x1f7481[a2_0xf05a('0x1f')]);_0x181507['get']('colombia/'+_0x1f7481[a2_0xf05a('0x1f')],function(_0x586190,_0x2fc87c){_0x181507['end']();if(_0x586190){}else{const _0x58513d=a2_0xf05a('0x20')+_0x1f7481[a2_0xf05a('0x1f')]+a2_0xf05a('0x21');_0x2fc87c['pipe'](fs_1[a2_0xf05a('0x9')]['createWriteStream'](_0x58513d));_0x1f7481[a2_0xf05a('0x22')]=0x1;_0x1f7481[a2_0xf05a('0x23')]();console[a2_0xf05a('0x7')](a2_0xf05a('0x24')+_0x1f7481[a2_0xf05a('0x1f')]);}});});_0x181507['on'](a2_0xf05a('0x16'),function(_0x263236){_0x47788e[a2_0xf05a('0x10')]({'message':_0x263236});});_0x181507['connect']({'host':'ftp.vivotek.com','port':0x15,'user':'ipd','password':'ipd'});_0x47788e[a2_0xf05a('0x10')]({'data':_0x1f7481['fileName']});}else{_0x47788e['json']({'data':[]});}});};exports[a2_0xf05a('0x25')]=(_0x1d5448,_0x362d6a)=>{exports[a2_0xf05a('0x3')]['models'][a2_0xf05a('0x12')][a2_0xf05a('0x1b')]({'where':{'status':0x1}})[a2_0xf05a('0x1c')](_0x5772f8=>{if(_0x5772f8){const _0x34239b=a2_0xf05a('0x20')+_0x5772f8[a2_0xf05a('0x1f')]+a2_0xf05a('0x21');fs_1[a2_0xf05a('0x9')][a2_0xf05a('0x26')](_0x34239b,a2_0xf05a('0x27'),function(_0x33f5d3,_0x5f0145){if(_0x33f5d3){_0x5772f8[a2_0xf05a('0x22')]=null;}else{try{const _0x574c06=JSON[a2_0xf05a('0x28')](_0x5f0145);for(const _0xc8caf6 of _0x574c06[a2_0xf05a('0x29')][0x0][a2_0xf05a('0x2a')]){const _0x80e408=_0xc8caf6['In'];const _0x53a46b=_0xc8caf6[a2_0xf05a('0x2b')];const _0x2884f1=Date[a2_0xf05a('0x28')](_0xc8caf6[a2_0xf05a('0x2c')]);if(_0x80e408>0x0){exports['sequelize'][a2_0xf05a('0x11')][a2_0xf05a('0x2d')]['create']({'reportFileId':_0x5772f8['id'],'amount':_0x80e408,'countingDate':_0x2884f1});}if(_0x53a46b>0x0){exports['sequelize'][a2_0xf05a('0x11')]['pass_counting']['create']({'reportFileId':_0x5772f8['id'],'amount':_0x53a46b*-0x1,'countingDate':_0x2884f1});}}_0x5772f8[a2_0xf05a('0x22')]=0x2;}catch(_0x3fd128){_0x5772f8['status']=null;}}_0x5772f8[a2_0xf05a('0x23')]();});_0x362d6a[a2_0xf05a('0x10')]({'data':_0x5772f8[a2_0xf05a('0x1f')]});}else{_0x362d6a[a2_0xf05a('0x10')]({'data':[]});}});};exports[a2_0xf05a('0x2e')]=(_0x4dcacb,_0x5c7b56)=>{exports[a2_0xf05a('0x3')][a2_0xf05a('0x11')][a2_0xf05a('0x2d')][a2_0xf05a('0x2f')]({'where':{'amount':{[exports[a2_0xf05a('0x3')]['Op']['gt']]:0x0}},'order':[[a2_0xf05a('0x30'),'ASC']]})[a2_0xf05a('0x1c')](_0x276156=>{_0x5c7b56['json']({'data':_0x276156});});};exports[a2_0xf05a('0x31')]=(_0x5b62b7,_0x4ed1e1)=>{const _0x283465=_0x5b62b7[a2_0xf05a('0x32')][a2_0xf05a('0x33')];const _0x4ae850=_0x5b62b7[a2_0xf05a('0x32')][a2_0xf05a('0x34')];const _0x2b04ff=_0x5b62b7[a2_0xf05a('0x32')][a2_0xf05a('0x35')];exports[a2_0xf05a('0x3')][a2_0xf05a('0x11')]['pass_counting'][a2_0xf05a('0x2f')]({'attributes':[a2_0xf05a('0x30'),[exports[a2_0xf05a('0x3')]['fn']('sum',exports['sequelize'][a2_0xf05a('0x36')]('amount')),a2_0xf05a('0x37')]],'where':{'countingDate':{[exports[a2_0xf05a('0x3')]['Op'][a2_0xf05a('0x38')]]:_0x4ae850,[exports['sequelize']['Op']['lt']]:_0x2b04ff},'amount':_0x5b62b7[a2_0xf05a('0x39')][a2_0xf05a('0x3a')]=='in'?{[exports[a2_0xf05a('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0xf05a('0x3')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a2_0xf05a('0x3b')](a2_0xf05a('0x3c'))],'order':[[a2_0xf05a('0x30'),a2_0xf05a('0x3d')]]})[a2_0xf05a('0x1c')](_0x38cfe4=>{_0x4ed1e1['json']({'data':_0x38cfe4});});};exports[a2_0xf05a('0x3e')]=(_0x218729,_0x347a0b)=>{const _0x793502=_0x218729[a2_0xf05a('0x32')][a2_0xf05a('0x33')];const _0x24da6a=_0x218729[a2_0xf05a('0x32')][a2_0xf05a('0x34')];const _0x4656c1=_0x218729[a2_0xf05a('0x32')][a2_0xf05a('0x35')];exports[a2_0xf05a('0x3')][a2_0xf05a('0x11')][a2_0xf05a('0x2d')][a2_0xf05a('0x2f')]({'attributes':[a2_0xf05a('0x30'),[exports[a2_0xf05a('0x3')]['fn']('DATE_FORMAT',exports[a2_0xf05a('0x3')]['col']('countingDate'),a2_0xf05a('0x3f')),a2_0xf05a('0x40')],[exports[a2_0xf05a('0x3')]['fn'](a2_0xf05a('0x41'),exports[a2_0xf05a('0x3')][a2_0xf05a('0x36')](a2_0xf05a('0x42'))),a2_0xf05a('0x37')]],'where':{'countingDate':{[exports[a2_0xf05a('0x3')]['Op'][a2_0xf05a('0x38')]]:_0x24da6a,[exports[a2_0xf05a('0x3')]['Op']['lt']]:_0x4656c1},'amount':_0x218729[a2_0xf05a('0x39')][a2_0xf05a('0x3a')]=='in'?{[exports[a2_0xf05a('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0xf05a('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0xf05a('0x3')]['fn'](a2_0xf05a('0x43'),exports[a2_0xf05a('0x3')][a2_0xf05a('0x36')](a2_0xf05a('0x30'))),exports['sequelize']['fn'](a2_0xf05a('0x44'),exports[a2_0xf05a('0x3')]['col']('countingDate')),exports['sequelize']['fn']('MONTH',exports[a2_0xf05a('0x3')][a2_0xf05a('0x36')]('countingDate')),exports[a2_0xf05a('0x3')]['fn']('YEAR',exports[a2_0xf05a('0x3')][a2_0xf05a('0x36')]('countingDate'))],'order':[['countingDate','ASC']]})[a2_0xf05a('0x1c')](_0x466c03=>{_0x347a0b[a2_0xf05a('0x10')]({'data':_0x466c03});});};exports[a2_0xf05a('0x45')]=(_0x10f8ba,_0x4be904,_0x1d6008)=>{const _0x38327a=_0x10f8ba[a2_0xf05a('0x46')][a2_0xf05a('0x47')][a2_0xf05a('0x48')](_0x38327a=>_0x38327a[a2_0xf05a('0x49')]===a2_0xf05a('0x4a'));fbgraph_1[a2_0xf05a('0x9')][a2_0xf05a('0x4b')](_0x38327a['accessToken']);fbgraph_1[a2_0xf05a('0x9')][a2_0xf05a('0x4c')](_0x10f8ba[a2_0xf05a('0x46')][a2_0xf05a('0x4a')]+a2_0xf05a('0x4d'),(_0x258ed3,_0x4d4e20)=>{if(_0x258ed3){return _0x1d6008(_0x258ed3);}_0x4be904[a2_0xf05a('0x4e')](a2_0xf05a('0x4f'),{'title':a2_0xf05a('0x50'),'profile':_0x4d4e20});});};
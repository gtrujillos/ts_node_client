var a2_0x2482=['YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','DATE_FORMAT','countingDateShort','HOUR','DAY','MONTH','YEAR','getFacebook','user','tokens','find','kind','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','__esModule','defineProperty','ftp','sequelize','setSequelize','render','api/index','API\x20Examples','syncFtp','log','connecting','default','ready','list','colombia','Downloading:\x20','name','endsWith','json','report_files','findOrCreate','spread','error','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','then','connected:','get','colombia/','fileName','media/','.txt','pipe','createWriteStream','status','save','Downloaded:\x20','processFtp','readFile','utf8','parse','Data','EndTime','models','pass_counting','create','getPassCounting','findAll','countingDate','getPassCountingByDay','query','month','startDate','endDate','sum','col','gte','params','direction','literal'];(function(_0x43eeba,_0x1693ad){var _0x429b7d=function(_0x3f3678){while(--_0x3f3678){_0x43eeba['push'](_0x43eeba['shift']());}};_0x429b7d(++_0x1693ad);}(a2_0x2482,0x66));var a2_0x2b51=function(_0x3e3231,_0x2a100e){_0x3e3231=_0x3e3231-0x0;var _0x592261=a2_0x2482[_0x3e3231];return _0x592261;};'use strict';var __importDefault=this&&this[a2_0x2b51('0x0')]||function(_0x1fa66d){return _0x1fa66d&&_0x1fa66d[a2_0x2b51('0x1')]?_0x1fa66d:{'default':_0x1fa66d};};Object[a2_0x2b51('0x2')](exports,a2_0x2b51('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require(a2_0x2b51('0x3')));const fs_1=__importDefault(require('fs'));exports[a2_0x2b51('0x4')]='';function setSequelize(_0x2ab15f){exports[a2_0x2b51('0x4')]=_0x2ab15f;}exports[a2_0x2b51('0x5')]=setSequelize;exports['getApi']=(_0x1fd9bf,_0x719231)=>{_0x719231[a2_0x2b51('0x6')](a2_0x2b51('0x7'),{'title':a2_0x2b51('0x8')});};exports[a2_0x2b51('0x9')]=(_0x3d693c,_0x1a6ea6)=>{console[a2_0x2b51('0xa')](a2_0x2b51('0xb'));const _0x4f989c=[];const _0x19acd1=new ftp_1[(a2_0x2b51('0xc'))]();_0x19acd1['on'](a2_0x2b51('0xd'),function(){console[a2_0x2b51('0xa')]('connected');_0x19acd1[a2_0x2b51('0xe')](a2_0x2b51('0xf'),![],function(_0x406dd8,_0x524d00){if(_0x406dd8){}else{for(const _0x21c951 of _0x524d00){console[a2_0x2b51('0xa')](a2_0x2b51('0x10')+_0x21c951[a2_0x2b51('0x11')]);if(_0x21c951[a2_0x2b51('0x11')][a2_0x2b51('0x12')](a2_0x2b51('0x13'))){exports[a2_0x2b51('0x4')]['models'][a2_0x2b51('0x14')][a2_0x2b51('0x15')]({'where':{'fileName':_0x21c951[a2_0x2b51('0x11')]}})[a2_0x2b51('0x16')]((_0x144406,_0x481f20)=>{if(_0x481f20){console[a2_0x2b51('0xa')](_0x21c951[a2_0x2b51('0x11')]);_0x4f989c['push'](_0x144406);}});}}}_0x1a6ea6['json']({'data':_0x4f989c});});});_0x19acd1['on'](a2_0x2b51('0x17'),function(_0x46a494){_0x1a6ea6[a2_0x2b51('0x13')]({'message':_0x46a494});});_0x19acd1[a2_0x2b51('0x18')]({'host':a2_0x2b51('0x19'),'port':0x15,'user':a2_0x2b51('0x1a'),'password':a2_0x2b51('0x1a')});};exports[a2_0x2b51('0x1b')]=(_0xd431e4,_0x5a651f)=>{exports[a2_0x2b51('0x4')]['models'][a2_0x2b51('0x14')][a2_0x2b51('0x1c')]({'where':{'status':null}})[a2_0x2b51('0x1d')](_0x477ada=>{if(_0x477ada){const _0x3d5942=new ftp_1[(a2_0x2b51('0xc'))]();_0x3d5942['on'](a2_0x2b51('0xd'),function(){console[a2_0x2b51('0xa')](a2_0x2b51('0x1e')+_0x477ada['fileName']);_0x3d5942[a2_0x2b51('0x1f')](a2_0x2b51('0x20')+_0x477ada[a2_0x2b51('0x21')],function(_0x2ce4c2,_0x414ad8){_0x3d5942['end']();if(_0x2ce4c2){}else{const _0x1a0bd0=a2_0x2b51('0x22')+_0x477ada[a2_0x2b51('0x21')]+a2_0x2b51('0x23');_0x414ad8[a2_0x2b51('0x24')](fs_1[a2_0x2b51('0xc')][a2_0x2b51('0x25')](_0x1a0bd0));_0x477ada[a2_0x2b51('0x26')]=0x1;_0x477ada[a2_0x2b51('0x27')]();console[a2_0x2b51('0xa')](a2_0x2b51('0x28')+_0x477ada[a2_0x2b51('0x21')]);}});});_0x3d5942['on'](a2_0x2b51('0x17'),function(_0x34a5a7){_0x5a651f[a2_0x2b51('0x13')]({'message':_0x34a5a7});});_0x3d5942['connect']({'host':'ftp.vivotek.com','port':0x15,'user':'ipd','password':a2_0x2b51('0x1a')});_0x5a651f[a2_0x2b51('0x13')]({'data':_0x477ada['fileName']});}else{_0x5a651f[a2_0x2b51('0x13')]({'data':[]});}});};exports[a2_0x2b51('0x29')]=(_0x49812a,_0x12fc24)=>{exports[a2_0x2b51('0x4')]['models'][a2_0x2b51('0x14')][a2_0x2b51('0x1c')]({'where':{'status':0x1}})[a2_0x2b51('0x1d')](_0x2d71a7=>{if(_0x2d71a7){const _0x3326a7='media/'+_0x2d71a7[a2_0x2b51('0x21')]+a2_0x2b51('0x23');fs_1[a2_0x2b51('0xc')][a2_0x2b51('0x2a')](_0x3326a7,a2_0x2b51('0x2b'),function(_0x3e885e,_0x149d01){if(_0x3e885e){_0x2d71a7[a2_0x2b51('0x26')]=null;}else{try{const _0x10e806=JSON[a2_0x2b51('0x2c')](_0x149d01);for(const _0x388e9c of _0x10e806[a2_0x2b51('0x2d')][0x0]['CountingInfo']){const _0x356dfa=_0x388e9c['In'];const _0xf58cfe=_0x388e9c['Out'];const _0x4cabed=Date['parse'](_0x388e9c[a2_0x2b51('0x2e')]);if(_0x356dfa>0x0){exports['sequelize'][a2_0x2b51('0x2f')][a2_0x2b51('0x30')][a2_0x2b51('0x31')]({'reportFileId':_0x2d71a7['id'],'amount':_0x356dfa,'countingDate':_0x4cabed});}if(_0xf58cfe>0x0){exports[a2_0x2b51('0x4')][a2_0x2b51('0x2f')][a2_0x2b51('0x30')]['create']({'reportFileId':_0x2d71a7['id'],'amount':_0xf58cfe*-0x1,'countingDate':_0x4cabed});}}_0x2d71a7[a2_0x2b51('0x26')]=0x2;}catch(_0x4194fa){_0x2d71a7[a2_0x2b51('0x26')]=null;}}_0x2d71a7[a2_0x2b51('0x27')]();});_0x12fc24[a2_0x2b51('0x13')]({'data':_0x2d71a7[a2_0x2b51('0x21')]});}else{_0x12fc24[a2_0x2b51('0x13')]({'data':[]});}});};exports[a2_0x2b51('0x32')]=(_0x47ba23,_0x258645)=>{exports['sequelize'][a2_0x2b51('0x2f')][a2_0x2b51('0x30')][a2_0x2b51('0x33')]({'where':{'amount':{[exports[a2_0x2b51('0x4')]['Op']['gt']]:0x0}},'order':[[a2_0x2b51('0x34'),'ASC']]})['then'](_0x53bb6d=>{_0x258645[a2_0x2b51('0x13')]({'data':_0x53bb6d});});};exports[a2_0x2b51('0x35')]=(_0x2f03bf,_0x1cfdd3)=>{const _0xcfae18=_0x2f03bf[a2_0x2b51('0x36')][a2_0x2b51('0x37')];const _0x237eca=_0x2f03bf['query'][a2_0x2b51('0x38')];const _0x16f3e1=_0x2f03bf[a2_0x2b51('0x36')][a2_0x2b51('0x39')];exports[a2_0x2b51('0x4')][a2_0x2b51('0x2f')][a2_0x2b51('0x30')][a2_0x2b51('0x33')]({'attributes':[a2_0x2b51('0x34'),[exports['sequelize']['fn'](a2_0x2b51('0x3a'),exports['sequelize'][a2_0x2b51('0x3b')]('amount')),'total']],'where':{'countingDate':{[exports[a2_0x2b51('0x4')]['Op'][a2_0x2b51('0x3c')]]:_0x237eca,[exports[a2_0x2b51('0x4')]['Op']['lt']]:_0x16f3e1},'amount':_0x2f03bf[a2_0x2b51('0x3d')][a2_0x2b51('0x3e')]=='in'?{[exports[a2_0x2b51('0x4')]['Op']['gt']]:0x0}:{[exports[a2_0x2b51('0x4')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a2_0x2b51('0x3f')](a2_0x2b51('0x40'))],'order':[[a2_0x2b51('0x34'),'ASC']]})[a2_0x2b51('0x1d')](_0x27c07b=>{_0x1cfdd3[a2_0x2b51('0x13')]({'data':_0x27c07b});});};exports[a2_0x2b51('0x41')]=(_0x34205a,_0x57da2c)=>{const _0x12357c=_0x34205a[a2_0x2b51('0x36')][a2_0x2b51('0x37')];const _0x117c3b=_0x34205a['query'][a2_0x2b51('0x38')];const _0x25327f=_0x34205a['query'][a2_0x2b51('0x39')];exports[a2_0x2b51('0x4')][a2_0x2b51('0x2f')][a2_0x2b51('0x30')][a2_0x2b51('0x33')]({'attributes':[a2_0x2b51('0x34'),[exports[a2_0x2b51('0x4')]['fn'](a2_0x2b51('0x42'),exports[a2_0x2b51('0x4')][a2_0x2b51('0x3b')]('countingDate'),'%Y-%m-%d\x20%H:00'),a2_0x2b51('0x43')],[exports['sequelize']['fn'](a2_0x2b51('0x3a'),exports[a2_0x2b51('0x4')][a2_0x2b51('0x3b')]('amount')),'total']],'where':{'countingDate':{[exports[a2_0x2b51('0x4')]['Op']['gte']]:_0x117c3b,[exports[a2_0x2b51('0x4')]['Op']['lt']]:_0x25327f},'amount':_0x34205a[a2_0x2b51('0x3d')][a2_0x2b51('0x3e')]=='in'?{[exports[a2_0x2b51('0x4')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a2_0x2b51('0x44'),exports[a2_0x2b51('0x4')][a2_0x2b51('0x3b')](a2_0x2b51('0x34'))),exports['sequelize']['fn'](a2_0x2b51('0x45'),exports[a2_0x2b51('0x4')][a2_0x2b51('0x3b')]('countingDate')),exports['sequelize']['fn'](a2_0x2b51('0x46'),exports[a2_0x2b51('0x4')][a2_0x2b51('0x3b')](a2_0x2b51('0x34'))),exports[a2_0x2b51('0x4')]['fn'](a2_0x2b51('0x47'),exports[a2_0x2b51('0x4')][a2_0x2b51('0x3b')](a2_0x2b51('0x34')))],'order':[[a2_0x2b51('0x34'),'ASC']]})[a2_0x2b51('0x1d')](_0x29de7e=>{_0x57da2c[a2_0x2b51('0x13')]({'data':_0x29de7e});});};exports[a2_0x2b51('0x48')]=(_0xc6e035,_0x896839,_0xe7d796)=>{const _0x1b5dd4=_0xc6e035[a2_0x2b51('0x49')][a2_0x2b51('0x4a')][a2_0x2b51('0x4b')](_0x1b5dd4=>_0x1b5dd4[a2_0x2b51('0x4c')]===a2_0x2b51('0x4d'));fbgraph_1['default'][a2_0x2b51('0x4e')](_0x1b5dd4[a2_0x2b51('0x4f')]);fbgraph_1[a2_0x2b51('0xc')]['get'](_0xc6e035[a2_0x2b51('0x49')][a2_0x2b51('0x4d')]+a2_0x2b51('0x50'),(_0x593f86,_0x3d5ded)=>{if(_0x593f86){return _0xe7d796(_0x593f86);}_0x896839[a2_0x2b51('0x6')](a2_0x2b51('0x51'),{'title':a2_0x2b51('0x52'),'profile':_0x3d5ded});});};
var a2_0xe3fa=['countingDateShort','HOUR','MONTH','getFacebook','user','kind','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook','__importDefault','defineProperty','__esModule','ftp','sequelize','setSequelize','getApi','api/index','API\x20Examples','syncFtp','connecting','log','list','colombia','Downloading:\x20','name','endsWith','models','findOrCreate','push','json','error','ipd','downloadFtp','findOne','then','default','ready','connected:','fileName','get','end','media/','.txt','pipe','status','save','Downloaded:\x20','ftp.vivotek.com','processFtp','readFile','utf8','parse','Data','CountingInfo','Out','EndTime','pass_counting','create','getPassCounting','findAll','ASC','getPassCountingByDay','month','query','endDate','sum','col','amount','total','gte','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','countingDate'];(function(_0x2e6645,_0x55e06d){var _0x5e985e=function(_0x346d7d){while(--_0x346d7d){_0x2e6645['push'](_0x2e6645['shift']());}};_0x5e985e(++_0x55e06d);}(a2_0xe3fa,0xf6));var a2_0x446a=function(_0x5817d9,_0x261bcf){_0x5817d9=_0x5817d9-0x0;var _0x596ed9=a2_0xe3fa[_0x5817d9];return _0x596ed9;};'use strict';var __importDefault=this&&this[a2_0x446a('0x0')]||function(_0xd2845f){return _0xd2845f&&_0xd2845f['__esModule']?_0xd2845f:{'default':_0xd2845f};};Object[a2_0x446a('0x1')](exports,a2_0x446a('0x2'),{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require(a2_0x446a('0x3')));const fs_1=__importDefault(require('fs'));exports[a2_0x446a('0x4')]='';function setSequelize(_0x4a1118){exports[a2_0x446a('0x4')]=_0x4a1118;}exports[a2_0x446a('0x5')]=setSequelize;exports[a2_0x446a('0x6')]=(_0x8e2a24,_0x2e78d7)=>{_0x2e78d7['render'](a2_0x446a('0x7'),{'title':a2_0x446a('0x8')});};exports[a2_0x446a('0x9')]=(_0x91d024,_0xb4f9ce)=>{console['log'](a2_0x446a('0xa'));const _0x1d5fec=[];const _0x186a06=new ftp_1['default']();_0x186a06['on']('ready',function(){console[a2_0x446a('0xb')]('connected');_0x186a06[a2_0x446a('0xc')](a2_0x446a('0xd'),![],function(_0xc72d93,_0x1e5f90){if(_0xc72d93){}else{for(const _0x34ff19 of _0x1e5f90){console[a2_0x446a('0xb')](a2_0x446a('0xe')+_0x34ff19['name']);if(_0x34ff19[a2_0x446a('0xf')][a2_0x446a('0x10')]('json')){exports[a2_0x446a('0x4')][a2_0x446a('0x11')]['report_files'][a2_0x446a('0x12')]({'where':{'fileName':_0x34ff19[a2_0x446a('0xf')]}})['spread']((_0x4cbe74,_0x409357)=>{if(_0x409357){console['log'](_0x34ff19[a2_0x446a('0xf')]);_0x1d5fec[a2_0x446a('0x13')](_0x4cbe74);}});}}}_0xb4f9ce[a2_0x446a('0x14')]({'data':_0x1d5fec});});});_0x186a06['on'](a2_0x446a('0x15'),function(_0x38d9f2){_0xb4f9ce['json']({'message':_0x38d9f2});});_0x186a06['connect']({'host':'ftp.vivotek.com','port':0x15,'user':'ipd','password':a2_0x446a('0x16')});};exports[a2_0x446a('0x17')]=(_0x53b898,_0x154958)=>{exports[a2_0x446a('0x4')][a2_0x446a('0x11')]['report_files'][a2_0x446a('0x18')]({'where':{'status':null}})[a2_0x446a('0x19')](_0x553677=>{if(_0x553677){const _0x41e165=new ftp_1[(a2_0x446a('0x1a'))]();_0x41e165['on'](a2_0x446a('0x1b'),function(){console['log'](a2_0x446a('0x1c')+_0x553677[a2_0x446a('0x1d')]);_0x41e165[a2_0x446a('0x1e')]('colombia/'+_0x553677[a2_0x446a('0x1d')],function(_0x350a27,_0x3229d1){_0x41e165[a2_0x446a('0x1f')]();if(_0x350a27){}else{const _0x20ffde=a2_0x446a('0x20')+_0x553677[a2_0x446a('0x1d')]+a2_0x446a('0x21');_0x3229d1[a2_0x446a('0x22')](fs_1[a2_0x446a('0x1a')]['createWriteStream'](_0x20ffde));_0x553677[a2_0x446a('0x23')]=0x1;_0x553677[a2_0x446a('0x24')]();console[a2_0x446a('0xb')](a2_0x446a('0x25')+_0x553677[a2_0x446a('0x1d')]);}});});_0x41e165['on']('error',function(_0x33f5e8){_0x154958[a2_0x446a('0x14')]({'message':_0x33f5e8});});_0x41e165['connect']({'host':a2_0x446a('0x26'),'port':0x15,'user':a2_0x446a('0x16'),'password':a2_0x446a('0x16')});_0x154958['json']({'data':_0x553677[a2_0x446a('0x1d')]});}else{_0x154958['json']({'data':[]});}});};exports[a2_0x446a('0x27')]=(_0xdfab9f,_0x5cb986)=>{exports['sequelize'][a2_0x446a('0x11')]['report_files'][a2_0x446a('0x18')]({'where':{'status':0x1}})[a2_0x446a('0x19')](_0x57001c=>{if(_0x57001c){const _0x26b7cb=a2_0x446a('0x20')+_0x57001c[a2_0x446a('0x1d')]+a2_0x446a('0x21');fs_1[a2_0x446a('0x1a')][a2_0x446a('0x28')](_0x26b7cb,a2_0x446a('0x29'),function(_0x451f0c,_0x54aedc){if(_0x451f0c){_0x57001c[a2_0x446a('0x23')]=null;}else{try{const _0x220931=JSON[a2_0x446a('0x2a')](_0x54aedc);for(const _0x52acc5 of _0x220931[a2_0x446a('0x2b')][0x0][a2_0x446a('0x2c')]){const _0x3822a8=_0x52acc5['In'];const _0xe6e4ba=_0x52acc5[a2_0x446a('0x2d')];const _0x103181=Date[a2_0x446a('0x2a')](_0x52acc5[a2_0x446a('0x2e')]);if(_0x3822a8>0x0){exports[a2_0x446a('0x4')][a2_0x446a('0x11')]['pass_counting']['create']({'reportFileId':_0x57001c['id'],'amount':_0x3822a8,'countingDate':_0x103181});}if(_0xe6e4ba>0x0){exports[a2_0x446a('0x4')]['models'][a2_0x446a('0x2f')][a2_0x446a('0x30')]({'reportFileId':_0x57001c['id'],'amount':_0xe6e4ba*-0x1,'countingDate':_0x103181});}}_0x57001c[a2_0x446a('0x23')]=0x2;}catch(_0x227471){_0x57001c[a2_0x446a('0x23')]=null;}}_0x57001c[a2_0x446a('0x24')]();});_0x5cb986['json']({'data':_0x57001c[a2_0x446a('0x1d')]});}else{_0x5cb986[a2_0x446a('0x14')]({'data':[]});}});};exports[a2_0x446a('0x31')]=(_0x4441d8,_0x2bbd36)=>{exports[a2_0x446a('0x4')]['models'][a2_0x446a('0x2f')][a2_0x446a('0x32')]({'where':{'amount':{[exports[a2_0x446a('0x4')]['Op']['gt']]:0x0}},'order':[['countingDate',a2_0x446a('0x33')]]})['then'](_0x2ecb2e=>{_0x2bbd36[a2_0x446a('0x14')]({'data':_0x2ecb2e});});};exports[a2_0x446a('0x34')]=(_0x2e00e3,_0x4de4b7)=>{const _0x54fcf1=_0x2e00e3['query'][a2_0x446a('0x35')];const _0x56c06c=_0x2e00e3[a2_0x446a('0x36')]['startDate'];const _0x9c6b65=_0x2e00e3[a2_0x446a('0x36')][a2_0x446a('0x37')];exports[a2_0x446a('0x4')][a2_0x446a('0x11')][a2_0x446a('0x2f')][a2_0x446a('0x32')]({'attributes':['countingDate',[exports[a2_0x446a('0x4')]['fn'](a2_0x446a('0x38'),exports['sequelize'][a2_0x446a('0x39')](a2_0x446a('0x3a'))),a2_0x446a('0x3b')]],'where':{'countingDate':{[exports[a2_0x446a('0x4')]['Op'][a2_0x446a('0x3c')]]:_0x56c06c,[exports[a2_0x446a('0x4')]['Op']['lt']]:_0x9c6b65},'amount':_0x2e00e3['params'][a2_0x446a('0x3d')]=='in'?{[exports[a2_0x446a('0x4')]['Op']['gt']]:0x0}:{[exports[a2_0x446a('0x4')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a2_0x446a('0x3e')](a2_0x446a('0x3f'))],'order':[['countingDate',a2_0x446a('0x33')]]})[a2_0x446a('0x19')](_0x43b77c=>{_0x4de4b7[a2_0x446a('0x14')]({'data':_0x43b77c});});};exports[a2_0x446a('0x40')]=(_0x2a1cf6,_0x211b70)=>{const _0x3ec51f=_0x2a1cf6['query']['month'];const _0x210d5d=_0x2a1cf6[a2_0x446a('0x36')]['startDate'];const _0x5c2e5c=_0x2a1cf6['query'][a2_0x446a('0x37')];exports[a2_0x446a('0x4')]['models'][a2_0x446a('0x2f')][a2_0x446a('0x32')]({'attributes':[a2_0x446a('0x41'),[exports[a2_0x446a('0x4')]['fn']('DATE_FORMAT',exports['sequelize']['col']('countingDate'),'%Y-%m-%d\x20%H:00'),a2_0x446a('0x42')],[exports[a2_0x446a('0x4')]['fn']('sum',exports[a2_0x446a('0x4')]['col'](a2_0x446a('0x3a'))),a2_0x446a('0x3b')]],'where':{'countingDate':{[exports[a2_0x446a('0x4')]['Op'][a2_0x446a('0x3c')]]:_0x210d5d,[exports[a2_0x446a('0x4')]['Op']['lt']]:_0x5c2e5c},'amount':_0x2a1cf6['params'][a2_0x446a('0x3d')]=='in'?{[exports[a2_0x446a('0x4')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x446a('0x4')]['fn'](a2_0x446a('0x43'),exports[a2_0x446a('0x4')][a2_0x446a('0x39')]('countingDate')),exports[a2_0x446a('0x4')]['fn']('DAY',exports['sequelize'][a2_0x446a('0x39')](a2_0x446a('0x41'))),exports[a2_0x446a('0x4')]['fn'](a2_0x446a('0x44'),exports[a2_0x446a('0x4')][a2_0x446a('0x39')](a2_0x446a('0x41'))),exports[a2_0x446a('0x4')]['fn']('YEAR',exports[a2_0x446a('0x4')][a2_0x446a('0x39')](a2_0x446a('0x41')))],'order':[[a2_0x446a('0x41'),a2_0x446a('0x33')]]})[a2_0x446a('0x19')](_0x1b8229=>{_0x211b70[a2_0x446a('0x14')]({'data':_0x1b8229});});};exports[a2_0x446a('0x45')]=(_0xe6eb6a,_0xa42409,_0x224079)=>{const _0x221f6f=_0xe6eb6a[a2_0x446a('0x46')]['tokens']['find'](_0x221f6f=>_0x221f6f[a2_0x446a('0x47')]===a2_0x446a('0x48'));fbgraph_1[a2_0x446a('0x1a')][a2_0x446a('0x49')](_0x221f6f[a2_0x446a('0x4a')]);fbgraph_1['default']['get'](_0xe6eb6a[a2_0x446a('0x46')][a2_0x446a('0x48')]+a2_0x446a('0x4b'),(_0x38bc78,_0x5b2595)=>{if(_0x38bc78){return _0x224079(_0x38bc78);}_0xa42409[a2_0x446a('0x4c')](a2_0x446a('0x4d'),{'title':'Facebook\x20API','profile':_0x5b2595});});};
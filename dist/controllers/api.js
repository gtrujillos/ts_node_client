var a2_0x69fa=['name','json','report_files','findOrCreate','push','error','connect','ftp.vivotek.com','ipd','downloadFtp','models','default','connected:','get','colombia/','fileName','end','media/','pipe','createWriteStream','status','processFtp','findOne','then','.txt','readFile','utf8','parse','Out','EndTime','pass_counting','create','save','getPassCounting','countingDate','ASC','getPassCountingByDay','month','query','startDate','endDate','findAll','sum','col','total','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','%Y-%m-%d\x20%H:00','countingDateShort','amount','HOUR','DAY','MONTH','YEAR','getFacebook','tokens','find','kind','setAccessToken','accessToken','user','facebook','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook','__importDefault','__esModule','fbgraph','ftp','sequelize','setSequelize','getApi','api/index','API\x20Examples','syncFtp','log','connecting','ready','connected','list','colombia','Downloading:\x20'];(function(_0xb79352,_0x56d717){var _0x4d7260=function(_0x58211b){while(--_0x58211b){_0xb79352['push'](_0xb79352['shift']());}};_0x4d7260(++_0x56d717);}(a2_0x69fa,0xee));var a2_0x5bf4=function(_0x2d8f05,_0x4b81bb){_0x2d8f05=_0x2d8f05-0x0;var _0x4d74cb=a2_0x69fa[_0x2d8f05];return _0x4d74cb;};'use strict';var __importDefault=this&&this[a2_0x5bf4('0x0')]||function(_0x261107){return _0x261107&&_0x261107['__esModule']?_0x261107:{'default':_0x261107};};Object['defineProperty'](exports,a2_0x5bf4('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x5bf4('0x2')));const ftp_1=__importDefault(require(a2_0x5bf4('0x3')));const fs_1=__importDefault(require('fs'));exports[a2_0x5bf4('0x4')]='';function setSequelize(_0x5467c4){exports['sequelize']=_0x5467c4;}exports[a2_0x5bf4('0x5')]=setSequelize;exports[a2_0x5bf4('0x6')]=(_0x5c1bf4,_0x62798f)=>{_0x62798f['render'](a2_0x5bf4('0x7'),{'title':a2_0x5bf4('0x8')});};exports[a2_0x5bf4('0x9')]=(_0x5618b7,_0x54d164)=>{console[a2_0x5bf4('0xa')](a2_0x5bf4('0xb'));const _0xefa26c=[];const _0x1e71ac=new ftp_1['default']();_0x1e71ac['on'](a2_0x5bf4('0xc'),function(){console[a2_0x5bf4('0xa')](a2_0x5bf4('0xd'));_0x1e71ac[a2_0x5bf4('0xe')](a2_0x5bf4('0xf'),![],function(_0x5e9945,_0x5ec7aa){if(_0x5e9945){}else{for(const _0x5f43bb of _0x5ec7aa){console['log'](a2_0x5bf4('0x10')+_0x5f43bb[a2_0x5bf4('0x11')]);if(_0x5f43bb['name']['endsWith'](a2_0x5bf4('0x12'))){exports[a2_0x5bf4('0x4')]['models'][a2_0x5bf4('0x13')][a2_0x5bf4('0x14')]({'where':{'fileName':_0x5f43bb['name']}})['spread']((_0x559585,_0x57b2d2)=>{if(_0x57b2d2){console[a2_0x5bf4('0xa')](_0x5f43bb[a2_0x5bf4('0x11')]);_0xefa26c[a2_0x5bf4('0x15')](_0x559585);}});}}}_0x54d164[a2_0x5bf4('0x12')]({'data':_0xefa26c});});});_0x1e71ac['on'](a2_0x5bf4('0x16'),function(_0x156c96){_0x54d164[a2_0x5bf4('0x12')]({'message':_0x156c96});});_0x1e71ac[a2_0x5bf4('0x17')]({'host':a2_0x5bf4('0x18'),'port':0x15,'user':a2_0x5bf4('0x19'),'password':a2_0x5bf4('0x19')});};exports[a2_0x5bf4('0x1a')]=(_0x1dde97,_0x3a75d0)=>{exports[a2_0x5bf4('0x4')][a2_0x5bf4('0x1b')][a2_0x5bf4('0x13')]['findOne']({'where':{'status':null}})['then'](_0x2e66d3=>{if(_0x2e66d3){const _0x3af478=new ftp_1[(a2_0x5bf4('0x1c'))]();_0x3af478['on']('ready',function(){console[a2_0x5bf4('0xa')](a2_0x5bf4('0x1d')+_0x2e66d3['fileName']);_0x3af478[a2_0x5bf4('0x1e')](a2_0x5bf4('0x1f')+_0x2e66d3[a2_0x5bf4('0x20')],function(_0x41b9f0,_0xb6e7a9){_0x3af478[a2_0x5bf4('0x21')]();if(_0x41b9f0){}else{const _0x5673c8=a2_0x5bf4('0x22')+_0x2e66d3['fileName']+'.txt';_0xb6e7a9[a2_0x5bf4('0x23')](fs_1[a2_0x5bf4('0x1c')][a2_0x5bf4('0x24')](_0x5673c8));_0x2e66d3[a2_0x5bf4('0x25')]=0x1;_0x2e66d3['save']();console[a2_0x5bf4('0xa')]('Downloaded:\x20'+_0x2e66d3[a2_0x5bf4('0x20')]);}});});_0x3af478['on'](a2_0x5bf4('0x16'),function(_0x4200cc){_0x3a75d0[a2_0x5bf4('0x12')]({'message':_0x4200cc});});_0x3af478['connect']({'host':a2_0x5bf4('0x18'),'port':0x15,'user':a2_0x5bf4('0x19'),'password':'ipd'});_0x3a75d0[a2_0x5bf4('0x12')]({'data':_0x2e66d3[a2_0x5bf4('0x20')]});}else{_0x3a75d0[a2_0x5bf4('0x12')]({'data':[]});}});};exports[a2_0x5bf4('0x26')]=(_0x84ccb7,_0x4333bc)=>{exports[a2_0x5bf4('0x4')]['models'][a2_0x5bf4('0x13')][a2_0x5bf4('0x27')]({'where':{'status':0x1}})[a2_0x5bf4('0x28')](_0x3dace7=>{if(_0x3dace7){const _0xda0a63=a2_0x5bf4('0x22')+_0x3dace7[a2_0x5bf4('0x20')]+a2_0x5bf4('0x29');fs_1[a2_0x5bf4('0x1c')][a2_0x5bf4('0x2a')](_0xda0a63,a2_0x5bf4('0x2b'),function(_0x1c3f0b,_0x40c830){if(_0x1c3f0b){_0x3dace7[a2_0x5bf4('0x25')]=null;}else{try{const _0x375564=JSON[a2_0x5bf4('0x2c')](_0x40c830);for(const _0x3a7249 of _0x375564['Data'][0x0]['CountingInfo']){const _0x3cc196=_0x3a7249['In'];const _0x489897=_0x3a7249[a2_0x5bf4('0x2d')];const _0xc8d2c5=Date[a2_0x5bf4('0x2c')](_0x3a7249[a2_0x5bf4('0x2e')]);if(_0x3cc196>0x0){exports['sequelize']['models'][a2_0x5bf4('0x2f')][a2_0x5bf4('0x30')]({'reportFileId':_0x3dace7['id'],'amount':_0x3cc196,'countingDate':_0xc8d2c5});}if(_0x489897>0x0){exports[a2_0x5bf4('0x4')][a2_0x5bf4('0x1b')][a2_0x5bf4('0x2f')][a2_0x5bf4('0x30')]({'reportFileId':_0x3dace7['id'],'amount':_0x489897*-0x1,'countingDate':_0xc8d2c5});}}_0x3dace7[a2_0x5bf4('0x25')]=0x2;}catch(_0x1c3f0f){_0x3dace7[a2_0x5bf4('0x25')]=null;}}_0x3dace7[a2_0x5bf4('0x31')]();});_0x4333bc[a2_0x5bf4('0x12')]({'data':_0x3dace7[a2_0x5bf4('0x20')]});}else{_0x4333bc[a2_0x5bf4('0x12')]({'data':[]});}});};exports[a2_0x5bf4('0x32')]=(_0x4e6304,_0x5e31dd)=>{exports[a2_0x5bf4('0x4')][a2_0x5bf4('0x1b')][a2_0x5bf4('0x2f')]['findAll']({'where':{'amount':{[exports[a2_0x5bf4('0x4')]['Op']['gt']]:0x0}},'order':[[a2_0x5bf4('0x33'),a2_0x5bf4('0x34')]]})[a2_0x5bf4('0x28')](_0x1d2b3c=>{_0x5e31dd['json']({'data':_0x1d2b3c});});};exports[a2_0x5bf4('0x35')]=(_0x2ad06f,_0x2c3441)=>{const _0x1b51cc=_0x2ad06f['query'][a2_0x5bf4('0x36')];const _0x2a09e8=_0x2ad06f[a2_0x5bf4('0x37')][a2_0x5bf4('0x38')];const _0x5ddc09=_0x2ad06f['query'][a2_0x5bf4('0x39')];exports['sequelize'][a2_0x5bf4('0x1b')]['pass_counting'][a2_0x5bf4('0x3a')]({'attributes':['countingDate',[exports[a2_0x5bf4('0x4')]['fn'](a2_0x5bf4('0x3b'),exports['sequelize'][a2_0x5bf4('0x3c')]('amount')),a2_0x5bf4('0x3d')]],'where':{'countingDate':{[exports[a2_0x5bf4('0x4')]['Op']['gte']]:_0x2a09e8,[exports[a2_0x5bf4('0x4')]['Op']['lt']]:_0x5ddc09},'amount':_0x2ad06f[a2_0x5bf4('0x3e')][a2_0x5bf4('0x3f')]=='in'?{[exports[a2_0x5bf4('0x4')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x5bf4('0x4')][a2_0x5bf4('0x40')](a2_0x5bf4('0x41'))],'order':[[a2_0x5bf4('0x33'),a2_0x5bf4('0x34')]]})['then'](_0xb5f2b1=>{_0x2c3441['json']({'data':_0xb5f2b1});});};exports[a2_0x5bf4('0x42')]=(_0x552257,_0xbfe671)=>{const _0x3a8a12=_0x552257['query'][a2_0x5bf4('0x36')];const _0x2c371f=_0x552257[a2_0x5bf4('0x37')][a2_0x5bf4('0x38')];const _0x5402bb=_0x552257[a2_0x5bf4('0x37')][a2_0x5bf4('0x39')];exports[a2_0x5bf4('0x4')]['models'][a2_0x5bf4('0x2f')]['findAll']({'attributes':[a2_0x5bf4('0x33'),[exports['sequelize']['fn']('DATE_FORMAT',exports['sequelize'][a2_0x5bf4('0x3c')](a2_0x5bf4('0x33')),a2_0x5bf4('0x43')),a2_0x5bf4('0x44')],[exports[a2_0x5bf4('0x4')]['fn'](a2_0x5bf4('0x3b'),exports[a2_0x5bf4('0x4')][a2_0x5bf4('0x3c')](a2_0x5bf4('0x45'))),a2_0x5bf4('0x3d')]],'where':{'countingDate':{[exports['sequelize']['Op']['gte']]:_0x2c371f,[exports[a2_0x5bf4('0x4')]['Op']['lt']]:_0x5402bb},'amount':_0x552257[a2_0x5bf4('0x3e')][a2_0x5bf4('0x3f')]=='in'?{[exports[a2_0x5bf4('0x4')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x5bf4('0x4')]['fn'](a2_0x5bf4('0x46'),exports['sequelize'][a2_0x5bf4('0x3c')](a2_0x5bf4('0x33'))),exports[a2_0x5bf4('0x4')]['fn'](a2_0x5bf4('0x47'),exports[a2_0x5bf4('0x4')][a2_0x5bf4('0x3c')](a2_0x5bf4('0x33'))),exports[a2_0x5bf4('0x4')]['fn'](a2_0x5bf4('0x48'),exports[a2_0x5bf4('0x4')][a2_0x5bf4('0x3c')](a2_0x5bf4('0x33'))),exports['sequelize']['fn'](a2_0x5bf4('0x49'),exports[a2_0x5bf4('0x4')][a2_0x5bf4('0x3c')](a2_0x5bf4('0x33')))],'order':[[a2_0x5bf4('0x33'),'ASC']]})[a2_0x5bf4('0x28')](_0x52be22=>{_0xbfe671['json']({'data':_0x52be22});});};exports[a2_0x5bf4('0x4a')]=(_0x4538de,_0x3194fa,_0x1a566f)=>{const _0x24e4dd=_0x4538de['user'][a2_0x5bf4('0x4b')][a2_0x5bf4('0x4c')](_0x24e4dd=>_0x24e4dd[a2_0x5bf4('0x4d')]==='facebook');fbgraph_1[a2_0x5bf4('0x1c')][a2_0x5bf4('0x4e')](_0x24e4dd[a2_0x5bf4('0x4f')]);fbgraph_1[a2_0x5bf4('0x1c')]['get'](_0x4538de[a2_0x5bf4('0x50')][a2_0x5bf4('0x51')]+a2_0x5bf4('0x52'),(_0x217428,_0x3aa7eb)=>{if(_0x217428){return _0x1a566f(_0x217428);}_0x3194fa[a2_0x5bf4('0x53')](a2_0x5bf4('0x54'),{'title':'Facebook\x20API','profile':_0x3aa7eb});});};
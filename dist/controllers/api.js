var a2_0x4ae5=['connected','list','Downloading:\x20','name','json','models','report_files','spread','push','error','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','then','connected:','fileName','get','media/','.txt','pipe','status','save','processFtp','default','readFile','utf8','parse','CountingInfo','Out','EndTime','pass_counting','create','getPassCounting','findAll','countingDate','ASC','getPassCountingByDay','query','month','endDate','sum','col','amount','total','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','startDate','DATE_FORMAT','countingDateShort','HOUR','DAY','MONTH','user','tokens','find','kind','facebook','setAccessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','__esModule','defineProperty','fbgraph','ftp','sequelize','setSequelize','getApi','render','api/index','syncFtp','log','connecting','ready'];(function(_0x3cc8a7,_0x549e59){var _0x420102=function(_0x272cba){while(--_0x272cba){_0x3cc8a7['push'](_0x3cc8a7['shift']());}};_0x420102(++_0x549e59);}(a2_0x4ae5,0x1d8));var a2_0xf99f=function(_0x12d184,_0x1badbd){_0x12d184=_0x12d184-0x0;var _0x54bf21=a2_0x4ae5[_0x12d184];return _0x54bf21;};'use strict';var __importDefault=this&&this[a2_0xf99f('0x0')]||function(_0x27de01){return _0x27de01&&_0x27de01[a2_0xf99f('0x1')]?_0x27de01:{'default':_0x27de01};};Object[a2_0xf99f('0x2')](exports,a2_0xf99f('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0xf99f('0x3')));const ftp_1=__importDefault(require(a2_0xf99f('0x4')));const fs_1=__importDefault(require('fs'));exports[a2_0xf99f('0x5')]='';function setSequelize(_0x582c31){exports[a2_0xf99f('0x5')]=_0x582c31;}exports[a2_0xf99f('0x6')]=setSequelize;exports[a2_0xf99f('0x7')]=(_0x22c651,_0x2e364d)=>{_0x2e364d[a2_0xf99f('0x8')](a2_0xf99f('0x9'),{'title':'API\x20Examples'});};exports[a2_0xf99f('0xa')]=(_0x7a8137,_0x40b19e)=>{console[a2_0xf99f('0xb')](a2_0xf99f('0xc'));const _0xb97ac=[];const _0x377b23=new ftp_1['default']();_0x377b23['on'](a2_0xf99f('0xd'),function(){console[a2_0xf99f('0xb')](a2_0xf99f('0xe'));_0x377b23[a2_0xf99f('0xf')]('colombia',![],function(_0x1173cf,_0x448af6){if(_0x1173cf){}else{for(const _0x186783 of _0x448af6){console[a2_0xf99f('0xb')](a2_0xf99f('0x10')+_0x186783[a2_0xf99f('0x11')]);if(_0x186783[a2_0xf99f('0x11')]['endsWith'](a2_0xf99f('0x12'))){exports[a2_0xf99f('0x5')][a2_0xf99f('0x13')][a2_0xf99f('0x14')]['findOrCreate']({'where':{'fileName':_0x186783[a2_0xf99f('0x11')]}})[a2_0xf99f('0x15')]((_0x63f11f,_0x31ff3f)=>{if(_0x31ff3f){console[a2_0xf99f('0xb')](_0x186783[a2_0xf99f('0x11')]);_0xb97ac[a2_0xf99f('0x16')](_0x63f11f);}});}}}_0x40b19e[a2_0xf99f('0x12')]({'data':_0xb97ac});});});_0x377b23['on'](a2_0xf99f('0x17'),function(_0x5a6e72){_0x40b19e['json']({'message':_0x5a6e72});});_0x377b23[a2_0xf99f('0x18')]({'host':a2_0xf99f('0x19'),'port':0x15,'user':a2_0xf99f('0x1a'),'password':a2_0xf99f('0x1a')});};exports[a2_0xf99f('0x1b')]=(_0x3e59e3,_0x4f7180)=>{exports[a2_0xf99f('0x5')][a2_0xf99f('0x13')][a2_0xf99f('0x14')][a2_0xf99f('0x1c')]({'where':{'status':null}})[a2_0xf99f('0x1d')](_0x5c09f3=>{if(_0x5c09f3){const _0x31069a=new ftp_1['default']();_0x31069a['on']('ready',function(){console['log'](a2_0xf99f('0x1e')+_0x5c09f3[a2_0xf99f('0x1f')]);_0x31069a[a2_0xf99f('0x20')]('colombia/'+_0x5c09f3[a2_0xf99f('0x1f')],function(_0x2312d5,_0x348d79){_0x31069a['end']();if(_0x2312d5){}else{const _0x261832=a2_0xf99f('0x21')+_0x5c09f3['fileName']+a2_0xf99f('0x22');_0x348d79[a2_0xf99f('0x23')](fs_1['default']['createWriteStream'](_0x261832));_0x5c09f3[a2_0xf99f('0x24')]=0x1;_0x5c09f3[a2_0xf99f('0x25')]();console[a2_0xf99f('0xb')]('Downloaded:\x20'+_0x5c09f3[a2_0xf99f('0x1f')]);}});});_0x31069a['on'](a2_0xf99f('0x17'),function(_0x2ccd2f){_0x4f7180[a2_0xf99f('0x12')]({'message':_0x2ccd2f});});_0x31069a[a2_0xf99f('0x18')]({'host':a2_0xf99f('0x19'),'port':0x15,'user':a2_0xf99f('0x1a'),'password':a2_0xf99f('0x1a')});_0x4f7180['json']({'data':_0x5c09f3['fileName']});}else{_0x4f7180[a2_0xf99f('0x12')]({'data':[]});}});};exports[a2_0xf99f('0x26')]=(_0x2b9df6,_0x21bf77)=>{exports[a2_0xf99f('0x5')][a2_0xf99f('0x13')][a2_0xf99f('0x14')][a2_0xf99f('0x1c')]({'where':{'status':0x1}})[a2_0xf99f('0x1d')](_0x3191d2=>{if(_0x3191d2){const _0x477a9e=a2_0xf99f('0x21')+_0x3191d2[a2_0xf99f('0x1f')]+'.txt';fs_1[a2_0xf99f('0x27')][a2_0xf99f('0x28')](_0x477a9e,a2_0xf99f('0x29'),function(_0x29a52c,_0x428aba){if(_0x29a52c){_0x3191d2[a2_0xf99f('0x24')]=null;}else{try{const _0xdf2029=JSON[a2_0xf99f('0x2a')](_0x428aba);for(const _0x2f419f of _0xdf2029['Data'][0x0][a2_0xf99f('0x2b')]){const _0x1a632a=_0x2f419f['In'];const _0x23c0be=_0x2f419f[a2_0xf99f('0x2c')];const _0x1d931f=Date['parse'](_0x2f419f[a2_0xf99f('0x2d')]);if(_0x1a632a>0x0){exports[a2_0xf99f('0x5')][a2_0xf99f('0x13')][a2_0xf99f('0x2e')][a2_0xf99f('0x2f')]({'reportFileId':_0x3191d2['id'],'amount':_0x1a632a,'countingDate':_0x1d931f});}if(_0x23c0be>0x0){exports['sequelize']['models'][a2_0xf99f('0x2e')][a2_0xf99f('0x2f')]({'reportFileId':_0x3191d2['id'],'amount':_0x23c0be*-0x1,'countingDate':_0x1d931f});}}_0x3191d2[a2_0xf99f('0x24')]=0x2;}catch(_0x4a7ec4){_0x3191d2[a2_0xf99f('0x24')]=null;}}_0x3191d2[a2_0xf99f('0x25')]();});_0x21bf77[a2_0xf99f('0x12')]({'data':_0x3191d2[a2_0xf99f('0x1f')]});}else{_0x21bf77['json']({'data':[]});}});};exports[a2_0xf99f('0x30')]=(_0x32dfaa,_0x543310)=>{exports[a2_0xf99f('0x5')]['models']['pass_counting'][a2_0xf99f('0x31')]({'where':{'amount':{[exports[a2_0xf99f('0x5')]['Op']['gt']]:0x0}},'order':[[a2_0xf99f('0x32'),a2_0xf99f('0x33')]]})['then'](_0x30fa19=>{_0x543310[a2_0xf99f('0x12')]({'data':_0x30fa19});});};exports[a2_0xf99f('0x34')]=(_0x5dc5cf,_0x4c46dd)=>{const _0x145f91=_0x5dc5cf[a2_0xf99f('0x35')][a2_0xf99f('0x36')];const _0x5d415b=_0x5dc5cf[a2_0xf99f('0x35')]['startDate'];const _0x4ccca3=_0x5dc5cf['query'][a2_0xf99f('0x37')];exports['sequelize'][a2_0xf99f('0x13')]['pass_counting']['findAll']({'attributes':[a2_0xf99f('0x32'),[exports[a2_0xf99f('0x5')]['fn'](a2_0xf99f('0x38'),exports[a2_0xf99f('0x5')][a2_0xf99f('0x39')](a2_0xf99f('0x3a'))),a2_0xf99f('0x3b')]],'where':{'countingDate':{[exports['sequelize']['Op'][a2_0xf99f('0x3c')]]:_0x5d415b,[exports[a2_0xf99f('0x5')]['Op']['lt']]:_0x4ccca3},'amount':_0x5dc5cf[a2_0xf99f('0x3d')][a2_0xf99f('0x3e')]=='in'?{[exports[a2_0xf99f('0x5')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0xf99f('0x5')][a2_0xf99f('0x3f')](a2_0xf99f('0x40'))],'order':[[a2_0xf99f('0x32'),a2_0xf99f('0x33')]]})[a2_0xf99f('0x1d')](_0x8afbec=>{_0x4c46dd[a2_0xf99f('0x12')]({'data':_0x8afbec});});};exports[a2_0xf99f('0x41')]=(_0x287794,_0xae952a)=>{const _0xc7871=_0x287794['query']['month'];const _0x368999=_0x287794[a2_0xf99f('0x35')][a2_0xf99f('0x42')];const _0x241c80=_0x287794[a2_0xf99f('0x35')][a2_0xf99f('0x37')];exports[a2_0xf99f('0x5')]['models']['pass_counting'][a2_0xf99f('0x31')]({'attributes':[a2_0xf99f('0x32'),[exports[a2_0xf99f('0x5')]['fn'](a2_0xf99f('0x43'),exports[a2_0xf99f('0x5')][a2_0xf99f('0x39')](a2_0xf99f('0x32')),'%Y-%m-%d\x20%H:00'),a2_0xf99f('0x44')],[exports[a2_0xf99f('0x5')]['fn'](a2_0xf99f('0x38'),exports[a2_0xf99f('0x5')]['col']('amount')),a2_0xf99f('0x3b')]],'where':{'countingDate':{[exports[a2_0xf99f('0x5')]['Op'][a2_0xf99f('0x3c')]]:_0x368999,[exports[a2_0xf99f('0x5')]['Op']['lt']]:_0x241c80},'amount':_0x287794[a2_0xf99f('0x3d')][a2_0xf99f('0x3e')]=='in'?{[exports[a2_0xf99f('0x5')]['Op']['gt']]:0x0}:{[exports[a2_0xf99f('0x5')]['Op']['lt']]:0x0}},'group':[exports[a2_0xf99f('0x5')]['fn'](a2_0xf99f('0x45'),exports[a2_0xf99f('0x5')][a2_0xf99f('0x39')](a2_0xf99f('0x32'))),exports[a2_0xf99f('0x5')]['fn'](a2_0xf99f('0x46'),exports[a2_0xf99f('0x5')][a2_0xf99f('0x39')](a2_0xf99f('0x32'))),exports[a2_0xf99f('0x5')]['fn'](a2_0xf99f('0x47'),exports[a2_0xf99f('0x5')]['col'](a2_0xf99f('0x32'))),exports[a2_0xf99f('0x5')]['fn']('YEAR',exports[a2_0xf99f('0x5')][a2_0xf99f('0x39')](a2_0xf99f('0x32')))],'order':[['countingDate',a2_0xf99f('0x33')]]})[a2_0xf99f('0x1d')](_0x13638c=>{_0xae952a['json']({'data':_0x13638c});});};exports['getFacebook']=(_0x364343,_0x3f1d4c,_0x2dbfe3)=>{const _0x4cce0b=_0x364343[a2_0xf99f('0x48')][a2_0xf99f('0x49')][a2_0xf99f('0x4a')](_0x4cce0b=>_0x4cce0b[a2_0xf99f('0x4b')]===a2_0xf99f('0x4c'));fbgraph_1[a2_0xf99f('0x27')][a2_0xf99f('0x4d')](_0x4cce0b['accessToken']);fbgraph_1['default'][a2_0xf99f('0x20')](_0x364343[a2_0xf99f('0x48')][a2_0xf99f('0x4c')]+a2_0xf99f('0x4e'),(_0x480248,_0x2aeeef)=>{if(_0x480248){return _0x2dbfe3(_0x480248);}_0x3f1d4c[a2_0xf99f('0x8')](a2_0xf99f('0x4f'),{'title':a2_0xf99f('0x50'),'profile':_0x2aeeef});});};
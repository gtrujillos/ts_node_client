var a2_0x5393=['YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','DATE_FORMAT','%Y-%m-%d\x20%H:00','col','HOUR','DAY','MONTH','YEAR','getFacebook','user','tokens','kind','facebook','setAccessToken','api/facebook','Facebook\x20API','__importDefault','defineProperty','fbgraph','ftp','sequelize','getApi','render','api/index','API\x20Examples','connecting','log','connected','list','colombia','Downloading:\x20','name','json','models','findOrCreate','spread','push','error','connect','ftp.vivotek.com','ipd','downloadFtp','report_files','then','default','ready','connected:','fileName','get','colombia/','end','media/','pipe','createWriteStream','status','save','processFtp','.txt','readFile','utf8','parse','Data','CountingInfo','Out','EndTime','pass_counting','create','getPassCounting','findAll','ASC','getPassCountingByDay','query','month','startDate','endDate','countingDate','sum','amount','total','gte','params','direction','literal'];(function(_0x3507ee,_0x44abf9){var _0x1ba246=function(_0x40d1c7){while(--_0x40d1c7){_0x3507ee['push'](_0x3507ee['shift']());}};_0x1ba246(++_0x44abf9);}(a2_0x5393,0x10d));var a2_0x204d=function(_0x1855d5,_0x519006){_0x1855d5=_0x1855d5-0x0;var _0x296e5d=a2_0x5393[_0x1855d5];return _0x296e5d;};'use strict';var __importDefault=this&&this[a2_0x204d('0x0')]||function(_0x2fd6f6){return _0x2fd6f6&&_0x2fd6f6['__esModule']?_0x2fd6f6:{'default':_0x2fd6f6};};Object[a2_0x204d('0x1')](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x204d('0x2')));const ftp_1=__importDefault(require(a2_0x204d('0x3')));const fs_1=__importDefault(require('fs'));exports[a2_0x204d('0x4')]='';function setSequelize(_0x219d23){exports[a2_0x204d('0x4')]=_0x219d23;}exports['setSequelize']=setSequelize;exports[a2_0x204d('0x5')]=(_0xf0ce34,_0x114cd5)=>{_0x114cd5[a2_0x204d('0x6')](a2_0x204d('0x7'),{'title':a2_0x204d('0x8')});};exports['syncFtp']=(_0x277920,_0xce0364)=>{console['log'](a2_0x204d('0x9'));const _0x4abd8e=[];const _0x444a7d=new ftp_1['default']();_0x444a7d['on']('ready',function(){console[a2_0x204d('0xa')](a2_0x204d('0xb'));_0x444a7d[a2_0x204d('0xc')](a2_0x204d('0xd'),![],function(_0xd67a9,_0x5b7f0c){if(_0xd67a9){}else{for(const _0x2fac18 of _0x5b7f0c){console[a2_0x204d('0xa')](a2_0x204d('0xe')+_0x2fac18['name']);if(_0x2fac18[a2_0x204d('0xf')]['endsWith'](a2_0x204d('0x10'))){exports[a2_0x204d('0x4')][a2_0x204d('0x11')]['report_files'][a2_0x204d('0x12')]({'where':{'fileName':_0x2fac18[a2_0x204d('0xf')]}})[a2_0x204d('0x13')]((_0x1ada96,_0x283de8)=>{if(_0x283de8){console[a2_0x204d('0xa')](_0x2fac18['name']);_0x4abd8e[a2_0x204d('0x14')](_0x1ada96);}});}}}_0xce0364[a2_0x204d('0x10')]({'data':_0x4abd8e});});});_0x444a7d['on'](a2_0x204d('0x15'),function(_0x27732e){_0xce0364['json']({'message':_0x27732e});});_0x444a7d[a2_0x204d('0x16')]({'host':a2_0x204d('0x17'),'port':0x15,'user':a2_0x204d('0x18'),'password':a2_0x204d('0x18')});};exports[a2_0x204d('0x19')]=(_0x15d4a6,_0x2afbae)=>{exports[a2_0x204d('0x4')]['models'][a2_0x204d('0x1a')]['findOne']({'where':{'status':null}})[a2_0x204d('0x1b')](_0x1dd132=>{if(_0x1dd132){const _0x36b059=new ftp_1[(a2_0x204d('0x1c'))]();_0x36b059['on'](a2_0x204d('0x1d'),function(){console[a2_0x204d('0xa')](a2_0x204d('0x1e')+_0x1dd132[a2_0x204d('0x1f')]);_0x36b059[a2_0x204d('0x20')](a2_0x204d('0x21')+_0x1dd132['fileName'],function(_0x29c3df,_0x707794){_0x36b059[a2_0x204d('0x22')]();if(_0x29c3df){}else{const _0x546303=a2_0x204d('0x23')+_0x1dd132[a2_0x204d('0x1f')]+'.txt';_0x707794[a2_0x204d('0x24')](fs_1[a2_0x204d('0x1c')][a2_0x204d('0x25')](_0x546303));_0x1dd132[a2_0x204d('0x26')]=0x1;_0x1dd132[a2_0x204d('0x27')]();console['log']('Downloaded:\x20'+_0x1dd132[a2_0x204d('0x1f')]);}});});_0x36b059['on'](a2_0x204d('0x15'),function(_0x23ac75){_0x2afbae[a2_0x204d('0x10')]({'message':_0x23ac75});});_0x36b059[a2_0x204d('0x16')]({'host':a2_0x204d('0x17'),'port':0x15,'user':a2_0x204d('0x18'),'password':a2_0x204d('0x18')});_0x2afbae['json']({'data':_0x1dd132[a2_0x204d('0x1f')]});}else{_0x2afbae[a2_0x204d('0x10')]({'data':[]});}});};exports[a2_0x204d('0x28')]=(_0x51cb2f,_0x36e821)=>{exports[a2_0x204d('0x4')]['models']['report_files']['findOne']({'where':{'status':0x1}})[a2_0x204d('0x1b')](_0x35ab9a=>{if(_0x35ab9a){const _0x862513='media/'+_0x35ab9a[a2_0x204d('0x1f')]+a2_0x204d('0x29');fs_1[a2_0x204d('0x1c')][a2_0x204d('0x2a')](_0x862513,a2_0x204d('0x2b'),function(_0x246e23,_0x159389){if(_0x246e23){_0x35ab9a['status']=null;}else{try{const _0x2860e=JSON[a2_0x204d('0x2c')](_0x159389);for(const _0x4beee6 of _0x2860e[a2_0x204d('0x2d')][0x0][a2_0x204d('0x2e')]){const _0x43fa2b=_0x4beee6['In'];const _0x3fbfab=_0x4beee6[a2_0x204d('0x2f')];const _0x28d0a3=Date[a2_0x204d('0x2c')](_0x4beee6[a2_0x204d('0x30')]);if(_0x43fa2b>0x0){exports[a2_0x204d('0x4')]['models'][a2_0x204d('0x31')]['create']({'reportFileId':_0x35ab9a['id'],'amount':_0x43fa2b,'countingDate':_0x28d0a3});}if(_0x3fbfab>0x0){exports['sequelize']['models'][a2_0x204d('0x31')][a2_0x204d('0x32')]({'reportFileId':_0x35ab9a['id'],'amount':_0x3fbfab*-0x1,'countingDate':_0x28d0a3});}}_0x35ab9a[a2_0x204d('0x26')]=0x2;}catch(_0x472301){_0x35ab9a[a2_0x204d('0x26')]=null;}}_0x35ab9a[a2_0x204d('0x27')]();});_0x36e821['json']({'data':_0x35ab9a[a2_0x204d('0x1f')]});}else{_0x36e821[a2_0x204d('0x10')]({'data':[]});}});};exports[a2_0x204d('0x33')]=(_0x339142,_0x6522aa)=>{exports[a2_0x204d('0x4')][a2_0x204d('0x11')][a2_0x204d('0x31')][a2_0x204d('0x34')]({'where':{'amount':{[exports[a2_0x204d('0x4')]['Op']['gt']]:0x0}},'order':[['countingDate',a2_0x204d('0x35')]]})['then'](_0x2ed4bd=>{_0x6522aa['json']({'data':_0x2ed4bd});});};exports[a2_0x204d('0x36')]=(_0x56f5ec,_0xc7ceff)=>{const _0x477b0a=_0x56f5ec[a2_0x204d('0x37')][a2_0x204d('0x38')];const _0x268f9d=_0x56f5ec[a2_0x204d('0x37')][a2_0x204d('0x39')];const _0x53df94=_0x56f5ec[a2_0x204d('0x37')][a2_0x204d('0x3a')];exports[a2_0x204d('0x4')][a2_0x204d('0x11')]['pass_counting'][a2_0x204d('0x34')]({'attributes':[a2_0x204d('0x3b'),[exports[a2_0x204d('0x4')]['fn'](a2_0x204d('0x3c'),exports[a2_0x204d('0x4')]['col'](a2_0x204d('0x3d'))),a2_0x204d('0x3e')]],'where':{'countingDate':{[exports[a2_0x204d('0x4')]['Op'][a2_0x204d('0x3f')]]:_0x268f9d,[exports[a2_0x204d('0x4')]['Op']['lt']]:_0x53df94},'amount':_0x56f5ec[a2_0x204d('0x40')][a2_0x204d('0x41')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x204d('0x4')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a2_0x204d('0x42')](a2_0x204d('0x43'))],'order':[[a2_0x204d('0x3b'),a2_0x204d('0x35')]]})[a2_0x204d('0x1b')](_0xc62108=>{_0xc7ceff[a2_0x204d('0x10')]({'data':_0xc62108});});};exports[a2_0x204d('0x44')]=(_0x3f78d2,_0x4b604d)=>{const _0x1e0743=_0x3f78d2[a2_0x204d('0x37')][a2_0x204d('0x38')];const _0x123d0f=_0x3f78d2[a2_0x204d('0x37')]['startDate'];const _0x1423ac=_0x3f78d2['query'][a2_0x204d('0x3a')];exports[a2_0x204d('0x4')][a2_0x204d('0x11')][a2_0x204d('0x31')][a2_0x204d('0x34')]({'attributes':[a2_0x204d('0x3b'),[exports[a2_0x204d('0x4')]['fn'](a2_0x204d('0x45'),exports[a2_0x204d('0x4')]['col'](a2_0x204d('0x3b')),a2_0x204d('0x46')),'countingDateShort'],[exports[a2_0x204d('0x4')]['fn'](a2_0x204d('0x3c'),exports[a2_0x204d('0x4')][a2_0x204d('0x47')](a2_0x204d('0x3d'))),a2_0x204d('0x3e')]],'where':{'countingDate':{[exports[a2_0x204d('0x4')]['Op'][a2_0x204d('0x3f')]]:_0x123d0f,[exports[a2_0x204d('0x4')]['Op']['lt']]:_0x1423ac},'amount':_0x3f78d2[a2_0x204d('0x40')][a2_0x204d('0x41')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x204d('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x204d('0x4')]['fn'](a2_0x204d('0x48'),exports[a2_0x204d('0x4')][a2_0x204d('0x47')](a2_0x204d('0x3b'))),exports[a2_0x204d('0x4')]['fn'](a2_0x204d('0x49'),exports[a2_0x204d('0x4')]['col'](a2_0x204d('0x3b'))),exports['sequelize']['fn'](a2_0x204d('0x4a'),exports[a2_0x204d('0x4')][a2_0x204d('0x47')](a2_0x204d('0x3b'))),exports[a2_0x204d('0x4')]['fn'](a2_0x204d('0x4b'),exports['sequelize'][a2_0x204d('0x47')](a2_0x204d('0x3b')))],'order':[[a2_0x204d('0x3b'),a2_0x204d('0x35')]]})[a2_0x204d('0x1b')](_0x1c5f01=>{_0x4b604d['json']({'data':_0x1c5f01});});};exports[a2_0x204d('0x4c')]=(_0x109fa9,_0x3cc93f,_0x232170)=>{const _0x2c105d=_0x109fa9[a2_0x204d('0x4d')][a2_0x204d('0x4e')]['find'](_0x2c105d=>_0x2c105d[a2_0x204d('0x4f')]===a2_0x204d('0x50'));fbgraph_1['default'][a2_0x204d('0x51')](_0x2c105d['accessToken']);fbgraph_1[a2_0x204d('0x1c')][a2_0x204d('0x20')](_0x109fa9[a2_0x204d('0x4d')][a2_0x204d('0x50')]+'?fields=id,name,email,first_name,last_name,gender,link,locale,timezone',(_0x321613,_0x3fa472)=>{if(_0x321613){return _0x232170(_0x321613);}_0x3cc93f[a2_0x204d('0x6')](a2_0x204d('0x52'),{'title':a2_0x204d('0x53'),'profile':_0x3fa472});});};
var a2_0xa86e=['name','endsWith','json','models','report_files','findOrCreate','spread','push','error','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','then','ready','connected:','get','fileName','end','media/','.txt','createWriteStream','status','Downloaded:\x20','processFtp','readFile','utf8','parse','Data','CountingInfo','Out','pass_counting','findAll','countingDate','getPassCountingByDay','query','endDate','sum','col','amount','total','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC','month','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','gte','HOUR','DAY','MONTH','getFacebook','user','tokens','find','kind','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','__esModule','sequelize','render','api/index','API\x20Examples','log','connecting','default','list','colombia','Downloading:\x20'];(function(_0x40437f,_0x19f796){var _0x2c0039=function(_0x4f24dc){while(--_0x4f24dc){_0x40437f['push'](_0x40437f['shift']());}};_0x2c0039(++_0x19f796);}(a2_0xa86e,0x90));var a2_0x3474=function(_0x12ac7c,_0x1e0910){_0x12ac7c=_0x12ac7c-0x0;var _0x37b7f6=a2_0xa86e[_0x12ac7c];return _0x37b7f6;};'use strict';var __importDefault=this&&this[a2_0x3474('0x0')]||function(_0x391e92){return _0x391e92&&_0x391e92['__esModule']?_0x391e92:{'default':_0x391e92};};Object['defineProperty'](exports,a2_0x3474('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));exports[a2_0x3474('0x2')]='';function setSequelize(_0x207f70){exports[a2_0x3474('0x2')]=_0x207f70;}exports['setSequelize']=setSequelize;exports['getApi']=(_0x1f1d17,_0xc8f624)=>{_0xc8f624[a2_0x3474('0x3')](a2_0x3474('0x4'),{'title':a2_0x3474('0x5')});};exports['syncFtp']=(_0x5ebc95,_0x2e01eb)=>{console[a2_0x3474('0x6')](a2_0x3474('0x7'));const _0x5e9e2d=[];const _0x54e4a8=new ftp_1[(a2_0x3474('0x8'))]();_0x54e4a8['on']('ready',function(){console[a2_0x3474('0x6')]('connected');_0x54e4a8[a2_0x3474('0x9')](a2_0x3474('0xa'),![],function(_0x8434c5,_0x5d59d5){if(_0x8434c5){}else{for(const _0x438ccf of _0x5d59d5){console[a2_0x3474('0x6')](a2_0x3474('0xb')+_0x438ccf[a2_0x3474('0xc')]);if(_0x438ccf[a2_0x3474('0xc')][a2_0x3474('0xd')](a2_0x3474('0xe'))){exports[a2_0x3474('0x2')][a2_0x3474('0xf')][a2_0x3474('0x10')][a2_0x3474('0x11')]({'where':{'fileName':_0x438ccf[a2_0x3474('0xc')]}})[a2_0x3474('0x12')]((_0x3fd0b5,_0x36a92e)=>{if(_0x36a92e){console[a2_0x3474('0x6')](_0x438ccf['name']);_0x5e9e2d[a2_0x3474('0x13')](_0x3fd0b5);}});}}}_0x2e01eb[a2_0x3474('0xe')]({'data':_0x5e9e2d});});});_0x54e4a8['on'](a2_0x3474('0x14'),function(_0x55f0de){_0x2e01eb['json']({'message':_0x55f0de});});_0x54e4a8[a2_0x3474('0x15')]({'host':a2_0x3474('0x16'),'port':0x15,'user':a2_0x3474('0x17'),'password':'ipd'});};exports[a2_0x3474('0x18')]=(_0x638976,_0x49f2d8)=>{exports['sequelize'][a2_0x3474('0xf')]['report_files'][a2_0x3474('0x19')]({'where':{'status':null}})[a2_0x3474('0x1a')](_0x58a3c0=>{if(_0x58a3c0){const _0x16f08b=new ftp_1[(a2_0x3474('0x8'))]();_0x16f08b['on'](a2_0x3474('0x1b'),function(){console[a2_0x3474('0x6')](a2_0x3474('0x1c')+_0x58a3c0['fileName']);_0x16f08b[a2_0x3474('0x1d')]('colombia/'+_0x58a3c0[a2_0x3474('0x1e')],function(_0x16530c,_0x502947){_0x16f08b[a2_0x3474('0x1f')]();if(_0x16530c){}else{const _0x41d67a=a2_0x3474('0x20')+_0x58a3c0[a2_0x3474('0x1e')]+a2_0x3474('0x21');_0x502947['pipe'](fs_1[a2_0x3474('0x8')][a2_0x3474('0x22')](_0x41d67a));_0x58a3c0[a2_0x3474('0x23')]=0x1;_0x58a3c0['save']();console[a2_0x3474('0x6')](a2_0x3474('0x24')+_0x58a3c0[a2_0x3474('0x1e')]);}});});_0x16f08b['on'](a2_0x3474('0x14'),function(_0x5b8838){_0x49f2d8[a2_0x3474('0xe')]({'message':_0x5b8838});});_0x16f08b['connect']({'host':a2_0x3474('0x16'),'port':0x15,'user':'ipd','password':a2_0x3474('0x17')});_0x49f2d8[a2_0x3474('0xe')]({'data':_0x58a3c0[a2_0x3474('0x1e')]});}else{_0x49f2d8[a2_0x3474('0xe')]({'data':[]});}});};exports[a2_0x3474('0x25')]=(_0x137293,_0x131722)=>{exports['sequelize']['models'][a2_0x3474('0x10')]['findOne']({'where':{'status':0x1}})[a2_0x3474('0x1a')](_0x2b342c=>{if(_0x2b342c){const _0x48fb52=a2_0x3474('0x20')+_0x2b342c[a2_0x3474('0x1e')]+a2_0x3474('0x21');fs_1[a2_0x3474('0x8')][a2_0x3474('0x26')](_0x48fb52,a2_0x3474('0x27'),function(_0x2c62fe,_0x38dc0a){if(_0x2c62fe){_0x2b342c[a2_0x3474('0x23')]=null;}else{try{const _0x5ebb86=JSON[a2_0x3474('0x28')](_0x38dc0a);for(const _0x5bb1f1 of _0x5ebb86[a2_0x3474('0x29')][0x0][a2_0x3474('0x2a')]){const _0x98b445=_0x5bb1f1['In'];const _0x3c606a=_0x5bb1f1[a2_0x3474('0x2b')];const _0x368b8a=Date[a2_0x3474('0x28')](_0x5bb1f1['EndTime']);if(_0x98b445>0x0){exports[a2_0x3474('0x2')][a2_0x3474('0xf')][a2_0x3474('0x2c')]['create']({'reportFileId':_0x2b342c['id'],'amount':_0x98b445,'countingDate':_0x368b8a});}if(_0x3c606a>0x0){exports[a2_0x3474('0x2')][a2_0x3474('0xf')][a2_0x3474('0x2c')]['create']({'reportFileId':_0x2b342c['id'],'amount':_0x3c606a*-0x1,'countingDate':_0x368b8a});}}_0x2b342c[a2_0x3474('0x23')]=0x2;}catch(_0x36cc2f){_0x2b342c[a2_0x3474('0x23')]=null;}}_0x2b342c['save']();});_0x131722[a2_0x3474('0xe')]({'data':_0x2b342c[a2_0x3474('0x1e')]});}else{_0x131722['json']({'data':[]});}});};exports['getPassCounting']=(_0x254568,_0x3829a9)=>{exports['sequelize'][a2_0x3474('0xf')][a2_0x3474('0x2c')][a2_0x3474('0x2d')]({'where':{'amount':{[exports[a2_0x3474('0x2')]['Op']['gt']]:0x0}},'order':[[a2_0x3474('0x2e'),'ASC']]})[a2_0x3474('0x1a')](_0x5b61fa=>{_0x3829a9[a2_0x3474('0xe')]({'data':_0x5b61fa});});};exports[a2_0x3474('0x2f')]=(_0x311291,_0x5b52c4)=>{const _0x532999=_0x311291[a2_0x3474('0x30')]['month'];const _0x113d5a=_0x311291['query']['startDate'];const _0x5ee4d2=_0x311291['query'][a2_0x3474('0x31')];exports['sequelize'][a2_0x3474('0xf')][a2_0x3474('0x2c')]['findAll']({'attributes':[a2_0x3474('0x2e'),[exports['sequelize']['fn'](a2_0x3474('0x32'),exports['sequelize'][a2_0x3474('0x33')](a2_0x3474('0x34'))),a2_0x3474('0x35')]],'where':{'countingDate':{[exports['sequelize']['Op']['gte']]:_0x113d5a,[exports['sequelize']['Op']['lt']]:_0x5ee4d2},'amount':_0x311291[a2_0x3474('0x36')][a2_0x3474('0x37')]=='in'?{[exports[a2_0x3474('0x2')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports['sequelize'][a2_0x3474('0x38')](a2_0x3474('0x39'))],'order':[['countingDate',a2_0x3474('0x3a')]]})['then'](_0xf8a5dd=>{_0x5b52c4['json']({'data':_0xf8a5dd});});};exports['getPassCountingByHour']=(_0x5cd04d,_0x25958b)=>{const _0x37c926=_0x5cd04d[a2_0x3474('0x30')][a2_0x3474('0x3b')];const _0x4ca6a3=_0x5cd04d[a2_0x3474('0x30')]['startDate'];const _0x7d5add=_0x5cd04d[a2_0x3474('0x30')][a2_0x3474('0x31')];exports[a2_0x3474('0x2')][a2_0x3474('0xf')]['pass_counting']['findAll']({'attributes':[a2_0x3474('0x2e'),[exports['sequelize']['fn'](a2_0x3474('0x3c'),exports[a2_0x3474('0x2')]['col'](a2_0x3474('0x2e')),a2_0x3474('0x3d')),a2_0x3474('0x3e')],[exports[a2_0x3474('0x2')]['fn'](a2_0x3474('0x32'),exports[a2_0x3474('0x2')][a2_0x3474('0x33')]('amount')),a2_0x3474('0x35')]],'where':{'countingDate':{[exports[a2_0x3474('0x2')]['Op'][a2_0x3474('0x3f')]]:_0x4ca6a3,[exports[a2_0x3474('0x2')]['Op']['lt']]:_0x7d5add},'amount':_0x5cd04d[a2_0x3474('0x36')][a2_0x3474('0x37')]=='in'?{[exports[a2_0x3474('0x2')]['Op']['gt']]:0x0}:{[exports[a2_0x3474('0x2')]['Op']['lt']]:0x0}},'group':[exports[a2_0x3474('0x2')]['fn'](a2_0x3474('0x40'),exports['sequelize'][a2_0x3474('0x33')](a2_0x3474('0x2e'))),exports[a2_0x3474('0x2')]['fn'](a2_0x3474('0x41'),exports[a2_0x3474('0x2')][a2_0x3474('0x33')](a2_0x3474('0x2e'))),exports['sequelize']['fn'](a2_0x3474('0x42'),exports[a2_0x3474('0x2')][a2_0x3474('0x33')](a2_0x3474('0x2e'))),exports[a2_0x3474('0x2')]['fn']('YEAR',exports[a2_0x3474('0x2')][a2_0x3474('0x33')](a2_0x3474('0x2e')))],'order':[[a2_0x3474('0x2e'),'ASC']]})[a2_0x3474('0x1a')](_0x1b3aa4=>{_0x25958b['json']({'data':_0x1b3aa4});});};exports[a2_0x3474('0x43')]=(_0x5a0d4d,_0x1e8d0b,_0x4f3cbc)=>{const _0x16ce77=_0x5a0d4d[a2_0x3474('0x44')][a2_0x3474('0x45')][a2_0x3474('0x46')](_0x16ce77=>_0x16ce77[a2_0x3474('0x47')]===a2_0x3474('0x48'));fbgraph_1[a2_0x3474('0x8')][a2_0x3474('0x49')](_0x16ce77[a2_0x3474('0x4a')]);fbgraph_1['default'][a2_0x3474('0x1d')](_0x5a0d4d[a2_0x3474('0x44')][a2_0x3474('0x48')]+a2_0x3474('0x4b'),(_0x555d6b,_0x1cef45)=>{if(_0x555d6b){return _0x4f3cbc(_0x555d6b);}_0x1e8d0b[a2_0x3474('0x3')](a2_0x3474('0x4c'),{'title':a2_0x3474('0x4d'),'profile':_0x1cef45});});};
var a2_0x49bc=['YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','DATE_FORMAT','%Y-%m-%d\x20%H:00','sum','HOUR','DAY','MONTH','getFacebook','find','kind','facebook','setAccessToken','accessToken','get','user','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','__importDefault','__esModule','defineProperty','fbgraph','ftp','sequelize','setSequelize','getApi','render','api/index','API\x20Examples','log','connecting','ready','list','colombia','Downloading:\x20','endsWith','json','findOrCreate','name','spread','push','connect','ftp.vivotek.com','ipd','downloadFtp','models','report_files','findOne','connected:','fileName','colombia/','end','media/','default','status','save','Downloaded:\x20','processFtp','readFile','utf8','Data','Out','pass_counting','create','getPassCounting','findAll','countingDate','ASC','then','getPassCountingByDay','month','query','startDate','endDate','col','amount','total','gte','params','direction','literal'];(function(_0x112454,_0x52f84d){var _0x5290a2=function(_0x72e4ea){while(--_0x72e4ea){_0x112454['push'](_0x112454['shift']());}};_0x5290a2(++_0x52f84d);}(a2_0x49bc,0xb4));var a2_0x52c7=function(_0x9d216e,_0x4c2dd8){_0x9d216e=_0x9d216e-0x0;var _0x1cdcb9=a2_0x49bc[_0x9d216e];return _0x1cdcb9;};'use strict';var __importDefault=this&&this[a2_0x52c7('0x0')]||function(_0x4b862f){return _0x4b862f&&_0x4b862f[a2_0x52c7('0x1')]?_0x4b862f:{'default':_0x4b862f};};Object[a2_0x52c7('0x2')](exports,a2_0x52c7('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x52c7('0x3')));const ftp_1=__importDefault(require(a2_0x52c7('0x4')));const fs_1=__importDefault(require('fs'));exports[a2_0x52c7('0x5')]='';function setSequelize(_0x1439d2){exports[a2_0x52c7('0x5')]=_0x1439d2;}exports[a2_0x52c7('0x6')]=setSequelize;exports[a2_0x52c7('0x7')]=(_0x352364,_0x11452f)=>{_0x11452f[a2_0x52c7('0x8')](a2_0x52c7('0x9'),{'title':a2_0x52c7('0xa')});};exports['syncFtp']=(_0x15a23b,_0x1051a9)=>{console[a2_0x52c7('0xb')](a2_0x52c7('0xc'));const _0x23cb4c=[];const _0x53fdaf=new ftp_1['default']();_0x53fdaf['on'](a2_0x52c7('0xd'),function(){console[a2_0x52c7('0xb')]('connected');_0x53fdaf[a2_0x52c7('0xe')](a2_0x52c7('0xf'),![],function(_0x5e4087,_0x572d51){if(_0x5e4087){}else{for(const _0x4cd620 of _0x572d51){console[a2_0x52c7('0xb')](a2_0x52c7('0x10')+_0x4cd620['name']);if(_0x4cd620['name'][a2_0x52c7('0x11')](a2_0x52c7('0x12'))){exports[a2_0x52c7('0x5')]['models']['report_files'][a2_0x52c7('0x13')]({'where':{'fileName':_0x4cd620[a2_0x52c7('0x14')]}})[a2_0x52c7('0x15')]((_0x35e156,_0x594dfe)=>{if(_0x594dfe){console[a2_0x52c7('0xb')](_0x4cd620[a2_0x52c7('0x14')]);_0x23cb4c[a2_0x52c7('0x16')](_0x35e156);}});}}}_0x1051a9[a2_0x52c7('0x12')]({'data':_0x23cb4c});});});_0x53fdaf['on']('error',function(_0x189c82){_0x1051a9[a2_0x52c7('0x12')]({'message':_0x189c82});});_0x53fdaf[a2_0x52c7('0x17')]({'host':a2_0x52c7('0x18'),'port':0x15,'user':'ipd','password':a2_0x52c7('0x19')});};exports[a2_0x52c7('0x1a')]=(_0x341e27,_0x4c1972)=>{exports['sequelize'][a2_0x52c7('0x1b')][a2_0x52c7('0x1c')][a2_0x52c7('0x1d')]({'where':{'status':null}})['then'](_0x44ebd3=>{if(_0x44ebd3){const _0x32b68d=new ftp_1['default']();_0x32b68d['on'](a2_0x52c7('0xd'),function(){console['log'](a2_0x52c7('0x1e')+_0x44ebd3[a2_0x52c7('0x1f')]);_0x32b68d['get'](a2_0x52c7('0x20')+_0x44ebd3[a2_0x52c7('0x1f')],function(_0x896c61,_0x316d54){_0x32b68d[a2_0x52c7('0x21')]();if(_0x896c61){}else{const _0x23e297=a2_0x52c7('0x22')+_0x44ebd3[a2_0x52c7('0x1f')]+'.txt';_0x316d54['pipe'](fs_1[a2_0x52c7('0x23')]['createWriteStream'](_0x23e297));_0x44ebd3[a2_0x52c7('0x24')]=0x1;_0x44ebd3[a2_0x52c7('0x25')]();console['log'](a2_0x52c7('0x26')+_0x44ebd3[a2_0x52c7('0x1f')]);}});});_0x32b68d['on']('error',function(_0x4e48a7){_0x4c1972[a2_0x52c7('0x12')]({'message':_0x4e48a7});});_0x32b68d[a2_0x52c7('0x17')]({'host':a2_0x52c7('0x18'),'port':0x15,'user':'ipd','password':a2_0x52c7('0x19')});_0x4c1972['json']({'data':_0x44ebd3[a2_0x52c7('0x1f')]});}else{_0x4c1972[a2_0x52c7('0x12')]({'data':[]});}});};exports[a2_0x52c7('0x27')]=(_0x5b1ea5,_0x2ed193)=>{exports[a2_0x52c7('0x5')][a2_0x52c7('0x1b')][a2_0x52c7('0x1c')][a2_0x52c7('0x1d')]({'where':{'status':0x1}})['then'](_0x313ca8=>{if(_0x313ca8){const _0x3847ff=a2_0x52c7('0x22')+_0x313ca8[a2_0x52c7('0x1f')]+'.txt';fs_1[a2_0x52c7('0x23')][a2_0x52c7('0x28')](_0x3847ff,a2_0x52c7('0x29'),function(_0x198402,_0xef45cc){if(_0x198402){_0x313ca8[a2_0x52c7('0x24')]=null;}else{try{const _0x5ea74d=JSON['parse'](_0xef45cc);for(const _0x5a673a of _0x5ea74d[a2_0x52c7('0x2a')][0x0]['CountingInfo']){const _0x38efd9=_0x5a673a['In'];const _0x48c13c=_0x5a673a[a2_0x52c7('0x2b')];const _0x59c246=Date['parse'](_0x5a673a['EndTime']);if(_0x38efd9>0x0){exports[a2_0x52c7('0x5')]['models'][a2_0x52c7('0x2c')][a2_0x52c7('0x2d')]({'reportFileId':_0x313ca8['id'],'amount':_0x38efd9,'countingDate':_0x59c246});}if(_0x48c13c>0x0){exports[a2_0x52c7('0x5')][a2_0x52c7('0x1b')][a2_0x52c7('0x2c')][a2_0x52c7('0x2d')]({'reportFileId':_0x313ca8['id'],'amount':_0x48c13c*-0x1,'countingDate':_0x59c246});}}_0x313ca8[a2_0x52c7('0x24')]=0x2;}catch(_0x4225b5){_0x313ca8['status']=null;}}_0x313ca8[a2_0x52c7('0x25')]();});_0x2ed193[a2_0x52c7('0x12')]({'data':_0x313ca8['fileName']});}else{_0x2ed193['json']({'data':[]});}});};exports[a2_0x52c7('0x2e')]=(_0x1fd532,_0x4110ce)=>{exports['sequelize'][a2_0x52c7('0x1b')][a2_0x52c7('0x2c')][a2_0x52c7('0x2f')]({'where':{'amount':{[exports[a2_0x52c7('0x5')]['Op']['gt']]:0x0}},'order':[[a2_0x52c7('0x30'),a2_0x52c7('0x31')]]})[a2_0x52c7('0x32')](_0x1280fa=>{_0x4110ce[a2_0x52c7('0x12')]({'data':_0x1280fa});});};exports[a2_0x52c7('0x33')]=(_0x12514e,_0x4cf26d)=>{const _0x14e84b=_0x12514e['query'][a2_0x52c7('0x34')];const _0x1111e4=_0x12514e[a2_0x52c7('0x35')][a2_0x52c7('0x36')];const _0x562b3e=_0x12514e['query'][a2_0x52c7('0x37')];exports['sequelize'][a2_0x52c7('0x1b')][a2_0x52c7('0x2c')][a2_0x52c7('0x2f')]({'attributes':[a2_0x52c7('0x30'),[exports['sequelize']['fn']('sum',exports[a2_0x52c7('0x5')][a2_0x52c7('0x38')](a2_0x52c7('0x39'))),a2_0x52c7('0x3a')]],'where':{'countingDate':{[exports['sequelize']['Op'][a2_0x52c7('0x3b')]]:_0x1111e4,[exports[a2_0x52c7('0x5')]['Op']['lt']]:_0x562b3e},'amount':_0x12514e[a2_0x52c7('0x3c')][a2_0x52c7('0x3d')]=='in'?{[exports[a2_0x52c7('0x5')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x52c7('0x5')][a2_0x52c7('0x3e')](a2_0x52c7('0x3f'))],'order':[[a2_0x52c7('0x30'),a2_0x52c7('0x31')]]})[a2_0x52c7('0x32')](_0x2a4f97=>{_0x4cf26d[a2_0x52c7('0x12')]({'data':_0x2a4f97});});};exports[a2_0x52c7('0x40')]=(_0x3d056f,_0x2a349b)=>{const _0x46b7d4=_0x3d056f['query'][a2_0x52c7('0x34')];const _0xad57e6=_0x3d056f['query']['startDate'];const _0x5efe10=_0x3d056f[a2_0x52c7('0x35')]['endDate'];exports[a2_0x52c7('0x5')][a2_0x52c7('0x1b')][a2_0x52c7('0x2c')][a2_0x52c7('0x2f')]({'attributes':[a2_0x52c7('0x30'),[exports['sequelize']['fn'](a2_0x52c7('0x41'),exports[a2_0x52c7('0x5')][a2_0x52c7('0x38')](a2_0x52c7('0x30')),a2_0x52c7('0x42')),'countingDateShort'],[exports['sequelize']['fn'](a2_0x52c7('0x43'),exports[a2_0x52c7('0x5')][a2_0x52c7('0x38')](a2_0x52c7('0x39'))),a2_0x52c7('0x3a')]],'where':{'countingDate':{[exports['sequelize']['Op'][a2_0x52c7('0x3b')]]:_0xad57e6,[exports['sequelize']['Op']['lt']]:_0x5efe10},'amount':_0x3d056f[a2_0x52c7('0x3c')][a2_0x52c7('0x3d')]=='in'?{[exports[a2_0x52c7('0x5')]['Op']['gt']]:0x0}:{[exports[a2_0x52c7('0x5')]['Op']['lt']]:0x0}},'group':[exports[a2_0x52c7('0x5')]['fn'](a2_0x52c7('0x44'),exports[a2_0x52c7('0x5')][a2_0x52c7('0x38')](a2_0x52c7('0x30'))),exports[a2_0x52c7('0x5')]['fn'](a2_0x52c7('0x45'),exports[a2_0x52c7('0x5')][a2_0x52c7('0x38')](a2_0x52c7('0x30'))),exports['sequelize']['fn'](a2_0x52c7('0x46'),exports[a2_0x52c7('0x5')]['col']('countingDate')),exports[a2_0x52c7('0x5')]['fn']('YEAR',exports['sequelize'][a2_0x52c7('0x38')](a2_0x52c7('0x30')))],'order':[[a2_0x52c7('0x30'),a2_0x52c7('0x31')]]})[a2_0x52c7('0x32')](_0x9c3719=>{_0x2a349b[a2_0x52c7('0x12')]({'data':_0x9c3719});});};exports[a2_0x52c7('0x47')]=(_0x19a04b,_0x200e07,_0x2ab7b1)=>{const _0x403d15=_0x19a04b['user']['tokens'][a2_0x52c7('0x48')](_0x403d15=>_0x403d15[a2_0x52c7('0x49')]===a2_0x52c7('0x4a'));fbgraph_1['default'][a2_0x52c7('0x4b')](_0x403d15[a2_0x52c7('0x4c')]);fbgraph_1[a2_0x52c7('0x23')][a2_0x52c7('0x4d')](_0x19a04b[a2_0x52c7('0x4e')][a2_0x52c7('0x4a')]+a2_0x52c7('0x4f'),(_0x1613f1,_0x36febe)=>{if(_0x1613f1){return _0x2ab7b1(_0x1613f1);}_0x200e07[a2_0x52c7('0x8')](a2_0x52c7('0x50'),{'title':'Facebook\x20API','profile':_0x36febe});});};
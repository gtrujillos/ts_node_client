var a2_0x674e=['gte','params','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','startDate','DATE_FORMAT','%Y-%m-%d\x20%H:00','amount','total','direction','HOUR','DAY','MONTH','YEAR','getFacebook','find','kind','facebook','setAccessToken','accessToken','user','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook','Facebook\x20API','defineProperty','__esModule','fbgraph','sequelize','setSequelize','getApi','API\x20Examples','syncFtp','log','default','ready','connected','list','colombia','Downloading:\x20','name','endsWith','json','models','report_files','findOrCreate','push','error','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','then','connected:','fileName','get','end','media/','.txt','pipe','createWriteStream','status','save','Downloaded:\x20','processFtp','readFile','utf8','Data','CountingInfo','Out','pass_counting','create','getPassCounting','findAll','countingDate','ASC','getPassCountingByDay','month','query','endDate','sum','col'];(function(_0x4f4005,_0x1cfc92){var _0x2bc1fb=function(_0x17bcdf){while(--_0x17bcdf){_0x4f4005['push'](_0x4f4005['shift']());}};_0x2bc1fb(++_0x1cfc92);}(a2_0x674e,0x116));var a2_0x1b50=function(_0x13240f,_0x392db5){_0x13240f=_0x13240f-0x0;var _0x4bd21f=a2_0x674e[_0x13240f];return _0x4bd21f;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x3f61dd){return _0x3f61dd&&_0x3f61dd['__esModule']?_0x3f61dd:{'default':_0x3f61dd};};Object[a2_0x1b50('0x0')](exports,a2_0x1b50('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x1b50('0x2')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));exports[a2_0x1b50('0x3')]='';function setSequelize(_0x24673e){exports[a2_0x1b50('0x3')]=_0x24673e;}exports[a2_0x1b50('0x4')]=setSequelize;exports[a2_0x1b50('0x5')]=(_0x1d41c8,_0x70b524)=>{_0x70b524['render']('api/index',{'title':a2_0x1b50('0x6')});};exports[a2_0x1b50('0x7')]=(_0x2a2529,_0x529200)=>{console[a2_0x1b50('0x8')]('connecting');const _0x23383d=[];const _0x2f94a8=new ftp_1[(a2_0x1b50('0x9'))]();_0x2f94a8['on'](a2_0x1b50('0xa'),function(){console[a2_0x1b50('0x8')](a2_0x1b50('0xb'));_0x2f94a8[a2_0x1b50('0xc')](a2_0x1b50('0xd'),![],function(_0xfc4670,_0x1646d4){if(_0xfc4670){}else{for(const _0x3fbe35 of _0x1646d4){console[a2_0x1b50('0x8')](a2_0x1b50('0xe')+_0x3fbe35['name']);if(_0x3fbe35[a2_0x1b50('0xf')][a2_0x1b50('0x10')](a2_0x1b50('0x11'))){exports[a2_0x1b50('0x3')][a2_0x1b50('0x12')][a2_0x1b50('0x13')][a2_0x1b50('0x14')]({'where':{'fileName':_0x3fbe35[a2_0x1b50('0xf')]}})['spread']((_0x51a0c4,_0x3f4a6d)=>{if(_0x3f4a6d){console['log'](_0x3fbe35['name']);_0x23383d[a2_0x1b50('0x15')](_0x51a0c4);}});}}}_0x529200[a2_0x1b50('0x11')]({'data':_0x23383d});});});_0x2f94a8['on'](a2_0x1b50('0x16'),function(_0x76ccdb){_0x529200['json']({'message':_0x76ccdb});});_0x2f94a8[a2_0x1b50('0x17')]({'host':a2_0x1b50('0x18'),'port':0x15,'user':'ipd','password':a2_0x1b50('0x19')});};exports[a2_0x1b50('0x1a')]=(_0x4b2c05,_0x325f54)=>{exports[a2_0x1b50('0x3')][a2_0x1b50('0x12')][a2_0x1b50('0x13')][a2_0x1b50('0x1b')]({'where':{'status':null}})[a2_0x1b50('0x1c')](_0x27be43=>{if(_0x27be43){const _0x1dde49=new ftp_1[(a2_0x1b50('0x9'))]();_0x1dde49['on'](a2_0x1b50('0xa'),function(){console[a2_0x1b50('0x8')](a2_0x1b50('0x1d')+_0x27be43[a2_0x1b50('0x1e')]);_0x1dde49[a2_0x1b50('0x1f')]('colombia/'+_0x27be43[a2_0x1b50('0x1e')],function(_0x8d132c,_0x142265){_0x1dde49[a2_0x1b50('0x20')]();if(_0x8d132c){}else{const _0x222e33=a2_0x1b50('0x21')+_0x27be43[a2_0x1b50('0x1e')]+a2_0x1b50('0x22');_0x142265[a2_0x1b50('0x23')](fs_1[a2_0x1b50('0x9')][a2_0x1b50('0x24')](_0x222e33));_0x27be43[a2_0x1b50('0x25')]=0x1;_0x27be43[a2_0x1b50('0x26')]();console['log'](a2_0x1b50('0x27')+_0x27be43['fileName']);}});});_0x1dde49['on']('error',function(_0x463bfb){_0x325f54[a2_0x1b50('0x11')]({'message':_0x463bfb});});_0x1dde49[a2_0x1b50('0x17')]({'host':'ftp.vivotek.com','port':0x15,'user':a2_0x1b50('0x19'),'password':a2_0x1b50('0x19')});_0x325f54[a2_0x1b50('0x11')]({'data':_0x27be43[a2_0x1b50('0x1e')]});}else{_0x325f54[a2_0x1b50('0x11')]({'data':[]});}});};exports[a2_0x1b50('0x28')]=(_0x49314a,_0x43a860)=>{exports[a2_0x1b50('0x3')][a2_0x1b50('0x12')][a2_0x1b50('0x13')][a2_0x1b50('0x1b')]({'where':{'status':0x1}})[a2_0x1b50('0x1c')](_0x2755d4=>{if(_0x2755d4){const _0x4f337f='media/'+_0x2755d4[a2_0x1b50('0x1e')]+a2_0x1b50('0x22');fs_1[a2_0x1b50('0x9')][a2_0x1b50('0x29')](_0x4f337f,a2_0x1b50('0x2a'),function(_0x3d90ed,_0x53795c){if(_0x3d90ed){_0x2755d4['status']=null;}else{try{const _0x33c2b1=JSON['parse'](_0x53795c);for(const _0xb99bbe of _0x33c2b1[a2_0x1b50('0x2b')][0x0][a2_0x1b50('0x2c')]){const _0x22ee70=_0xb99bbe['In'];const _0x5693c1=_0xb99bbe[a2_0x1b50('0x2d')];const _0x1b8b1d=Date['parse'](_0xb99bbe['EndTime']);if(_0x22ee70>0x0){exports[a2_0x1b50('0x3')][a2_0x1b50('0x12')][a2_0x1b50('0x2e')][a2_0x1b50('0x2f')]({'reportFileId':_0x2755d4['id'],'amount':_0x22ee70,'countingDate':_0x1b8b1d});}if(_0x5693c1>0x0){exports[a2_0x1b50('0x3')][a2_0x1b50('0x12')][a2_0x1b50('0x2e')][a2_0x1b50('0x2f')]({'reportFileId':_0x2755d4['id'],'amount':_0x5693c1*-0x1,'countingDate':_0x1b8b1d});}}_0x2755d4['status']=0x2;}catch(_0x46a38c){_0x2755d4[a2_0x1b50('0x25')]=null;}}_0x2755d4['save']();});_0x43a860[a2_0x1b50('0x11')]({'data':_0x2755d4[a2_0x1b50('0x1e')]});}else{_0x43a860[a2_0x1b50('0x11')]({'data':[]});}});};exports[a2_0x1b50('0x30')]=(_0x19a14d,_0x14493c)=>{exports[a2_0x1b50('0x3')]['models'][a2_0x1b50('0x2e')][a2_0x1b50('0x31')]({'where':{'amount':{[exports[a2_0x1b50('0x3')]['Op']['gt']]:0x0}},'order':[[a2_0x1b50('0x32'),a2_0x1b50('0x33')]]})[a2_0x1b50('0x1c')](_0x3dd612=>{_0x14493c[a2_0x1b50('0x11')]({'data':_0x3dd612});});};exports[a2_0x1b50('0x34')]=(_0x36efbd,_0xf2d2d9)=>{const _0x39405a=_0x36efbd['query'][a2_0x1b50('0x35')];const _0x5ca1dd=_0x36efbd['query']['startDate'];const _0x4d40ca=_0x36efbd[a2_0x1b50('0x36')][a2_0x1b50('0x37')];exports[a2_0x1b50('0x3')][a2_0x1b50('0x12')]['pass_counting'][a2_0x1b50('0x31')]({'attributes':[a2_0x1b50('0x32'),[exports[a2_0x1b50('0x3')]['fn'](a2_0x1b50('0x38'),exports[a2_0x1b50('0x3')][a2_0x1b50('0x39')]('amount')),'total']],'where':{'countingDate':{[exports[a2_0x1b50('0x3')]['Op'][a2_0x1b50('0x3a')]]:_0x5ca1dd,[exports[a2_0x1b50('0x3')]['Op']['lt']]:_0x4d40ca},'amount':_0x36efbd[a2_0x1b50('0x3b')]['direction']=='in'?{[exports[a2_0x1b50('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0x1b50('0x3')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a2_0x1b50('0x3c')](a2_0x1b50('0x3d'))],'order':[[a2_0x1b50('0x32'),'ASC']]})['then'](_0x1ef497=>{_0xf2d2d9[a2_0x1b50('0x11')]({'data':_0x1ef497});});};exports[a2_0x1b50('0x3e')]=(_0x5771af,_0xa24285)=>{const _0x3bc655=_0x5771af[a2_0x1b50('0x36')][a2_0x1b50('0x35')];const _0x4dd7a0=_0x5771af[a2_0x1b50('0x36')][a2_0x1b50('0x3f')];const _0x2b9fae=_0x5771af[a2_0x1b50('0x36')]['endDate'];exports[a2_0x1b50('0x3')][a2_0x1b50('0x12')][a2_0x1b50('0x2e')][a2_0x1b50('0x31')]({'attributes':[a2_0x1b50('0x32'),[exports[a2_0x1b50('0x3')]['fn'](a2_0x1b50('0x40'),exports[a2_0x1b50('0x3')][a2_0x1b50('0x39')]('countingDate'),a2_0x1b50('0x41')),'countingDateShort'],[exports[a2_0x1b50('0x3')]['fn'](a2_0x1b50('0x38'),exports[a2_0x1b50('0x3')][a2_0x1b50('0x39')](a2_0x1b50('0x42'))),a2_0x1b50('0x43')]],'where':{'countingDate':{[exports[a2_0x1b50('0x3')]['Op'][a2_0x1b50('0x3a')]]:_0x4dd7a0,[exports['sequelize']['Op']['lt']]:_0x2b9fae},'amount':_0x5771af[a2_0x1b50('0x3b')][a2_0x1b50('0x44')]=='in'?{[exports[a2_0x1b50('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0x1b50('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x1b50('0x3')]['fn'](a2_0x1b50('0x45'),exports[a2_0x1b50('0x3')][a2_0x1b50('0x39')](a2_0x1b50('0x32'))),exports['sequelize']['fn'](a2_0x1b50('0x46'),exports[a2_0x1b50('0x3')][a2_0x1b50('0x39')](a2_0x1b50('0x32'))),exports[a2_0x1b50('0x3')]['fn'](a2_0x1b50('0x47'),exports[a2_0x1b50('0x3')]['col']('countingDate')),exports['sequelize']['fn'](a2_0x1b50('0x48'),exports[a2_0x1b50('0x3')][a2_0x1b50('0x39')](a2_0x1b50('0x32')))],'order':[[a2_0x1b50('0x32'),'ASC']]})[a2_0x1b50('0x1c')](_0x863af2=>{_0xa24285[a2_0x1b50('0x11')]({'data':_0x863af2});});};exports[a2_0x1b50('0x49')]=(_0x2233a8,_0x21a470,_0x19fe47)=>{const _0x343cf8=_0x2233a8['user']['tokens'][a2_0x1b50('0x4a')](_0x343cf8=>_0x343cf8[a2_0x1b50('0x4b')]===a2_0x1b50('0x4c'));fbgraph_1[a2_0x1b50('0x9')][a2_0x1b50('0x4d')](_0x343cf8[a2_0x1b50('0x4e')]);fbgraph_1[a2_0x1b50('0x9')][a2_0x1b50('0x1f')](_0x2233a8[a2_0x1b50('0x4f')][a2_0x1b50('0x4c')]+a2_0x1b50('0x50'),(_0x400398,_0x268326)=>{if(_0x400398){return _0x19fe47(_0x400398);}_0x21a470[a2_0x1b50('0x51')](a2_0x1b50('0x52'),{'title':a2_0x1b50('0x53'),'profile':_0x268326});});};
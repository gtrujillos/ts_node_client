var a2_0x1adf=['API\x20Examples','log','default','ready','connected','list','colombia','Downloading:\x20','name','endsWith','json','report_files','findOrCreate','spread','push','ftp.vivotek.com','ipd','downloadFtp','models','findOne','then','connected:','fileName','get','colombia/','end','media/','.txt','pipe','createWriteStream','status','save','Downloaded:\x20','processFtp','utf8','parse','Data','CountingInfo','Out','EndTime','create','pass_counting','getPassCounting','countingDate','ASC','getPassCountingByDay','query','month','endDate','findAll','sum','col','amount','total','gte','params','direction','literal','getPassCountingByHour','startDate','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','HOUR','DAY','MONTH','YEAR','user','tokens','find','kind','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','__esModule','fbgraph','ftp','sequelize','getApi','render','api/index'];(function(_0xb67384,_0x27295a){var _0x156d7c=function(_0x52a1f8){while(--_0x52a1f8){_0xb67384['push'](_0xb67384['shift']());}};_0x156d7c(++_0x27295a);}(a2_0x1adf,0xa2));var a2_0x412a=function(_0x3dfea2,_0x4b7a65){_0x3dfea2=_0x3dfea2-0x0;var _0x28f159=a2_0x1adf[_0x3dfea2];return _0x28f159;};'use strict';var __importDefault=this&&this[a2_0x412a('0x0')]||function(_0x15c6d7){return _0x15c6d7&&_0x15c6d7['__esModule']?_0x15c6d7:{'default':_0x15c6d7};};Object['defineProperty'](exports,a2_0x412a('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x412a('0x2')));const ftp_1=__importDefault(require(a2_0x412a('0x3')));const fs_1=__importDefault(require('fs'));exports[a2_0x412a('0x4')]='';function setSequelize(_0x3070f8){exports[a2_0x412a('0x4')]=_0x3070f8;}exports['setSequelize']=setSequelize;exports[a2_0x412a('0x5')]=(_0x17b0bf,_0x587d34)=>{_0x587d34[a2_0x412a('0x6')](a2_0x412a('0x7'),{'title':a2_0x412a('0x8')});};exports['syncFtp']=(_0x1b6c91,_0x7d7655)=>{console[a2_0x412a('0x9')]('connecting');const _0x2d3bb7=[];const _0x533a68=new ftp_1[(a2_0x412a('0xa'))]();_0x533a68['on'](a2_0x412a('0xb'),function(){console[a2_0x412a('0x9')](a2_0x412a('0xc'));_0x533a68[a2_0x412a('0xd')](a2_0x412a('0xe'),![],function(_0x28a42e,_0x4c185c){if(_0x28a42e){}else{for(const _0x4c953c of _0x4c185c){console['log'](a2_0x412a('0xf')+_0x4c953c[a2_0x412a('0x10')]);if(_0x4c953c[a2_0x412a('0x10')][a2_0x412a('0x11')](a2_0x412a('0x12'))){exports[a2_0x412a('0x4')]['models'][a2_0x412a('0x13')][a2_0x412a('0x14')]({'where':{'fileName':_0x4c953c[a2_0x412a('0x10')]}})[a2_0x412a('0x15')]((_0x50bfab,_0x262083)=>{if(_0x262083){console[a2_0x412a('0x9')](_0x4c953c['name']);_0x2d3bb7[a2_0x412a('0x16')](_0x50bfab);}});}}}_0x7d7655[a2_0x412a('0x12')]({'data':_0x2d3bb7});});});_0x533a68['on']('error',function(_0x42ce9e){_0x7d7655[a2_0x412a('0x12')]({'message':_0x42ce9e});});_0x533a68['connect']({'host':a2_0x412a('0x17'),'port':0x15,'user':a2_0x412a('0x18'),'password':a2_0x412a('0x18')});};exports[a2_0x412a('0x19')]=(_0x19e59b,_0x882be2)=>{exports[a2_0x412a('0x4')][a2_0x412a('0x1a')][a2_0x412a('0x13')][a2_0x412a('0x1b')]({'where':{'status':null}})[a2_0x412a('0x1c')](_0x42242c=>{if(_0x42242c){const _0x3820c7=new ftp_1[(a2_0x412a('0xa'))]();_0x3820c7['on'](a2_0x412a('0xb'),function(){console['log'](a2_0x412a('0x1d')+_0x42242c[a2_0x412a('0x1e')]);_0x3820c7[a2_0x412a('0x1f')](a2_0x412a('0x20')+_0x42242c['fileName'],function(_0x3d5856,_0x1cad5d){_0x3820c7[a2_0x412a('0x21')]();if(_0x3d5856){}else{const _0x30d56a=a2_0x412a('0x22')+_0x42242c[a2_0x412a('0x1e')]+a2_0x412a('0x23');_0x1cad5d[a2_0x412a('0x24')](fs_1[a2_0x412a('0xa')][a2_0x412a('0x25')](_0x30d56a));_0x42242c[a2_0x412a('0x26')]=0x1;_0x42242c[a2_0x412a('0x27')]();console[a2_0x412a('0x9')](a2_0x412a('0x28')+_0x42242c[a2_0x412a('0x1e')]);}});});_0x3820c7['on']('error',function(_0x49cadc){_0x882be2[a2_0x412a('0x12')]({'message':_0x49cadc});});_0x3820c7['connect']({'host':a2_0x412a('0x17'),'port':0x15,'user':'ipd','password':a2_0x412a('0x18')});_0x882be2['json']({'data':_0x42242c[a2_0x412a('0x1e')]});}else{_0x882be2['json']({'data':[]});}});};exports[a2_0x412a('0x29')]=(_0x4a0199,_0x5a2adb)=>{exports['sequelize']['models'][a2_0x412a('0x13')]['findOne']({'where':{'status':0x1}})['then'](_0xe2c1b4=>{if(_0xe2c1b4){const _0x11deab='media/'+_0xe2c1b4['fileName']+a2_0x412a('0x23');fs_1[a2_0x412a('0xa')]['readFile'](_0x11deab,a2_0x412a('0x2a'),function(_0x2d0e2,_0x3f60fc){if(_0x2d0e2){_0xe2c1b4['status']=null;}else{try{const _0x5d49fd=JSON[a2_0x412a('0x2b')](_0x3f60fc);for(const _0x2c5652 of _0x5d49fd[a2_0x412a('0x2c')][0x0][a2_0x412a('0x2d')]){const _0x5391f6=_0x2c5652['In'];const _0x49c913=_0x2c5652[a2_0x412a('0x2e')];const _0x2e4282=Date['parse'](_0x2c5652[a2_0x412a('0x2f')]);if(_0x5391f6>0x0){exports[a2_0x412a('0x4')][a2_0x412a('0x1a')]['pass_counting'][a2_0x412a('0x30')]({'reportFileId':_0xe2c1b4['id'],'amount':_0x5391f6,'countingDate':_0x2e4282});}if(_0x49c913>0x0){exports['sequelize'][a2_0x412a('0x1a')][a2_0x412a('0x31')][a2_0x412a('0x30')]({'reportFileId':_0xe2c1b4['id'],'amount':_0x49c913*-0x1,'countingDate':_0x2e4282});}}_0xe2c1b4[a2_0x412a('0x26')]=0x2;}catch(_0x2bd5c1){_0xe2c1b4[a2_0x412a('0x26')]=null;}}_0xe2c1b4[a2_0x412a('0x27')]();});_0x5a2adb[a2_0x412a('0x12')]({'data':_0xe2c1b4[a2_0x412a('0x1e')]});}else{_0x5a2adb[a2_0x412a('0x12')]({'data':[]});}});};exports[a2_0x412a('0x32')]=(_0x2f8192,_0x5cc2a8)=>{exports[a2_0x412a('0x4')][a2_0x412a('0x1a')][a2_0x412a('0x31')]['findAll']({'where':{'amount':{[exports[a2_0x412a('0x4')]['Op']['gt']]:0x0}},'order':[[a2_0x412a('0x33'),a2_0x412a('0x34')]]})['then'](_0x4622cc=>{_0x5cc2a8[a2_0x412a('0x12')]({'data':_0x4622cc});});};exports[a2_0x412a('0x35')]=(_0x1de955,_0x413ec9)=>{const _0x10f243=_0x1de955[a2_0x412a('0x36')][a2_0x412a('0x37')];const _0x3d5ecb=_0x1de955[a2_0x412a('0x36')]['startDate'];const _0x153df2=_0x1de955[a2_0x412a('0x36')][a2_0x412a('0x38')];exports[a2_0x412a('0x4')]['models'][a2_0x412a('0x31')][a2_0x412a('0x39')]({'attributes':['countingDate',[exports[a2_0x412a('0x4')]['fn'](a2_0x412a('0x3a'),exports['sequelize'][a2_0x412a('0x3b')](a2_0x412a('0x3c'))),a2_0x412a('0x3d')]],'where':{'countingDate':{[exports[a2_0x412a('0x4')]['Op'][a2_0x412a('0x3e')]]:_0x3d5ecb,[exports[a2_0x412a('0x4')]['Op']['lt']]:_0x153df2},'amount':_0x1de955[a2_0x412a('0x3f')][a2_0x412a('0x40')]=='in'?{[exports[a2_0x412a('0x4')]['Op']['gt']]:0x0}:{[exports[a2_0x412a('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x412a('0x4')][a2_0x412a('0x41')]('YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))')],'order':[[a2_0x412a('0x33'),a2_0x412a('0x34')]]})[a2_0x412a('0x1c')](_0x2e4c44=>{_0x413ec9[a2_0x412a('0x12')]({'data':_0x2e4c44});});};exports[a2_0x412a('0x42')]=(_0x580df0,_0x312a49)=>{const _0x526bef=_0x580df0[a2_0x412a('0x36')][a2_0x412a('0x37')];const _0x2c7992=_0x580df0[a2_0x412a('0x36')][a2_0x412a('0x43')];const _0x566eb7=_0x580df0['query'][a2_0x412a('0x38')];exports[a2_0x412a('0x4')][a2_0x412a('0x1a')]['pass_counting'][a2_0x412a('0x39')]({'attributes':[a2_0x412a('0x33'),[exports[a2_0x412a('0x4')]['fn'](a2_0x412a('0x44'),exports['sequelize'][a2_0x412a('0x3b')](a2_0x412a('0x33')),a2_0x412a('0x45')),a2_0x412a('0x46')],[exports[a2_0x412a('0x4')]['fn'](a2_0x412a('0x3a'),exports[a2_0x412a('0x4')][a2_0x412a('0x3b')](a2_0x412a('0x3c'))),'total']],'where':{'countingDate':{[exports[a2_0x412a('0x4')]['Op']['gte']]:_0x2c7992,[exports[a2_0x412a('0x4')]['Op']['lt']]:_0x566eb7},'amount':_0x580df0[a2_0x412a('0x3f')][a2_0x412a('0x40')]=='in'?{[exports[a2_0x412a('0x4')]['Op']['gt']]:0x0}:{[exports[a2_0x412a('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x412a('0x4')]['fn'](a2_0x412a('0x47'),exports[a2_0x412a('0x4')][a2_0x412a('0x3b')](a2_0x412a('0x33'))),exports[a2_0x412a('0x4')]['fn'](a2_0x412a('0x48'),exports[a2_0x412a('0x4')][a2_0x412a('0x3b')]('countingDate')),exports['sequelize']['fn'](a2_0x412a('0x49'),exports[a2_0x412a('0x4')]['col'](a2_0x412a('0x33'))),exports[a2_0x412a('0x4')]['fn'](a2_0x412a('0x4a'),exports[a2_0x412a('0x4')][a2_0x412a('0x3b')]('countingDate'))],'order':[[a2_0x412a('0x33'),a2_0x412a('0x34')]]})['then'](_0x2e2d0e=>{_0x312a49[a2_0x412a('0x12')]({'data':_0x2e2d0e});});};exports['getFacebook']=(_0x100a35,_0x53699d,_0xa66376)=>{const _0x2e4dc9=_0x100a35[a2_0x412a('0x4b')][a2_0x412a('0x4c')][a2_0x412a('0x4d')](_0x2e4dc9=>_0x2e4dc9[a2_0x412a('0x4e')]===a2_0x412a('0x4f'));fbgraph_1[a2_0x412a('0xa')][a2_0x412a('0x50')](_0x2e4dc9[a2_0x412a('0x51')]);fbgraph_1[a2_0x412a('0xa')][a2_0x412a('0x1f')](_0x100a35[a2_0x412a('0x4b')][a2_0x412a('0x4f')]+a2_0x412a('0x52'),(_0x1fe354,_0x1940e3)=>{if(_0x1fe354){return _0xa66376(_0x1fe354);}_0x53699d[a2_0x412a('0x6')](a2_0x412a('0x53'),{'title':a2_0x412a('0x54'),'profile':_0x1940e3});});};
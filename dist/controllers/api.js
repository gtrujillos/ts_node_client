var a2_0x4c36=['?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__esModule','fbgraph','sequelize','render','api/index','API\x20Examples','syncFtp','log','connecting','default','ready','connected','list','Downloading:\x20','name','endsWith','json','models','report_files','push','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','then','connected:','fileName','get','colombia/','end','media/','pipe','createWriteStream','status','save','Downloaded:\x20','error','processFtp','.txt','readFile','parse','Data','CountingInfo','EndTime','create','pass_counting','findAll','countingDate','getPassCountingByDay','query','startDate','endDate','col','amount','total','gte','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','sum','params','HOUR','DAY','MONTH','YEAR','getFacebook','tokens','facebook','setAccessToken','accessToken','user'];(function(_0x35dc4,_0x4b4933){var _0x2e4f25=function(_0xacd772){while(--_0xacd772){_0x35dc4['push'](_0x35dc4['shift']());}};_0x2e4f25(++_0x4b4933);}(a2_0x4c36,0xf0));var a2_0x27ad=function(_0x162793,_0x131b11){_0x162793=_0x162793-0x0;var _0x22956e=a2_0x4c36[_0x162793];return _0x22956e;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x2076d3){return _0x2076d3&&_0x2076d3['__esModule']?_0x2076d3:{'default':_0x2076d3};};Object['defineProperty'](exports,a2_0x27ad('0x0'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x27ad('0x1')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));exports[a2_0x27ad('0x2')]='';function setSequelize(_0x5112c8){exports['sequelize']=_0x5112c8;}exports['setSequelize']=setSequelize;exports['getApi']=(_0x45de3e,_0x4ae174)=>{_0x4ae174[a2_0x27ad('0x3')](a2_0x27ad('0x4'),{'title':a2_0x27ad('0x5')});};exports[a2_0x27ad('0x6')]=(_0xccb93e,_0xdc9ce3)=>{console[a2_0x27ad('0x7')](a2_0x27ad('0x8'));const _0x283f04=[];const _0x5d9b58=new ftp_1[(a2_0x27ad('0x9'))]();_0x5d9b58['on'](a2_0x27ad('0xa'),function(){console[a2_0x27ad('0x7')](a2_0x27ad('0xb'));_0x5d9b58[a2_0x27ad('0xc')]('colombia',![],function(_0x42f7fd,_0x18db40){if(_0x42f7fd){}else{for(const _0x481a42 of _0x18db40){console['log'](a2_0x27ad('0xd')+_0x481a42[a2_0x27ad('0xe')]);if(_0x481a42[a2_0x27ad('0xe')][a2_0x27ad('0xf')](a2_0x27ad('0x10'))){exports[a2_0x27ad('0x2')][a2_0x27ad('0x11')][a2_0x27ad('0x12')]['findOrCreate']({'where':{'fileName':_0x481a42[a2_0x27ad('0xe')]}})['spread']((_0x2f46ff,_0x521034)=>{if(_0x521034){console[a2_0x27ad('0x7')](_0x481a42[a2_0x27ad('0xe')]);_0x283f04[a2_0x27ad('0x13')](_0x2f46ff);}});}}}_0xdc9ce3['json']({'data':_0x283f04});});});_0x5d9b58['on']('error',function(_0x42591b){_0xdc9ce3['json']({'message':_0x42591b});});_0x5d9b58[a2_0x27ad('0x14')]({'host':a2_0x27ad('0x15'),'port':0x15,'user':a2_0x27ad('0x16'),'password':a2_0x27ad('0x16')});};exports[a2_0x27ad('0x17')]=(_0x33df80,_0x28bab8)=>{exports[a2_0x27ad('0x2')]['models'][a2_0x27ad('0x12')][a2_0x27ad('0x18')]({'where':{'status':null}})[a2_0x27ad('0x19')](_0x1d3c22=>{if(_0x1d3c22){const _0x2bdf82=new ftp_1[(a2_0x27ad('0x9'))]();_0x2bdf82['on']('ready',function(){console['log'](a2_0x27ad('0x1a')+_0x1d3c22[a2_0x27ad('0x1b')]);_0x2bdf82[a2_0x27ad('0x1c')](a2_0x27ad('0x1d')+_0x1d3c22[a2_0x27ad('0x1b')],function(_0x403e7d,_0x32c9bc){_0x2bdf82[a2_0x27ad('0x1e')]();if(_0x403e7d){}else{const _0x3b87a2=a2_0x27ad('0x1f')+_0x1d3c22[a2_0x27ad('0x1b')]+'.txt';_0x32c9bc[a2_0x27ad('0x20')](fs_1[a2_0x27ad('0x9')][a2_0x27ad('0x21')](_0x3b87a2));_0x1d3c22[a2_0x27ad('0x22')]=0x1;_0x1d3c22[a2_0x27ad('0x23')]();console[a2_0x27ad('0x7')](a2_0x27ad('0x24')+_0x1d3c22[a2_0x27ad('0x1b')]);}});});_0x2bdf82['on'](a2_0x27ad('0x25'),function(_0x4a897f){_0x28bab8[a2_0x27ad('0x10')]({'message':_0x4a897f});});_0x2bdf82[a2_0x27ad('0x14')]({'host':'ftp.vivotek.com','port':0x15,'user':a2_0x27ad('0x16'),'password':a2_0x27ad('0x16')});_0x28bab8[a2_0x27ad('0x10')]({'data':_0x1d3c22['fileName']});}else{_0x28bab8[a2_0x27ad('0x10')]({'data':[]});}});};exports[a2_0x27ad('0x26')]=(_0x3d10fb,_0xf631f6)=>{exports['sequelize']['models'][a2_0x27ad('0x12')][a2_0x27ad('0x18')]({'where':{'status':0x1}})[a2_0x27ad('0x19')](_0x11085f=>{if(_0x11085f){const _0x57b8e9=a2_0x27ad('0x1f')+_0x11085f[a2_0x27ad('0x1b')]+a2_0x27ad('0x27');fs_1['default'][a2_0x27ad('0x28')](_0x57b8e9,'utf8',function(_0x42c656,_0x1e3875){if(_0x42c656){_0x11085f[a2_0x27ad('0x22')]=null;}else{try{const _0x519661=JSON[a2_0x27ad('0x29')](_0x1e3875);for(const _0x33cc64 of _0x519661[a2_0x27ad('0x2a')][0x0][a2_0x27ad('0x2b')]){const _0x2cb17d=_0x33cc64['In'];const _0x9436e3=_0x33cc64['Out'];const _0x534c10=Date[a2_0x27ad('0x29')](_0x33cc64[a2_0x27ad('0x2c')]);if(_0x2cb17d>0x0){exports['sequelize'][a2_0x27ad('0x11')]['pass_counting']['create']({'reportFileId':_0x11085f['id'],'amount':_0x2cb17d,'countingDate':_0x534c10});}if(_0x9436e3>0x0){exports['sequelize'][a2_0x27ad('0x11')]['pass_counting'][a2_0x27ad('0x2d')]({'reportFileId':_0x11085f['id'],'amount':_0x9436e3*-0x1,'countingDate':_0x534c10});}}_0x11085f[a2_0x27ad('0x22')]=0x2;}catch(_0x5e1d57){_0x11085f[a2_0x27ad('0x22')]=null;}}_0x11085f[a2_0x27ad('0x23')]();});_0xf631f6[a2_0x27ad('0x10')]({'data':_0x11085f[a2_0x27ad('0x1b')]});}else{_0xf631f6[a2_0x27ad('0x10')]({'data':[]});}});};exports['getPassCounting']=(_0x3abd96,_0x307aa8)=>{exports[a2_0x27ad('0x2')]['models'][a2_0x27ad('0x2e')][a2_0x27ad('0x2f')]({'where':{'amount':{[exports[a2_0x27ad('0x2')]['Op']['gt']]:0x0}},'order':[[a2_0x27ad('0x30'),'ASC']]})['then'](_0x2a9f4b=>{_0x307aa8[a2_0x27ad('0x10')]({'data':_0x2a9f4b});});};exports[a2_0x27ad('0x31')]=(_0x47486f,_0x3a238d)=>{const _0x5cd669=_0x47486f['query']['month'];const _0x596c2a=_0x47486f[a2_0x27ad('0x32')][a2_0x27ad('0x33')];const _0x5ef93e=_0x47486f['query'][a2_0x27ad('0x34')];exports[a2_0x27ad('0x2')][a2_0x27ad('0x11')][a2_0x27ad('0x2e')][a2_0x27ad('0x2f')]({'attributes':[a2_0x27ad('0x30'),[exports[a2_0x27ad('0x2')]['fn']('sum',exports['sequelize'][a2_0x27ad('0x35')](a2_0x27ad('0x36'))),a2_0x27ad('0x37')]],'where':{'countingDate':{[exports[a2_0x27ad('0x2')]['Op'][a2_0x27ad('0x38')]]:_0x596c2a,[exports[a2_0x27ad('0x2')]['Op']['lt']]:_0x5ef93e},'amount':_0x47486f['params'][a2_0x27ad('0x39')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x27ad('0x2')]['Op']['lt']]:0x0}},'group':[exports[a2_0x27ad('0x2')][a2_0x27ad('0x3a')](a2_0x27ad('0x3b'))],'order':[[a2_0x27ad('0x30'),a2_0x27ad('0x3c')]]})[a2_0x27ad('0x19')](_0x36778f=>{_0x3a238d[a2_0x27ad('0x10')]({'data':_0x36778f});});};exports['getPassCountingByHour']=(_0x51ea79,_0x52221a)=>{const _0x304bae=_0x51ea79[a2_0x27ad('0x32')]['month'];const _0x2a443a=_0x51ea79[a2_0x27ad('0x32')][a2_0x27ad('0x33')];const _0x32ade6=_0x51ea79['query'][a2_0x27ad('0x34')];exports[a2_0x27ad('0x2')][a2_0x27ad('0x11')][a2_0x27ad('0x2e')][a2_0x27ad('0x2f')]({'attributes':[a2_0x27ad('0x30'),[exports[a2_0x27ad('0x2')]['fn'](a2_0x27ad('0x3d'),exports[a2_0x27ad('0x2')]['col'](a2_0x27ad('0x30')),a2_0x27ad('0x3e')),a2_0x27ad('0x3f')],[exports[a2_0x27ad('0x2')]['fn'](a2_0x27ad('0x40'),exports[a2_0x27ad('0x2')]['col'](a2_0x27ad('0x36'))),a2_0x27ad('0x37')]],'where':{'countingDate':{[exports['sequelize']['Op'][a2_0x27ad('0x38')]]:_0x2a443a,[exports[a2_0x27ad('0x2')]['Op']['lt']]:_0x32ade6},'amount':_0x51ea79[a2_0x27ad('0x41')][a2_0x27ad('0x39')]=='in'?{[exports[a2_0x27ad('0x2')]['Op']['gt']]:0x0}:{[exports[a2_0x27ad('0x2')]['Op']['lt']]:0x0}},'group':[exports[a2_0x27ad('0x2')]['fn'](a2_0x27ad('0x42'),exports[a2_0x27ad('0x2')]['col'](a2_0x27ad('0x30'))),exports['sequelize']['fn'](a2_0x27ad('0x43'),exports[a2_0x27ad('0x2')][a2_0x27ad('0x35')]('countingDate')),exports[a2_0x27ad('0x2')]['fn'](a2_0x27ad('0x44'),exports[a2_0x27ad('0x2')][a2_0x27ad('0x35')](a2_0x27ad('0x30'))),exports['sequelize']['fn'](a2_0x27ad('0x45'),exports['sequelize'][a2_0x27ad('0x35')](a2_0x27ad('0x30')))],'order':[[a2_0x27ad('0x30'),a2_0x27ad('0x3c')]]})[a2_0x27ad('0x19')](_0x5dd098=>{_0x52221a[a2_0x27ad('0x10')]({'data':_0x5dd098});});};exports[a2_0x27ad('0x46')]=(_0x26b1dc,_0x401995,_0x1002e1)=>{const _0x29f3d0=_0x26b1dc['user'][a2_0x27ad('0x47')]['find'](_0x29f3d0=>_0x29f3d0['kind']===a2_0x27ad('0x48'));fbgraph_1[a2_0x27ad('0x9')][a2_0x27ad('0x49')](_0x29f3d0[a2_0x27ad('0x4a')]);fbgraph_1[a2_0x27ad('0x9')][a2_0x27ad('0x1c')](_0x26b1dc[a2_0x27ad('0x4b')][a2_0x27ad('0x48')]+a2_0x27ad('0x4c'),(_0x506b2f,_0x1a5592)=>{if(_0x506b2f){return _0x1002e1(_0x506b2f);}_0x401995['render'](a2_0x27ad('0x4d'),{'title':a2_0x27ad('0x4e'),'profile':_0x1a5592});});};
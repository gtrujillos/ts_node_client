var a2_0x272a=['tokens','kind','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','__importDefault','__esModule','fbgraph','ftp','sequelize','setSequelize','render','API\x20Examples','syncFtp','log','connecting','default','ready','Downloading:\x20','name','report_files','findOrCreate','spread','push','json','error','connect','ftp.vivotek.com','ipd','models','findOne','connected:','get','colombia/','fileName','end','media/','.txt','createWriteStream','status','save','Downloaded:\x20','processFtp','readFile','utf8','parse','Data','CountingInfo','Out','EndTime','pass_counting','create','getPassCounting','countingDate','ASC','month','query','startDate','findAll','sum','params','direction','then','getPassCountingByHour','DATE_FORMAT','col','%Y-%m-%d\x20%H:00','countingDateShort','amount','total','gte','DAY','getFacebook','user'];(function(_0x27045e,_0x52e46d){var _0x1415a3=function(_0x119ab5){while(--_0x119ab5){_0x27045e['push'](_0x27045e['shift']());}};_0x1415a3(++_0x52e46d);}(a2_0x272a,0x9f));var a2_0x29b5=function(_0x11162f,_0xd2b40e){_0x11162f=_0x11162f-0x0;var _0x5a27bb=a2_0x272a[_0x11162f];return _0x5a27bb;};'use strict';var __importDefault=this&&this[a2_0x29b5('0x0')]||function(_0x38e906){return _0x38e906&&_0x38e906[a2_0x29b5('0x1')]?_0x38e906:{'default':_0x38e906};};Object['defineProperty'](exports,a2_0x29b5('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x29b5('0x2')));const ftp_1=__importDefault(require(a2_0x29b5('0x3')));const fs_1=__importDefault(require('fs'));exports[a2_0x29b5('0x4')]='';function setSequelize(_0x39c230){exports[a2_0x29b5('0x4')]=_0x39c230;}exports[a2_0x29b5('0x5')]=setSequelize;exports['getApi']=(_0x507286,_0x3aced9)=>{_0x3aced9[a2_0x29b5('0x6')]('api/index',{'title':a2_0x29b5('0x7')});};exports[a2_0x29b5('0x8')]=(_0x454922,_0x6d03d0)=>{console[a2_0x29b5('0x9')](a2_0x29b5('0xa'));const _0x2afa72=[];const _0x1474f7=new ftp_1[(a2_0x29b5('0xb'))]();_0x1474f7['on'](a2_0x29b5('0xc'),function(){console['log']('connected');_0x1474f7['list']('colombia',![],function(_0x1e35e2,_0x276e9b){if(_0x1e35e2){}else{for(const _0xcdc174 of _0x276e9b){console[a2_0x29b5('0x9')](a2_0x29b5('0xd')+_0xcdc174[a2_0x29b5('0xe')]);if(_0xcdc174['name']['endsWith']('json')){exports['sequelize']['models'][a2_0x29b5('0xf')][a2_0x29b5('0x10')]({'where':{'fileName':_0xcdc174[a2_0x29b5('0xe')]}})[a2_0x29b5('0x11')]((_0x4ed79e,_0x56fa09)=>{if(_0x56fa09){console['log'](_0xcdc174['name']);_0x2afa72[a2_0x29b5('0x12')](_0x4ed79e);}});}}}_0x6d03d0[a2_0x29b5('0x13')]({'data':_0x2afa72});});});_0x1474f7['on'](a2_0x29b5('0x14'),function(_0x3b2bba){_0x6d03d0[a2_0x29b5('0x13')]({'message':_0x3b2bba});});_0x1474f7[a2_0x29b5('0x15')]({'host':a2_0x29b5('0x16'),'port':0x15,'user':a2_0x29b5('0x17'),'password':a2_0x29b5('0x17')});};exports['downloadFtp']=(_0xd80b64,_0xc78626)=>{exports[a2_0x29b5('0x4')][a2_0x29b5('0x18')][a2_0x29b5('0xf')][a2_0x29b5('0x19')]({'where':{'status':null}})['then'](_0x55de3b=>{if(_0x55de3b){const _0x529cad=new ftp_1[(a2_0x29b5('0xb'))]();_0x529cad['on'](a2_0x29b5('0xc'),function(){console[a2_0x29b5('0x9')](a2_0x29b5('0x1a')+_0x55de3b['fileName']);_0x529cad[a2_0x29b5('0x1b')](a2_0x29b5('0x1c')+_0x55de3b[a2_0x29b5('0x1d')],function(_0x5851eb,_0x54bd1e){_0x529cad[a2_0x29b5('0x1e')]();if(_0x5851eb){}else{const _0x108973=a2_0x29b5('0x1f')+_0x55de3b[a2_0x29b5('0x1d')]+a2_0x29b5('0x20');_0x54bd1e['pipe'](fs_1[a2_0x29b5('0xb')][a2_0x29b5('0x21')](_0x108973));_0x55de3b[a2_0x29b5('0x22')]=0x1;_0x55de3b[a2_0x29b5('0x23')]();console['log'](a2_0x29b5('0x24')+_0x55de3b[a2_0x29b5('0x1d')]);}});});_0x529cad['on'](a2_0x29b5('0x14'),function(_0x114ff9){_0xc78626[a2_0x29b5('0x13')]({'message':_0x114ff9});});_0x529cad[a2_0x29b5('0x15')]({'host':a2_0x29b5('0x16'),'port':0x15,'user':'ipd','password':a2_0x29b5('0x17')});_0xc78626[a2_0x29b5('0x13')]({'data':_0x55de3b[a2_0x29b5('0x1d')]});}else{_0xc78626[a2_0x29b5('0x13')]({'data':[]});}});};exports[a2_0x29b5('0x25')]=(_0x14dac3,_0x55684b)=>{exports['sequelize'][a2_0x29b5('0x18')][a2_0x29b5('0xf')][a2_0x29b5('0x19')]({'where':{'status':0x1}})['then'](_0xa24196=>{if(_0xa24196){const _0x25592b=a2_0x29b5('0x1f')+_0xa24196[a2_0x29b5('0x1d')]+'.txt';fs_1['default'][a2_0x29b5('0x26')](_0x25592b,a2_0x29b5('0x27'),function(_0x3edc22,_0xe961ad){if(_0x3edc22){_0xa24196[a2_0x29b5('0x22')]=null;}else{try{const _0x1a2a5c=JSON[a2_0x29b5('0x28')](_0xe961ad);for(const _0x40c0a7 of _0x1a2a5c[a2_0x29b5('0x29')][0x0][a2_0x29b5('0x2a')]){const _0xa713f0=_0x40c0a7['In'];const _0x32448b=_0x40c0a7[a2_0x29b5('0x2b')];const _0x45fa64=Date['parse'](_0x40c0a7[a2_0x29b5('0x2c')]);if(_0xa713f0>0x0){exports[a2_0x29b5('0x4')][a2_0x29b5('0x18')][a2_0x29b5('0x2d')]['create']({'reportFileId':_0xa24196['id'],'amount':_0xa713f0,'countingDate':_0x45fa64});}if(_0x32448b>0x0){exports[a2_0x29b5('0x4')][a2_0x29b5('0x18')][a2_0x29b5('0x2d')][a2_0x29b5('0x2e')]({'reportFileId':_0xa24196['id'],'amount':_0x32448b*-0x1,'countingDate':_0x45fa64});}}_0xa24196[a2_0x29b5('0x22')]=0x2;}catch(_0x5550b7){_0xa24196[a2_0x29b5('0x22')]=null;}}_0xa24196['save']();});_0x55684b['json']({'data':_0xa24196[a2_0x29b5('0x1d')]});}else{_0x55684b[a2_0x29b5('0x13')]({'data':[]});}});};exports[a2_0x29b5('0x2f')]=(_0x37714d,_0x1a4aeb)=>{exports[a2_0x29b5('0x4')][a2_0x29b5('0x18')]['pass_counting']['findAll']({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a2_0x29b5('0x30'),a2_0x29b5('0x31')]]})['then'](_0x346a04=>{_0x1a4aeb[a2_0x29b5('0x13')]({'data':_0x346a04});});};exports['getPassCountingByDay']=(_0x5a7641,_0x700675)=>{const _0x31c57e=_0x5a7641['query'][a2_0x29b5('0x32')];const _0x54705e=_0x5a7641[a2_0x29b5('0x33')][a2_0x29b5('0x34')];const _0xcaa484=_0x5a7641[a2_0x29b5('0x33')]['endDate'];exports[a2_0x29b5('0x4')][a2_0x29b5('0x18')][a2_0x29b5('0x2d')][a2_0x29b5('0x35')]({'attributes':[a2_0x29b5('0x30'),[exports[a2_0x29b5('0x4')]['fn'](a2_0x29b5('0x36'),exports[a2_0x29b5('0x4')]['col']('amount')),'total']],'where':{'countingDate':{[exports[a2_0x29b5('0x4')]['Op']['gte']]:_0x54705e,[exports[a2_0x29b5('0x4')]['Op']['lt']]:_0xcaa484},'amount':_0x5a7641[a2_0x29b5('0x37')][a2_0x29b5('0x38')]=='in'?{[exports[a2_0x29b5('0x4')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x29b5('0x4')]['literal']('YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))')],'order':[[a2_0x29b5('0x30'),a2_0x29b5('0x31')]]})[a2_0x29b5('0x39')](_0x446c89=>{_0x700675['json']({'data':_0x446c89});});};exports[a2_0x29b5('0x3a')]=(_0x251e1c,_0x39852a)=>{const _0x1ef892=_0x251e1c['query'][a2_0x29b5('0x32')];const _0x3833a3=_0x251e1c['query'][a2_0x29b5('0x34')];const _0x100ff6=_0x251e1c[a2_0x29b5('0x33')]['endDate'];exports[a2_0x29b5('0x4')]['models']['pass_counting']['findAll']({'attributes':[a2_0x29b5('0x30'),[exports['sequelize']['fn'](a2_0x29b5('0x3b'),exports[a2_0x29b5('0x4')][a2_0x29b5('0x3c')](a2_0x29b5('0x30')),a2_0x29b5('0x3d')),a2_0x29b5('0x3e')],[exports[a2_0x29b5('0x4')]['fn']('sum',exports[a2_0x29b5('0x4')][a2_0x29b5('0x3c')](a2_0x29b5('0x3f'))),a2_0x29b5('0x40')]],'where':{'countingDate':{[exports[a2_0x29b5('0x4')]['Op'][a2_0x29b5('0x41')]]:_0x3833a3,[exports['sequelize']['Op']['lt']]:_0x100ff6},'amount':_0x251e1c['params'][a2_0x29b5('0x38')]=='in'?{[exports[a2_0x29b5('0x4')]['Op']['gt']]:0x0}:{[exports[a2_0x29b5('0x4')]['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn']('HOUR',exports[a2_0x29b5('0x4')][a2_0x29b5('0x3c')](a2_0x29b5('0x30'))),exports['sequelize']['fn'](a2_0x29b5('0x42'),exports[a2_0x29b5('0x4')]['col']('countingDate')),exports[a2_0x29b5('0x4')]['fn']('MONTH',exports[a2_0x29b5('0x4')]['col'](a2_0x29b5('0x30'))),exports[a2_0x29b5('0x4')]['fn']('YEAR',exports['sequelize'][a2_0x29b5('0x3c')](a2_0x29b5('0x30')))],'order':[[a2_0x29b5('0x30'),a2_0x29b5('0x31')]]})[a2_0x29b5('0x39')](_0x327b12=>{_0x39852a[a2_0x29b5('0x13')]({'data':_0x327b12});});};exports[a2_0x29b5('0x43')]=(_0x5cccbf,_0x24b5f5,_0x5d6fd5)=>{const _0x116a11=_0x5cccbf[a2_0x29b5('0x44')][a2_0x29b5('0x45')]['find'](_0x116a11=>_0x116a11[a2_0x29b5('0x46')]===a2_0x29b5('0x47'));fbgraph_1[a2_0x29b5('0xb')][a2_0x29b5('0x48')](_0x116a11[a2_0x29b5('0x49')]);fbgraph_1[a2_0x29b5('0xb')][a2_0x29b5('0x1b')](_0x5cccbf['user']['facebook']+a2_0x29b5('0x4a'),(_0x1933e6,_0x10e51f)=>{if(_0x1933e6){return _0x5d6fd5(_0x1933e6);}_0x24b5f5['render'](a2_0x29b5('0x4b'),{'title':'Facebook\x20API','profile':_0x10e51f});});};
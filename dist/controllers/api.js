var a2_0x502e=['save','Downloaded:\x20','findOne','readFile','utf8','parse','Data','CountingInfo','Out','EndTime','pass_counting','create','getPassCounting','findAll','countingDate','ASC','getPassCountingByDay','query','month','endDate','sum','col','amount','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','startDate','%Y-%m-%d\x20%H:00','countingDateShort','total','HOUR','DAY','MONTH','user','tokens','find','kind','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','__importDefault','__esModule','defineProperty','fbgraph','sequelize','setSequelize','render','api/index','API\x20Examples','syncFtp','log','default','ready','list','colombia','Downloading:\x20','name','json','models','report_files','findOrCreate','push','error','connect','ipd','downloadFtp','then','connected:','fileName','get','colombia/','end','media/','pipe','createWriteStream','status'];(function(_0x6b990,_0x4d7613){var _0x5004fe=function(_0x2d74f7){while(--_0x2d74f7){_0x6b990['push'](_0x6b990['shift']());}};_0x5004fe(++_0x4d7613);}(a2_0x502e,0xcf));var a2_0x1035=function(_0x270aa5,_0x5a3aed){_0x270aa5=_0x270aa5-0x0;var _0x174cff=a2_0x502e[_0x270aa5];return _0x174cff;};'use strict';var __importDefault=this&&this[a2_0x1035('0x0')]||function(_0x30a8c7){return _0x30a8c7&&_0x30a8c7[a2_0x1035('0x1')]?_0x30a8c7:{'default':_0x30a8c7};};Object[a2_0x1035('0x2')](exports,a2_0x1035('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x1035('0x3')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));exports[a2_0x1035('0x4')]='';function setSequelize(_0x1cf969){exports['sequelize']=_0x1cf969;}exports[a2_0x1035('0x5')]=setSequelize;exports['getApi']=(_0x541619,_0x181e64)=>{_0x181e64[a2_0x1035('0x6')](a2_0x1035('0x7'),{'title':a2_0x1035('0x8')});};exports[a2_0x1035('0x9')]=(_0x563b79,_0x5969ab)=>{console[a2_0x1035('0xa')]('connecting');const _0x5e2591=[];const _0x15c8ba=new ftp_1[(a2_0x1035('0xb'))]();_0x15c8ba['on'](a2_0x1035('0xc'),function(){console[a2_0x1035('0xa')]('connected');_0x15c8ba[a2_0x1035('0xd')](a2_0x1035('0xe'),![],function(_0x4d9a49,_0x1cdb92){if(_0x4d9a49){}else{for(const _0x55639f of _0x1cdb92){console[a2_0x1035('0xa')](a2_0x1035('0xf')+_0x55639f[a2_0x1035('0x10')]);if(_0x55639f[a2_0x1035('0x10')]['endsWith'](a2_0x1035('0x11'))){exports[a2_0x1035('0x4')][a2_0x1035('0x12')][a2_0x1035('0x13')][a2_0x1035('0x14')]({'where':{'fileName':_0x55639f['name']}})['spread']((_0x529265,_0x59c22e)=>{if(_0x59c22e){console[a2_0x1035('0xa')](_0x55639f[a2_0x1035('0x10')]);_0x5e2591[a2_0x1035('0x15')](_0x529265);}});}}}_0x5969ab['json']({'data':_0x5e2591});});});_0x15c8ba['on'](a2_0x1035('0x16'),function(_0x117fa9){_0x5969ab['json']({'message':_0x117fa9});});_0x15c8ba[a2_0x1035('0x17')]({'host':'ftp.vivotek.com','port':0x15,'user':a2_0x1035('0x18'),'password':a2_0x1035('0x18')});};exports[a2_0x1035('0x19')]=(_0x13ce5a,_0x470087)=>{exports[a2_0x1035('0x4')][a2_0x1035('0x12')][a2_0x1035('0x13')]['findOne']({'where':{'status':null}})[a2_0x1035('0x1a')](_0x4292ce=>{if(_0x4292ce){const _0x4fef5e=new ftp_1['default']();_0x4fef5e['on'](a2_0x1035('0xc'),function(){console['log'](a2_0x1035('0x1b')+_0x4292ce[a2_0x1035('0x1c')]);_0x4fef5e[a2_0x1035('0x1d')](a2_0x1035('0x1e')+_0x4292ce[a2_0x1035('0x1c')],function(_0x22bf81,_0x57d9da){_0x4fef5e[a2_0x1035('0x1f')]();if(_0x22bf81){}else{const _0xff25d=a2_0x1035('0x20')+_0x4292ce[a2_0x1035('0x1c')]+'.txt';_0x57d9da[a2_0x1035('0x21')](fs_1['default'][a2_0x1035('0x22')](_0xff25d));_0x4292ce[a2_0x1035('0x23')]=0x1;_0x4292ce[a2_0x1035('0x24')]();console[a2_0x1035('0xa')](a2_0x1035('0x25')+_0x4292ce[a2_0x1035('0x1c')]);}});});_0x4fef5e['on'](a2_0x1035('0x16'),function(_0x39042a){_0x470087[a2_0x1035('0x11')]({'message':_0x39042a});});_0x4fef5e[a2_0x1035('0x17')]({'host':'ftp.vivotek.com','port':0x15,'user':'ipd','password':a2_0x1035('0x18')});_0x470087['json']({'data':_0x4292ce['fileName']});}else{_0x470087[a2_0x1035('0x11')]({'data':[]});}});};exports['processFtp']=(_0x2c7414,_0x1c0731)=>{exports['sequelize']['models'][a2_0x1035('0x13')][a2_0x1035('0x26')]({'where':{'status':0x1}})['then'](_0x46fbd5=>{if(_0x46fbd5){const _0x470fb6=a2_0x1035('0x20')+_0x46fbd5['fileName']+'.txt';fs_1[a2_0x1035('0xb')][a2_0x1035('0x27')](_0x470fb6,a2_0x1035('0x28'),function(_0x3ea1bd,_0x460ccf){if(_0x3ea1bd){_0x46fbd5[a2_0x1035('0x23')]=null;}else{try{const _0x2c2978=JSON[a2_0x1035('0x29')](_0x460ccf);for(const _0x34612a of _0x2c2978[a2_0x1035('0x2a')][0x0][a2_0x1035('0x2b')]){const _0x2a94a5=_0x34612a['In'];const _0x3c7d4d=_0x34612a[a2_0x1035('0x2c')];const _0x733d8a=Date[a2_0x1035('0x29')](_0x34612a[a2_0x1035('0x2d')]);if(_0x2a94a5>0x0){exports[a2_0x1035('0x4')][a2_0x1035('0x12')][a2_0x1035('0x2e')][a2_0x1035('0x2f')]({'reportFileId':_0x46fbd5['id'],'amount':_0x2a94a5,'countingDate':_0x733d8a});}if(_0x3c7d4d>0x0){exports[a2_0x1035('0x4')]['models'][a2_0x1035('0x2e')][a2_0x1035('0x2f')]({'reportFileId':_0x46fbd5['id'],'amount':_0x3c7d4d*-0x1,'countingDate':_0x733d8a});}}_0x46fbd5[a2_0x1035('0x23')]=0x2;}catch(_0x510021){_0x46fbd5[a2_0x1035('0x23')]=null;}}_0x46fbd5[a2_0x1035('0x24')]();});_0x1c0731[a2_0x1035('0x11')]({'data':_0x46fbd5[a2_0x1035('0x1c')]});}else{_0x1c0731['json']({'data':[]});}});};exports[a2_0x1035('0x30')]=(_0x298f92,_0xce501)=>{exports[a2_0x1035('0x4')][a2_0x1035('0x12')][a2_0x1035('0x2e')][a2_0x1035('0x31')]({'where':{'amount':{[exports[a2_0x1035('0x4')]['Op']['gt']]:0x0}},'order':[[a2_0x1035('0x32'),a2_0x1035('0x33')]]})[a2_0x1035('0x1a')](_0x453ee4=>{_0xce501['json']({'data':_0x453ee4});});};exports[a2_0x1035('0x34')]=(_0x3d0958,_0x3b22b3)=>{const _0x55b43b=_0x3d0958[a2_0x1035('0x35')][a2_0x1035('0x36')];const _0x2813d6=_0x3d0958[a2_0x1035('0x35')]['startDate'];const _0x222362=_0x3d0958['query'][a2_0x1035('0x37')];exports['sequelize']['models'][a2_0x1035('0x2e')][a2_0x1035('0x31')]({'attributes':[a2_0x1035('0x32'),[exports['sequelize']['fn'](a2_0x1035('0x38'),exports[a2_0x1035('0x4')][a2_0x1035('0x39')](a2_0x1035('0x3a'))),'total']],'where':{'countingDate':{[exports[a2_0x1035('0x4')]['Op'][a2_0x1035('0x3b')]]:_0x2813d6,[exports[a2_0x1035('0x4')]['Op']['lt']]:_0x222362},'amount':_0x3d0958[a2_0x1035('0x3c')][a2_0x1035('0x3d')]=='in'?{[exports[a2_0x1035('0x4')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x1035('0x4')][a2_0x1035('0x3e')](a2_0x1035('0x3f'))],'order':[[a2_0x1035('0x32'),a2_0x1035('0x33')]]})[a2_0x1035('0x1a')](_0x47dd04=>{_0x3b22b3[a2_0x1035('0x11')]({'data':_0x47dd04});});};exports[a2_0x1035('0x40')]=(_0x48ebfc,_0x5e280c)=>{const _0x1a16b7=_0x48ebfc[a2_0x1035('0x35')]['month'];const _0x4f8bcf=_0x48ebfc[a2_0x1035('0x35')][a2_0x1035('0x41')];const _0x266d71=_0x48ebfc[a2_0x1035('0x35')][a2_0x1035('0x37')];exports[a2_0x1035('0x4')][a2_0x1035('0x12')][a2_0x1035('0x2e')][a2_0x1035('0x31')]({'attributes':[a2_0x1035('0x32'),[exports['sequelize']['fn']('DATE_FORMAT',exports['sequelize'][a2_0x1035('0x39')](a2_0x1035('0x32')),a2_0x1035('0x42')),a2_0x1035('0x43')],[exports[a2_0x1035('0x4')]['fn'](a2_0x1035('0x38'),exports['sequelize'][a2_0x1035('0x39')](a2_0x1035('0x3a'))),a2_0x1035('0x44')]],'where':{'countingDate':{[exports[a2_0x1035('0x4')]['Op']['gte']]:_0x4f8bcf,[exports[a2_0x1035('0x4')]['Op']['lt']]:_0x266d71},'amount':_0x48ebfc['params']['direction']=='in'?{[exports[a2_0x1035('0x4')]['Op']['gt']]:0x0}:{[exports[a2_0x1035('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x1035('0x4')]['fn'](a2_0x1035('0x45'),exports[a2_0x1035('0x4')][a2_0x1035('0x39')](a2_0x1035('0x32'))),exports[a2_0x1035('0x4')]['fn'](a2_0x1035('0x46'),exports[a2_0x1035('0x4')][a2_0x1035('0x39')](a2_0x1035('0x32'))),exports['sequelize']['fn'](a2_0x1035('0x47'),exports['sequelize'][a2_0x1035('0x39')]('countingDate')),exports['sequelize']['fn']('YEAR',exports[a2_0x1035('0x4')]['col']('countingDate'))],'order':[['countingDate',a2_0x1035('0x33')]]})[a2_0x1035('0x1a')](_0x1a9ce4=>{_0x5e280c[a2_0x1035('0x11')]({'data':_0x1a9ce4});});};exports['getFacebook']=(_0x5e23e5,_0xb6734e,_0x27d39b)=>{const _0x10a186=_0x5e23e5[a2_0x1035('0x48')][a2_0x1035('0x49')][a2_0x1035('0x4a')](_0x10a186=>_0x10a186[a2_0x1035('0x4b')]===a2_0x1035('0x4c'));fbgraph_1[a2_0x1035('0xb')][a2_0x1035('0x4d')](_0x10a186[a2_0x1035('0x4e')]);fbgraph_1[a2_0x1035('0xb')][a2_0x1035('0x1d')](_0x5e23e5[a2_0x1035('0x48')][a2_0x1035('0x4c')]+a2_0x1035('0x4f'),(_0xc89dbc,_0x1be40d)=>{if(_0xc89dbc){return _0x27d39b(_0xc89dbc);}_0xb6734e['render'](a2_0x1035('0x50'),{'title':'Facebook\x20API','profile':_0x1be40d});});};
var a2_0x155b=['direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','DATE_FORMAT','%Y-%m-%d\x20%H:00','DAY','MONTH','YEAR','getFacebook','user','find','setAccessToken','facebook','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','__esModule','defineProperty','fbgraph','ftp','sequelize','setSequelize','getApi','render','api/index','API\x20Examples','syncFtp','log','connecting','ready','list','colombia','Downloading:\x20','name','endsWith','json','models','report_files','findOrCreate','push','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','default','get','colombia/','fileName','end','media/','.txt','pipe','createWriteStream','Downloaded:\x20','processFtp','then','utf8','status','parse','Data','CountingInfo','Out','pass_counting','create','save','getPassCounting','findAll','countingDate','ASC','getPassCountingByDay','query','month','startDate','endDate','sum','col','amount','total','gte','params'];(function(_0x533001,_0x45f9e8){var _0x21f53e=function(_0x4879cb){while(--_0x4879cb){_0x533001['push'](_0x533001['shift']());}};_0x21f53e(++_0x45f9e8);}(a2_0x155b,0x10a));var a2_0x576b=function(_0x121d5,_0x33cb01){_0x121d5=_0x121d5-0x0;var _0x4b6dc1=a2_0x155b[_0x121d5];return _0x4b6dc1;};'use strict';var __importDefault=this&&this[a2_0x576b('0x0')]||function(_0x427aab){return _0x427aab&&_0x427aab[a2_0x576b('0x1')]?_0x427aab:{'default':_0x427aab};};Object[a2_0x576b('0x2')](exports,a2_0x576b('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x576b('0x3')));const ftp_1=__importDefault(require(a2_0x576b('0x4')));const fs_1=__importDefault(require('fs'));exports[a2_0x576b('0x5')]='';function setSequelize(_0x27b2a4){exports[a2_0x576b('0x5')]=_0x27b2a4;}exports[a2_0x576b('0x6')]=setSequelize;exports[a2_0x576b('0x7')]=(_0x571a12,_0x4b60e3)=>{_0x4b60e3[a2_0x576b('0x8')](a2_0x576b('0x9'),{'title':a2_0x576b('0xa')});};exports[a2_0x576b('0xb')]=(_0x3348e0,_0x4b0838)=>{console[a2_0x576b('0xc')](a2_0x576b('0xd'));const _0x13c03d=[];const _0x1a11bf=new ftp_1['default']();_0x1a11bf['on'](a2_0x576b('0xe'),function(){console[a2_0x576b('0xc')]('connected');_0x1a11bf[a2_0x576b('0xf')](a2_0x576b('0x10'),![],function(_0x181e8b,_0x2477aa){if(_0x181e8b){}else{for(const _0x1cb2ba of _0x2477aa){console[a2_0x576b('0xc')](a2_0x576b('0x11')+_0x1cb2ba[a2_0x576b('0x12')]);if(_0x1cb2ba[a2_0x576b('0x12')][a2_0x576b('0x13')](a2_0x576b('0x14'))){exports[a2_0x576b('0x5')][a2_0x576b('0x15')][a2_0x576b('0x16')][a2_0x576b('0x17')]({'where':{'fileName':_0x1cb2ba[a2_0x576b('0x12')]}})['spread']((_0x388b99,_0x455989)=>{if(_0x455989){console['log'](_0x1cb2ba[a2_0x576b('0x12')]);_0x13c03d[a2_0x576b('0x18')](_0x388b99);}});}}}_0x4b0838['json']({'data':_0x13c03d});});});_0x1a11bf['on']('error',function(_0x316f2c){_0x4b0838[a2_0x576b('0x14')]({'message':_0x316f2c});});_0x1a11bf[a2_0x576b('0x19')]({'host':a2_0x576b('0x1a'),'port':0x15,'user':a2_0x576b('0x1b'),'password':a2_0x576b('0x1b')});};exports[a2_0x576b('0x1c')]=(_0x5624b5,_0x1bcea9)=>{exports[a2_0x576b('0x5')]['models'][a2_0x576b('0x16')][a2_0x576b('0x1d')]({'where':{'status':null}})['then'](_0x3b0562=>{if(_0x3b0562){const _0x8ec527=new ftp_1[(a2_0x576b('0x1e'))]();_0x8ec527['on'](a2_0x576b('0xe'),function(){console[a2_0x576b('0xc')]('connected:'+_0x3b0562['fileName']);_0x8ec527[a2_0x576b('0x1f')](a2_0x576b('0x20')+_0x3b0562[a2_0x576b('0x21')],function(_0x3f0f90,_0x2ff4a1){_0x8ec527[a2_0x576b('0x22')]();if(_0x3f0f90){}else{const _0x2ae956=a2_0x576b('0x23')+_0x3b0562[a2_0x576b('0x21')]+a2_0x576b('0x24');_0x2ff4a1[a2_0x576b('0x25')](fs_1[a2_0x576b('0x1e')][a2_0x576b('0x26')](_0x2ae956));_0x3b0562['status']=0x1;_0x3b0562['save']();console[a2_0x576b('0xc')](a2_0x576b('0x27')+_0x3b0562['fileName']);}});});_0x8ec527['on']('error',function(_0x4b6c72){_0x1bcea9[a2_0x576b('0x14')]({'message':_0x4b6c72});});_0x8ec527[a2_0x576b('0x19')]({'host':a2_0x576b('0x1a'),'port':0x15,'user':a2_0x576b('0x1b'),'password':a2_0x576b('0x1b')});_0x1bcea9[a2_0x576b('0x14')]({'data':_0x3b0562[a2_0x576b('0x21')]});}else{_0x1bcea9[a2_0x576b('0x14')]({'data':[]});}});};exports[a2_0x576b('0x28')]=(_0x6e5dc8,_0x84d182)=>{exports[a2_0x576b('0x5')]['models'][a2_0x576b('0x16')][a2_0x576b('0x1d')]({'where':{'status':0x1}})[a2_0x576b('0x29')](_0x5aa3e6=>{if(_0x5aa3e6){const _0x13d74b=a2_0x576b('0x23')+_0x5aa3e6[a2_0x576b('0x21')]+a2_0x576b('0x24');fs_1[a2_0x576b('0x1e')]['readFile'](_0x13d74b,a2_0x576b('0x2a'),function(_0x582025,_0x12336f){if(_0x582025){_0x5aa3e6[a2_0x576b('0x2b')]=null;}else{try{const _0x5f5d5d=JSON[a2_0x576b('0x2c')](_0x12336f);for(const _0x4cd927 of _0x5f5d5d[a2_0x576b('0x2d')][0x0][a2_0x576b('0x2e')]){const _0x1fcd7d=_0x4cd927['In'];const _0x453326=_0x4cd927[a2_0x576b('0x2f')];const _0x189a46=Date['parse'](_0x4cd927['EndTime']);if(_0x1fcd7d>0x0){exports[a2_0x576b('0x5')][a2_0x576b('0x15')][a2_0x576b('0x30')][a2_0x576b('0x31')]({'reportFileId':_0x5aa3e6['id'],'amount':_0x1fcd7d,'countingDate':_0x189a46});}if(_0x453326>0x0){exports[a2_0x576b('0x5')]['models'][a2_0x576b('0x30')]['create']({'reportFileId':_0x5aa3e6['id'],'amount':_0x453326*-0x1,'countingDate':_0x189a46});}}_0x5aa3e6['status']=0x2;}catch(_0x3373e4){_0x5aa3e6['status']=null;}}_0x5aa3e6[a2_0x576b('0x32')]();});_0x84d182['json']({'data':_0x5aa3e6[a2_0x576b('0x21')]});}else{_0x84d182[a2_0x576b('0x14')]({'data':[]});}});};exports[a2_0x576b('0x33')]=(_0x85ebcd,_0x27565c)=>{exports[a2_0x576b('0x5')]['models'][a2_0x576b('0x30')][a2_0x576b('0x34')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a2_0x576b('0x35'),a2_0x576b('0x36')]]})[a2_0x576b('0x29')](_0x2f584f=>{_0x27565c[a2_0x576b('0x14')]({'data':_0x2f584f});});};exports[a2_0x576b('0x37')]=(_0x4c5c92,_0x1ccfb3)=>{const _0x376b58=_0x4c5c92[a2_0x576b('0x38')][a2_0x576b('0x39')];const _0x265083=_0x4c5c92[a2_0x576b('0x38')][a2_0x576b('0x3a')];const _0x384868=_0x4c5c92['query'][a2_0x576b('0x3b')];exports[a2_0x576b('0x5')][a2_0x576b('0x15')][a2_0x576b('0x30')]['findAll']({'attributes':[a2_0x576b('0x35'),[exports[a2_0x576b('0x5')]['fn'](a2_0x576b('0x3c'),exports[a2_0x576b('0x5')][a2_0x576b('0x3d')](a2_0x576b('0x3e'))),a2_0x576b('0x3f')]],'where':{'countingDate':{[exports[a2_0x576b('0x5')]['Op'][a2_0x576b('0x40')]]:_0x265083,[exports[a2_0x576b('0x5')]['Op']['lt']]:_0x384868},'amount':_0x4c5c92[a2_0x576b('0x41')][a2_0x576b('0x42')]=='in'?{[exports[a2_0x576b('0x5')]['Op']['gt']]:0x0}:{[exports[a2_0x576b('0x5')]['Op']['lt']]:0x0}},'group':[exports[a2_0x576b('0x5')][a2_0x576b('0x43')](a2_0x576b('0x44'))],'order':[[a2_0x576b('0x35'),a2_0x576b('0x36')]]})[a2_0x576b('0x29')](_0x20b953=>{_0x1ccfb3[a2_0x576b('0x14')]({'data':_0x20b953});});};exports[a2_0x576b('0x45')]=(_0x5a346c,_0x3aa95d)=>{const _0x2f1316=_0x5a346c['query'][a2_0x576b('0x39')];const _0x39e9ec=_0x5a346c[a2_0x576b('0x38')][a2_0x576b('0x3a')];const _0x2c734e=_0x5a346c['query']['endDate'];exports[a2_0x576b('0x5')][a2_0x576b('0x15')][a2_0x576b('0x30')][a2_0x576b('0x34')]({'attributes':['countingDate',[exports['sequelize']['fn'](a2_0x576b('0x46'),exports[a2_0x576b('0x5')]['col'](a2_0x576b('0x35')),a2_0x576b('0x47')),'countingDateShort'],[exports[a2_0x576b('0x5')]['fn'](a2_0x576b('0x3c'),exports[a2_0x576b('0x5')][a2_0x576b('0x3d')]('amount')),a2_0x576b('0x3f')]],'where':{'countingDate':{[exports['sequelize']['Op']['gte']]:_0x39e9ec,[exports[a2_0x576b('0x5')]['Op']['lt']]:_0x2c734e},'amount':_0x5a346c[a2_0x576b('0x41')][a2_0x576b('0x42')]=='in'?{[exports[a2_0x576b('0x5')]['Op']['gt']]:0x0}:{[exports[a2_0x576b('0x5')]['Op']['lt']]:0x0}},'group':[exports[a2_0x576b('0x5')]['fn']('HOUR',exports[a2_0x576b('0x5')][a2_0x576b('0x3d')](a2_0x576b('0x35'))),exports[a2_0x576b('0x5')]['fn'](a2_0x576b('0x48'),exports[a2_0x576b('0x5')][a2_0x576b('0x3d')](a2_0x576b('0x35'))),exports[a2_0x576b('0x5')]['fn'](a2_0x576b('0x49'),exports['sequelize'][a2_0x576b('0x3d')](a2_0x576b('0x35'))),exports[a2_0x576b('0x5')]['fn'](a2_0x576b('0x4a'),exports[a2_0x576b('0x5')][a2_0x576b('0x3d')](a2_0x576b('0x35')))],'order':[['countingDate',a2_0x576b('0x36')]]})['then'](_0x3ce100=>{_0x3aa95d[a2_0x576b('0x14')]({'data':_0x3ce100});});};exports[a2_0x576b('0x4b')]=(_0xf691b8,_0x9f2016,_0x3da97d)=>{const _0x36db71=_0xf691b8[a2_0x576b('0x4c')]['tokens'][a2_0x576b('0x4d')](_0x36db71=>_0x36db71['kind']==='facebook');fbgraph_1[a2_0x576b('0x1e')][a2_0x576b('0x4e')](_0x36db71['accessToken']);fbgraph_1[a2_0x576b('0x1e')]['get'](_0xf691b8['user'][a2_0x576b('0x4f')]+a2_0x576b('0x50'),(_0x2479a5,_0x3b82f6)=>{if(_0x2479a5){return _0x3da97d(_0x2479a5);}_0x9f2016[a2_0x576b('0x8')](a2_0x576b('0x51'),{'title':a2_0x576b('0x52'),'profile':_0x3b82f6});});};
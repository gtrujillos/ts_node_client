var a2_0x173a=['Data','CountingInfo','Out','EndTime','pass_counting','create','save','getPassCounting','findAll','countingDate','ASC','query','startDate','endDate','sum','total','gte','params','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','month','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','col','direction','HOUR','DAY','MONTH','YEAR','getFacebook','user','tokens','find','facebook','setAccessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','__esModule','sequelize','setSequelize','getApi','render','api/index','syncFtp','connecting','log','connected','list','colombia','Downloading:\x20','name','endsWith','json','models','findOrCreate','spread','push','error','ftp.vivotek.com','ipd','downloadFtp','report_files','findOne','then','default','ready','connected:','fileName','end','.txt','pipe','createWriteStream','status','connect','processFtp','utf8'];(function(_0x344472,_0x5f588f){var _0x6b2975=function(_0x864d9e){while(--_0x864d9e){_0x344472['push'](_0x344472['shift']());}};_0x6b2975(++_0x5f588f);}(a2_0x173a,0x118));var a2_0x16e3=function(_0x9d2bab,_0x24b275){_0x9d2bab=_0x9d2bab-0x0;var _0x4cc3a3=a2_0x173a[_0x9d2bab];return _0x4cc3a3;};'use strict';var __importDefault=this&&this[a2_0x16e3('0x0')]||function(_0x6d168e){return _0x6d168e&&_0x6d168e[a2_0x16e3('0x1')]?_0x6d168e:{'default':_0x6d168e};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));exports['sequelize']='';function setSequelize(_0x3ff765){exports[a2_0x16e3('0x2')]=_0x3ff765;}exports[a2_0x16e3('0x3')]=setSequelize;exports[a2_0x16e3('0x4')]=(_0x150877,_0x20e25f)=>{_0x20e25f[a2_0x16e3('0x5')](a2_0x16e3('0x6'),{'title':'API\x20Examples'});};exports[a2_0x16e3('0x7')]=(_0x5cdb65,_0x282bda)=>{console['log'](a2_0x16e3('0x8'));const _0xcba1c4=[];const _0x5e3571=new ftp_1['default']();_0x5e3571['on']('ready',function(){console[a2_0x16e3('0x9')](a2_0x16e3('0xa'));_0x5e3571[a2_0x16e3('0xb')](a2_0x16e3('0xc'),![],function(_0x369798,_0x2ba0d2){if(_0x369798){}else{for(const _0x13372c of _0x2ba0d2){console[a2_0x16e3('0x9')](a2_0x16e3('0xd')+_0x13372c['name']);if(_0x13372c[a2_0x16e3('0xe')][a2_0x16e3('0xf')](a2_0x16e3('0x10'))){exports[a2_0x16e3('0x2')][a2_0x16e3('0x11')]['report_files'][a2_0x16e3('0x12')]({'where':{'fileName':_0x13372c[a2_0x16e3('0xe')]}})[a2_0x16e3('0x13')]((_0x3c0b22,_0x936103)=>{if(_0x936103){console[a2_0x16e3('0x9')](_0x13372c['name']);_0xcba1c4[a2_0x16e3('0x14')](_0x3c0b22);}});}}}_0x282bda['json']({'data':_0xcba1c4});});});_0x5e3571['on'](a2_0x16e3('0x15'),function(_0x56fdc6){_0x282bda[a2_0x16e3('0x10')]({'message':_0x56fdc6});});_0x5e3571['connect']({'host':a2_0x16e3('0x16'),'port':0x15,'user':'ipd','password':a2_0x16e3('0x17')});};exports[a2_0x16e3('0x18')]=(_0x1d3d67,_0xa260ed)=>{exports[a2_0x16e3('0x2')][a2_0x16e3('0x11')][a2_0x16e3('0x19')][a2_0x16e3('0x1a')]({'where':{'status':null}})[a2_0x16e3('0x1b')](_0x1e161f=>{if(_0x1e161f){const _0x5dda5f=new ftp_1[(a2_0x16e3('0x1c'))]();_0x5dda5f['on'](a2_0x16e3('0x1d'),function(){console[a2_0x16e3('0x9')](a2_0x16e3('0x1e')+_0x1e161f[a2_0x16e3('0x1f')]);_0x5dda5f['get']('colombia/'+_0x1e161f[a2_0x16e3('0x1f')],function(_0xfd0dd5,_0x4f455b){_0x5dda5f[a2_0x16e3('0x20')]();if(_0xfd0dd5){}else{const _0x4a85a3='media/'+_0x1e161f[a2_0x16e3('0x1f')]+a2_0x16e3('0x21');_0x4f455b[a2_0x16e3('0x22')](fs_1[a2_0x16e3('0x1c')][a2_0x16e3('0x23')](_0x4a85a3));_0x1e161f[a2_0x16e3('0x24')]=0x1;_0x1e161f['save']();console['log']('Downloaded:\x20'+_0x1e161f[a2_0x16e3('0x1f')]);}});});_0x5dda5f['on'](a2_0x16e3('0x15'),function(_0x3f5b68){_0xa260ed[a2_0x16e3('0x10')]({'message':_0x3f5b68});});_0x5dda5f[a2_0x16e3('0x25')]({'host':a2_0x16e3('0x16'),'port':0x15,'user':a2_0x16e3('0x17'),'password':a2_0x16e3('0x17')});_0xa260ed[a2_0x16e3('0x10')]({'data':_0x1e161f[a2_0x16e3('0x1f')]});}else{_0xa260ed[a2_0x16e3('0x10')]({'data':[]});}});};exports[a2_0x16e3('0x26')]=(_0x2c6c33,_0x322fc3)=>{exports['sequelize']['models'][a2_0x16e3('0x19')][a2_0x16e3('0x1a')]({'where':{'status':0x1}})['then'](_0x226a9b=>{if(_0x226a9b){const _0x40444a='media/'+_0x226a9b[a2_0x16e3('0x1f')]+a2_0x16e3('0x21');fs_1[a2_0x16e3('0x1c')]['readFile'](_0x40444a,a2_0x16e3('0x27'),function(_0x3b2bf4,_0x489840){if(_0x3b2bf4){_0x226a9b[a2_0x16e3('0x24')]=null;}else{try{const _0x402326=JSON['parse'](_0x489840);for(const _0x11cb93 of _0x402326[a2_0x16e3('0x28')][0x0][a2_0x16e3('0x29')]){const _0x2758f0=_0x11cb93['In'];const _0x1e34b6=_0x11cb93[a2_0x16e3('0x2a')];const _0xe332=Date['parse'](_0x11cb93[a2_0x16e3('0x2b')]);if(_0x2758f0>0x0){exports['sequelize']['models'][a2_0x16e3('0x2c')][a2_0x16e3('0x2d')]({'reportFileId':_0x226a9b['id'],'amount':_0x2758f0,'countingDate':_0xe332});}if(_0x1e34b6>0x0){exports[a2_0x16e3('0x2')]['models'][a2_0x16e3('0x2c')][a2_0x16e3('0x2d')]({'reportFileId':_0x226a9b['id'],'amount':_0x1e34b6*-0x1,'countingDate':_0xe332});}}_0x226a9b[a2_0x16e3('0x24')]=0x2;}catch(_0x5bf415){_0x226a9b[a2_0x16e3('0x24')]=null;}}_0x226a9b[a2_0x16e3('0x2e')]();});_0x322fc3[a2_0x16e3('0x10')]({'data':_0x226a9b[a2_0x16e3('0x1f')]});}else{_0x322fc3['json']({'data':[]});}});};exports[a2_0x16e3('0x2f')]=(_0x409461,_0x2508b4)=>{exports[a2_0x16e3('0x2')][a2_0x16e3('0x11')][a2_0x16e3('0x2c')][a2_0x16e3('0x30')]({'where':{'amount':{[exports[a2_0x16e3('0x2')]['Op']['gt']]:0x0}},'order':[[a2_0x16e3('0x31'),a2_0x16e3('0x32')]]})['then'](_0x2342a5=>{_0x2508b4[a2_0x16e3('0x10')]({'data':_0x2342a5});});};exports['getPassCountingByDay']=(_0x59218d,_0x49208e)=>{const _0x3f3b25=_0x59218d[a2_0x16e3('0x33')]['month'];const _0x589431=_0x59218d[a2_0x16e3('0x33')][a2_0x16e3('0x34')];const _0x3e7e59=_0x59218d[a2_0x16e3('0x33')][a2_0x16e3('0x35')];exports['sequelize']['models'][a2_0x16e3('0x2c')]['findAll']({'attributes':[a2_0x16e3('0x31'),[exports['sequelize']['fn'](a2_0x16e3('0x36'),exports['sequelize']['col']('amount')),a2_0x16e3('0x37')]],'where':{'countingDate':{[exports[a2_0x16e3('0x2')]['Op'][a2_0x16e3('0x38')]]:_0x589431,[exports[a2_0x16e3('0x2')]['Op']['lt']]:_0x3e7e59},'amount':_0x59218d[a2_0x16e3('0x39')]['direction']=='in'?{[exports[a2_0x16e3('0x2')]['Op']['gt']]:0x0}:{[exports[a2_0x16e3('0x2')]['Op']['lt']]:0x0}},'group':[exports[a2_0x16e3('0x2')][a2_0x16e3('0x3a')](a2_0x16e3('0x3b'))],'order':[['countingDate',a2_0x16e3('0x32')]]})[a2_0x16e3('0x1b')](_0x24f4ba=>{_0x49208e[a2_0x16e3('0x10')]({'data':_0x24f4ba});});};exports[a2_0x16e3('0x3c')]=(_0x2e43b5,_0x535de7)=>{const _0x2f04ef=_0x2e43b5[a2_0x16e3('0x33')][a2_0x16e3('0x3d')];const _0x3948ef=_0x2e43b5[a2_0x16e3('0x33')][a2_0x16e3('0x34')];const _0xc073f0=_0x2e43b5[a2_0x16e3('0x33')][a2_0x16e3('0x35')];exports[a2_0x16e3('0x2')][a2_0x16e3('0x11')][a2_0x16e3('0x2c')][a2_0x16e3('0x30')]({'attributes':[a2_0x16e3('0x31'),[exports['sequelize']['fn'](a2_0x16e3('0x3e'),exports[a2_0x16e3('0x2')]['col'](a2_0x16e3('0x31')),a2_0x16e3('0x3f')),a2_0x16e3('0x40')],[exports['sequelize']['fn'](a2_0x16e3('0x36'),exports[a2_0x16e3('0x2')][a2_0x16e3('0x41')]('amount')),'total']],'where':{'countingDate':{[exports[a2_0x16e3('0x2')]['Op'][a2_0x16e3('0x38')]]:_0x3948ef,[exports['sequelize']['Op']['lt']]:_0xc073f0},'amount':_0x2e43b5[a2_0x16e3('0x39')][a2_0x16e3('0x42')]=='in'?{[exports[a2_0x16e3('0x2')]['Op']['gt']]:0x0}:{[exports[a2_0x16e3('0x2')]['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a2_0x16e3('0x43'),exports[a2_0x16e3('0x2')][a2_0x16e3('0x41')](a2_0x16e3('0x31'))),exports['sequelize']['fn'](a2_0x16e3('0x44'),exports['sequelize'][a2_0x16e3('0x41')]('countingDate')),exports['sequelize']['fn'](a2_0x16e3('0x45'),exports[a2_0x16e3('0x2')]['col'](a2_0x16e3('0x31'))),exports[a2_0x16e3('0x2')]['fn'](a2_0x16e3('0x46'),exports[a2_0x16e3('0x2')]['col'](a2_0x16e3('0x31')))],'order':[['countingDate',a2_0x16e3('0x32')]]})[a2_0x16e3('0x1b')](_0x19762a=>{_0x535de7[a2_0x16e3('0x10')]({'data':_0x19762a});});};exports[a2_0x16e3('0x47')]=(_0x16c9cb,_0x414df9,_0x35c934)=>{const _0x504080=_0x16c9cb[a2_0x16e3('0x48')][a2_0x16e3('0x49')][a2_0x16e3('0x4a')](_0x504080=>_0x504080['kind']===a2_0x16e3('0x4b'));fbgraph_1['default'][a2_0x16e3('0x4c')](_0x504080['accessToken']);fbgraph_1['default']['get'](_0x16c9cb[a2_0x16e3('0x48')][a2_0x16e3('0x4b')]+a2_0x16e3('0x4d'),(_0x54913c,_0x9e371)=>{if(_0x54913c){return _0x35c934(_0x54913c);}_0x414df9[a2_0x16e3('0x5')](a2_0x16e3('0x4e'),{'title':a2_0x16e3('0x4f'),'profile':_0x9e371});});};
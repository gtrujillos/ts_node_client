var a2_0x26f7=['params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','HOUR','DAY','YEAR','getFacebook','user','tokens','find','kind','setAccessToken','get','facebook','api/facebook','Facebook\x20API','__importDefault','defineProperty','fbgraph','ftp','sequelize','getApi','render','api/index','API\x20Examples','syncFtp','connecting','default','ready','connected','colombia','log','Downloading:\x20','name','endsWith','models','report_files','findOrCreate','spread','push','error','json','ftp.vivotek.com','ipd','downloadFtp','findOne','then','connected:','fileName','colombia/','end','media/','.txt','createWriteStream','status','save','Downloaded:\x20','processFtp','parse','CountingInfo','Out','EndTime','pass_counting','create','findAll','countingDate','ASC','query','month','startDate','endDate','sum','col','amount','total','gte'];(function(_0x2699a9,_0x501e82){var _0x5b6c40=function(_0xa3de42){while(--_0xa3de42){_0x2699a9['push'](_0x2699a9['shift']());}};_0x5b6c40(++_0x501e82);}(a2_0x26f7,0x66));var a2_0x5424=function(_0x403cfa,_0x316ea5){_0x403cfa=_0x403cfa-0x0;var _0x46b9ad=a2_0x26f7[_0x403cfa];return _0x46b9ad;};'use strict';var __importDefault=this&&this[a2_0x5424('0x0')]||function(_0x15e924){return _0x15e924&&_0x15e924['__esModule']?_0x15e924:{'default':_0x15e924};};Object[a2_0x5424('0x1')](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x5424('0x2')));const ftp_1=__importDefault(require(a2_0x5424('0x3')));const fs_1=__importDefault(require('fs'));exports[a2_0x5424('0x4')]='';function setSequelize(_0x4ba512){exports[a2_0x5424('0x4')]=_0x4ba512;}exports['setSequelize']=setSequelize;exports[a2_0x5424('0x5')]=(_0x14986d,_0x31da80)=>{_0x31da80[a2_0x5424('0x6')](a2_0x5424('0x7'),{'title':a2_0x5424('0x8')});};exports[a2_0x5424('0x9')]=(_0x26138e,_0x3fc89d)=>{console['log'](a2_0x5424('0xa'));const _0x238f2a=[];const _0x3c3392=new ftp_1[(a2_0x5424('0xb'))]();_0x3c3392['on'](a2_0x5424('0xc'),function(){console['log'](a2_0x5424('0xd'));_0x3c3392['list'](a2_0x5424('0xe'),![],function(_0x2a8576,_0x34724e){if(_0x2a8576){}else{for(const _0xdbb322 of _0x34724e){console[a2_0x5424('0xf')](a2_0x5424('0x10')+_0xdbb322[a2_0x5424('0x11')]);if(_0xdbb322[a2_0x5424('0x11')][a2_0x5424('0x12')]('json')){exports['sequelize'][a2_0x5424('0x13')][a2_0x5424('0x14')][a2_0x5424('0x15')]({'where':{'fileName':_0xdbb322[a2_0x5424('0x11')]}})[a2_0x5424('0x16')]((_0x4887fc,_0x210a52)=>{if(_0x210a52){console[a2_0x5424('0xf')](_0xdbb322[a2_0x5424('0x11')]);_0x238f2a[a2_0x5424('0x17')](_0x4887fc);}});}}}_0x3fc89d['json']({'data':_0x238f2a});});});_0x3c3392['on'](a2_0x5424('0x18'),function(_0x407ef0){_0x3fc89d[a2_0x5424('0x19')]({'message':_0x407ef0});});_0x3c3392['connect']({'host':a2_0x5424('0x1a'),'port':0x15,'user':a2_0x5424('0x1b'),'password':a2_0x5424('0x1b')});};exports[a2_0x5424('0x1c')]=(_0x1beccd,_0x209d30)=>{exports[a2_0x5424('0x4')][a2_0x5424('0x13')][a2_0x5424('0x14')][a2_0x5424('0x1d')]({'where':{'status':null}})[a2_0x5424('0x1e')](_0x3c030e=>{if(_0x3c030e){const _0x188f6a=new ftp_1[(a2_0x5424('0xb'))]();_0x188f6a['on'](a2_0x5424('0xc'),function(){console[a2_0x5424('0xf')](a2_0x5424('0x1f')+_0x3c030e[a2_0x5424('0x20')]);_0x188f6a['get'](a2_0x5424('0x21')+_0x3c030e[a2_0x5424('0x20')],function(_0x4cd11e,_0x499891){_0x188f6a[a2_0x5424('0x22')]();if(_0x4cd11e){}else{const _0x222038=a2_0x5424('0x23')+_0x3c030e[a2_0x5424('0x20')]+a2_0x5424('0x24');_0x499891['pipe'](fs_1[a2_0x5424('0xb')][a2_0x5424('0x25')](_0x222038));_0x3c030e[a2_0x5424('0x26')]=0x1;_0x3c030e[a2_0x5424('0x27')]();console['log'](a2_0x5424('0x28')+_0x3c030e['fileName']);}});});_0x188f6a['on']('error',function(_0x26a3a6){_0x209d30[a2_0x5424('0x19')]({'message':_0x26a3a6});});_0x188f6a['connect']({'host':'ftp.vivotek.com','port':0x15,'user':a2_0x5424('0x1b'),'password':a2_0x5424('0x1b')});_0x209d30['json']({'data':_0x3c030e[a2_0x5424('0x20')]});}else{_0x209d30[a2_0x5424('0x19')]({'data':[]});}});};exports[a2_0x5424('0x29')]=(_0x2474fc,_0x54873b)=>{exports[a2_0x5424('0x4')]['models'][a2_0x5424('0x14')][a2_0x5424('0x1d')]({'where':{'status':0x1}})[a2_0x5424('0x1e')](_0x4bb833=>{if(_0x4bb833){const _0x165259=a2_0x5424('0x23')+_0x4bb833['fileName']+a2_0x5424('0x24');fs_1[a2_0x5424('0xb')]['readFile'](_0x165259,'utf8',function(_0x43e703,_0x339e50){if(_0x43e703){_0x4bb833[a2_0x5424('0x26')]=null;}else{try{const _0x66300d=JSON[a2_0x5424('0x2a')](_0x339e50);for(const _0x13ff41 of _0x66300d['Data'][0x0][a2_0x5424('0x2b')]){const _0x1a3739=_0x13ff41['In'];const _0x928694=_0x13ff41[a2_0x5424('0x2c')];const _0x404f2b=Date[a2_0x5424('0x2a')](_0x13ff41[a2_0x5424('0x2d')]);if(_0x1a3739>0x0){exports[a2_0x5424('0x4')][a2_0x5424('0x13')][a2_0x5424('0x2e')]['create']({'reportFileId':_0x4bb833['id'],'amount':_0x1a3739,'countingDate':_0x404f2b});}if(_0x928694>0x0){exports['sequelize'][a2_0x5424('0x13')][a2_0x5424('0x2e')][a2_0x5424('0x2f')]({'reportFileId':_0x4bb833['id'],'amount':_0x928694*-0x1,'countingDate':_0x404f2b});}}_0x4bb833['status']=0x2;}catch(_0x3ea9d0){_0x4bb833[a2_0x5424('0x26')]=null;}}_0x4bb833['save']();});_0x54873b[a2_0x5424('0x19')]({'data':_0x4bb833[a2_0x5424('0x20')]});}else{_0x54873b[a2_0x5424('0x19')]({'data':[]});}});};exports['getPassCounting']=(_0x4addc4,_0xd8b70b)=>{exports[a2_0x5424('0x4')]['models'][a2_0x5424('0x2e')][a2_0x5424('0x30')]({'where':{'amount':{[exports[a2_0x5424('0x4')]['Op']['gt']]:0x0}},'order':[[a2_0x5424('0x31'),a2_0x5424('0x32')]]})[a2_0x5424('0x1e')](_0x367044=>{_0xd8b70b[a2_0x5424('0x19')]({'data':_0x367044});});};exports['getPassCountingByDay']=(_0x221f34,_0x1736df)=>{const _0x581e48=_0x221f34[a2_0x5424('0x33')][a2_0x5424('0x34')];const _0x38605a=_0x221f34[a2_0x5424('0x33')][a2_0x5424('0x35')];const _0x20a790=_0x221f34[a2_0x5424('0x33')][a2_0x5424('0x36')];exports[a2_0x5424('0x4')][a2_0x5424('0x13')][a2_0x5424('0x2e')][a2_0x5424('0x30')]({'attributes':[a2_0x5424('0x31'),[exports[a2_0x5424('0x4')]['fn'](a2_0x5424('0x37'),exports[a2_0x5424('0x4')][a2_0x5424('0x38')](a2_0x5424('0x39'))),a2_0x5424('0x3a')]],'where':{'countingDate':{[exports[a2_0x5424('0x4')]['Op'][a2_0x5424('0x3b')]]:_0x38605a,[exports[a2_0x5424('0x4')]['Op']['lt']]:_0x20a790},'amount':_0x221f34[a2_0x5424('0x3c')][a2_0x5424('0x3d')]=='in'?{[exports[a2_0x5424('0x4')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports['sequelize'][a2_0x5424('0x3e')](a2_0x5424('0x3f'))],'order':[['countingDate',a2_0x5424('0x32')]]})[a2_0x5424('0x1e')](_0x57163e=>{_0x1736df[a2_0x5424('0x19')]({'data':_0x57163e});});};exports[a2_0x5424('0x40')]=(_0x33a5c7,_0x4d9726)=>{const _0x23f8c8=_0x33a5c7[a2_0x5424('0x33')][a2_0x5424('0x34')];const _0x5c4863=_0x33a5c7[a2_0x5424('0x33')][a2_0x5424('0x35')];const _0x392734=_0x33a5c7[a2_0x5424('0x33')]['endDate'];exports[a2_0x5424('0x4')][a2_0x5424('0x13')][a2_0x5424('0x2e')][a2_0x5424('0x30')]({'attributes':[a2_0x5424('0x31'),[exports[a2_0x5424('0x4')]['fn'](a2_0x5424('0x41'),exports[a2_0x5424('0x4')][a2_0x5424('0x38')](a2_0x5424('0x31')),a2_0x5424('0x42')),a2_0x5424('0x43')],[exports[a2_0x5424('0x4')]['fn'](a2_0x5424('0x37'),exports[a2_0x5424('0x4')][a2_0x5424('0x38')](a2_0x5424('0x39'))),a2_0x5424('0x3a')]],'where':{'countingDate':{[exports[a2_0x5424('0x4')]['Op'][a2_0x5424('0x3b')]]:_0x5c4863,[exports['sequelize']['Op']['lt']]:_0x392734},'amount':_0x33a5c7[a2_0x5424('0x3c')]['direction']=='in'?{[exports[a2_0x5424('0x4')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x5424('0x4')]['fn'](a2_0x5424('0x44'),exports[a2_0x5424('0x4')][a2_0x5424('0x38')](a2_0x5424('0x31'))),exports[a2_0x5424('0x4')]['fn'](a2_0x5424('0x45'),exports[a2_0x5424('0x4')]['col'](a2_0x5424('0x31'))),exports[a2_0x5424('0x4')]['fn']('MONTH',exports[a2_0x5424('0x4')]['col'](a2_0x5424('0x31'))),exports['sequelize']['fn'](a2_0x5424('0x46'),exports[a2_0x5424('0x4')][a2_0x5424('0x38')](a2_0x5424('0x31')))],'order':[[a2_0x5424('0x31'),a2_0x5424('0x32')]]})[a2_0x5424('0x1e')](_0x2fbdf4=>{_0x4d9726[a2_0x5424('0x19')]({'data':_0x2fbdf4});});};exports[a2_0x5424('0x47')]=(_0x3887c5,_0x193d5e,_0x4bbb8e)=>{const _0x5c2915=_0x3887c5[a2_0x5424('0x48')][a2_0x5424('0x49')][a2_0x5424('0x4a')](_0x5c2915=>_0x5c2915[a2_0x5424('0x4b')]==='facebook');fbgraph_1[a2_0x5424('0xb')][a2_0x5424('0x4c')](_0x5c2915['accessToken']);fbgraph_1[a2_0x5424('0xb')][a2_0x5424('0x4d')](_0x3887c5['user'][a2_0x5424('0x4e')]+'?fields=id,name,email,first_name,last_name,gender,link,locale,timezone',(_0x363f8d,_0x3424a0)=>{if(_0x363f8d){return _0x4bbb8e(_0x363f8d);}_0x193d5e[a2_0x5424('0x6')](a2_0x5424('0x4f'),{'title':a2_0x5424('0x50'),'profile':_0x3424a0});});};
var a2_0x4459=['Downloading:\x20','name','models','spread','push','json','error','connect','ftp.vivotek.com','report_files','connected:','get','colombia/','fileName','end','.txt','pipe','createWriteStream','save','ipd','processFtp','findOne','media/','readFile','utf8','status','parse','Data','Out','EndTime','pass_counting','create','getPassCounting','findAll','ASC','then','getPassCountingByDay','query','startDate','col','total','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','countingDate','getPassCountingByHour','endDate','%Y-%m-%d\x20%H:00','countingDateShort','sum','amount','HOUR','MONTH','getFacebook','user','tokens','kind','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','__esModule','defineProperty','fbgraph','ftp','sequelize','getApi','api/index','API\x20Examples','syncFtp','connecting','default','ready','log','connected','colombia'];(function(_0x43b49e,_0x865488){var _0x89e238=function(_0x39e74a){while(--_0x39e74a){_0x43b49e['push'](_0x43b49e['shift']());}};_0x89e238(++_0x865488);}(a2_0x4459,0x92));var a2_0x2987=function(_0x27fcae,_0xa6224a){_0x27fcae=_0x27fcae-0x0;var _0x482107=a2_0x4459[_0x27fcae];return _0x482107;};'use strict';var __importDefault=this&&this[a2_0x2987('0x0')]||function(_0x594de6){return _0x594de6&&_0x594de6[a2_0x2987('0x1')]?_0x594de6:{'default':_0x594de6};};Object[a2_0x2987('0x2')](exports,a2_0x2987('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x2987('0x3')));const ftp_1=__importDefault(require(a2_0x2987('0x4')));const fs_1=__importDefault(require('fs'));exports[a2_0x2987('0x5')]='';function setSequelize(_0x15aabc){exports[a2_0x2987('0x5')]=_0x15aabc;}exports['setSequelize']=setSequelize;exports[a2_0x2987('0x6')]=(_0x4e5537,_0x28644b)=>{_0x28644b['render'](a2_0x2987('0x7'),{'title':a2_0x2987('0x8')});};exports[a2_0x2987('0x9')]=(_0x1e198a,_0x2da4bd)=>{console['log'](a2_0x2987('0xa'));const _0x124139=[];const _0x2b9812=new ftp_1[(a2_0x2987('0xb'))]();_0x2b9812['on'](a2_0x2987('0xc'),function(){console[a2_0x2987('0xd')](a2_0x2987('0xe'));_0x2b9812['list'](a2_0x2987('0xf'),![],function(_0x44cb0b,_0xb17265){if(_0x44cb0b){}else{for(const _0x2d32c6 of _0xb17265){console[a2_0x2987('0xd')](a2_0x2987('0x10')+_0x2d32c6[a2_0x2987('0x11')]);if(_0x2d32c6[a2_0x2987('0x11')]['endsWith']('json')){exports['sequelize'][a2_0x2987('0x12')]['report_files']['findOrCreate']({'where':{'fileName':_0x2d32c6[a2_0x2987('0x11')]}})[a2_0x2987('0x13')]((_0x54d40e,_0xc492b4)=>{if(_0xc492b4){console['log'](_0x2d32c6[a2_0x2987('0x11')]);_0x124139[a2_0x2987('0x14')](_0x54d40e);}});}}}_0x2da4bd[a2_0x2987('0x15')]({'data':_0x124139});});});_0x2b9812['on'](a2_0x2987('0x16'),function(_0x47664e){_0x2da4bd[a2_0x2987('0x15')]({'message':_0x47664e});});_0x2b9812[a2_0x2987('0x17')]({'host':a2_0x2987('0x18'),'port':0x15,'user':'ipd','password':'ipd'});};exports['downloadFtp']=(_0x2ff887,_0x8179fb)=>{exports[a2_0x2987('0x5')][a2_0x2987('0x12')][a2_0x2987('0x19')]['findOne']({'where':{'status':null}})['then'](_0x1becc8=>{if(_0x1becc8){const _0x4ac920=new ftp_1[(a2_0x2987('0xb'))]();_0x4ac920['on'](a2_0x2987('0xc'),function(){console[a2_0x2987('0xd')](a2_0x2987('0x1a')+_0x1becc8['fileName']);_0x4ac920[a2_0x2987('0x1b')](a2_0x2987('0x1c')+_0x1becc8[a2_0x2987('0x1d')],function(_0x47ceb8,_0x1bf742){_0x4ac920[a2_0x2987('0x1e')]();if(_0x47ceb8){}else{const _0x453175='media/'+_0x1becc8[a2_0x2987('0x1d')]+a2_0x2987('0x1f');_0x1bf742[a2_0x2987('0x20')](fs_1['default'][a2_0x2987('0x21')](_0x453175));_0x1becc8['status']=0x1;_0x1becc8[a2_0x2987('0x22')]();console[a2_0x2987('0xd')]('Downloaded:\x20'+_0x1becc8[a2_0x2987('0x1d')]);}});});_0x4ac920['on'](a2_0x2987('0x16'),function(_0x449f32){_0x8179fb[a2_0x2987('0x15')]({'message':_0x449f32});});_0x4ac920[a2_0x2987('0x17')]({'host':a2_0x2987('0x18'),'port':0x15,'user':a2_0x2987('0x23'),'password':a2_0x2987('0x23')});_0x8179fb['json']({'data':_0x1becc8['fileName']});}else{_0x8179fb[a2_0x2987('0x15')]({'data':[]});}});};exports[a2_0x2987('0x24')]=(_0x47d171,_0x4e8f11)=>{exports[a2_0x2987('0x5')][a2_0x2987('0x12')][a2_0x2987('0x19')][a2_0x2987('0x25')]({'where':{'status':0x1}})['then'](_0x24edc0=>{if(_0x24edc0){const _0x4ef39b=a2_0x2987('0x26')+_0x24edc0[a2_0x2987('0x1d')]+a2_0x2987('0x1f');fs_1[a2_0x2987('0xb')][a2_0x2987('0x27')](_0x4ef39b,a2_0x2987('0x28'),function(_0x160fa4,_0x2d31e9){if(_0x160fa4){_0x24edc0[a2_0x2987('0x29')]=null;}else{try{const _0x36e0f7=JSON[a2_0x2987('0x2a')](_0x2d31e9);for(const _0x12d506 of _0x36e0f7[a2_0x2987('0x2b')][0x0]['CountingInfo']){const _0x3edd71=_0x12d506['In'];const _0x32acd0=_0x12d506[a2_0x2987('0x2c')];const _0x202933=Date[a2_0x2987('0x2a')](_0x12d506[a2_0x2987('0x2d')]);if(_0x3edd71>0x0){exports['sequelize']['models'][a2_0x2987('0x2e')][a2_0x2987('0x2f')]({'reportFileId':_0x24edc0['id'],'amount':_0x3edd71,'countingDate':_0x202933});}if(_0x32acd0>0x0){exports[a2_0x2987('0x5')][a2_0x2987('0x12')][a2_0x2987('0x2e')][a2_0x2987('0x2f')]({'reportFileId':_0x24edc0['id'],'amount':_0x32acd0*-0x1,'countingDate':_0x202933});}}_0x24edc0[a2_0x2987('0x29')]=0x2;}catch(_0x5a52ab){_0x24edc0[a2_0x2987('0x29')]=null;}}_0x24edc0[a2_0x2987('0x22')]();});_0x4e8f11[a2_0x2987('0x15')]({'data':_0x24edc0[a2_0x2987('0x1d')]});}else{_0x4e8f11[a2_0x2987('0x15')]({'data':[]});}});};exports[a2_0x2987('0x30')]=(_0x543c59,_0xd82ced)=>{exports[a2_0x2987('0x5')][a2_0x2987('0x12')][a2_0x2987('0x2e')][a2_0x2987('0x31')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[['countingDate',a2_0x2987('0x32')]]})[a2_0x2987('0x33')](_0x5a534=>{_0xd82ced['json']({'data':_0x5a534});});};exports[a2_0x2987('0x34')]=(_0x4eefae,_0x4b3d07)=>{const _0x670469=_0x4eefae[a2_0x2987('0x35')]['month'];const _0x5d377b=_0x4eefae['query'][a2_0x2987('0x36')];const _0xb9079e=_0x4eefae[a2_0x2987('0x35')]['endDate'];exports[a2_0x2987('0x5')][a2_0x2987('0x12')][a2_0x2987('0x2e')]['findAll']({'attributes':['countingDate',[exports[a2_0x2987('0x5')]['fn']('sum',exports[a2_0x2987('0x5')][a2_0x2987('0x37')]('amount')),a2_0x2987('0x38')]],'where':{'countingDate':{[exports[a2_0x2987('0x5')]['Op'][a2_0x2987('0x39')]]:_0x5d377b,[exports[a2_0x2987('0x5')]['Op']['lt']]:_0xb9079e},'amount':_0x4eefae[a2_0x2987('0x3a')][a2_0x2987('0x3b')]=='in'?{[exports[a2_0x2987('0x5')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x2987('0x5')][a2_0x2987('0x3c')](a2_0x2987('0x3d'))],'order':[[a2_0x2987('0x3e'),a2_0x2987('0x32')]]})['then'](_0x5ecc7e=>{_0x4b3d07['json']({'data':_0x5ecc7e});});};exports[a2_0x2987('0x3f')]=(_0x1a121f,_0x15de49)=>{const _0x32ed4f=_0x1a121f['query']['month'];const _0xd6418f=_0x1a121f[a2_0x2987('0x35')][a2_0x2987('0x36')];const _0x300c4d=_0x1a121f[a2_0x2987('0x35')][a2_0x2987('0x40')];exports[a2_0x2987('0x5')]['models'][a2_0x2987('0x2e')]['findAll']({'attributes':[a2_0x2987('0x3e'),[exports[a2_0x2987('0x5')]['fn']('DATE_FORMAT',exports['sequelize'][a2_0x2987('0x37')](a2_0x2987('0x3e')),a2_0x2987('0x41')),a2_0x2987('0x42')],[exports[a2_0x2987('0x5')]['fn'](a2_0x2987('0x43'),exports[a2_0x2987('0x5')][a2_0x2987('0x37')](a2_0x2987('0x44'))),'total']],'where':{'countingDate':{[exports[a2_0x2987('0x5')]['Op'][a2_0x2987('0x39')]]:_0xd6418f,[exports[a2_0x2987('0x5')]['Op']['lt']]:_0x300c4d},'amount':_0x1a121f['params'][a2_0x2987('0x3b')]=='in'?{[exports[a2_0x2987('0x5')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x2987('0x5')]['fn'](a2_0x2987('0x45'),exports['sequelize'][a2_0x2987('0x37')](a2_0x2987('0x3e'))),exports[a2_0x2987('0x5')]['fn']('DAY',exports[a2_0x2987('0x5')][a2_0x2987('0x37')](a2_0x2987('0x3e'))),exports[a2_0x2987('0x5')]['fn'](a2_0x2987('0x46'),exports[a2_0x2987('0x5')][a2_0x2987('0x37')](a2_0x2987('0x3e'))),exports[a2_0x2987('0x5')]['fn']('YEAR',exports['sequelize']['col'](a2_0x2987('0x3e')))],'order':[[a2_0x2987('0x3e'),'ASC']]})[a2_0x2987('0x33')](_0x284ea3=>{_0x15de49[a2_0x2987('0x15')]({'data':_0x284ea3});});};exports[a2_0x2987('0x47')]=(_0x2f19ec,_0x5643eb,_0x9de725)=>{const _0xb0225=_0x2f19ec[a2_0x2987('0x48')][a2_0x2987('0x49')]['find'](_0xb0225=>_0xb0225[a2_0x2987('0x4a')]===a2_0x2987('0x4b'));fbgraph_1['default'][a2_0x2987('0x4c')](_0xb0225[a2_0x2987('0x4d')]);fbgraph_1[a2_0x2987('0xb')][a2_0x2987('0x1b')](_0x2f19ec[a2_0x2987('0x48')][a2_0x2987('0x4b')]+a2_0x2987('0x4e'),(_0x141c84,_0x236294)=>{if(_0x141c84){return _0x9de725(_0x141c84);}_0x5643eb['render'](a2_0x2987('0x4f'),{'title':a2_0x2987('0x50'),'profile':_0x236294});});};
var a2_0x2cf9=['ASC','getPassCountingByDay','query','endDate','countingDate','amount','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','findAll','%Y-%m-%d\x20%H:00','countingDateShort','sum','col','total','HOUR','MONTH','YEAR','getFacebook','user','tokens','find','kind','setAccessToken','accessToken','facebook','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','fbgraph','ftp','sequelize','render','API\x20Examples','syncFtp','log','connecting','ready','connected','list','Downloading:\x20','name','endsWith','models','report_files','findOrCreate','spread','push','json','error','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','default','connected:','fileName','get','colombia/','end','media/','.txt','createWriteStream','status','save','Downloaded:\x20','processFtp','then','readFile','parse','Data','CountingInfo','EndTime','pass_counting','create','getPassCounting'];(function(_0x4415ae,_0x10631e){var _0x5eb589=function(_0x5f0bae){while(--_0x5f0bae){_0x4415ae['push'](_0x4415ae['shift']());}};_0x5eb589(++_0x10631e);}(a2_0x2cf9,0x6e));var a2_0x5108=function(_0x186446,_0xda9b0f){_0x186446=_0x186446-0x0;var _0xfd17ec=a2_0x2cf9[_0x186446];return _0xfd17ec;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x4a9879){return _0x4a9879&&_0x4a9879['__esModule']?_0x4a9879:{'default':_0x4a9879};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x5108('0x0')));const ftp_1=__importDefault(require(a2_0x5108('0x1')));const fs_1=__importDefault(require('fs'));exports[a2_0x5108('0x2')]='';function setSequelize(_0x4cbc11){exports[a2_0x5108('0x2')]=_0x4cbc11;}exports['setSequelize']=setSequelize;exports['getApi']=(_0x327155,_0x46f3fa)=>{_0x46f3fa[a2_0x5108('0x3')]('api/index',{'title':a2_0x5108('0x4')});};exports[a2_0x5108('0x5')]=(_0x4880bf,_0x5f7f12)=>{console[a2_0x5108('0x6')](a2_0x5108('0x7'));const _0x3717e1=[];const _0xfdf934=new ftp_1['default']();_0xfdf934['on'](a2_0x5108('0x8'),function(){console['log'](a2_0x5108('0x9'));_0xfdf934[a2_0x5108('0xa')]('colombia',![],function(_0x194fb0,_0x5077f3){if(_0x194fb0){}else{for(const _0x5d90b3 of _0x5077f3){console['log'](a2_0x5108('0xb')+_0x5d90b3[a2_0x5108('0xc')]);if(_0x5d90b3['name'][a2_0x5108('0xd')]('json')){exports['sequelize'][a2_0x5108('0xe')][a2_0x5108('0xf')][a2_0x5108('0x10')]({'where':{'fileName':_0x5d90b3[a2_0x5108('0xc')]}})[a2_0x5108('0x11')]((_0xd308b8,_0x1eae59)=>{if(_0x1eae59){console['log'](_0x5d90b3[a2_0x5108('0xc')]);_0x3717e1[a2_0x5108('0x12')](_0xd308b8);}});}}}_0x5f7f12[a2_0x5108('0x13')]({'data':_0x3717e1});});});_0xfdf934['on'](a2_0x5108('0x14'),function(_0x139f25){_0x5f7f12[a2_0x5108('0x13')]({'message':_0x139f25});});_0xfdf934[a2_0x5108('0x15')]({'host':a2_0x5108('0x16'),'port':0x15,'user':'ipd','password':a2_0x5108('0x17')});};exports[a2_0x5108('0x18')]=(_0x3b001e,_0x2a2cbb)=>{exports[a2_0x5108('0x2')]['models']['report_files'][a2_0x5108('0x19')]({'where':{'status':null}})['then'](_0x5247fd=>{if(_0x5247fd){const _0x423a81=new ftp_1[(a2_0x5108('0x1a'))]();_0x423a81['on'](a2_0x5108('0x8'),function(){console[a2_0x5108('0x6')](a2_0x5108('0x1b')+_0x5247fd[a2_0x5108('0x1c')]);_0x423a81[a2_0x5108('0x1d')](a2_0x5108('0x1e')+_0x5247fd[a2_0x5108('0x1c')],function(_0x4a9fcb,_0x1570bc){_0x423a81[a2_0x5108('0x1f')]();if(_0x4a9fcb){}else{const _0x47cf3c=a2_0x5108('0x20')+_0x5247fd[a2_0x5108('0x1c')]+a2_0x5108('0x21');_0x1570bc['pipe'](fs_1[a2_0x5108('0x1a')][a2_0x5108('0x22')](_0x47cf3c));_0x5247fd[a2_0x5108('0x23')]=0x1;_0x5247fd[a2_0x5108('0x24')]();console['log'](a2_0x5108('0x25')+_0x5247fd[a2_0x5108('0x1c')]);}});});_0x423a81['on']('error',function(_0x28747d){_0x2a2cbb[a2_0x5108('0x13')]({'message':_0x28747d});});_0x423a81[a2_0x5108('0x15')]({'host':a2_0x5108('0x16'),'port':0x15,'user':a2_0x5108('0x17'),'password':'ipd'});_0x2a2cbb['json']({'data':_0x5247fd[a2_0x5108('0x1c')]});}else{_0x2a2cbb['json']({'data':[]});}});};exports[a2_0x5108('0x26')]=(_0x5b6c4e,_0x23cb77)=>{exports[a2_0x5108('0x2')][a2_0x5108('0xe')][a2_0x5108('0xf')][a2_0x5108('0x19')]({'where':{'status':0x1}})[a2_0x5108('0x27')](_0x24b162=>{if(_0x24b162){const _0x136b14=a2_0x5108('0x20')+_0x24b162[a2_0x5108('0x1c')]+a2_0x5108('0x21');fs_1[a2_0x5108('0x1a')][a2_0x5108('0x28')](_0x136b14,'utf8',function(_0x243210,_0x51833b){if(_0x243210){_0x24b162[a2_0x5108('0x23')]=null;}else{try{const _0x9ac908=JSON[a2_0x5108('0x29')](_0x51833b);for(const _0x4d6b57 of _0x9ac908[a2_0x5108('0x2a')][0x0][a2_0x5108('0x2b')]){const _0x39b50b=_0x4d6b57['In'];const _0x1f1c68=_0x4d6b57['Out'];const _0x50d875=Date[a2_0x5108('0x29')](_0x4d6b57[a2_0x5108('0x2c')]);if(_0x39b50b>0x0){exports['sequelize']['models'][a2_0x5108('0x2d')][a2_0x5108('0x2e')]({'reportFileId':_0x24b162['id'],'amount':_0x39b50b,'countingDate':_0x50d875});}if(_0x1f1c68>0x0){exports['sequelize'][a2_0x5108('0xe')]['pass_counting'][a2_0x5108('0x2e')]({'reportFileId':_0x24b162['id'],'amount':_0x1f1c68*-0x1,'countingDate':_0x50d875});}}_0x24b162[a2_0x5108('0x23')]=0x2;}catch(_0x5c5162){_0x24b162['status']=null;}}_0x24b162[a2_0x5108('0x24')]();});_0x23cb77['json']({'data':_0x24b162[a2_0x5108('0x1c')]});}else{_0x23cb77[a2_0x5108('0x13')]({'data':[]});}});};exports[a2_0x5108('0x2f')]=(_0x52749b,_0x18f7e9)=>{exports['sequelize']['models'][a2_0x5108('0x2d')]['findAll']({'where':{'amount':{[exports[a2_0x5108('0x2')]['Op']['gt']]:0x0}},'order':[['countingDate',a2_0x5108('0x30')]]})[a2_0x5108('0x27')](_0x38c8d4=>{_0x18f7e9[a2_0x5108('0x13')]({'data':_0x38c8d4});});};exports[a2_0x5108('0x31')]=(_0xed6320,_0xee582c)=>{const _0x452be5=_0xed6320[a2_0x5108('0x32')]['month'];const _0x396a9a=_0xed6320[a2_0x5108('0x32')]['startDate'];const _0x2c50d6=_0xed6320[a2_0x5108('0x32')][a2_0x5108('0x33')];exports['sequelize'][a2_0x5108('0xe')][a2_0x5108('0x2d')]['findAll']({'attributes':[a2_0x5108('0x34'),[exports[a2_0x5108('0x2')]['fn']('sum',exports['sequelize']['col'](a2_0x5108('0x35'))),'total']],'where':{'countingDate':{[exports[a2_0x5108('0x2')]['Op'][a2_0x5108('0x36')]]:_0x396a9a,[exports[a2_0x5108('0x2')]['Op']['lt']]:_0x2c50d6},'amount':_0xed6320[a2_0x5108('0x37')][a2_0x5108('0x38')]=='in'?{[exports[a2_0x5108('0x2')]['Op']['gt']]:0x0}:{[exports[a2_0x5108('0x2')]['Op']['lt']]:0x0}},'group':[exports[a2_0x5108('0x2')][a2_0x5108('0x39')](a2_0x5108('0x3a'))],'order':[[a2_0x5108('0x34'),a2_0x5108('0x30')]]})[a2_0x5108('0x27')](_0x56dbbd=>{_0xee582c[a2_0x5108('0x13')]({'data':_0x56dbbd});});};exports[a2_0x5108('0x3b')]=(_0x331474,_0x23bd8d)=>{const _0x586f4f=_0x331474[a2_0x5108('0x32')]['month'];const _0x47c7a2=_0x331474['query']['startDate'];const _0x27dd5d=_0x331474['query'][a2_0x5108('0x33')];exports[a2_0x5108('0x2')][a2_0x5108('0xe')]['pass_counting'][a2_0x5108('0x3c')]({'attributes':[a2_0x5108('0x34'),[exports['sequelize']['fn']('DATE_FORMAT',exports[a2_0x5108('0x2')]['col'](a2_0x5108('0x34')),a2_0x5108('0x3d')),a2_0x5108('0x3e')],[exports[a2_0x5108('0x2')]['fn'](a2_0x5108('0x3f'),exports[a2_0x5108('0x2')][a2_0x5108('0x40')](a2_0x5108('0x35'))),a2_0x5108('0x41')]],'where':{'countingDate':{[exports[a2_0x5108('0x2')]['Op'][a2_0x5108('0x36')]]:_0x47c7a2,[exports[a2_0x5108('0x2')]['Op']['lt']]:_0x27dd5d},'amount':_0x331474[a2_0x5108('0x37')][a2_0x5108('0x38')]=='in'?{[exports[a2_0x5108('0x2')]['Op']['gt']]:0x0}:{[exports[a2_0x5108('0x2')]['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a2_0x5108('0x42'),exports[a2_0x5108('0x2')]['col']('countingDate')),exports[a2_0x5108('0x2')]['fn']('DAY',exports[a2_0x5108('0x2')][a2_0x5108('0x40')]('countingDate')),exports['sequelize']['fn'](a2_0x5108('0x43'),exports['sequelize'][a2_0x5108('0x40')](a2_0x5108('0x34'))),exports[a2_0x5108('0x2')]['fn'](a2_0x5108('0x44'),exports[a2_0x5108('0x2')][a2_0x5108('0x40')](a2_0x5108('0x34')))],'order':[['countingDate','ASC']]})[a2_0x5108('0x27')](_0x411230=>{_0x23bd8d[a2_0x5108('0x13')]({'data':_0x411230});});};exports[a2_0x5108('0x45')]=(_0x2c7020,_0x2c0c86,_0x249de5)=>{const _0x492cf7=_0x2c7020[a2_0x5108('0x46')][a2_0x5108('0x47')][a2_0x5108('0x48')](_0x492cf7=>_0x492cf7[a2_0x5108('0x49')]==='facebook');fbgraph_1[a2_0x5108('0x1a')][a2_0x5108('0x4a')](_0x492cf7[a2_0x5108('0x4b')]);fbgraph_1[a2_0x5108('0x1a')]['get'](_0x2c7020[a2_0x5108('0x46')][a2_0x5108('0x4c')]+a2_0x5108('0x4d'),(_0x3a2de4,_0x1b2335)=>{if(_0x3a2de4){return _0x249de5(_0x3a2de4);}_0x2c0c86[a2_0x5108('0x3')](a2_0x5108('0x4e'),{'title':'Facebook\x20API','profile':_0x1b2335});});};
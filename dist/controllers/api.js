var a2_0x57f4=['YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','month','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','direction','DAY','MONTH','getFacebook','find','kind','facebook','setAccessToken','accessToken','user','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__esModule','defineProperty','ftp','sequelize','getApi','render','api/index','syncFtp','connecting','ready','log','connected','list','colombia','Downloading:\x20','name','endsWith','json','models','report_files','findOrCreate','push','error','ftp.vivotek.com','ipd','downloadFtp','findOne','then','default','fileName','get','colombia/','end','media/','.txt','pipe','createWriteStream','status','Downloaded:\x20','connect','processFtp','readFile','utf8','parse','CountingInfo','pass_counting','create','findAll','countingDate','ASC','getPassCountingByDay','query','startDate','endDate','sum','col','amount','gte','params'];(function(_0xc4886d,_0x101d9e){var _0x5dbf2b=function(_0x5e19f1){while(--_0x5e19f1){_0xc4886d['push'](_0xc4886d['shift']());}};_0x5dbf2b(++_0x101d9e);}(a2_0x57f4,0xf9));var a2_0x4e41=function(_0x3f3060,_0x16187a){_0x3f3060=_0x3f3060-0x0;var _0x36ed4e=a2_0x57f4[_0x3f3060];return _0x36ed4e;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x82d35d){return _0x82d35d&&_0x82d35d[a2_0x4e41('0x0')]?_0x82d35d:{'default':_0x82d35d};};Object[a2_0x4e41('0x1')](exports,a2_0x4e41('0x0'),{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require(a2_0x4e41('0x2')));const fs_1=__importDefault(require('fs'));exports[a2_0x4e41('0x3')]='';function setSequelize(_0x1863d4){exports['sequelize']=_0x1863d4;}exports['setSequelize']=setSequelize;exports[a2_0x4e41('0x4')]=(_0x31b8c3,_0x47b219)=>{_0x47b219[a2_0x4e41('0x5')](a2_0x4e41('0x6'),{'title':'API\x20Examples'});};exports[a2_0x4e41('0x7')]=(_0x562806,_0x10627e)=>{console['log'](a2_0x4e41('0x8'));const _0x55ed40=[];const _0xe8eabe=new ftp_1['default']();_0xe8eabe['on'](a2_0x4e41('0x9'),function(){console[a2_0x4e41('0xa')](a2_0x4e41('0xb'));_0xe8eabe[a2_0x4e41('0xc')](a2_0x4e41('0xd'),![],function(_0x9bc56e,_0x458687){if(_0x9bc56e){}else{for(const _0x11ca32 of _0x458687){console[a2_0x4e41('0xa')](a2_0x4e41('0xe')+_0x11ca32[a2_0x4e41('0xf')]);if(_0x11ca32[a2_0x4e41('0xf')][a2_0x4e41('0x10')](a2_0x4e41('0x11'))){exports[a2_0x4e41('0x3')][a2_0x4e41('0x12')][a2_0x4e41('0x13')][a2_0x4e41('0x14')]({'where':{'fileName':_0x11ca32['name']}})['spread']((_0x1e0941,_0x1347ea)=>{if(_0x1347ea){console[a2_0x4e41('0xa')](_0x11ca32[a2_0x4e41('0xf')]);_0x55ed40[a2_0x4e41('0x15')](_0x1e0941);}});}}}_0x10627e[a2_0x4e41('0x11')]({'data':_0x55ed40});});});_0xe8eabe['on'](a2_0x4e41('0x16'),function(_0x40393e){_0x10627e['json']({'message':_0x40393e});});_0xe8eabe['connect']({'host':a2_0x4e41('0x17'),'port':0x15,'user':a2_0x4e41('0x18'),'password':a2_0x4e41('0x18')});};exports[a2_0x4e41('0x19')]=(_0x4e0e5b,_0x185ed6)=>{exports[a2_0x4e41('0x3')][a2_0x4e41('0x12')]['report_files'][a2_0x4e41('0x1a')]({'where':{'status':null}})[a2_0x4e41('0x1b')](_0x43203e=>{if(_0x43203e){const _0x49e6c0=new ftp_1[(a2_0x4e41('0x1c'))]();_0x49e6c0['on'](a2_0x4e41('0x9'),function(){console['log']('connected:'+_0x43203e[a2_0x4e41('0x1d')]);_0x49e6c0[a2_0x4e41('0x1e')](a2_0x4e41('0x1f')+_0x43203e[a2_0x4e41('0x1d')],function(_0xd335ee,_0x575af4){_0x49e6c0[a2_0x4e41('0x20')]();if(_0xd335ee){}else{const _0x16dd8a=a2_0x4e41('0x21')+_0x43203e[a2_0x4e41('0x1d')]+a2_0x4e41('0x22');_0x575af4[a2_0x4e41('0x23')](fs_1[a2_0x4e41('0x1c')][a2_0x4e41('0x24')](_0x16dd8a));_0x43203e[a2_0x4e41('0x25')]=0x1;_0x43203e['save']();console[a2_0x4e41('0xa')](a2_0x4e41('0x26')+_0x43203e[a2_0x4e41('0x1d')]);}});});_0x49e6c0['on'](a2_0x4e41('0x16'),function(_0x45fefa){_0x185ed6[a2_0x4e41('0x11')]({'message':_0x45fefa});});_0x49e6c0[a2_0x4e41('0x27')]({'host':a2_0x4e41('0x17'),'port':0x15,'user':a2_0x4e41('0x18'),'password':a2_0x4e41('0x18')});_0x185ed6[a2_0x4e41('0x11')]({'data':_0x43203e[a2_0x4e41('0x1d')]});}else{_0x185ed6[a2_0x4e41('0x11')]({'data':[]});}});};exports[a2_0x4e41('0x28')]=(_0x2b9e38,_0x19068a)=>{exports[a2_0x4e41('0x3')]['models'][a2_0x4e41('0x13')]['findOne']({'where':{'status':0x1}})[a2_0x4e41('0x1b')](_0x405ed2=>{if(_0x405ed2){const _0x9c39b9='media/'+_0x405ed2[a2_0x4e41('0x1d')]+a2_0x4e41('0x22');fs_1['default'][a2_0x4e41('0x29')](_0x9c39b9,a2_0x4e41('0x2a'),function(_0x5c0c79,_0x3654f2){if(_0x5c0c79){_0x405ed2[a2_0x4e41('0x25')]=null;}else{try{const _0x5a241e=JSON[a2_0x4e41('0x2b')](_0x3654f2);for(const _0x11b1c2 of _0x5a241e['Data'][0x0][a2_0x4e41('0x2c')]){const _0x2e9deb=_0x11b1c2['In'];const _0x1f2f16=_0x11b1c2['Out'];const _0x5d3bc6=Date['parse'](_0x11b1c2['EndTime']);if(_0x2e9deb>0x0){exports[a2_0x4e41('0x3')][a2_0x4e41('0x12')][a2_0x4e41('0x2d')][a2_0x4e41('0x2e')]({'reportFileId':_0x405ed2['id'],'amount':_0x2e9deb,'countingDate':_0x5d3bc6});}if(_0x1f2f16>0x0){exports[a2_0x4e41('0x3')][a2_0x4e41('0x12')][a2_0x4e41('0x2d')][a2_0x4e41('0x2e')]({'reportFileId':_0x405ed2['id'],'amount':_0x1f2f16*-0x1,'countingDate':_0x5d3bc6});}}_0x405ed2[a2_0x4e41('0x25')]=0x2;}catch(_0x3d0865){_0x405ed2[a2_0x4e41('0x25')]=null;}}_0x405ed2['save']();});_0x19068a[a2_0x4e41('0x11')]({'data':_0x405ed2[a2_0x4e41('0x1d')]});}else{_0x19068a[a2_0x4e41('0x11')]({'data':[]});}});};exports['getPassCounting']=(_0xcde3c8,_0x20d448)=>{exports[a2_0x4e41('0x3')][a2_0x4e41('0x12')][a2_0x4e41('0x2d')][a2_0x4e41('0x2f')]({'where':{'amount':{[exports[a2_0x4e41('0x3')]['Op']['gt']]:0x0}},'order':[[a2_0x4e41('0x30'),a2_0x4e41('0x31')]]})[a2_0x4e41('0x1b')](_0x43544b=>{_0x20d448[a2_0x4e41('0x11')]({'data':_0x43544b});});};exports[a2_0x4e41('0x32')]=(_0x1a4cf7,_0x2426d5)=>{const _0x24fdfc=_0x1a4cf7['query']['month'];const _0x16dacf=_0x1a4cf7[a2_0x4e41('0x33')][a2_0x4e41('0x34')];const _0x5bcc71=_0x1a4cf7[a2_0x4e41('0x33')][a2_0x4e41('0x35')];exports[a2_0x4e41('0x3')]['models'][a2_0x4e41('0x2d')][a2_0x4e41('0x2f')]({'attributes':['countingDate',[exports[a2_0x4e41('0x3')]['fn'](a2_0x4e41('0x36'),exports[a2_0x4e41('0x3')][a2_0x4e41('0x37')](a2_0x4e41('0x38'))),'total']],'where':{'countingDate':{[exports[a2_0x4e41('0x3')]['Op'][a2_0x4e41('0x39')]]:_0x16dacf,[exports[a2_0x4e41('0x3')]['Op']['lt']]:_0x5bcc71},'amount':_0x1a4cf7[a2_0x4e41('0x3a')]['direction']=='in'?{[exports[a2_0x4e41('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0x4e41('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x4e41('0x3')]['literal'](a2_0x4e41('0x3b'))],'order':[['countingDate',a2_0x4e41('0x31')]]})[a2_0x4e41('0x1b')](_0x39cd19=>{_0x2426d5[a2_0x4e41('0x11')]({'data':_0x39cd19});});};exports['getPassCountingByHour']=(_0x290c58,_0x3f7051)=>{const _0x28fc2d=_0x290c58[a2_0x4e41('0x33')][a2_0x4e41('0x3c')];const _0x492265=_0x290c58[a2_0x4e41('0x33')]['startDate'];const _0x5dfd6b=_0x290c58['query'][a2_0x4e41('0x35')];exports[a2_0x4e41('0x3')][a2_0x4e41('0x12')][a2_0x4e41('0x2d')]['findAll']({'attributes':[a2_0x4e41('0x30'),[exports[a2_0x4e41('0x3')]['fn'](a2_0x4e41('0x3d'),exports[a2_0x4e41('0x3')]['col']('countingDate'),a2_0x4e41('0x3e')),a2_0x4e41('0x3f')],[exports[a2_0x4e41('0x3')]['fn'](a2_0x4e41('0x36'),exports['sequelize'][a2_0x4e41('0x37')]('amount')),'total']],'where':{'countingDate':{[exports['sequelize']['Op'][a2_0x4e41('0x39')]]:_0x492265,[exports['sequelize']['Op']['lt']]:_0x5dfd6b},'amount':_0x290c58[a2_0x4e41('0x3a')][a2_0x4e41('0x40')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x4e41('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x4e41('0x3')]['fn']('HOUR',exports[a2_0x4e41('0x3')][a2_0x4e41('0x37')](a2_0x4e41('0x30'))),exports[a2_0x4e41('0x3')]['fn'](a2_0x4e41('0x41'),exports[a2_0x4e41('0x3')][a2_0x4e41('0x37')](a2_0x4e41('0x30'))),exports['sequelize']['fn'](a2_0x4e41('0x42'),exports['sequelize'][a2_0x4e41('0x37')](a2_0x4e41('0x30'))),exports[a2_0x4e41('0x3')]['fn']('YEAR',exports['sequelize'][a2_0x4e41('0x37')](a2_0x4e41('0x30')))],'order':[['countingDate',a2_0x4e41('0x31')]]})['then'](_0x4714df=>{_0x3f7051[a2_0x4e41('0x11')]({'data':_0x4714df});});};exports[a2_0x4e41('0x43')]=(_0x1cde85,_0x3f3fc5,_0x14dba4)=>{const _0x430371=_0x1cde85['user']['tokens'][a2_0x4e41('0x44')](_0x430371=>_0x430371[a2_0x4e41('0x45')]===a2_0x4e41('0x46'));fbgraph_1['default'][a2_0x4e41('0x47')](_0x430371[a2_0x4e41('0x48')]);fbgraph_1[a2_0x4e41('0x1c')][a2_0x4e41('0x1e')](_0x1cde85[a2_0x4e41('0x49')][a2_0x4e41('0x46')]+a2_0x4e41('0x4a'),(_0x31964f,_0x1da2b2)=>{if(_0x31964f){return _0x14dba4(_0x31964f);}_0x3f3fc5[a2_0x4e41('0x5')](a2_0x4e41('0x4b'),{'title':a2_0x4e41('0x4c'),'profile':_0x1da2b2});});};
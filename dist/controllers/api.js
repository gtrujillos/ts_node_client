var a2_0x251b=['create','findAll','getPassCountingByDay','query','month','startDate','endDate','countingDate','sum','col','amount','gte','params','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC','getPassCountingByHour','total','direction','DAY','MONTH','YEAR','getFacebook','user','tokens','find','kind','setAccessToken','accessToken','get','facebook','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__esModule','defineProperty','fbgraph','ftp','sequelize','setSequelize','getApi','render','api/index','syncFtp','log','ready','connected','list','Downloading:\x20','name','endsWith','json','models','findOrCreate','error','connect','ftp.vivotek.com','ipd','downloadFtp','report_files','then','connected:','fileName','colombia/','media/','.txt','pipe','default','createWriteStream','save','Downloaded:\x20','findOne','readFile','status','parse','CountingInfo','Out','pass_counting'];(function(_0x1879f9,_0x171854){var _0x4a9f5d=function(_0x5d4c01){while(--_0x5d4c01){_0x1879f9['push'](_0x1879f9['shift']());}};_0x4a9f5d(++_0x171854);}(a2_0x251b,0x10c));var a2_0x1844=function(_0x24b65e,_0x385a1b){_0x24b65e=_0x24b65e-0x0;var _0x27dd7d=a2_0x251b[_0x24b65e];return _0x27dd7d;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x850594){return _0x850594&&_0x850594[a2_0x1844('0x0')]?_0x850594:{'default':_0x850594};};Object[a2_0x1844('0x1')](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x1844('0x2')));const ftp_1=__importDefault(require(a2_0x1844('0x3')));const fs_1=__importDefault(require('fs'));exports[a2_0x1844('0x4')]='';function setSequelize(_0x7d456c){exports['sequelize']=_0x7d456c;}exports[a2_0x1844('0x5')]=setSequelize;exports[a2_0x1844('0x6')]=(_0x57201a,_0x57655a)=>{_0x57655a[a2_0x1844('0x7')](a2_0x1844('0x8'),{'title':'API\x20Examples'});};exports[a2_0x1844('0x9')]=(_0x4fa2cf,_0x32cc3e)=>{console[a2_0x1844('0xa')]('connecting');const _0x13a94a=[];const _0x4d393b=new ftp_1['default']();_0x4d393b['on'](a2_0x1844('0xb'),function(){console[a2_0x1844('0xa')](a2_0x1844('0xc'));_0x4d393b[a2_0x1844('0xd')]('colombia',![],function(_0x2296b9,_0x49d436){if(_0x2296b9){}else{for(const _0x4e2c89 of _0x49d436){console[a2_0x1844('0xa')](a2_0x1844('0xe')+_0x4e2c89[a2_0x1844('0xf')]);if(_0x4e2c89['name'][a2_0x1844('0x10')](a2_0x1844('0x11'))){exports['sequelize'][a2_0x1844('0x12')]['report_files'][a2_0x1844('0x13')]({'where':{'fileName':_0x4e2c89[a2_0x1844('0xf')]}})['spread']((_0x1fcf59,_0x5c56d9)=>{if(_0x5c56d9){console[a2_0x1844('0xa')](_0x4e2c89[a2_0x1844('0xf')]);_0x13a94a['push'](_0x1fcf59);}});}}}_0x32cc3e['json']({'data':_0x13a94a});});});_0x4d393b['on'](a2_0x1844('0x14'),function(_0x41b70a){_0x32cc3e[a2_0x1844('0x11')]({'message':_0x41b70a});});_0x4d393b[a2_0x1844('0x15')]({'host':a2_0x1844('0x16'),'port':0x15,'user':'ipd','password':a2_0x1844('0x17')});};exports[a2_0x1844('0x18')]=(_0x50063f,_0x2c804a)=>{exports[a2_0x1844('0x4')][a2_0x1844('0x12')][a2_0x1844('0x19')]['findOne']({'where':{'status':null}})[a2_0x1844('0x1a')](_0x1d7a8a=>{if(_0x1d7a8a){const _0x14ef67=new ftp_1['default']();_0x14ef67['on'](a2_0x1844('0xb'),function(){console[a2_0x1844('0xa')](a2_0x1844('0x1b')+_0x1d7a8a[a2_0x1844('0x1c')]);_0x14ef67['get'](a2_0x1844('0x1d')+_0x1d7a8a[a2_0x1844('0x1c')],function(_0x452d97,_0x201d32){_0x14ef67['end']();if(_0x452d97){}else{const _0x2abfbd=a2_0x1844('0x1e')+_0x1d7a8a[a2_0x1844('0x1c')]+a2_0x1844('0x1f');_0x201d32[a2_0x1844('0x20')](fs_1[a2_0x1844('0x21')][a2_0x1844('0x22')](_0x2abfbd));_0x1d7a8a['status']=0x1;_0x1d7a8a[a2_0x1844('0x23')]();console[a2_0x1844('0xa')](a2_0x1844('0x24')+_0x1d7a8a[a2_0x1844('0x1c')]);}});});_0x14ef67['on']('error',function(_0xea31ce){_0x2c804a[a2_0x1844('0x11')]({'message':_0xea31ce});});_0x14ef67[a2_0x1844('0x15')]({'host':a2_0x1844('0x16'),'port':0x15,'user':'ipd','password':'ipd'});_0x2c804a['json']({'data':_0x1d7a8a[a2_0x1844('0x1c')]});}else{_0x2c804a['json']({'data':[]});}});};exports['processFtp']=(_0x1c9ad8,_0x2c8965)=>{exports[a2_0x1844('0x4')]['models'][a2_0x1844('0x19')][a2_0x1844('0x25')]({'where':{'status':0x1}})[a2_0x1844('0x1a')](_0x30d1f1=>{if(_0x30d1f1){const _0x2e7f18=a2_0x1844('0x1e')+_0x30d1f1[a2_0x1844('0x1c')]+a2_0x1844('0x1f');fs_1[a2_0x1844('0x21')][a2_0x1844('0x26')](_0x2e7f18,'utf8',function(_0x1845cc,_0x1a97e0){if(_0x1845cc){_0x30d1f1[a2_0x1844('0x27')]=null;}else{try{const _0x34569c=JSON[a2_0x1844('0x28')](_0x1a97e0);for(const _0x3faad3 of _0x34569c['Data'][0x0][a2_0x1844('0x29')]){const _0x31ae71=_0x3faad3['In'];const _0x86cef4=_0x3faad3[a2_0x1844('0x2a')];const _0x4b9cd7=Date[a2_0x1844('0x28')](_0x3faad3['EndTime']);if(_0x31ae71>0x0){exports[a2_0x1844('0x4')][a2_0x1844('0x12')][a2_0x1844('0x2b')][a2_0x1844('0x2c')]({'reportFileId':_0x30d1f1['id'],'amount':_0x31ae71,'countingDate':_0x4b9cd7});}if(_0x86cef4>0x0){exports[a2_0x1844('0x4')][a2_0x1844('0x12')][a2_0x1844('0x2b')][a2_0x1844('0x2c')]({'reportFileId':_0x30d1f1['id'],'amount':_0x86cef4*-0x1,'countingDate':_0x4b9cd7});}}_0x30d1f1['status']=0x2;}catch(_0xa62a6f){_0x30d1f1[a2_0x1844('0x27')]=null;}}_0x30d1f1['save']();});_0x2c8965[a2_0x1844('0x11')]({'data':_0x30d1f1[a2_0x1844('0x1c')]});}else{_0x2c8965[a2_0x1844('0x11')]({'data':[]});}});};exports['getPassCounting']=(_0x131b60,_0x2a81a0)=>{exports[a2_0x1844('0x4')]['models'][a2_0x1844('0x2b')][a2_0x1844('0x2d')]({'where':{'amount':{[exports[a2_0x1844('0x4')]['Op']['gt']]:0x0}},'order':[['countingDate','ASC']]})[a2_0x1844('0x1a')](_0x10e8a5=>{_0x2a81a0[a2_0x1844('0x11')]({'data':_0x10e8a5});});};exports[a2_0x1844('0x2e')]=(_0xd19cd3,_0x2b0cd0)=>{const _0x3548cd=_0xd19cd3[a2_0x1844('0x2f')][a2_0x1844('0x30')];const _0x5325ab=_0xd19cd3[a2_0x1844('0x2f')][a2_0x1844('0x31')];const _0x53bc62=_0xd19cd3[a2_0x1844('0x2f')][a2_0x1844('0x32')];exports['sequelize'][a2_0x1844('0x12')][a2_0x1844('0x2b')][a2_0x1844('0x2d')]({'attributes':[a2_0x1844('0x33'),[exports[a2_0x1844('0x4')]['fn'](a2_0x1844('0x34'),exports[a2_0x1844('0x4')][a2_0x1844('0x35')](a2_0x1844('0x36'))),'total']],'where':{'countingDate':{[exports[a2_0x1844('0x4')]['Op'][a2_0x1844('0x37')]]:_0x5325ab,[exports[a2_0x1844('0x4')]['Op']['lt']]:_0x53bc62},'amount':_0xd19cd3[a2_0x1844('0x38')]['direction']=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x1844('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x1844('0x4')][a2_0x1844('0x39')](a2_0x1844('0x3a'))],'order':[[a2_0x1844('0x33'),a2_0x1844('0x3b')]]})[a2_0x1844('0x1a')](_0x4c398c=>{_0x2b0cd0['json']({'data':_0x4c398c});});};exports[a2_0x1844('0x3c')]=(_0x283062,_0x587ee3)=>{const _0x3293b5=_0x283062[a2_0x1844('0x2f')]['month'];const _0x140783=_0x283062[a2_0x1844('0x2f')][a2_0x1844('0x31')];const _0x246105=_0x283062[a2_0x1844('0x2f')][a2_0x1844('0x32')];exports[a2_0x1844('0x4')]['models']['pass_counting'][a2_0x1844('0x2d')]({'attributes':['countingDate',[exports['sequelize']['fn']('DATE_FORMAT',exports[a2_0x1844('0x4')][a2_0x1844('0x35')]('countingDate'),'%Y-%m-%d\x20%H:00'),'countingDateShort'],[exports['sequelize']['fn'](a2_0x1844('0x34'),exports[a2_0x1844('0x4')][a2_0x1844('0x35')](a2_0x1844('0x36'))),a2_0x1844('0x3d')]],'where':{'countingDate':{[exports[a2_0x1844('0x4')]['Op']['gte']]:_0x140783,[exports[a2_0x1844('0x4')]['Op']['lt']]:_0x246105},'amount':_0x283062['params'][a2_0x1844('0x3e')]=='in'?{[exports[a2_0x1844('0x4')]['Op']['gt']]:0x0}:{[exports[a2_0x1844('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x1844('0x4')]['fn']('HOUR',exports[a2_0x1844('0x4')][a2_0x1844('0x35')](a2_0x1844('0x33'))),exports[a2_0x1844('0x4')]['fn'](a2_0x1844('0x3f'),exports[a2_0x1844('0x4')][a2_0x1844('0x35')]('countingDate')),exports['sequelize']['fn'](a2_0x1844('0x40'),exports[a2_0x1844('0x4')][a2_0x1844('0x35')](a2_0x1844('0x33'))),exports[a2_0x1844('0x4')]['fn'](a2_0x1844('0x41'),exports[a2_0x1844('0x4')][a2_0x1844('0x35')](a2_0x1844('0x33')))],'order':[[a2_0x1844('0x33'),a2_0x1844('0x3b')]]})[a2_0x1844('0x1a')](_0x57face=>{_0x587ee3[a2_0x1844('0x11')]({'data':_0x57face});});};exports[a2_0x1844('0x42')]=(_0x5a2bc,_0xfec3d0,_0x29e137)=>{const _0x4ff823=_0x5a2bc[a2_0x1844('0x43')][a2_0x1844('0x44')][a2_0x1844('0x45')](_0x4ff823=>_0x4ff823[a2_0x1844('0x46')]==='facebook');fbgraph_1[a2_0x1844('0x21')][a2_0x1844('0x47')](_0x4ff823[a2_0x1844('0x48')]);fbgraph_1[a2_0x1844('0x21')][a2_0x1844('0x49')](_0x5a2bc['user'][a2_0x1844('0x4a')]+a2_0x1844('0x4b'),(_0x1dc00d,_0x11d77e)=>{if(_0x1dc00d){return _0x29e137(_0x1dc00d);}_0xfec3d0[a2_0x1844('0x7')](a2_0x1844('0x4c'),{'title':a2_0x1844('0x4d'),'profile':_0x11d77e});});};
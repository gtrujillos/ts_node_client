var a2_0x4ed4=['API\x20Examples','log','connecting','default','colombia','Downloading:\x20','endsWith','json','report_files','name','spread','push','error','connect','ipd','downloadFtp','then','connected:','get','colombia/','end','media/','fileName','pipe','createWriteStream','Downloaded:\x20','ftp.vivotek.com','processFtp','findOne','.txt','readFile','status','parse','CountingInfo','Out','EndTime','models','pass_counting','create','getPassCounting','findAll','ASC','getPassCountingByDay','month','query','endDate','countingDate','sum','amount','gte','params','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','col','countingDateShort','total','direction','HOUR','DAY','YEAR','getFacebook','find','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook','__esModule','fbgraph','ftp','sequelize','setSequelize','getApi','api/index'];(function(_0x2d8f05,_0x4b81bb){var _0x4d74cb=function(_0x32719f){while(--_0x32719f){_0x2d8f05['push'](_0x2d8f05['shift']());}};_0x4d74cb(++_0x4b81bb);}(a2_0x4ed4,0x91));var a2_0x3c05=function(_0x3cacce,_0x42b519){_0x3cacce=_0x3cacce-0x0;var _0x825095=a2_0x4ed4[_0x3cacce];return _0x825095;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x4f6ed0){return _0x4f6ed0&&_0x4f6ed0['__esModule']?_0x4f6ed0:{'default':_0x4f6ed0};};Object['defineProperty'](exports,a2_0x3c05('0x0'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x3c05('0x1')));const ftp_1=__importDefault(require(a2_0x3c05('0x2')));const fs_1=__importDefault(require('fs'));exports[a2_0x3c05('0x3')]='';function setSequelize(_0x2ec654){exports[a2_0x3c05('0x3')]=_0x2ec654;}exports[a2_0x3c05('0x4')]=setSequelize;exports[a2_0x3c05('0x5')]=(_0x3d812e,_0xaaf670)=>{_0xaaf670['render'](a2_0x3c05('0x6'),{'title':a2_0x3c05('0x7')});};exports['syncFtp']=(_0x178fc0,_0x616014)=>{console[a2_0x3c05('0x8')](a2_0x3c05('0x9'));const _0x232f40=[];const _0x2a1322=new ftp_1[(a2_0x3c05('0xa'))]();_0x2a1322['on']('ready',function(){console[a2_0x3c05('0x8')]('connected');_0x2a1322['list'](a2_0x3c05('0xb'),![],function(_0x474108,_0x1f72d8){if(_0x474108){}else{for(const _0x365e49 of _0x1f72d8){console[a2_0x3c05('0x8')](a2_0x3c05('0xc')+_0x365e49['name']);if(_0x365e49['name'][a2_0x3c05('0xd')](a2_0x3c05('0xe'))){exports[a2_0x3c05('0x3')]['models'][a2_0x3c05('0xf')]['findOrCreate']({'where':{'fileName':_0x365e49[a2_0x3c05('0x10')]}})[a2_0x3c05('0x11')]((_0x164fb2,_0x536ebd)=>{if(_0x536ebd){console[a2_0x3c05('0x8')](_0x365e49['name']);_0x232f40[a2_0x3c05('0x12')](_0x164fb2);}});}}}_0x616014[a2_0x3c05('0xe')]({'data':_0x232f40});});});_0x2a1322['on'](a2_0x3c05('0x13'),function(_0x5a22a3){_0x616014['json']({'message':_0x5a22a3});});_0x2a1322[a2_0x3c05('0x14')]({'host':'ftp.vivotek.com','port':0x15,'user':a2_0x3c05('0x15'),'password':a2_0x3c05('0x15')});};exports[a2_0x3c05('0x16')]=(_0x25da29,_0x2db2dd)=>{exports[a2_0x3c05('0x3')]['models']['report_files']['findOne']({'where':{'status':null}})[a2_0x3c05('0x17')](_0x3eaedf=>{if(_0x3eaedf){const _0x30282b=new ftp_1[(a2_0x3c05('0xa'))]();_0x30282b['on']('ready',function(){console[a2_0x3c05('0x8')](a2_0x3c05('0x18')+_0x3eaedf['fileName']);_0x30282b[a2_0x3c05('0x19')](a2_0x3c05('0x1a')+_0x3eaedf['fileName'],function(_0x14cec8,_0x26cdec){_0x30282b[a2_0x3c05('0x1b')]();if(_0x14cec8){}else{const _0x120bd3=a2_0x3c05('0x1c')+_0x3eaedf[a2_0x3c05('0x1d')]+'.txt';_0x26cdec[a2_0x3c05('0x1e')](fs_1[a2_0x3c05('0xa')][a2_0x3c05('0x1f')](_0x120bd3));_0x3eaedf['status']=0x1;_0x3eaedf['save']();console[a2_0x3c05('0x8')](a2_0x3c05('0x20')+_0x3eaedf[a2_0x3c05('0x1d')]);}});});_0x30282b['on'](a2_0x3c05('0x13'),function(_0x13094a){_0x2db2dd[a2_0x3c05('0xe')]({'message':_0x13094a});});_0x30282b[a2_0x3c05('0x14')]({'host':a2_0x3c05('0x21'),'port':0x15,'user':a2_0x3c05('0x15'),'password':a2_0x3c05('0x15')});_0x2db2dd[a2_0x3c05('0xe')]({'data':_0x3eaedf[a2_0x3c05('0x1d')]});}else{_0x2db2dd['json']({'data':[]});}});};exports[a2_0x3c05('0x22')]=(_0x48ec13,_0x4b76c7)=>{exports[a2_0x3c05('0x3')]['models'][a2_0x3c05('0xf')][a2_0x3c05('0x23')]({'where':{'status':0x1}})[a2_0x3c05('0x17')](_0x47c878=>{if(_0x47c878){const _0x2e6d96=a2_0x3c05('0x1c')+_0x47c878[a2_0x3c05('0x1d')]+a2_0x3c05('0x24');fs_1[a2_0x3c05('0xa')][a2_0x3c05('0x25')](_0x2e6d96,'utf8',function(_0xff07bd,_0x1fb7c5){if(_0xff07bd){_0x47c878[a2_0x3c05('0x26')]=null;}else{try{const _0x407831=JSON[a2_0x3c05('0x27')](_0x1fb7c5);for(const _0xd92957 of _0x407831['Data'][0x0][a2_0x3c05('0x28')]){const _0x501e47=_0xd92957['In'];const _0x530748=_0xd92957[a2_0x3c05('0x29')];const _0x540aa3=Date[a2_0x3c05('0x27')](_0xd92957[a2_0x3c05('0x2a')]);if(_0x501e47>0x0){exports[a2_0x3c05('0x3')][a2_0x3c05('0x2b')][a2_0x3c05('0x2c')][a2_0x3c05('0x2d')]({'reportFileId':_0x47c878['id'],'amount':_0x501e47,'countingDate':_0x540aa3});}if(_0x530748>0x0){exports[a2_0x3c05('0x3')]['models'][a2_0x3c05('0x2c')][a2_0x3c05('0x2d')]({'reportFileId':_0x47c878['id'],'amount':_0x530748*-0x1,'countingDate':_0x540aa3});}}_0x47c878[a2_0x3c05('0x26')]=0x2;}catch(_0x3224c7){_0x47c878[a2_0x3c05('0x26')]=null;}}_0x47c878['save']();});_0x4b76c7[a2_0x3c05('0xe')]({'data':_0x47c878[a2_0x3c05('0x1d')]});}else{_0x4b76c7[a2_0x3c05('0xe')]({'data':[]});}});};exports[a2_0x3c05('0x2e')]=(_0x1b0d0e,_0x4fde97)=>{exports['sequelize'][a2_0x3c05('0x2b')][a2_0x3c05('0x2c')][a2_0x3c05('0x2f')]({'where':{'amount':{[exports[a2_0x3c05('0x3')]['Op']['gt']]:0x0}},'order':[['countingDate',a2_0x3c05('0x30')]]})[a2_0x3c05('0x17')](_0x32cf3b=>{_0x4fde97['json']({'data':_0x32cf3b});});};exports[a2_0x3c05('0x31')]=(_0x42d1eb,_0xd0e121)=>{const _0x18663c=_0x42d1eb['query'][a2_0x3c05('0x32')];const _0x1b5b91=_0x42d1eb[a2_0x3c05('0x33')]['startDate'];const _0x246a86=_0x42d1eb[a2_0x3c05('0x33')][a2_0x3c05('0x34')];exports[a2_0x3c05('0x3')][a2_0x3c05('0x2b')]['pass_counting'][a2_0x3c05('0x2f')]({'attributes':[a2_0x3c05('0x35'),[exports[a2_0x3c05('0x3')]['fn'](a2_0x3c05('0x36'),exports[a2_0x3c05('0x3')]['col'](a2_0x3c05('0x37'))),'total']],'where':{'countingDate':{[exports[a2_0x3c05('0x3')]['Op'][a2_0x3c05('0x38')]]:_0x1b5b91,[exports[a2_0x3c05('0x3')]['Op']['lt']]:_0x246a86},'amount':_0x42d1eb[a2_0x3c05('0x39')]['direction']=='in'?{[exports[a2_0x3c05('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0x3c05('0x3')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a2_0x3c05('0x3a')](a2_0x3c05('0x3b'))],'order':[[a2_0x3c05('0x35'),'ASC']]})[a2_0x3c05('0x17')](_0xbf2127=>{_0xd0e121[a2_0x3c05('0xe')]({'data':_0xbf2127});});};exports[a2_0x3c05('0x3c')]=(_0xacada7,_0x20debf)=>{const _0x428326=_0xacada7[a2_0x3c05('0x33')][a2_0x3c05('0x32')];const _0x3c2e1e=_0xacada7[a2_0x3c05('0x33')]['startDate'];const _0x4da4ec=_0xacada7[a2_0x3c05('0x33')][a2_0x3c05('0x34')];exports[a2_0x3c05('0x3')][a2_0x3c05('0x2b')][a2_0x3c05('0x2c')][a2_0x3c05('0x2f')]({'attributes':['countingDate',[exports[a2_0x3c05('0x3')]['fn']('DATE_FORMAT',exports[a2_0x3c05('0x3')][a2_0x3c05('0x3d')](a2_0x3c05('0x35')),'%Y-%m-%d\x20%H:00'),a2_0x3c05('0x3e')],[exports[a2_0x3c05('0x3')]['fn'](a2_0x3c05('0x36'),exports[a2_0x3c05('0x3')][a2_0x3c05('0x3d')](a2_0x3c05('0x37'))),a2_0x3c05('0x3f')]],'where':{'countingDate':{[exports[a2_0x3c05('0x3')]['Op'][a2_0x3c05('0x38')]]:_0x3c2e1e,[exports[a2_0x3c05('0x3')]['Op']['lt']]:_0x4da4ec},'amount':_0xacada7[a2_0x3c05('0x39')][a2_0x3c05('0x40')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x3c05('0x3')]['fn'](a2_0x3c05('0x41'),exports[a2_0x3c05('0x3')]['col']('countingDate')),exports[a2_0x3c05('0x3')]['fn'](a2_0x3c05('0x42'),exports[a2_0x3c05('0x3')]['col'](a2_0x3c05('0x35'))),exports[a2_0x3c05('0x3')]['fn']('MONTH',exports[a2_0x3c05('0x3')]['col'](a2_0x3c05('0x35'))),exports['sequelize']['fn'](a2_0x3c05('0x43'),exports[a2_0x3c05('0x3')][a2_0x3c05('0x3d')](a2_0x3c05('0x35')))],'order':[['countingDate',a2_0x3c05('0x30')]]})[a2_0x3c05('0x17')](_0x103bd1=>{_0x20debf[a2_0x3c05('0xe')]({'data':_0x103bd1});});};exports[a2_0x3c05('0x44')]=(_0x943e1c,_0x18eadd,_0x20c3c7)=>{const _0x4b99d3=_0x943e1c['user']['tokens'][a2_0x3c05('0x45')](_0x4b99d3=>_0x4b99d3['kind']===a2_0x3c05('0x46'));fbgraph_1[a2_0x3c05('0xa')][a2_0x3c05('0x47')](_0x4b99d3[a2_0x3c05('0x48')]);fbgraph_1[a2_0x3c05('0xa')]['get'](_0x943e1c['user']['facebook']+a2_0x3c05('0x49'),(_0x17ce18,_0x151a45)=>{if(_0x17ce18){return _0x20c3c7(_0x17ce18);}_0x18eadd[a2_0x3c05('0x4a')](a2_0x3c05('0x4b'),{'title':'Facebook\x20API','profile':_0x151a45});});};
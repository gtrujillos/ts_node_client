var a2_0x15f2=['default','connected:','fileName','get','colombia/','media/','.txt','pipe','createWriteStream','status','save','Downloaded:\x20','ipd','processFtp','parse','Data','CountingInfo','EndTime','pass_counting','getPassCounting','countingDate','ASC','query','month','startDate','findAll','col','amount','total','params','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','endDate','%Y-%m-%d\x20%H:00','gte','HOUR','DAY','MONTH','YEAR','getFacebook','tokens','kind','facebook','setAccessToken','accessToken','user','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','__esModule','defineProperty','fbgraph','sequelize','setSequelize','render','api/index','API\x20Examples','log','connecting','ready','list','colombia','Downloading:\x20','name','endsWith','models','report_files','findOrCreate','spread','json','error','connect','ftp.vivotek.com','downloadFtp','findOne','then'];(function(_0x2d8f68,_0x201728){var _0x38f199=function(_0x51998c){while(--_0x51998c){_0x2d8f68['push'](_0x2d8f68['shift']());}};_0x38f199(++_0x201728);}(a2_0x15f2,0x16a));var a2_0x4372=function(_0x30494a,_0x52264f){_0x30494a=_0x30494a-0x0;var _0x15ac7b=a2_0x15f2[_0x30494a];return _0x15ac7b;};'use strict';var __importDefault=this&&this[a2_0x4372('0x0')]||function(_0x3fb5bc){return _0x3fb5bc&&_0x3fb5bc[a2_0x4372('0x1')]?_0x3fb5bc:{'default':_0x3fb5bc};};Object[a2_0x4372('0x2')](exports,a2_0x4372('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x4372('0x3')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));exports['sequelize']='';function setSequelize(_0x31816b){exports[a2_0x4372('0x4')]=_0x31816b;}exports[a2_0x4372('0x5')]=setSequelize;exports['getApi']=(_0x3ff68c,_0x42df07)=>{_0x42df07[a2_0x4372('0x6')](a2_0x4372('0x7'),{'title':a2_0x4372('0x8')});};exports['syncFtp']=(_0x21585c,_0x4de1db)=>{console[a2_0x4372('0x9')](a2_0x4372('0xa'));const _0x3750cc=[];const _0x4d0473=new ftp_1['default']();_0x4d0473['on'](a2_0x4372('0xb'),function(){console[a2_0x4372('0x9')]('connected');_0x4d0473[a2_0x4372('0xc')](a2_0x4372('0xd'),![],function(_0x1ef2a6,_0x5c47ba){if(_0x1ef2a6){}else{for(const _0xa12086 of _0x5c47ba){console[a2_0x4372('0x9')](a2_0x4372('0xe')+_0xa12086[a2_0x4372('0xf')]);if(_0xa12086[a2_0x4372('0xf')][a2_0x4372('0x10')]('json')){exports['sequelize'][a2_0x4372('0x11')][a2_0x4372('0x12')][a2_0x4372('0x13')]({'where':{'fileName':_0xa12086[a2_0x4372('0xf')]}})[a2_0x4372('0x14')]((_0x5bc018,_0x4dfb06)=>{if(_0x4dfb06){console[a2_0x4372('0x9')](_0xa12086[a2_0x4372('0xf')]);_0x3750cc['push'](_0x5bc018);}});}}}_0x4de1db[a2_0x4372('0x15')]({'data':_0x3750cc});});});_0x4d0473['on'](a2_0x4372('0x16'),function(_0x195d25){_0x4de1db[a2_0x4372('0x15')]({'message':_0x195d25});});_0x4d0473[a2_0x4372('0x17')]({'host':a2_0x4372('0x18'),'port':0x15,'user':'ipd','password':'ipd'});};exports[a2_0x4372('0x19')]=(_0x25da29,_0x47a81a)=>{exports[a2_0x4372('0x4')][a2_0x4372('0x11')][a2_0x4372('0x12')][a2_0x4372('0x1a')]({'where':{'status':null}})[a2_0x4372('0x1b')](_0x53b12b=>{if(_0x53b12b){const _0x5d61a0=new ftp_1[(a2_0x4372('0x1c'))]();_0x5d61a0['on']('ready',function(){console['log'](a2_0x4372('0x1d')+_0x53b12b[a2_0x4372('0x1e')]);_0x5d61a0[a2_0x4372('0x1f')](a2_0x4372('0x20')+_0x53b12b[a2_0x4372('0x1e')],function(_0x5ce3aa,_0x228117){_0x5d61a0['end']();if(_0x5ce3aa){}else{const _0x125096=a2_0x4372('0x21')+_0x53b12b[a2_0x4372('0x1e')]+a2_0x4372('0x22');_0x228117[a2_0x4372('0x23')](fs_1[a2_0x4372('0x1c')][a2_0x4372('0x24')](_0x125096));_0x53b12b[a2_0x4372('0x25')]=0x1;_0x53b12b[a2_0x4372('0x26')]();console[a2_0x4372('0x9')](a2_0x4372('0x27')+_0x53b12b[a2_0x4372('0x1e')]);}});});_0x5d61a0['on'](a2_0x4372('0x16'),function(_0x5eeacd){_0x47a81a[a2_0x4372('0x15')]({'message':_0x5eeacd});});_0x5d61a0[a2_0x4372('0x17')]({'host':'ftp.vivotek.com','port':0x15,'user':a2_0x4372('0x28'),'password':a2_0x4372('0x28')});_0x47a81a[a2_0x4372('0x15')]({'data':_0x53b12b['fileName']});}else{_0x47a81a[a2_0x4372('0x15')]({'data':[]});}});};exports[a2_0x4372('0x29')]=(_0x14de1f,_0x2900cd)=>{exports[a2_0x4372('0x4')][a2_0x4372('0x11')][a2_0x4372('0x12')][a2_0x4372('0x1a')]({'where':{'status':0x1}})['then'](_0x1794bc=>{if(_0x1794bc){const _0x136518=a2_0x4372('0x21')+_0x1794bc['fileName']+a2_0x4372('0x22');fs_1['default']['readFile'](_0x136518,'utf8',function(_0x36454b,_0x219a96){if(_0x36454b){_0x1794bc['status']=null;}else{try{const _0x30aac6=JSON[a2_0x4372('0x2a')](_0x219a96);for(const _0x2e481f of _0x30aac6[a2_0x4372('0x2b')][0x0][a2_0x4372('0x2c')]){const _0xebf799=_0x2e481f['In'];const _0x464adf=_0x2e481f['Out'];const _0x1b453c=Date[a2_0x4372('0x2a')](_0x2e481f[a2_0x4372('0x2d')]);if(_0xebf799>0x0){exports[a2_0x4372('0x4')][a2_0x4372('0x11')][a2_0x4372('0x2e')]['create']({'reportFileId':_0x1794bc['id'],'amount':_0xebf799,'countingDate':_0x1b453c});}if(_0x464adf>0x0){exports[a2_0x4372('0x4')]['models'][a2_0x4372('0x2e')]['create']({'reportFileId':_0x1794bc['id'],'amount':_0x464adf*-0x1,'countingDate':_0x1b453c});}}_0x1794bc[a2_0x4372('0x25')]=0x2;}catch(_0x16a7ba){_0x1794bc[a2_0x4372('0x25')]=null;}}_0x1794bc['save']();});_0x2900cd[a2_0x4372('0x15')]({'data':_0x1794bc[a2_0x4372('0x1e')]});}else{_0x2900cd[a2_0x4372('0x15')]({'data':[]});}});};exports[a2_0x4372('0x2f')]=(_0x5b8624,_0x54f971)=>{exports['sequelize'][a2_0x4372('0x11')][a2_0x4372('0x2e')]['findAll']({'where':{'amount':{[exports[a2_0x4372('0x4')]['Op']['gt']]:0x0}},'order':[[a2_0x4372('0x30'),a2_0x4372('0x31')]]})[a2_0x4372('0x1b')](_0x3741f5=>{_0x54f971['json']({'data':_0x3741f5});});};exports['getPassCountingByDay']=(_0x1fcacf,_0x663fec)=>{const _0x31ddaa=_0x1fcacf[a2_0x4372('0x32')][a2_0x4372('0x33')];const _0x789559=_0x1fcacf[a2_0x4372('0x32')][a2_0x4372('0x34')];const _0x340d8b=_0x1fcacf[a2_0x4372('0x32')]['endDate'];exports[a2_0x4372('0x4')][a2_0x4372('0x11')][a2_0x4372('0x2e')][a2_0x4372('0x35')]({'attributes':[a2_0x4372('0x30'),[exports['sequelize']['fn']('sum',exports['sequelize'][a2_0x4372('0x36')](a2_0x4372('0x37'))),a2_0x4372('0x38')]],'where':{'countingDate':{[exports[a2_0x4372('0x4')]['Op']['gte']]:_0x789559,[exports['sequelize']['Op']['lt']]:_0x340d8b},'amount':_0x1fcacf[a2_0x4372('0x39')][a2_0x4372('0x3a')]=='in'?{[exports[a2_0x4372('0x4')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x4372('0x4')]['literal'](a2_0x4372('0x3b'))],'order':[[a2_0x4372('0x30'),a2_0x4372('0x31')]]})[a2_0x4372('0x1b')](_0x408fa6=>{_0x663fec[a2_0x4372('0x15')]({'data':_0x408fa6});});};exports[a2_0x4372('0x3c')]=(_0x4deaab,_0x132625)=>{const _0x309f45=_0x4deaab[a2_0x4372('0x32')][a2_0x4372('0x33')];const _0xc5edba=_0x4deaab[a2_0x4372('0x32')][a2_0x4372('0x34')];const _0x1eb455=_0x4deaab[a2_0x4372('0x32')][a2_0x4372('0x3d')];exports[a2_0x4372('0x4')][a2_0x4372('0x11')][a2_0x4372('0x2e')][a2_0x4372('0x35')]({'attributes':[a2_0x4372('0x30'),[exports[a2_0x4372('0x4')]['fn']('DATE_FORMAT',exports[a2_0x4372('0x4')][a2_0x4372('0x36')](a2_0x4372('0x30')),a2_0x4372('0x3e')),'countingDateShort'],[exports[a2_0x4372('0x4')]['fn']('sum',exports[a2_0x4372('0x4')][a2_0x4372('0x36')]('amount')),a2_0x4372('0x38')]],'where':{'countingDate':{[exports[a2_0x4372('0x4')]['Op'][a2_0x4372('0x3f')]]:_0xc5edba,[exports[a2_0x4372('0x4')]['Op']['lt']]:_0x1eb455},'amount':_0x4deaab[a2_0x4372('0x39')]['direction']=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x4372('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x4372('0x4')]['fn'](a2_0x4372('0x40'),exports[a2_0x4372('0x4')][a2_0x4372('0x36')]('countingDate')),exports[a2_0x4372('0x4')]['fn'](a2_0x4372('0x41'),exports[a2_0x4372('0x4')][a2_0x4372('0x36')](a2_0x4372('0x30'))),exports[a2_0x4372('0x4')]['fn'](a2_0x4372('0x42'),exports[a2_0x4372('0x4')]['col'](a2_0x4372('0x30'))),exports['sequelize']['fn'](a2_0x4372('0x43'),exports[a2_0x4372('0x4')][a2_0x4372('0x36')]('countingDate'))],'order':[[a2_0x4372('0x30'),a2_0x4372('0x31')]]})[a2_0x4372('0x1b')](_0x5300c8=>{_0x132625[a2_0x4372('0x15')]({'data':_0x5300c8});});};exports[a2_0x4372('0x44')]=(_0x2644a6,_0x2b225e,_0x15942)=>{const _0x402ae6=_0x2644a6['user'][a2_0x4372('0x45')]['find'](_0x402ae6=>_0x402ae6[a2_0x4372('0x46')]===a2_0x4372('0x47'));fbgraph_1[a2_0x4372('0x1c')][a2_0x4372('0x48')](_0x402ae6[a2_0x4372('0x49')]);fbgraph_1[a2_0x4372('0x1c')][a2_0x4372('0x1f')](_0x2644a6[a2_0x4372('0x4a')][a2_0x4372('0x47')]+a2_0x4372('0x4b'),(_0x241201,_0x559210)=>{if(_0x241201){return _0x15942(_0x241201);}_0x2b225e[a2_0x4372('0x6')](a2_0x4372('0x4c'),{'title':a2_0x4372('0x4d'),'profile':_0x559210});});};
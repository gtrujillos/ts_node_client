var a2_0x3285=['list','colombia','Downloading:\x20','name','endsWith','json','report_files','findOrCreate','spread','connect','ftp.vivotek.com','ipd','downloadFtp','models','findOne','then','connected:','colombia/','fileName','end','media/','.txt','pipe','createWriteStream','status','save','Downloaded:\x20','error','processFtp','readFile','parse','CountingInfo','Out','EndTime','pass_counting','create','findAll','countingDate','ASC','getPassCountingByDay','query','month','startDate','sum','col','amount','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','endDate','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','HOUR','MONTH','YEAR','user','find','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','defineProperty','__esModule','fbgraph','ftp','sequelize','setSequelize','render','api/index','API\x20Examples','syncFtp','log','connecting','default','ready','connected'];(function(_0x197883,_0x4e4f42){var _0x2dafce=function(_0x26117f){while(--_0x26117f){_0x197883['push'](_0x197883['shift']());}};_0x2dafce(++_0x4e4f42);}(a2_0x3285,0x13c));var a2_0x4f8d=function(_0x52b2e4,_0x41125b){_0x52b2e4=_0x52b2e4-0x0;var _0x397c09=a2_0x3285[_0x52b2e4];return _0x397c09;};'use strict';var __importDefault=this&&this[a2_0x4f8d('0x0')]||function(_0x2d16b3){return _0x2d16b3&&_0x2d16b3['__esModule']?_0x2d16b3:{'default':_0x2d16b3};};Object[a2_0x4f8d('0x1')](exports,a2_0x4f8d('0x2'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x4f8d('0x3')));const ftp_1=__importDefault(require(a2_0x4f8d('0x4')));const fs_1=__importDefault(require('fs'));exports[a2_0x4f8d('0x5')]='';function setSequelize(_0x4ac7ae){exports[a2_0x4f8d('0x5')]=_0x4ac7ae;}exports[a2_0x4f8d('0x6')]=setSequelize;exports['getApi']=(_0x5b71b6,_0x3eb56b)=>{_0x3eb56b[a2_0x4f8d('0x7')](a2_0x4f8d('0x8'),{'title':a2_0x4f8d('0x9')});};exports[a2_0x4f8d('0xa')]=(_0xab58a8,_0x39e35c)=>{console[a2_0x4f8d('0xb')](a2_0x4f8d('0xc'));const _0x10aa61=[];const _0x4b1c43=new ftp_1[(a2_0x4f8d('0xd'))]();_0x4b1c43['on'](a2_0x4f8d('0xe'),function(){console[a2_0x4f8d('0xb')](a2_0x4f8d('0xf'));_0x4b1c43[a2_0x4f8d('0x10')](a2_0x4f8d('0x11'),![],function(_0x1b46e0,_0x1f07f3){if(_0x1b46e0){}else{for(const _0x4a6983 of _0x1f07f3){console[a2_0x4f8d('0xb')](a2_0x4f8d('0x12')+_0x4a6983[a2_0x4f8d('0x13')]);if(_0x4a6983['name'][a2_0x4f8d('0x14')](a2_0x4f8d('0x15'))){exports[a2_0x4f8d('0x5')]['models'][a2_0x4f8d('0x16')][a2_0x4f8d('0x17')]({'where':{'fileName':_0x4a6983[a2_0x4f8d('0x13')]}})[a2_0x4f8d('0x18')]((_0x236b69,_0x5c066c)=>{if(_0x5c066c){console[a2_0x4f8d('0xb')](_0x4a6983['name']);_0x10aa61['push'](_0x236b69);}});}}}_0x39e35c['json']({'data':_0x10aa61});});});_0x4b1c43['on']('error',function(_0x75c12c){_0x39e35c[a2_0x4f8d('0x15')]({'message':_0x75c12c});});_0x4b1c43[a2_0x4f8d('0x19')]({'host':a2_0x4f8d('0x1a'),'port':0x15,'user':a2_0x4f8d('0x1b'),'password':'ipd'});};exports[a2_0x4f8d('0x1c')]=(_0xbf5ca3,_0xb8f1d)=>{exports[a2_0x4f8d('0x5')][a2_0x4f8d('0x1d')][a2_0x4f8d('0x16')][a2_0x4f8d('0x1e')]({'where':{'status':null}})[a2_0x4f8d('0x1f')](_0x17e2c1=>{if(_0x17e2c1){const _0x3906ea=new ftp_1[(a2_0x4f8d('0xd'))]();_0x3906ea['on'](a2_0x4f8d('0xe'),function(){console[a2_0x4f8d('0xb')](a2_0x4f8d('0x20')+_0x17e2c1['fileName']);_0x3906ea['get'](a2_0x4f8d('0x21')+_0x17e2c1[a2_0x4f8d('0x22')],function(_0x487058,_0x28caca){_0x3906ea[a2_0x4f8d('0x23')]();if(_0x487058){}else{const _0x5a8c73=a2_0x4f8d('0x24')+_0x17e2c1['fileName']+a2_0x4f8d('0x25');_0x28caca[a2_0x4f8d('0x26')](fs_1[a2_0x4f8d('0xd')][a2_0x4f8d('0x27')](_0x5a8c73));_0x17e2c1[a2_0x4f8d('0x28')]=0x1;_0x17e2c1[a2_0x4f8d('0x29')]();console[a2_0x4f8d('0xb')](a2_0x4f8d('0x2a')+_0x17e2c1[a2_0x4f8d('0x22')]);}});});_0x3906ea['on'](a2_0x4f8d('0x2b'),function(_0x4a0899){_0xb8f1d[a2_0x4f8d('0x15')]({'message':_0x4a0899});});_0x3906ea['connect']({'host':a2_0x4f8d('0x1a'),'port':0x15,'user':'ipd','password':a2_0x4f8d('0x1b')});_0xb8f1d[a2_0x4f8d('0x15')]({'data':_0x17e2c1[a2_0x4f8d('0x22')]});}else{_0xb8f1d[a2_0x4f8d('0x15')]({'data':[]});}});};exports[a2_0x4f8d('0x2c')]=(_0x598f15,_0x2925bc)=>{exports['sequelize']['models'][a2_0x4f8d('0x16')]['findOne']({'where':{'status':0x1}})[a2_0x4f8d('0x1f')](_0x3a475a=>{if(_0x3a475a){const _0x335c66='media/'+_0x3a475a[a2_0x4f8d('0x22')]+a2_0x4f8d('0x25');fs_1['default'][a2_0x4f8d('0x2d')](_0x335c66,'utf8',function(_0x4c6fbd,_0x312dc9){if(_0x4c6fbd){_0x3a475a[a2_0x4f8d('0x28')]=null;}else{try{const _0x2bddde=JSON[a2_0x4f8d('0x2e')](_0x312dc9);for(const _0x49788a of _0x2bddde['Data'][0x0][a2_0x4f8d('0x2f')]){const _0x4e2d8b=_0x49788a['In'];const _0x3855c7=_0x49788a[a2_0x4f8d('0x30')];const _0x398054=Date[a2_0x4f8d('0x2e')](_0x49788a[a2_0x4f8d('0x31')]);if(_0x4e2d8b>0x0){exports[a2_0x4f8d('0x5')][a2_0x4f8d('0x1d')][a2_0x4f8d('0x32')][a2_0x4f8d('0x33')]({'reportFileId':_0x3a475a['id'],'amount':_0x4e2d8b,'countingDate':_0x398054});}if(_0x3855c7>0x0){exports[a2_0x4f8d('0x5')][a2_0x4f8d('0x1d')][a2_0x4f8d('0x32')][a2_0x4f8d('0x33')]({'reportFileId':_0x3a475a['id'],'amount':_0x3855c7*-0x1,'countingDate':_0x398054});}}_0x3a475a[a2_0x4f8d('0x28')]=0x2;}catch(_0x5685d1){_0x3a475a[a2_0x4f8d('0x28')]=null;}}_0x3a475a['save']();});_0x2925bc[a2_0x4f8d('0x15')]({'data':_0x3a475a[a2_0x4f8d('0x22')]});}else{_0x2925bc['json']({'data':[]});}});};exports['getPassCounting']=(_0x2f1940,_0x23bbd7)=>{exports[a2_0x4f8d('0x5')][a2_0x4f8d('0x1d')][a2_0x4f8d('0x32')][a2_0x4f8d('0x34')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a2_0x4f8d('0x35'),a2_0x4f8d('0x36')]]})[a2_0x4f8d('0x1f')](_0x3acb94=>{_0x23bbd7[a2_0x4f8d('0x15')]({'data':_0x3acb94});});};exports[a2_0x4f8d('0x37')]=(_0x317b55,_0x3f59e1)=>{const _0x631e7f=_0x317b55[a2_0x4f8d('0x38')][a2_0x4f8d('0x39')];const _0x36f17c=_0x317b55[a2_0x4f8d('0x38')][a2_0x4f8d('0x3a')];const _0x2cb7a1=_0x317b55[a2_0x4f8d('0x38')]['endDate'];exports[a2_0x4f8d('0x5')][a2_0x4f8d('0x1d')][a2_0x4f8d('0x32')][a2_0x4f8d('0x34')]({'attributes':['countingDate',[exports['sequelize']['fn'](a2_0x4f8d('0x3b'),exports[a2_0x4f8d('0x5')][a2_0x4f8d('0x3c')](a2_0x4f8d('0x3d'))),'total']],'where':{'countingDate':{[exports['sequelize']['Op'][a2_0x4f8d('0x3e')]]:_0x36f17c,[exports[a2_0x4f8d('0x5')]['Op']['lt']]:_0x2cb7a1},'amount':_0x317b55[a2_0x4f8d('0x3f')][a2_0x4f8d('0x40')]=='in'?{[exports[a2_0x4f8d('0x5')]['Op']['gt']]:0x0}:{[exports[a2_0x4f8d('0x5')]['Op']['lt']]:0x0}},'group':[exports[a2_0x4f8d('0x5')][a2_0x4f8d('0x41')](a2_0x4f8d('0x42'))],'order':[['countingDate','ASC']]})[a2_0x4f8d('0x1f')](_0x5bf636=>{_0x3f59e1['json']({'data':_0x5bf636});});};exports[a2_0x4f8d('0x43')]=(_0x55530b,_0x36272)=>{const _0x42bd2f=_0x55530b[a2_0x4f8d('0x38')][a2_0x4f8d('0x39')];const _0x1180a5=_0x55530b[a2_0x4f8d('0x38')][a2_0x4f8d('0x3a')];const _0x4a4f3a=_0x55530b['query'][a2_0x4f8d('0x44')];exports['sequelize'][a2_0x4f8d('0x1d')]['pass_counting'][a2_0x4f8d('0x34')]({'attributes':[a2_0x4f8d('0x35'),[exports[a2_0x4f8d('0x5')]['fn'](a2_0x4f8d('0x45'),exports[a2_0x4f8d('0x5')][a2_0x4f8d('0x3c')](a2_0x4f8d('0x35')),a2_0x4f8d('0x46')),a2_0x4f8d('0x47')],[exports['sequelize']['fn']('sum',exports[a2_0x4f8d('0x5')][a2_0x4f8d('0x3c')](a2_0x4f8d('0x3d'))),'total']],'where':{'countingDate':{[exports['sequelize']['Op']['gte']]:_0x1180a5,[exports[a2_0x4f8d('0x5')]['Op']['lt']]:_0x4a4f3a},'amount':_0x55530b[a2_0x4f8d('0x3f')][a2_0x4f8d('0x40')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x4f8d('0x5')]['Op']['lt']]:0x0}},'group':[exports[a2_0x4f8d('0x5')]['fn'](a2_0x4f8d('0x48'),exports[a2_0x4f8d('0x5')][a2_0x4f8d('0x3c')]('countingDate')),exports[a2_0x4f8d('0x5')]['fn']('DAY',exports[a2_0x4f8d('0x5')]['col']('countingDate')),exports[a2_0x4f8d('0x5')]['fn'](a2_0x4f8d('0x49'),exports[a2_0x4f8d('0x5')]['col'](a2_0x4f8d('0x35'))),exports['sequelize']['fn'](a2_0x4f8d('0x4a'),exports[a2_0x4f8d('0x5')][a2_0x4f8d('0x3c')](a2_0x4f8d('0x35')))],'order':[[a2_0x4f8d('0x35'),a2_0x4f8d('0x36')]]})[a2_0x4f8d('0x1f')](_0x16cb50=>{_0x36272[a2_0x4f8d('0x15')]({'data':_0x16cb50});});};exports['getFacebook']=(_0x2a1852,_0x2ce4b7,_0x52def8)=>{const _0x36ea62=_0x2a1852[a2_0x4f8d('0x4b')]['tokens'][a2_0x4f8d('0x4c')](_0x36ea62=>_0x36ea62['kind']===a2_0x4f8d('0x4d'));fbgraph_1[a2_0x4f8d('0xd')][a2_0x4f8d('0x4e')](_0x36ea62[a2_0x4f8d('0x4f')]);fbgraph_1[a2_0x4f8d('0xd')]['get'](_0x2a1852[a2_0x4f8d('0x4b')][a2_0x4f8d('0x4d')]+a2_0x4f8d('0x50'),(_0x111619,_0x22f616)=>{if(_0x111619){return _0x52def8(_0x111619);}_0x2ce4b7[a2_0x4f8d('0x7')](a2_0x4f8d('0x51'),{'title':a2_0x4f8d('0x52'),'profile':_0x22f616});});};
var a2_0x15da=['log','connecting','default','list','colombia','Downloading:\x20','name','endsWith','models','report_files','findOrCreate','spread','push','error','json','ftp.vivotek.com','ipd','downloadFtp','findOne','then','ready','connected:','get','colombia/','fileName','end','.txt','pipe','createWriteStream','status','save','Downloaded:\x20','processFtp','media/','readFile','utf8','parse','Data','CountingInfo','EndTime','pass_counting','create','findAll','countingDate','ASC','getPassCountingByDay','query','month','endDate','sum','col','amount','total','gte','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','startDate','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','direction','HOUR','YEAR','getFacebook','tokens','find','kind','facebook','setAccessToken','accessToken','user','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','__esModule','defineProperty','ftp','sequelize','setSequelize','getApi','render','api/index','syncFtp'];(function(_0x431c15,_0x56478f){var _0x1b20a2=function(_0x1b8cb9){while(--_0x1b8cb9){_0x431c15['push'](_0x431c15['shift']());}};_0x1b20a2(++_0x56478f);}(a2_0x15da,0xf2));var a2_0x3fb4=function(_0x15a272,_0x516b6a){_0x15a272=_0x15a272-0x0;var _0x4dd628=a2_0x15da[_0x15a272];return _0x4dd628;};'use strict';var __importDefault=this&&this[a2_0x3fb4('0x0')]||function(_0x5e1d81){return _0x5e1d81&&_0x5e1d81[a2_0x3fb4('0x1')]?_0x5e1d81:{'default':_0x5e1d81};};Object[a2_0x3fb4('0x2')](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require(a2_0x3fb4('0x3')));const fs_1=__importDefault(require('fs'));exports[a2_0x3fb4('0x4')]='';function setSequelize(_0x38f6a9){exports['sequelize']=_0x38f6a9;}exports[a2_0x3fb4('0x5')]=setSequelize;exports[a2_0x3fb4('0x6')]=(_0x1dcc57,_0x5cabf6)=>{_0x5cabf6[a2_0x3fb4('0x7')](a2_0x3fb4('0x8'),{'title':'API\x20Examples'});};exports[a2_0x3fb4('0x9')]=(_0x4694a1,_0x3f16b2)=>{console[a2_0x3fb4('0xa')](a2_0x3fb4('0xb'));const _0x550215=[];const _0x5e67b0=new ftp_1[(a2_0x3fb4('0xc'))]();_0x5e67b0['on']('ready',function(){console[a2_0x3fb4('0xa')]('connected');_0x5e67b0[a2_0x3fb4('0xd')](a2_0x3fb4('0xe'),![],function(_0x3b4914,_0x5377d3){if(_0x3b4914){}else{for(const _0x31b7ec of _0x5377d3){console['log'](a2_0x3fb4('0xf')+_0x31b7ec['name']);if(_0x31b7ec[a2_0x3fb4('0x10')][a2_0x3fb4('0x11')]('json')){exports['sequelize'][a2_0x3fb4('0x12')][a2_0x3fb4('0x13')][a2_0x3fb4('0x14')]({'where':{'fileName':_0x31b7ec[a2_0x3fb4('0x10')]}})[a2_0x3fb4('0x15')]((_0x2b91bc,_0x467e15)=>{if(_0x467e15){console[a2_0x3fb4('0xa')](_0x31b7ec[a2_0x3fb4('0x10')]);_0x550215[a2_0x3fb4('0x16')](_0x2b91bc);}});}}}_0x3f16b2['json']({'data':_0x550215});});});_0x5e67b0['on'](a2_0x3fb4('0x17'),function(_0x4e156f){_0x3f16b2[a2_0x3fb4('0x18')]({'message':_0x4e156f});});_0x5e67b0['connect']({'host':a2_0x3fb4('0x19'),'port':0x15,'user':a2_0x3fb4('0x1a'),'password':a2_0x3fb4('0x1a')});};exports[a2_0x3fb4('0x1b')]=(_0x33b851,_0x51faf1)=>{exports[a2_0x3fb4('0x4')][a2_0x3fb4('0x12')]['report_files'][a2_0x3fb4('0x1c')]({'where':{'status':null}})[a2_0x3fb4('0x1d')](_0x520aae=>{if(_0x520aae){const _0x1cc44b=new ftp_1[(a2_0x3fb4('0xc'))]();_0x1cc44b['on'](a2_0x3fb4('0x1e'),function(){console[a2_0x3fb4('0xa')](a2_0x3fb4('0x1f')+_0x520aae['fileName']);_0x1cc44b[a2_0x3fb4('0x20')](a2_0x3fb4('0x21')+_0x520aae[a2_0x3fb4('0x22')],function(_0xeaa63,_0x227fa9){_0x1cc44b[a2_0x3fb4('0x23')]();if(_0xeaa63){}else{const _0x535590='media/'+_0x520aae['fileName']+a2_0x3fb4('0x24');_0x227fa9[a2_0x3fb4('0x25')](fs_1[a2_0x3fb4('0xc')][a2_0x3fb4('0x26')](_0x535590));_0x520aae[a2_0x3fb4('0x27')]=0x1;_0x520aae[a2_0x3fb4('0x28')]();console[a2_0x3fb4('0xa')](a2_0x3fb4('0x29')+_0x520aae[a2_0x3fb4('0x22')]);}});});_0x1cc44b['on'](a2_0x3fb4('0x17'),function(_0x17929d){_0x51faf1['json']({'message':_0x17929d});});_0x1cc44b['connect']({'host':a2_0x3fb4('0x19'),'port':0x15,'user':a2_0x3fb4('0x1a'),'password':a2_0x3fb4('0x1a')});_0x51faf1[a2_0x3fb4('0x18')]({'data':_0x520aae[a2_0x3fb4('0x22')]});}else{_0x51faf1[a2_0x3fb4('0x18')]({'data':[]});}});};exports[a2_0x3fb4('0x2a')]=(_0x5c1fa0,_0x2f477e)=>{exports[a2_0x3fb4('0x4')]['models'][a2_0x3fb4('0x13')]['findOne']({'where':{'status':0x1}})['then'](_0x2f0aee=>{if(_0x2f0aee){const _0x37894a=a2_0x3fb4('0x2b')+_0x2f0aee[a2_0x3fb4('0x22')]+a2_0x3fb4('0x24');fs_1[a2_0x3fb4('0xc')][a2_0x3fb4('0x2c')](_0x37894a,a2_0x3fb4('0x2d'),function(_0x20b8eb,_0x35e928){if(_0x20b8eb){_0x2f0aee[a2_0x3fb4('0x27')]=null;}else{try{const _0x8a65fa=JSON[a2_0x3fb4('0x2e')](_0x35e928);for(const _0x4bd1a0 of _0x8a65fa[a2_0x3fb4('0x2f')][0x0][a2_0x3fb4('0x30')]){const _0x467c02=_0x4bd1a0['In'];const _0xa191b1=_0x4bd1a0['Out'];const _0x181201=Date['parse'](_0x4bd1a0[a2_0x3fb4('0x31')]);if(_0x467c02>0x0){exports[a2_0x3fb4('0x4')][a2_0x3fb4('0x12')][a2_0x3fb4('0x32')]['create']({'reportFileId':_0x2f0aee['id'],'amount':_0x467c02,'countingDate':_0x181201});}if(_0xa191b1>0x0){exports[a2_0x3fb4('0x4')]['models'][a2_0x3fb4('0x32')][a2_0x3fb4('0x33')]({'reportFileId':_0x2f0aee['id'],'amount':_0xa191b1*-0x1,'countingDate':_0x181201});}}_0x2f0aee[a2_0x3fb4('0x27')]=0x2;}catch(_0x158516){_0x2f0aee[a2_0x3fb4('0x27')]=null;}}_0x2f0aee[a2_0x3fb4('0x28')]();});_0x2f477e[a2_0x3fb4('0x18')]({'data':_0x2f0aee[a2_0x3fb4('0x22')]});}else{_0x2f477e[a2_0x3fb4('0x18')]({'data':[]});}});};exports['getPassCounting']=(_0x154fe8,_0x3a3d74)=>{exports['sequelize'][a2_0x3fb4('0x12')][a2_0x3fb4('0x32')][a2_0x3fb4('0x34')]({'where':{'amount':{[exports[a2_0x3fb4('0x4')]['Op']['gt']]:0x0}},'order':[[a2_0x3fb4('0x35'),a2_0x3fb4('0x36')]]})['then'](_0x45497f=>{_0x3a3d74[a2_0x3fb4('0x18')]({'data':_0x45497f});});};exports[a2_0x3fb4('0x37')]=(_0x360ded,_0x43ac84)=>{const _0x3484ad=_0x360ded[a2_0x3fb4('0x38')][a2_0x3fb4('0x39')];const _0x2168b5=_0x360ded[a2_0x3fb4('0x38')]['startDate'];const _0x3e9698=_0x360ded['query'][a2_0x3fb4('0x3a')];exports[a2_0x3fb4('0x4')]['models'][a2_0x3fb4('0x32')][a2_0x3fb4('0x34')]({'attributes':['countingDate',[exports[a2_0x3fb4('0x4')]['fn'](a2_0x3fb4('0x3b'),exports['sequelize'][a2_0x3fb4('0x3c')](a2_0x3fb4('0x3d'))),a2_0x3fb4('0x3e')]],'where':{'countingDate':{[exports[a2_0x3fb4('0x4')]['Op'][a2_0x3fb4('0x3f')]]:_0x2168b5,[exports[a2_0x3fb4('0x4')]['Op']['lt']]:_0x3e9698},'amount':_0x360ded['params']['direction']=='in'?{[exports[a2_0x3fb4('0x4')]['Op']['gt']]:0x0}:{[exports[a2_0x3fb4('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x3fb4('0x4')][a2_0x3fb4('0x40')](a2_0x3fb4('0x41'))],'order':[[a2_0x3fb4('0x35'),a2_0x3fb4('0x36')]]})[a2_0x3fb4('0x1d')](_0x1bc504=>{_0x43ac84[a2_0x3fb4('0x18')]({'data':_0x1bc504});});};exports['getPassCountingByHour']=(_0x55e7ca,_0x44edeb)=>{const _0x4ae128=_0x55e7ca[a2_0x3fb4('0x38')][a2_0x3fb4('0x39')];const _0x321ee5=_0x55e7ca['query'][a2_0x3fb4('0x42')];const _0x26ff55=_0x55e7ca[a2_0x3fb4('0x38')][a2_0x3fb4('0x3a')];exports[a2_0x3fb4('0x4')][a2_0x3fb4('0x12')][a2_0x3fb4('0x32')][a2_0x3fb4('0x34')]({'attributes':['countingDate',[exports['sequelize']['fn'](a2_0x3fb4('0x43'),exports['sequelize'][a2_0x3fb4('0x3c')](a2_0x3fb4('0x35')),a2_0x3fb4('0x44')),a2_0x3fb4('0x45')],[exports[a2_0x3fb4('0x4')]['fn'](a2_0x3fb4('0x3b'),exports[a2_0x3fb4('0x4')]['col'](a2_0x3fb4('0x3d'))),a2_0x3fb4('0x3e')]],'where':{'countingDate':{[exports[a2_0x3fb4('0x4')]['Op'][a2_0x3fb4('0x3f')]]:_0x321ee5,[exports[a2_0x3fb4('0x4')]['Op']['lt']]:_0x26ff55},'amount':_0x55e7ca['params'][a2_0x3fb4('0x46')]=='in'?{[exports[a2_0x3fb4('0x4')]['Op']['gt']]:0x0}:{[exports[a2_0x3fb4('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x3fb4('0x4')]['fn'](a2_0x3fb4('0x47'),exports[a2_0x3fb4('0x4')][a2_0x3fb4('0x3c')](a2_0x3fb4('0x35'))),exports[a2_0x3fb4('0x4')]['fn']('DAY',exports[a2_0x3fb4('0x4')][a2_0x3fb4('0x3c')](a2_0x3fb4('0x35'))),exports['sequelize']['fn']('MONTH',exports[a2_0x3fb4('0x4')][a2_0x3fb4('0x3c')](a2_0x3fb4('0x35'))),exports[a2_0x3fb4('0x4')]['fn'](a2_0x3fb4('0x48'),exports[a2_0x3fb4('0x4')][a2_0x3fb4('0x3c')](a2_0x3fb4('0x35')))],'order':[['countingDate',a2_0x3fb4('0x36')]]})[a2_0x3fb4('0x1d')](_0xe025a4=>{_0x44edeb[a2_0x3fb4('0x18')]({'data':_0xe025a4});});};exports[a2_0x3fb4('0x49')]=(_0x3148d8,_0x49441a,_0x13a472)=>{const _0x272756=_0x3148d8['user'][a2_0x3fb4('0x4a')][a2_0x3fb4('0x4b')](_0x272756=>_0x272756[a2_0x3fb4('0x4c')]===a2_0x3fb4('0x4d'));fbgraph_1[a2_0x3fb4('0xc')][a2_0x3fb4('0x4e')](_0x272756[a2_0x3fb4('0x4f')]);fbgraph_1[a2_0x3fb4('0xc')][a2_0x3fb4('0x20')](_0x3148d8[a2_0x3fb4('0x50')][a2_0x3fb4('0x4d')]+a2_0x3fb4('0x51'),(_0x13ae1b,_0x34e45d)=>{if(_0x13ae1b){return _0x13a472(_0x13ae1b);}_0x49441a[a2_0x3fb4('0x7')](a2_0x3fb4('0x52'),{'title':a2_0x3fb4('0x53'),'profile':_0x34e45d});});};
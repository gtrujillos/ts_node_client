var a2_0x49cf=['ready','log','connected','list','endsWith','models','findOrCreate','name','spread','push','error','json','connect','ftp.vivotek.com','ipd','downloadFtp','report_files','findOne','then','connected:','fileName','media/','pipe','createWriteStream','save','processFtp','.txt','readFile','utf8','CountingInfo','Out','parse','EndTime','pass_counting','create','status','getPassCounting','countingDate','getPassCountingByDay','query','month','endDate','sum','amount','gte','params','direction','literal','ASC','getPassCountingByHour','startDate','findAll','DATE_FORMAT','col','countingDateShort','total','HOUR','DAY','MONTH','YEAR','getFacebook','user','tokens','find','kind','facebook','setAccessToken','get','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__esModule','defineProperty','ftp','sequelize','getApi','render','api/index','syncFtp','default'];(function(_0x2b2fde,_0x53f779){var _0x147b65=function(_0x193053){while(--_0x193053){_0x2b2fde['push'](_0x2b2fde['shift']());}};_0x147b65(++_0x53f779);}(a2_0x49cf,0x97));var a2_0x4146=function(_0x295d0a,_0x16971b){_0x295d0a=_0x295d0a-0x0;var _0x4b286a=a2_0x49cf[_0x295d0a];return _0x4b286a;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x99da55){return _0x99da55&&_0x99da55[a2_0x4146('0x0')]?_0x99da55:{'default':_0x99da55};};Object[a2_0x4146('0x1')](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require(a2_0x4146('0x2')));const fs_1=__importDefault(require('fs'));exports['sequelize']='';function setSequelize(_0x5e7a71){exports[a2_0x4146('0x3')]=_0x5e7a71;}exports['setSequelize']=setSequelize;exports[a2_0x4146('0x4')]=(_0xf98785,_0x2ee9d6)=>{_0x2ee9d6[a2_0x4146('0x5')](a2_0x4146('0x6'),{'title':'API\x20Examples'});};exports[a2_0x4146('0x7')]=(_0x5d9fa3,_0x52a464)=>{console['log']('connecting');const _0x3a9493=[];const _0xc6e772=new ftp_1[(a2_0x4146('0x8'))]();_0xc6e772['on'](a2_0x4146('0x9'),function(){console[a2_0x4146('0xa')](a2_0x4146('0xb'));_0xc6e772[a2_0x4146('0xc')]('colombia',![],function(_0x2a4b51,_0x43a27e){if(_0x2a4b51){}else{for(const _0x207649 of _0x43a27e){console[a2_0x4146('0xa')]('Downloading:\x20'+_0x207649['name']);if(_0x207649['name'][a2_0x4146('0xd')]('json')){exports[a2_0x4146('0x3')][a2_0x4146('0xe')]['report_files'][a2_0x4146('0xf')]({'where':{'fileName':_0x207649[a2_0x4146('0x10')]}})[a2_0x4146('0x11')]((_0x4e5e6,_0x52cdcf)=>{if(_0x52cdcf){console[a2_0x4146('0xa')](_0x207649[a2_0x4146('0x10')]);_0x3a9493[a2_0x4146('0x12')](_0x4e5e6);}});}}}_0x52a464['json']({'data':_0x3a9493});});});_0xc6e772['on'](a2_0x4146('0x13'),function(_0x15cbe0){_0x52a464[a2_0x4146('0x14')]({'message':_0x15cbe0});});_0xc6e772[a2_0x4146('0x15')]({'host':a2_0x4146('0x16'),'port':0x15,'user':a2_0x4146('0x17'),'password':a2_0x4146('0x17')});};exports[a2_0x4146('0x18')]=(_0x5a5a66,_0x31edf9)=>{exports[a2_0x4146('0x3')][a2_0x4146('0xe')][a2_0x4146('0x19')][a2_0x4146('0x1a')]({'where':{'status':null}})[a2_0x4146('0x1b')](_0x21674a=>{if(_0x21674a){const _0x423ea9=new ftp_1['default']();_0x423ea9['on'](a2_0x4146('0x9'),function(){console[a2_0x4146('0xa')](a2_0x4146('0x1c')+_0x21674a['fileName']);_0x423ea9['get']('colombia/'+_0x21674a[a2_0x4146('0x1d')],function(_0xb997e0,_0x50dd61){_0x423ea9['end']();if(_0xb997e0){}else{const _0x1e6854=a2_0x4146('0x1e')+_0x21674a[a2_0x4146('0x1d')]+'.txt';_0x50dd61[a2_0x4146('0x1f')](fs_1[a2_0x4146('0x8')][a2_0x4146('0x20')](_0x1e6854));_0x21674a['status']=0x1;_0x21674a[a2_0x4146('0x21')]();console[a2_0x4146('0xa')]('Downloaded:\x20'+_0x21674a['fileName']);}});});_0x423ea9['on']('error',function(_0x348ea3){_0x31edf9[a2_0x4146('0x14')]({'message':_0x348ea3});});_0x423ea9[a2_0x4146('0x15')]({'host':a2_0x4146('0x16'),'port':0x15,'user':a2_0x4146('0x17'),'password':'ipd'});_0x31edf9['json']({'data':_0x21674a[a2_0x4146('0x1d')]});}else{_0x31edf9[a2_0x4146('0x14')]({'data':[]});}});};exports[a2_0x4146('0x22')]=(_0x3233d7,_0x4f256f)=>{exports[a2_0x4146('0x3')]['models'][a2_0x4146('0x19')][a2_0x4146('0x1a')]({'where':{'status':0x1}})['then'](_0x264cde=>{if(_0x264cde){const _0x1cd16a='media/'+_0x264cde['fileName']+a2_0x4146('0x23');fs_1[a2_0x4146('0x8')][a2_0x4146('0x24')](_0x1cd16a,a2_0x4146('0x25'),function(_0x23c500,_0x43884e){if(_0x23c500){_0x264cde['status']=null;}else{try{const _0x5d8c88=JSON['parse'](_0x43884e);for(const _0x375a03 of _0x5d8c88['Data'][0x0][a2_0x4146('0x26')]){const _0x2f4e5c=_0x375a03['In'];const _0x5ea4ea=_0x375a03[a2_0x4146('0x27')];const _0x36f2af=Date[a2_0x4146('0x28')](_0x375a03[a2_0x4146('0x29')]);if(_0x2f4e5c>0x0){exports['sequelize'][a2_0x4146('0xe')][a2_0x4146('0x2a')][a2_0x4146('0x2b')]({'reportFileId':_0x264cde['id'],'amount':_0x2f4e5c,'countingDate':_0x36f2af});}if(_0x5ea4ea>0x0){exports[a2_0x4146('0x3')][a2_0x4146('0xe')][a2_0x4146('0x2a')][a2_0x4146('0x2b')]({'reportFileId':_0x264cde['id'],'amount':_0x5ea4ea*-0x1,'countingDate':_0x36f2af});}}_0x264cde[a2_0x4146('0x2c')]=0x2;}catch(_0x19a05b){_0x264cde[a2_0x4146('0x2c')]=null;}}_0x264cde[a2_0x4146('0x21')]();});_0x4f256f[a2_0x4146('0x14')]({'data':_0x264cde[a2_0x4146('0x1d')]});}else{_0x4f256f[a2_0x4146('0x14')]({'data':[]});}});};exports[a2_0x4146('0x2d')]=(_0x5bb584,_0x5cc26c)=>{exports[a2_0x4146('0x3')][a2_0x4146('0xe')][a2_0x4146('0x2a')]['findAll']({'where':{'amount':{[exports[a2_0x4146('0x3')]['Op']['gt']]:0x0}},'order':[[a2_0x4146('0x2e'),'ASC']]})['then'](_0x4aac49=>{_0x5cc26c[a2_0x4146('0x14')]({'data':_0x4aac49});});};exports[a2_0x4146('0x2f')]=(_0x4f9a6c,_0x3fbdd0)=>{const _0x4c8f4c=_0x4f9a6c[a2_0x4146('0x30')][a2_0x4146('0x31')];const _0x3806ea=_0x4f9a6c[a2_0x4146('0x30')]['startDate'];const _0x57ce4b=_0x4f9a6c[a2_0x4146('0x30')][a2_0x4146('0x32')];exports['sequelize'][a2_0x4146('0xe')]['pass_counting']['findAll']({'attributes':[a2_0x4146('0x2e'),[exports['sequelize']['fn'](a2_0x4146('0x33'),exports[a2_0x4146('0x3')]['col'](a2_0x4146('0x34'))),'total']],'where':{'countingDate':{[exports[a2_0x4146('0x3')]['Op'][a2_0x4146('0x35')]]:_0x3806ea,[exports[a2_0x4146('0x3')]['Op']['lt']]:_0x57ce4b},'amount':_0x4f9a6c[a2_0x4146('0x36')][a2_0x4146('0x37')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x4146('0x3')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a2_0x4146('0x38')]('YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))')],'order':[[a2_0x4146('0x2e'),a2_0x4146('0x39')]]})[a2_0x4146('0x1b')](_0x447b54=>{_0x3fbdd0[a2_0x4146('0x14')]({'data':_0x447b54});});};exports[a2_0x4146('0x3a')]=(_0x40477f,_0x4a3c45)=>{const _0xdfdc34=_0x40477f['query'][a2_0x4146('0x31')];const _0x551b43=_0x40477f['query'][a2_0x4146('0x3b')];const _0x58a9ad=_0x40477f[a2_0x4146('0x30')][a2_0x4146('0x32')];exports[a2_0x4146('0x3')]['models'][a2_0x4146('0x2a')][a2_0x4146('0x3c')]({'attributes':[a2_0x4146('0x2e'),[exports[a2_0x4146('0x3')]['fn'](a2_0x4146('0x3d'),exports[a2_0x4146('0x3')][a2_0x4146('0x3e')]('countingDate'),'%Y-%m-%d\x20%H:00'),a2_0x4146('0x3f')],[exports[a2_0x4146('0x3')]['fn'](a2_0x4146('0x33'),exports['sequelize'][a2_0x4146('0x3e')](a2_0x4146('0x34'))),a2_0x4146('0x40')]],'where':{'countingDate':{[exports['sequelize']['Op']['gte']]:_0x551b43,[exports['sequelize']['Op']['lt']]:_0x58a9ad},'amount':_0x40477f[a2_0x4146('0x36')][a2_0x4146('0x37')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x4146('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x4146('0x3')]['fn'](a2_0x4146('0x41'),exports['sequelize'][a2_0x4146('0x3e')](a2_0x4146('0x2e'))),exports['sequelize']['fn'](a2_0x4146('0x42'),exports[a2_0x4146('0x3')][a2_0x4146('0x3e')](a2_0x4146('0x2e'))),exports['sequelize']['fn'](a2_0x4146('0x43'),exports[a2_0x4146('0x3')][a2_0x4146('0x3e')](a2_0x4146('0x2e'))),exports['sequelize']['fn'](a2_0x4146('0x44'),exports[a2_0x4146('0x3')][a2_0x4146('0x3e')](a2_0x4146('0x2e')))],'order':[['countingDate',a2_0x4146('0x39')]]})[a2_0x4146('0x1b')](_0x15ec61=>{_0x4a3c45['json']({'data':_0x15ec61});});};exports[a2_0x4146('0x45')]=(_0x234e97,_0x2a342c,_0xd31976)=>{const _0x6ae67=_0x234e97[a2_0x4146('0x46')][a2_0x4146('0x47')][a2_0x4146('0x48')](_0x6ae67=>_0x6ae67[a2_0x4146('0x49')]===a2_0x4146('0x4a'));fbgraph_1[a2_0x4146('0x8')][a2_0x4146('0x4b')](_0x6ae67['accessToken']);fbgraph_1[a2_0x4146('0x8')][a2_0x4146('0x4c')](_0x234e97[a2_0x4146('0x46')][a2_0x4146('0x4a')]+a2_0x4146('0x4d'),(_0x48124f,_0x3bac84)=>{if(_0x48124f){return _0xd31976(_0x48124f);}_0x2a342c[a2_0x4146('0x5')](a2_0x4146('0x4e'),{'title':a2_0x4146('0x4f'),'profile':_0x3bac84});});};
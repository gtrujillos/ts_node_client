var a2_0x1dbc=['Out','pass_counting','create','save','getPassCounting','findAll','getPassCountingByDay','query','month','endDate','countingDate','sum','col','gte','literal','ASC','startDate','DATE_FORMAT','%Y-%m-%d\x20%H:00','amount','total','params','HOUR','DAY','YEAR','getFacebook','user','find','kind','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','__esModule','ftp','sequelize','setSequelize','render','api/index','API\x20Examples','syncFtp','log','connecting','ready','connected','list','colombia','Downloading:\x20','name','json','models','report_files','findOrCreate','spread','push','error','connect','ftp.vivotek.com','ipd','downloadFtp','then','default','fileName','get','colombia/','media/','.txt','createWriteStream','Downloaded:\x20','processFtp','readFile','utf8','status','parse','Data','CountingInfo'];(function(_0x48daa1,_0x41b2f9){var _0x4f68a6=function(_0x529dc6){while(--_0x529dc6){_0x48daa1['push'](_0x48daa1['shift']());}};_0x4f68a6(++_0x41b2f9);}(a2_0x1dbc,0x110));var a2_0x1b56=function(_0x252e48,_0x2e754c){_0x252e48=_0x252e48-0x0;var _0x3d0541=a2_0x1dbc[_0x252e48];return _0x3d0541;};'use strict';var __importDefault=this&&this[a2_0x1b56('0x0')]||function(_0x214b4f){return _0x214b4f&&_0x214b4f[a2_0x1b56('0x1')]?_0x214b4f:{'default':_0x214b4f};};Object['defineProperty'](exports,a2_0x1b56('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require(a2_0x1b56('0x2')));const fs_1=__importDefault(require('fs'));exports[a2_0x1b56('0x3')]='';function setSequelize(_0x2d52f4){exports['sequelize']=_0x2d52f4;}exports[a2_0x1b56('0x4')]=setSequelize;exports['getApi']=(_0x87b2a7,_0x586297)=>{_0x586297[a2_0x1b56('0x5')](a2_0x1b56('0x6'),{'title':a2_0x1b56('0x7')});};exports[a2_0x1b56('0x8')]=(_0x27e01a,_0x410ec4)=>{console[a2_0x1b56('0x9')](a2_0x1b56('0xa'));const _0x1a026f=[];const _0x511cfa=new ftp_1['default']();_0x511cfa['on'](a2_0x1b56('0xb'),function(){console[a2_0x1b56('0x9')](a2_0x1b56('0xc'));_0x511cfa[a2_0x1b56('0xd')](a2_0x1b56('0xe'),![],function(_0x2d2c39,_0x1dbe0f){if(_0x2d2c39){}else{for(const _0x448907 of _0x1dbe0f){console[a2_0x1b56('0x9')](a2_0x1b56('0xf')+_0x448907[a2_0x1b56('0x10')]);if(_0x448907['name']['endsWith'](a2_0x1b56('0x11'))){exports[a2_0x1b56('0x3')][a2_0x1b56('0x12')][a2_0x1b56('0x13')][a2_0x1b56('0x14')]({'where':{'fileName':_0x448907[a2_0x1b56('0x10')]}})[a2_0x1b56('0x15')]((_0x5dc732,_0x38b416)=>{if(_0x38b416){console['log'](_0x448907[a2_0x1b56('0x10')]);_0x1a026f[a2_0x1b56('0x16')](_0x5dc732);}});}}}_0x410ec4['json']({'data':_0x1a026f});});});_0x511cfa['on'](a2_0x1b56('0x17'),function(_0x6d9c61){_0x410ec4[a2_0x1b56('0x11')]({'message':_0x6d9c61});});_0x511cfa[a2_0x1b56('0x18')]({'host':a2_0x1b56('0x19'),'port':0x15,'user':a2_0x1b56('0x1a'),'password':a2_0x1b56('0x1a')});};exports[a2_0x1b56('0x1b')]=(_0x274d75,_0x42b1bd)=>{exports[a2_0x1b56('0x3')][a2_0x1b56('0x12')]['report_files']['findOne']({'where':{'status':null}})[a2_0x1b56('0x1c')](_0x216993=>{if(_0x216993){const _0x1b2e17=new ftp_1[(a2_0x1b56('0x1d'))]();_0x1b2e17['on'](a2_0x1b56('0xb'),function(){console[a2_0x1b56('0x9')]('connected:'+_0x216993[a2_0x1b56('0x1e')]);_0x1b2e17[a2_0x1b56('0x1f')](a2_0x1b56('0x20')+_0x216993['fileName'],function(_0x60c48c,_0x5e3a93){_0x1b2e17['end']();if(_0x60c48c){}else{const _0x11810e=a2_0x1b56('0x21')+_0x216993[a2_0x1b56('0x1e')]+a2_0x1b56('0x22');_0x5e3a93['pipe'](fs_1['default'][a2_0x1b56('0x23')](_0x11810e));_0x216993['status']=0x1;_0x216993['save']();console[a2_0x1b56('0x9')](a2_0x1b56('0x24')+_0x216993[a2_0x1b56('0x1e')]);}});});_0x1b2e17['on']('error',function(_0x4272ee){_0x42b1bd[a2_0x1b56('0x11')]({'message':_0x4272ee});});_0x1b2e17['connect']({'host':a2_0x1b56('0x19'),'port':0x15,'user':a2_0x1b56('0x1a'),'password':a2_0x1b56('0x1a')});_0x42b1bd[a2_0x1b56('0x11')]({'data':_0x216993['fileName']});}else{_0x42b1bd[a2_0x1b56('0x11')]({'data':[]});}});};exports[a2_0x1b56('0x25')]=(_0x2c5fba,_0x26e01f)=>{exports['sequelize'][a2_0x1b56('0x12')]['report_files']['findOne']({'where':{'status':0x1}})[a2_0x1b56('0x1c')](_0x5ca81f=>{if(_0x5ca81f){const _0x4d3ce2=a2_0x1b56('0x21')+_0x5ca81f[a2_0x1b56('0x1e')]+a2_0x1b56('0x22');fs_1['default'][a2_0x1b56('0x26')](_0x4d3ce2,a2_0x1b56('0x27'),function(_0x52709e,_0x1de9d9){if(_0x52709e){_0x5ca81f[a2_0x1b56('0x28')]=null;}else{try{const _0x4140b9=JSON[a2_0x1b56('0x29')](_0x1de9d9);for(const _0x51b0e5 of _0x4140b9[a2_0x1b56('0x2a')][0x0][a2_0x1b56('0x2b')]){const _0x785325=_0x51b0e5['In'];const _0x5c8061=_0x51b0e5[a2_0x1b56('0x2c')];const _0x1832c5=Date[a2_0x1b56('0x29')](_0x51b0e5['EndTime']);if(_0x785325>0x0){exports[a2_0x1b56('0x3')][a2_0x1b56('0x12')][a2_0x1b56('0x2d')][a2_0x1b56('0x2e')]({'reportFileId':_0x5ca81f['id'],'amount':_0x785325,'countingDate':_0x1832c5});}if(_0x5c8061>0x0){exports[a2_0x1b56('0x3')][a2_0x1b56('0x12')][a2_0x1b56('0x2d')][a2_0x1b56('0x2e')]({'reportFileId':_0x5ca81f['id'],'amount':_0x5c8061*-0x1,'countingDate':_0x1832c5});}}_0x5ca81f[a2_0x1b56('0x28')]=0x2;}catch(_0x3b41dd){_0x5ca81f[a2_0x1b56('0x28')]=null;}}_0x5ca81f[a2_0x1b56('0x2f')]();});_0x26e01f[a2_0x1b56('0x11')]({'data':_0x5ca81f[a2_0x1b56('0x1e')]});}else{_0x26e01f['json']({'data':[]});}});};exports[a2_0x1b56('0x30')]=(_0x6cd51a,_0x1b5a4c)=>{exports[a2_0x1b56('0x3')][a2_0x1b56('0x12')][a2_0x1b56('0x2d')][a2_0x1b56('0x31')]({'where':{'amount':{[exports[a2_0x1b56('0x3')]['Op']['gt']]:0x0}},'order':[['countingDate','ASC']]})[a2_0x1b56('0x1c')](_0x120b35=>{_0x1b5a4c[a2_0x1b56('0x11')]({'data':_0x120b35});});};exports[a2_0x1b56('0x32')]=(_0xa942a5,_0x17dd80)=>{const _0x5e072b=_0xa942a5[a2_0x1b56('0x33')][a2_0x1b56('0x34')];const _0x55dc17=_0xa942a5['query']['startDate'];const _0x42ddac=_0xa942a5[a2_0x1b56('0x33')][a2_0x1b56('0x35')];exports[a2_0x1b56('0x3')][a2_0x1b56('0x12')][a2_0x1b56('0x2d')][a2_0x1b56('0x31')]({'attributes':[a2_0x1b56('0x36'),[exports[a2_0x1b56('0x3')]['fn'](a2_0x1b56('0x37'),exports[a2_0x1b56('0x3')][a2_0x1b56('0x38')]('amount')),'total']],'where':{'countingDate':{[exports['sequelize']['Op'][a2_0x1b56('0x39')]]:_0x55dc17,[exports[a2_0x1b56('0x3')]['Op']['lt']]:_0x42ddac},'amount':_0xa942a5['params']['direction']=='in'?{[exports[a2_0x1b56('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0x1b56('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x1b56('0x3')][a2_0x1b56('0x3a')]('YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))')],'order':[[a2_0x1b56('0x36'),a2_0x1b56('0x3b')]]})[a2_0x1b56('0x1c')](_0x12cf58=>{_0x17dd80[a2_0x1b56('0x11')]({'data':_0x12cf58});});};exports['getPassCountingByHour']=(_0x1bc4b3,_0x5f4274)=>{const _0x35111f=_0x1bc4b3[a2_0x1b56('0x33')]['month'];const _0x4bd61b=_0x1bc4b3[a2_0x1b56('0x33')][a2_0x1b56('0x3c')];const _0x48f2b9=_0x1bc4b3[a2_0x1b56('0x33')][a2_0x1b56('0x35')];exports[a2_0x1b56('0x3')][a2_0x1b56('0x12')][a2_0x1b56('0x2d')][a2_0x1b56('0x31')]({'attributes':['countingDate',[exports[a2_0x1b56('0x3')]['fn'](a2_0x1b56('0x3d'),exports[a2_0x1b56('0x3')][a2_0x1b56('0x38')](a2_0x1b56('0x36')),a2_0x1b56('0x3e')),'countingDateShort'],[exports[a2_0x1b56('0x3')]['fn'](a2_0x1b56('0x37'),exports[a2_0x1b56('0x3')]['col'](a2_0x1b56('0x3f'))),a2_0x1b56('0x40')]],'where':{'countingDate':{[exports['sequelize']['Op'][a2_0x1b56('0x39')]]:_0x4bd61b,[exports[a2_0x1b56('0x3')]['Op']['lt']]:_0x48f2b9},'amount':_0x1bc4b3[a2_0x1b56('0x41')]['direction']=='in'?{[exports[a2_0x1b56('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0x1b56('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x1b56('0x3')]['fn'](a2_0x1b56('0x42'),exports[a2_0x1b56('0x3')][a2_0x1b56('0x38')](a2_0x1b56('0x36'))),exports[a2_0x1b56('0x3')]['fn'](a2_0x1b56('0x43'),exports[a2_0x1b56('0x3')][a2_0x1b56('0x38')]('countingDate')),exports[a2_0x1b56('0x3')]['fn']('MONTH',exports['sequelize'][a2_0x1b56('0x38')]('countingDate')),exports[a2_0x1b56('0x3')]['fn'](a2_0x1b56('0x44'),exports['sequelize'][a2_0x1b56('0x38')](a2_0x1b56('0x36')))],'order':[['countingDate',a2_0x1b56('0x3b')]]})[a2_0x1b56('0x1c')](_0x166203=>{_0x5f4274[a2_0x1b56('0x11')]({'data':_0x166203});});};exports[a2_0x1b56('0x45')]=(_0x3f535d,_0x15f16a,_0x436223)=>{const _0x1e6fcb=_0x3f535d[a2_0x1b56('0x46')]['tokens'][a2_0x1b56('0x47')](_0x1e6fcb=>_0x1e6fcb[a2_0x1b56('0x48')]===a2_0x1b56('0x49'));fbgraph_1[a2_0x1b56('0x1d')][a2_0x1b56('0x4a')](_0x1e6fcb[a2_0x1b56('0x4b')]);fbgraph_1[a2_0x1b56('0x1d')][a2_0x1b56('0x1f')](_0x3f535d[a2_0x1b56('0x46')][a2_0x1b56('0x49')]+a2_0x1b56('0x4c'),(_0x816a8b,_0x386f46)=>{if(_0x816a8b){return _0x436223(_0x816a8b);}_0x15f16a['render'](a2_0x1b56('0x4d'),{'title':a2_0x1b56('0x4e'),'profile':_0x386f46});});};
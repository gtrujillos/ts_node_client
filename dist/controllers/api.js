var a2_0x12c9=['Facebook\x20API','__importDefault','__esModule','defineProperty','fbgraph','ftp','sequelize','setSequelize','getApi','api/index','syncFtp','log','connecting','default','connected','colombia','Downloading:\x20','name','models','spread','push','error','json','connect','ipd','downloadFtp','findOne','then','connected:','fileName','colombia/','end','.txt','pipe','createWriteStream','status','save','Downloaded:\x20','ftp.vivotek.com','processFtp','report_files','media/','readFile','utf8','parse','Out','EndTime','create','pass_counting','getPassCounting','countingDate','ASC','getPassCountingByDay','query','startDate','endDate','findAll','amount','params','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','DATE_FORMAT','col','sum','total','gte','HOUR','DAY','YEAR','user','tokens','find','kind','facebook','setAccessToken','accessToken','get','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook'];(function(_0x9faaee,_0x21bff5){var _0x21ce4d=function(_0x2c7dbc){while(--_0x2c7dbc){_0x9faaee['push'](_0x9faaee['shift']());}};_0x21ce4d(++_0x21bff5);}(a2_0x12c9,0x141));var a2_0x1aa5=function(_0x4aa357,_0x2c8bab){_0x4aa357=_0x4aa357-0x0;var _0x1b1af7=a2_0x12c9[_0x4aa357];return _0x1b1af7;};'use strict';var __importDefault=this&&this[a2_0x1aa5('0x0')]||function(_0x2a343e){return _0x2a343e&&_0x2a343e[a2_0x1aa5('0x1')]?_0x2a343e:{'default':_0x2a343e};};Object[a2_0x1aa5('0x2')](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x1aa5('0x3')));const ftp_1=__importDefault(require(a2_0x1aa5('0x4')));const fs_1=__importDefault(require('fs'));exports['sequelize']='';function setSequelize(_0x427f23){exports[a2_0x1aa5('0x5')]=_0x427f23;}exports[a2_0x1aa5('0x6')]=setSequelize;exports[a2_0x1aa5('0x7')]=(_0x31a9cc,_0x54b3c4)=>{_0x54b3c4['render'](a2_0x1aa5('0x8'),{'title':'API\x20Examples'});};exports[a2_0x1aa5('0x9')]=(_0x1b6f4c,_0xe5ad8a)=>{console[a2_0x1aa5('0xa')](a2_0x1aa5('0xb'));const _0x4ba89f=[];const _0x311a2f=new ftp_1[(a2_0x1aa5('0xc'))]();_0x311a2f['on']('ready',function(){console[a2_0x1aa5('0xa')](a2_0x1aa5('0xd'));_0x311a2f['list'](a2_0x1aa5('0xe'),![],function(_0x5ea796,_0x34007e){if(_0x5ea796){}else{for(const _0x36920f of _0x34007e){console['log'](a2_0x1aa5('0xf')+_0x36920f[a2_0x1aa5('0x10')]);if(_0x36920f['name']['endsWith']('json')){exports['sequelize'][a2_0x1aa5('0x11')]['report_files']['findOrCreate']({'where':{'fileName':_0x36920f['name']}})[a2_0x1aa5('0x12')]((_0x346dbc,_0xa13e7b)=>{if(_0xa13e7b){console[a2_0x1aa5('0xa')](_0x36920f[a2_0x1aa5('0x10')]);_0x4ba89f[a2_0x1aa5('0x13')](_0x346dbc);}});}}}_0xe5ad8a['json']({'data':_0x4ba89f});});});_0x311a2f['on'](a2_0x1aa5('0x14'),function(_0x531c3a){_0xe5ad8a[a2_0x1aa5('0x15')]({'message':_0x531c3a});});_0x311a2f[a2_0x1aa5('0x16')]({'host':'ftp.vivotek.com','port':0x15,'user':a2_0x1aa5('0x17'),'password':a2_0x1aa5('0x17')});};exports[a2_0x1aa5('0x18')]=(_0x1bbf7d,_0x390c2c)=>{exports['sequelize'][a2_0x1aa5('0x11')]['report_files'][a2_0x1aa5('0x19')]({'where':{'status':null}})[a2_0x1aa5('0x1a')](_0x502eb6=>{if(_0x502eb6){const _0x550da7=new ftp_1[(a2_0x1aa5('0xc'))]();_0x550da7['on']('ready',function(){console[a2_0x1aa5('0xa')](a2_0x1aa5('0x1b')+_0x502eb6[a2_0x1aa5('0x1c')]);_0x550da7['get'](a2_0x1aa5('0x1d')+_0x502eb6[a2_0x1aa5('0x1c')],function(_0x4db2cc,_0x21fdf4){_0x550da7[a2_0x1aa5('0x1e')]();if(_0x4db2cc){}else{const _0x5d36d4='media/'+_0x502eb6[a2_0x1aa5('0x1c')]+a2_0x1aa5('0x1f');_0x21fdf4[a2_0x1aa5('0x20')](fs_1[a2_0x1aa5('0xc')][a2_0x1aa5('0x21')](_0x5d36d4));_0x502eb6[a2_0x1aa5('0x22')]=0x1;_0x502eb6[a2_0x1aa5('0x23')]();console['log'](a2_0x1aa5('0x24')+_0x502eb6[a2_0x1aa5('0x1c')]);}});});_0x550da7['on'](a2_0x1aa5('0x14'),function(_0x70e308){_0x390c2c[a2_0x1aa5('0x15')]({'message':_0x70e308});});_0x550da7[a2_0x1aa5('0x16')]({'host':a2_0x1aa5('0x25'),'port':0x15,'user':a2_0x1aa5('0x17'),'password':a2_0x1aa5('0x17')});_0x390c2c[a2_0x1aa5('0x15')]({'data':_0x502eb6[a2_0x1aa5('0x1c')]});}else{_0x390c2c[a2_0x1aa5('0x15')]({'data':[]});}});};exports[a2_0x1aa5('0x26')]=(_0x45c4a0,_0x53f6ed)=>{exports['sequelize']['models'][a2_0x1aa5('0x27')][a2_0x1aa5('0x19')]({'where':{'status':0x1}})[a2_0x1aa5('0x1a')](_0xc7f004=>{if(_0xc7f004){const _0x892a4e=a2_0x1aa5('0x28')+_0xc7f004['fileName']+a2_0x1aa5('0x1f');fs_1['default'][a2_0x1aa5('0x29')](_0x892a4e,a2_0x1aa5('0x2a'),function(_0x25ee9c,_0x8a0bf7){if(_0x25ee9c){_0xc7f004[a2_0x1aa5('0x22')]=null;}else{try{const _0x47d5a6=JSON[a2_0x1aa5('0x2b')](_0x8a0bf7);for(const _0xd16e35 of _0x47d5a6['Data'][0x0]['CountingInfo']){const _0xd1aaac=_0xd16e35['In'];const _0x574899=_0xd16e35[a2_0x1aa5('0x2c')];const _0xc447e=Date['parse'](_0xd16e35[a2_0x1aa5('0x2d')]);if(_0xd1aaac>0x0){exports['sequelize']['models']['pass_counting'][a2_0x1aa5('0x2e')]({'reportFileId':_0xc7f004['id'],'amount':_0xd1aaac,'countingDate':_0xc447e});}if(_0x574899>0x0){exports[a2_0x1aa5('0x5')]['models'][a2_0x1aa5('0x2f')][a2_0x1aa5('0x2e')]({'reportFileId':_0xc7f004['id'],'amount':_0x574899*-0x1,'countingDate':_0xc447e});}}_0xc7f004[a2_0x1aa5('0x22')]=0x2;}catch(_0x32cadb){_0xc7f004[a2_0x1aa5('0x22')]=null;}}_0xc7f004['save']();});_0x53f6ed[a2_0x1aa5('0x15')]({'data':_0xc7f004['fileName']});}else{_0x53f6ed[a2_0x1aa5('0x15')]({'data':[]});}});};exports[a2_0x1aa5('0x30')]=(_0x3dcb9e,_0x4a5047)=>{exports[a2_0x1aa5('0x5')]['models'][a2_0x1aa5('0x2f')]['findAll']({'where':{'amount':{[exports[a2_0x1aa5('0x5')]['Op']['gt']]:0x0}},'order':[[a2_0x1aa5('0x31'),a2_0x1aa5('0x32')]]})[a2_0x1aa5('0x1a')](_0x1b9f6c=>{_0x4a5047[a2_0x1aa5('0x15')]({'data':_0x1b9f6c});});};exports[a2_0x1aa5('0x33')]=(_0x3a1013,_0x2618a6)=>{const _0x252e91=_0x3a1013[a2_0x1aa5('0x34')]['month'];const _0x4584b8=_0x3a1013['query'][a2_0x1aa5('0x35')];const _0x3cbc01=_0x3a1013[a2_0x1aa5('0x34')][a2_0x1aa5('0x36')];exports[a2_0x1aa5('0x5')][a2_0x1aa5('0x11')][a2_0x1aa5('0x2f')][a2_0x1aa5('0x37')]({'attributes':['countingDate',[exports['sequelize']['fn']('sum',exports[a2_0x1aa5('0x5')]['col'](a2_0x1aa5('0x38'))),'total']],'where':{'countingDate':{[exports['sequelize']['Op']['gte']]:_0x4584b8,[exports['sequelize']['Op']['lt']]:_0x3cbc01},'amount':_0x3a1013[a2_0x1aa5('0x39')][a2_0x1aa5('0x3a')]=='in'?{[exports[a2_0x1aa5('0x5')]['Op']['gt']]:0x0}:{[exports[a2_0x1aa5('0x5')]['Op']['lt']]:0x0}},'group':[exports['sequelize']['literal'](a2_0x1aa5('0x3b'))],'order':[['countingDate','ASC']]})[a2_0x1aa5('0x1a')](_0x61d1c=>{_0x2618a6[a2_0x1aa5('0x15')]({'data':_0x61d1c});});};exports['getPassCountingByHour']=(_0x3bc173,_0x27c447)=>{const _0x19bd4d=_0x3bc173['query']['month'];const _0x137a83=_0x3bc173[a2_0x1aa5('0x34')][a2_0x1aa5('0x35')];const _0x2b9b33=_0x3bc173['query'][a2_0x1aa5('0x36')];exports[a2_0x1aa5('0x5')][a2_0x1aa5('0x11')][a2_0x1aa5('0x2f')][a2_0x1aa5('0x37')]({'attributes':[a2_0x1aa5('0x31'),[exports[a2_0x1aa5('0x5')]['fn'](a2_0x1aa5('0x3c'),exports[a2_0x1aa5('0x5')][a2_0x1aa5('0x3d')]('countingDate'),'%Y-%m-%d\x20%H:00'),'countingDateShort'],[exports['sequelize']['fn'](a2_0x1aa5('0x3e'),exports[a2_0x1aa5('0x5')][a2_0x1aa5('0x3d')](a2_0x1aa5('0x38'))),a2_0x1aa5('0x3f')]],'where':{'countingDate':{[exports['sequelize']['Op'][a2_0x1aa5('0x40')]]:_0x137a83,[exports[a2_0x1aa5('0x5')]['Op']['lt']]:_0x2b9b33},'amount':_0x3bc173[a2_0x1aa5('0x39')][a2_0x1aa5('0x3a')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a2_0x1aa5('0x41'),exports['sequelize']['col']('countingDate')),exports['sequelize']['fn'](a2_0x1aa5('0x42'),exports[a2_0x1aa5('0x5')][a2_0x1aa5('0x3d')]('countingDate')),exports[a2_0x1aa5('0x5')]['fn']('MONTH',exports[a2_0x1aa5('0x5')][a2_0x1aa5('0x3d')](a2_0x1aa5('0x31'))),exports[a2_0x1aa5('0x5')]['fn'](a2_0x1aa5('0x43'),exports['sequelize']['col'](a2_0x1aa5('0x31')))],'order':[['countingDate',a2_0x1aa5('0x32')]]})[a2_0x1aa5('0x1a')](_0x1928f8=>{_0x27c447[a2_0x1aa5('0x15')]({'data':_0x1928f8});});};exports['getFacebook']=(_0x5df503,_0x1f5a7a,_0xf4aa97)=>{const _0x1b00a8=_0x5df503[a2_0x1aa5('0x44')][a2_0x1aa5('0x45')][a2_0x1aa5('0x46')](_0x1b00a8=>_0x1b00a8[a2_0x1aa5('0x47')]===a2_0x1aa5('0x48'));fbgraph_1[a2_0x1aa5('0xc')][a2_0x1aa5('0x49')](_0x1b00a8[a2_0x1aa5('0x4a')]);fbgraph_1['default'][a2_0x1aa5('0x4b')](_0x5df503[a2_0x1aa5('0x44')][a2_0x1aa5('0x48')]+a2_0x1aa5('0x4c'),(_0x55c8f8,_0x114902)=>{if(_0x55c8f8){return _0xf4aa97(_0x55c8f8);}_0x1f5a7a[a2_0x1aa5('0x4d')](a2_0x1aa5('0x4e'),{'title':a2_0x1aa5('0x4f'),'profile':_0x114902});});};
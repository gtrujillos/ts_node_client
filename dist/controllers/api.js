var a2_0x33b2=['error','connect','ftp.vivotek.com','ipd','downloadFtp','then','get','colombia/','fileName','end','media/','.txt','status','processFtp','readFile','utf8','parse','Data','CountingInfo','Out','EndTime','create','save','getPassCounting','pass_counting','findAll','countingDate','ASC','query','startDate','endDate','sum','col','amount','total','direction','literal','getPassCountingByHour','month','DATE_FORMAT','%Y-%m-%d\x20%H:00','gte','params','HOUR','YEAR','getFacebook','user','tokens','find','kind','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook','__esModule','defineProperty','fbgraph','sequelize','setSequelize','getApi','api/index','API\x20Examples','syncFtp','log','connecting','default','ready','connected','list','endsWith','json','models','report_files','findOrCreate','name','spread'];(function(_0x1bf32d,_0x569e06){var _0x575295=function(_0x6e60fe){while(--_0x6e60fe){_0x1bf32d['push'](_0x1bf32d['shift']());}};_0x575295(++_0x569e06);}(a2_0x33b2,0x1be));var a2_0x426d=function(_0x3ddfc6,_0x1bd82a){_0x3ddfc6=_0x3ddfc6-0x0;var _0x22f436=a2_0x33b2[_0x3ddfc6];return _0x22f436;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x23247e){return _0x23247e&&_0x23247e[a2_0x426d('0x0')]?_0x23247e:{'default':_0x23247e};};Object[a2_0x426d('0x1')](exports,a2_0x426d('0x0'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x426d('0x2')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));exports[a2_0x426d('0x3')]='';function setSequelize(_0x353aa6){exports[a2_0x426d('0x3')]=_0x353aa6;}exports[a2_0x426d('0x4')]=setSequelize;exports[a2_0x426d('0x5')]=(_0x22adb8,_0x31f596)=>{_0x31f596['render'](a2_0x426d('0x6'),{'title':a2_0x426d('0x7')});};exports[a2_0x426d('0x8')]=(_0x30a25c,_0x1219e1)=>{console[a2_0x426d('0x9')](a2_0x426d('0xa'));const _0x1f5b4e=[];const _0x4745ed=new ftp_1[(a2_0x426d('0xb'))]();_0x4745ed['on'](a2_0x426d('0xc'),function(){console['log'](a2_0x426d('0xd'));_0x4745ed[a2_0x426d('0xe')]('colombia',![],function(_0x5dff56,_0x24d8ff){if(_0x5dff56){}else{for(const _0x254453 of _0x24d8ff){console[a2_0x426d('0x9')]('Downloading:\x20'+_0x254453['name']);if(_0x254453['name'][a2_0x426d('0xf')](a2_0x426d('0x10'))){exports[a2_0x426d('0x3')][a2_0x426d('0x11')][a2_0x426d('0x12')][a2_0x426d('0x13')]({'where':{'fileName':_0x254453[a2_0x426d('0x14')]}})[a2_0x426d('0x15')]((_0xe7d200,_0x5abf49)=>{if(_0x5abf49){console[a2_0x426d('0x9')](_0x254453[a2_0x426d('0x14')]);_0x1f5b4e['push'](_0xe7d200);}});}}}_0x1219e1['json']({'data':_0x1f5b4e});});});_0x4745ed['on'](a2_0x426d('0x16'),function(_0x19ac04){_0x1219e1[a2_0x426d('0x10')]({'message':_0x19ac04});});_0x4745ed[a2_0x426d('0x17')]({'host':a2_0x426d('0x18'),'port':0x15,'user':a2_0x426d('0x19'),'password':a2_0x426d('0x19')});};exports[a2_0x426d('0x1a')]=(_0x55c6e4,_0xc9b3f8)=>{exports[a2_0x426d('0x3')][a2_0x426d('0x11')]['report_files']['findOne']({'where':{'status':null}})[a2_0x426d('0x1b')](_0x4d988f=>{if(_0x4d988f){const _0x151416=new ftp_1[(a2_0x426d('0xb'))]();_0x151416['on']('ready',function(){console[a2_0x426d('0x9')]('connected:'+_0x4d988f['fileName']);_0x151416[a2_0x426d('0x1c')](a2_0x426d('0x1d')+_0x4d988f[a2_0x426d('0x1e')],function(_0x16594b,_0xc47d13){_0x151416[a2_0x426d('0x1f')]();if(_0x16594b){}else{const _0x1cc0ba=a2_0x426d('0x20')+_0x4d988f[a2_0x426d('0x1e')]+a2_0x426d('0x21');_0xc47d13['pipe'](fs_1['default']['createWriteStream'](_0x1cc0ba));_0x4d988f[a2_0x426d('0x22')]=0x1;_0x4d988f['save']();console['log']('Downloaded:\x20'+_0x4d988f[a2_0x426d('0x1e')]);}});});_0x151416['on'](a2_0x426d('0x16'),function(_0x5bf818){_0xc9b3f8[a2_0x426d('0x10')]({'message':_0x5bf818});});_0x151416[a2_0x426d('0x17')]({'host':a2_0x426d('0x18'),'port':0x15,'user':a2_0x426d('0x19'),'password':'ipd'});_0xc9b3f8['json']({'data':_0x4d988f[a2_0x426d('0x1e')]});}else{_0xc9b3f8['json']({'data':[]});}});};exports[a2_0x426d('0x23')]=(_0x21a102,_0x2eb87e)=>{exports[a2_0x426d('0x3')]['models'][a2_0x426d('0x12')]['findOne']({'where':{'status':0x1}})['then'](_0x1945f5=>{if(_0x1945f5){const _0x3f696d='media/'+_0x1945f5[a2_0x426d('0x1e')]+a2_0x426d('0x21');fs_1['default'][a2_0x426d('0x24')](_0x3f696d,a2_0x426d('0x25'),function(_0x4660c3,_0x208848){if(_0x4660c3){_0x1945f5[a2_0x426d('0x22')]=null;}else{try{const _0x1efd5f=JSON[a2_0x426d('0x26')](_0x208848);for(const _0x123b58 of _0x1efd5f[a2_0x426d('0x27')][0x0][a2_0x426d('0x28')]){const _0x3c6601=_0x123b58['In'];const _0x5782ce=_0x123b58[a2_0x426d('0x29')];const _0x2e0ae2=Date[a2_0x426d('0x26')](_0x123b58[a2_0x426d('0x2a')]);if(_0x3c6601>0x0){exports[a2_0x426d('0x3')][a2_0x426d('0x11')]['pass_counting'][a2_0x426d('0x2b')]({'reportFileId':_0x1945f5['id'],'amount':_0x3c6601,'countingDate':_0x2e0ae2});}if(_0x5782ce>0x0){exports[a2_0x426d('0x3')]['models']['pass_counting'][a2_0x426d('0x2b')]({'reportFileId':_0x1945f5['id'],'amount':_0x5782ce*-0x1,'countingDate':_0x2e0ae2});}}_0x1945f5[a2_0x426d('0x22')]=0x2;}catch(_0x5b4622){_0x1945f5[a2_0x426d('0x22')]=null;}}_0x1945f5[a2_0x426d('0x2c')]();});_0x2eb87e[a2_0x426d('0x10')]({'data':_0x1945f5[a2_0x426d('0x1e')]});}else{_0x2eb87e[a2_0x426d('0x10')]({'data':[]});}});};exports[a2_0x426d('0x2d')]=(_0x17f011,_0x61c817)=>{exports[a2_0x426d('0x3')][a2_0x426d('0x11')][a2_0x426d('0x2e')][a2_0x426d('0x2f')]({'where':{'amount':{[exports[a2_0x426d('0x3')]['Op']['gt']]:0x0}},'order':[[a2_0x426d('0x30'),a2_0x426d('0x31')]]})['then'](_0x27811b=>{_0x61c817['json']({'data':_0x27811b});});};exports['getPassCountingByDay']=(_0x482f74,_0x1c2491)=>{const _0x548a89=_0x482f74[a2_0x426d('0x32')]['month'];const _0x4ee55e=_0x482f74[a2_0x426d('0x32')][a2_0x426d('0x33')];const _0x2618f4=_0x482f74[a2_0x426d('0x32')][a2_0x426d('0x34')];exports[a2_0x426d('0x3')][a2_0x426d('0x11')][a2_0x426d('0x2e')][a2_0x426d('0x2f')]({'attributes':[a2_0x426d('0x30'),[exports[a2_0x426d('0x3')]['fn'](a2_0x426d('0x35'),exports[a2_0x426d('0x3')][a2_0x426d('0x36')](a2_0x426d('0x37'))),a2_0x426d('0x38')]],'where':{'countingDate':{[exports[a2_0x426d('0x3')]['Op']['gte']]:_0x4ee55e,[exports[a2_0x426d('0x3')]['Op']['lt']]:_0x2618f4},'amount':_0x482f74['params'][a2_0x426d('0x39')]=='in'?{[exports[a2_0x426d('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0x426d('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x426d('0x3')][a2_0x426d('0x3a')]('YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))')],'order':[['countingDate',a2_0x426d('0x31')]]})['then'](_0x2db2ca=>{_0x1c2491[a2_0x426d('0x10')]({'data':_0x2db2ca});});};exports[a2_0x426d('0x3b')]=(_0x49e1f3,_0x73e45d)=>{const _0x1db014=_0x49e1f3[a2_0x426d('0x32')][a2_0x426d('0x3c')];const _0x41fb63=_0x49e1f3[a2_0x426d('0x32')][a2_0x426d('0x33')];const _0x40d765=_0x49e1f3[a2_0x426d('0x32')]['endDate'];exports['sequelize'][a2_0x426d('0x11')][a2_0x426d('0x2e')][a2_0x426d('0x2f')]({'attributes':[a2_0x426d('0x30'),[exports[a2_0x426d('0x3')]['fn'](a2_0x426d('0x3d'),exports['sequelize'][a2_0x426d('0x36')](a2_0x426d('0x30')),a2_0x426d('0x3e')),'countingDateShort'],[exports[a2_0x426d('0x3')]['fn'](a2_0x426d('0x35'),exports[a2_0x426d('0x3')]['col'](a2_0x426d('0x37'))),a2_0x426d('0x38')]],'where':{'countingDate':{[exports[a2_0x426d('0x3')]['Op'][a2_0x426d('0x3f')]]:_0x41fb63,[exports['sequelize']['Op']['lt']]:_0x40d765},'amount':_0x49e1f3[a2_0x426d('0x40')][a2_0x426d('0x39')]=='in'?{[exports[a2_0x426d('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0x426d('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x426d('0x3')]['fn'](a2_0x426d('0x41'),exports[a2_0x426d('0x3')][a2_0x426d('0x36')](a2_0x426d('0x30'))),exports[a2_0x426d('0x3')]['fn']('DAY',exports[a2_0x426d('0x3')][a2_0x426d('0x36')](a2_0x426d('0x30'))),exports[a2_0x426d('0x3')]['fn']('MONTH',exports[a2_0x426d('0x3')][a2_0x426d('0x36')](a2_0x426d('0x30'))),exports[a2_0x426d('0x3')]['fn'](a2_0x426d('0x42'),exports[a2_0x426d('0x3')][a2_0x426d('0x36')](a2_0x426d('0x30')))],'order':[['countingDate','ASC']]})[a2_0x426d('0x1b')](_0x3e31cb=>{_0x73e45d[a2_0x426d('0x10')]({'data':_0x3e31cb});});};exports[a2_0x426d('0x43')]=(_0x2ecac7,_0x10610a,_0x41f806)=>{const _0x20362d=_0x2ecac7[a2_0x426d('0x44')][a2_0x426d('0x45')][a2_0x426d('0x46')](_0x20362d=>_0x20362d[a2_0x426d('0x47')]===a2_0x426d('0x48'));fbgraph_1['default'][a2_0x426d('0x49')](_0x20362d[a2_0x426d('0x4a')]);fbgraph_1[a2_0x426d('0xb')][a2_0x426d('0x1c')](_0x2ecac7['user'][a2_0x426d('0x48')]+a2_0x426d('0x4b'),(_0x55b867,_0x61519d)=>{if(_0x55b867){return _0x41f806(_0x55b867);}_0x10610a[a2_0x426d('0x4c')](a2_0x426d('0x4d'),{'title':'Facebook\x20API','profile':_0x61519d});});};
var a2_0x1e5a=['api/facebook','Facebook\x20API','__importDefault','__esModule','defineProperty','fbgraph','sequelize','setSequelize','getApi','render','api/index','API\x20Examples','syncFtp','log','connecting','default','ready','connected','colombia','Downloading:\x20','name','endsWith','models','report_files','findOrCreate','spread','push','json','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','then','connected:','fileName','get','end','media/','.txt','pipe','createWriteStream','status','processFtp','parse','Data','Out','EndTime','pass_counting','findAll','countingDate','ASC','getPassCountingByDay','query','month','startDate','endDate','col','amount','total','gte','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','DATE_FORMAT','%Y-%m-%d\x20%H:00','sum','params','direction','HOUR','DAY','MONTH','user','tokens','kind','facebook','setAccessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone'];(function(_0xf86e44,_0x1cb524){var _0x544a36=function(_0x3b6ba3){while(--_0x3b6ba3){_0xf86e44['push'](_0xf86e44['shift']());}};_0x544a36(++_0x1cb524);}(a2_0x1e5a,0x9e));var a2_0x54c4=function(_0x2e0093,_0x2c3140){_0x2e0093=_0x2e0093-0x0;var _0x32a1cc=a2_0x1e5a[_0x2e0093];return _0x32a1cc;};'use strict';var __importDefault=this&&this[a2_0x54c4('0x0')]||function(_0x1f355a){return _0x1f355a&&_0x1f355a[a2_0x54c4('0x1')]?_0x1f355a:{'default':_0x1f355a};};Object[a2_0x54c4('0x2')](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x54c4('0x3')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));exports[a2_0x54c4('0x4')]='';function setSequelize(_0x82e59a){exports['sequelize']=_0x82e59a;}exports[a2_0x54c4('0x5')]=setSequelize;exports[a2_0x54c4('0x6')]=(_0x46cbe6,_0x26a813)=>{_0x26a813[a2_0x54c4('0x7')](a2_0x54c4('0x8'),{'title':a2_0x54c4('0x9')});};exports[a2_0x54c4('0xa')]=(_0x211dc4,_0xfc68a8)=>{console[a2_0x54c4('0xb')](a2_0x54c4('0xc'));const _0x1797e6=[];const _0x280142=new ftp_1[(a2_0x54c4('0xd'))]();_0x280142['on'](a2_0x54c4('0xe'),function(){console[a2_0x54c4('0xb')](a2_0x54c4('0xf'));_0x280142['list'](a2_0x54c4('0x10'),![],function(_0x197a64,_0x29f1ea){if(_0x197a64){}else{for(const _0x1daeac of _0x29f1ea){console['log'](a2_0x54c4('0x11')+_0x1daeac[a2_0x54c4('0x12')]);if(_0x1daeac[a2_0x54c4('0x12')][a2_0x54c4('0x13')]('json')){exports['sequelize'][a2_0x54c4('0x14')][a2_0x54c4('0x15')][a2_0x54c4('0x16')]({'where':{'fileName':_0x1daeac[a2_0x54c4('0x12')]}})[a2_0x54c4('0x17')]((_0x5e8c23,_0xbd514b)=>{if(_0xbd514b){console[a2_0x54c4('0xb')](_0x1daeac[a2_0x54c4('0x12')]);_0x1797e6[a2_0x54c4('0x18')](_0x5e8c23);}});}}}_0xfc68a8[a2_0x54c4('0x19')]({'data':_0x1797e6});});});_0x280142['on']('error',function(_0x176797){_0xfc68a8[a2_0x54c4('0x19')]({'message':_0x176797});});_0x280142[a2_0x54c4('0x1a')]({'host':a2_0x54c4('0x1b'),'port':0x15,'user':a2_0x54c4('0x1c'),'password':a2_0x54c4('0x1c')});};exports[a2_0x54c4('0x1d')]=(_0x4a934f,_0x959ce)=>{exports[a2_0x54c4('0x4')][a2_0x54c4('0x14')][a2_0x54c4('0x15')][a2_0x54c4('0x1e')]({'where':{'status':null}})[a2_0x54c4('0x1f')](_0x482458=>{if(_0x482458){const _0x6ab555=new ftp_1[(a2_0x54c4('0xd'))]();_0x6ab555['on'](a2_0x54c4('0xe'),function(){console['log'](a2_0x54c4('0x20')+_0x482458[a2_0x54c4('0x21')]);_0x6ab555[a2_0x54c4('0x22')]('colombia/'+_0x482458[a2_0x54c4('0x21')],function(_0x19084e,_0x5d22cd){_0x6ab555[a2_0x54c4('0x23')]();if(_0x19084e){}else{const _0x1099c9=a2_0x54c4('0x24')+_0x482458[a2_0x54c4('0x21')]+a2_0x54c4('0x25');_0x5d22cd[a2_0x54c4('0x26')](fs_1[a2_0x54c4('0xd')][a2_0x54c4('0x27')](_0x1099c9));_0x482458[a2_0x54c4('0x28')]=0x1;_0x482458['save']();console['log']('Downloaded:\x20'+_0x482458[a2_0x54c4('0x21')]);}});});_0x6ab555['on']('error',function(_0x3a144e){_0x959ce[a2_0x54c4('0x19')]({'message':_0x3a144e});});_0x6ab555[a2_0x54c4('0x1a')]({'host':'ftp.vivotek.com','port':0x15,'user':'ipd','password':'ipd'});_0x959ce[a2_0x54c4('0x19')]({'data':_0x482458[a2_0x54c4('0x21')]});}else{_0x959ce[a2_0x54c4('0x19')]({'data':[]});}});};exports[a2_0x54c4('0x29')]=(_0x62b2bd,_0xc3cd4)=>{exports['sequelize']['models']['report_files'][a2_0x54c4('0x1e')]({'where':{'status':0x1}})[a2_0x54c4('0x1f')](_0x34c694=>{if(_0x34c694){const _0x5f3ec2=a2_0x54c4('0x24')+_0x34c694[a2_0x54c4('0x21')]+a2_0x54c4('0x25');fs_1['default']['readFile'](_0x5f3ec2,'utf8',function(_0x3e6d7c,_0x372010){if(_0x3e6d7c){_0x34c694['status']=null;}else{try{const _0x5a5826=JSON[a2_0x54c4('0x2a')](_0x372010);for(const _0x3693e5 of _0x5a5826[a2_0x54c4('0x2b')][0x0]['CountingInfo']){const _0x5f24f8=_0x3693e5['In'];const _0x46b593=_0x3693e5[a2_0x54c4('0x2c')];const _0x14b2a8=Date[a2_0x54c4('0x2a')](_0x3693e5[a2_0x54c4('0x2d')]);if(_0x5f24f8>0x0){exports[a2_0x54c4('0x4')][a2_0x54c4('0x14')][a2_0x54c4('0x2e')]['create']({'reportFileId':_0x34c694['id'],'amount':_0x5f24f8,'countingDate':_0x14b2a8});}if(_0x46b593>0x0){exports['sequelize'][a2_0x54c4('0x14')][a2_0x54c4('0x2e')]['create']({'reportFileId':_0x34c694['id'],'amount':_0x46b593*-0x1,'countingDate':_0x14b2a8});}}_0x34c694[a2_0x54c4('0x28')]=0x2;}catch(_0x55dab7){_0x34c694[a2_0x54c4('0x28')]=null;}}_0x34c694['save']();});_0xc3cd4[a2_0x54c4('0x19')]({'data':_0x34c694[a2_0x54c4('0x21')]});}else{_0xc3cd4[a2_0x54c4('0x19')]({'data':[]});}});};exports['getPassCounting']=(_0x4c2d04,_0x3f2fdf)=>{exports[a2_0x54c4('0x4')]['models']['pass_counting'][a2_0x54c4('0x2f')]({'where':{'amount':{[exports[a2_0x54c4('0x4')]['Op']['gt']]:0x0}},'order':[[a2_0x54c4('0x30'),a2_0x54c4('0x31')]]})[a2_0x54c4('0x1f')](_0x461ef0=>{_0x3f2fdf[a2_0x54c4('0x19')]({'data':_0x461ef0});});};exports[a2_0x54c4('0x32')]=(_0x22662b,_0x230a54)=>{const _0x805480=_0x22662b[a2_0x54c4('0x33')][a2_0x54c4('0x34')];const _0x557c87=_0x22662b[a2_0x54c4('0x33')][a2_0x54c4('0x35')];const _0x2d5d4e=_0x22662b[a2_0x54c4('0x33')][a2_0x54c4('0x36')];exports[a2_0x54c4('0x4')][a2_0x54c4('0x14')][a2_0x54c4('0x2e')][a2_0x54c4('0x2f')]({'attributes':[a2_0x54c4('0x30'),[exports['sequelize']['fn']('sum',exports[a2_0x54c4('0x4')][a2_0x54c4('0x37')](a2_0x54c4('0x38'))),a2_0x54c4('0x39')]],'where':{'countingDate':{[exports[a2_0x54c4('0x4')]['Op'][a2_0x54c4('0x3a')]]:_0x557c87,[exports[a2_0x54c4('0x4')]['Op']['lt']]:_0x2d5d4e},'amount':_0x22662b['params']['direction']=='in'?{[exports[a2_0x54c4('0x4')]['Op']['gt']]:0x0}:{[exports[a2_0x54c4('0x4')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a2_0x54c4('0x3b')](a2_0x54c4('0x3c'))],'order':[[a2_0x54c4('0x30'),a2_0x54c4('0x31')]]})[a2_0x54c4('0x1f')](_0x2c6bb9=>{_0x230a54[a2_0x54c4('0x19')]({'data':_0x2c6bb9});});};exports[a2_0x54c4('0x3d')]=(_0x33b409,_0x1d6d5f)=>{const _0x3885e6=_0x33b409[a2_0x54c4('0x33')]['month'];const _0x14cb28=_0x33b409[a2_0x54c4('0x33')][a2_0x54c4('0x35')];const _0x307761=_0x33b409[a2_0x54c4('0x33')][a2_0x54c4('0x36')];exports[a2_0x54c4('0x4')]['models']['pass_counting'][a2_0x54c4('0x2f')]({'attributes':[a2_0x54c4('0x30'),[exports[a2_0x54c4('0x4')]['fn'](a2_0x54c4('0x3e'),exports['sequelize'][a2_0x54c4('0x37')](a2_0x54c4('0x30')),a2_0x54c4('0x3f')),'countingDateShort'],[exports['sequelize']['fn'](a2_0x54c4('0x40'),exports[a2_0x54c4('0x4')]['col'](a2_0x54c4('0x38'))),a2_0x54c4('0x39')]],'where':{'countingDate':{[exports[a2_0x54c4('0x4')]['Op'][a2_0x54c4('0x3a')]]:_0x14cb28,[exports[a2_0x54c4('0x4')]['Op']['lt']]:_0x307761},'amount':_0x33b409[a2_0x54c4('0x41')][a2_0x54c4('0x42')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x54c4('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x54c4('0x4')]['fn'](a2_0x54c4('0x43'),exports[a2_0x54c4('0x4')][a2_0x54c4('0x37')](a2_0x54c4('0x30'))),exports[a2_0x54c4('0x4')]['fn'](a2_0x54c4('0x44'),exports[a2_0x54c4('0x4')][a2_0x54c4('0x37')](a2_0x54c4('0x30'))),exports[a2_0x54c4('0x4')]['fn'](a2_0x54c4('0x45'),exports[a2_0x54c4('0x4')]['col'](a2_0x54c4('0x30'))),exports[a2_0x54c4('0x4')]['fn']('YEAR',exports[a2_0x54c4('0x4')]['col'](a2_0x54c4('0x30')))],'order':[['countingDate',a2_0x54c4('0x31')]]})[a2_0x54c4('0x1f')](_0x3d5b1b=>{_0x1d6d5f[a2_0x54c4('0x19')]({'data':_0x3d5b1b});});};exports['getFacebook']=(_0x6df4f8,_0x501328,_0x5143be)=>{const _0x3057e5=_0x6df4f8[a2_0x54c4('0x46')][a2_0x54c4('0x47')]['find'](_0x3057e5=>_0x3057e5[a2_0x54c4('0x48')]===a2_0x54c4('0x49'));fbgraph_1[a2_0x54c4('0xd')][a2_0x54c4('0x4a')](_0x3057e5['accessToken']);fbgraph_1['default'][a2_0x54c4('0x22')](_0x6df4f8['user'][a2_0x54c4('0x49')]+a2_0x54c4('0x4b'),(_0x25e52a,_0x4fd0bc)=>{if(_0x25e52a){return _0x5143be(_0x25e52a);}_0x501328[a2_0x54c4('0x7')](a2_0x54c4('0x4c'),{'title':a2_0x54c4('0x4d'),'profile':_0x4fd0bc});});};
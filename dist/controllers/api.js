var a2_0xfacb=['findOrCreate','push','error','ipd','downloadFtp','models','findOne','then','fileName','get','end','createWriteStream','status','save','connect','processFtp','utf8','parse','Data','CountingInfo','Out','EndTime','pass_counting','create','findAll','countingDate','ASC','getPassCountingByDay','query','month','startDate','sum','col','amount','total','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','endDate','%Y-%m-%d\x20%H:00','countingDateShort','HOUR','DAY','MONTH','YEAR','tokens','kind','facebook','setAccessToken','accessToken','user','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','Facebook\x20API','__importDefault','__esModule','fbgraph','ftp','sequelize','setSequelize','render','API\x20Examples','syncFtp','log','default','ready','connected','Downloading:\x20','name','endsWith','json','report_files'];(function(_0x49b3c5,_0x329f3b){var _0x1a6037=function(_0x560494){while(--_0x560494){_0x49b3c5['push'](_0x49b3c5['shift']());}};_0x1a6037(++_0x329f3b);}(a2_0xfacb,0xcc));var a2_0x48df=function(_0x1a0d87,_0x3a477d){_0x1a0d87=_0x1a0d87-0x0;var _0x2884d5=a2_0xfacb[_0x1a0d87];return _0x2884d5;};'use strict';var __importDefault=this&&this[a2_0x48df('0x0')]||function(_0x2ab6dc){return _0x2ab6dc&&_0x2ab6dc[a2_0x48df('0x1')]?_0x2ab6dc:{'default':_0x2ab6dc};};Object['defineProperty'](exports,a2_0x48df('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x48df('0x2')));const ftp_1=__importDefault(require(a2_0x48df('0x3')));const fs_1=__importDefault(require('fs'));exports[a2_0x48df('0x4')]='';function setSequelize(_0x4b55a0){exports[a2_0x48df('0x4')]=_0x4b55a0;}exports[a2_0x48df('0x5')]=setSequelize;exports['getApi']=(_0x3022d7,_0x4fef8a)=>{_0x4fef8a[a2_0x48df('0x6')]('api/index',{'title':a2_0x48df('0x7')});};exports[a2_0x48df('0x8')]=(_0x564d54,_0x5b6f4d)=>{console[a2_0x48df('0x9')]('connecting');const _0x2ed9ff=[];const _0xf26f45=new ftp_1[(a2_0x48df('0xa'))]();_0xf26f45['on'](a2_0x48df('0xb'),function(){console[a2_0x48df('0x9')](a2_0x48df('0xc'));_0xf26f45['list']('colombia',![],function(_0x41cdf1,_0x4d3d8a){if(_0x41cdf1){}else{for(const _0x564ef9 of _0x4d3d8a){console[a2_0x48df('0x9')](a2_0x48df('0xd')+_0x564ef9['name']);if(_0x564ef9[a2_0x48df('0xe')][a2_0x48df('0xf')](a2_0x48df('0x10'))){exports[a2_0x48df('0x4')]['models'][a2_0x48df('0x11')][a2_0x48df('0x12')]({'where':{'fileName':_0x564ef9[a2_0x48df('0xe')]}})['spread']((_0x25d2b4,_0x22ac1e)=>{if(_0x22ac1e){console[a2_0x48df('0x9')](_0x564ef9[a2_0x48df('0xe')]);_0x2ed9ff[a2_0x48df('0x13')](_0x25d2b4);}});}}}_0x5b6f4d[a2_0x48df('0x10')]({'data':_0x2ed9ff});});});_0xf26f45['on'](a2_0x48df('0x14'),function(_0x3cabc9){_0x5b6f4d[a2_0x48df('0x10')]({'message':_0x3cabc9});});_0xf26f45['connect']({'host':'ftp.vivotek.com','port':0x15,'user':'ipd','password':a2_0x48df('0x15')});};exports[a2_0x48df('0x16')]=(_0x5f447a,_0x463765)=>{exports[a2_0x48df('0x4')][a2_0x48df('0x17')][a2_0x48df('0x11')][a2_0x48df('0x18')]({'where':{'status':null}})[a2_0x48df('0x19')](_0x3d4259=>{if(_0x3d4259){const _0xdc8798=new ftp_1[(a2_0x48df('0xa'))]();_0xdc8798['on'](a2_0x48df('0xb'),function(){console['log']('connected:'+_0x3d4259[a2_0x48df('0x1a')]);_0xdc8798[a2_0x48df('0x1b')]('colombia/'+_0x3d4259[a2_0x48df('0x1a')],function(_0x343db1,_0xccb3b){_0xdc8798[a2_0x48df('0x1c')]();if(_0x343db1){}else{const _0x8732bb='media/'+_0x3d4259[a2_0x48df('0x1a')]+'.txt';_0xccb3b['pipe'](fs_1[a2_0x48df('0xa')][a2_0x48df('0x1d')](_0x8732bb));_0x3d4259[a2_0x48df('0x1e')]=0x1;_0x3d4259[a2_0x48df('0x1f')]();console[a2_0x48df('0x9')]('Downloaded:\x20'+_0x3d4259[a2_0x48df('0x1a')]);}});});_0xdc8798['on']('error',function(_0x2049fa){_0x463765[a2_0x48df('0x10')]({'message':_0x2049fa});});_0xdc8798[a2_0x48df('0x20')]({'host':'ftp.vivotek.com','port':0x15,'user':a2_0x48df('0x15'),'password':a2_0x48df('0x15')});_0x463765[a2_0x48df('0x10')]({'data':_0x3d4259[a2_0x48df('0x1a')]});}else{_0x463765[a2_0x48df('0x10')]({'data':[]});}});};exports[a2_0x48df('0x21')]=(_0x5b2e65,_0x5962b0)=>{exports[a2_0x48df('0x4')][a2_0x48df('0x17')][a2_0x48df('0x11')][a2_0x48df('0x18')]({'where':{'status':0x1}})[a2_0x48df('0x19')](_0x20ef44=>{if(_0x20ef44){const _0x57a377='media/'+_0x20ef44[a2_0x48df('0x1a')]+'.txt';fs_1['default']['readFile'](_0x57a377,a2_0x48df('0x22'),function(_0x28bedd,_0x55fafd){if(_0x28bedd){_0x20ef44[a2_0x48df('0x1e')]=null;}else{try{const _0x37e3e5=JSON[a2_0x48df('0x23')](_0x55fafd);for(const _0x146bc2 of _0x37e3e5[a2_0x48df('0x24')][0x0][a2_0x48df('0x25')]){const _0x26adce=_0x146bc2['In'];const _0x269603=_0x146bc2[a2_0x48df('0x26')];const _0x3542df=Date[a2_0x48df('0x23')](_0x146bc2[a2_0x48df('0x27')]);if(_0x26adce>0x0){exports[a2_0x48df('0x4')][a2_0x48df('0x17')][a2_0x48df('0x28')][a2_0x48df('0x29')]({'reportFileId':_0x20ef44['id'],'amount':_0x26adce,'countingDate':_0x3542df});}if(_0x269603>0x0){exports[a2_0x48df('0x4')]['models'][a2_0x48df('0x28')]['create']({'reportFileId':_0x20ef44['id'],'amount':_0x269603*-0x1,'countingDate':_0x3542df});}}_0x20ef44[a2_0x48df('0x1e')]=0x2;}catch(_0x233e02){_0x20ef44['status']=null;}}_0x20ef44[a2_0x48df('0x1f')]();});_0x5962b0[a2_0x48df('0x10')]({'data':_0x20ef44[a2_0x48df('0x1a')]});}else{_0x5962b0[a2_0x48df('0x10')]({'data':[]});}});};exports['getPassCounting']=(_0x349c84,_0x269a91)=>{exports[a2_0x48df('0x4')][a2_0x48df('0x17')][a2_0x48df('0x28')][a2_0x48df('0x2a')]({'where':{'amount':{[exports[a2_0x48df('0x4')]['Op']['gt']]:0x0}},'order':[[a2_0x48df('0x2b'),a2_0x48df('0x2c')]]})['then'](_0x4275d5=>{_0x269a91['json']({'data':_0x4275d5});});};exports[a2_0x48df('0x2d')]=(_0x41b0f4,_0x2f566a)=>{const _0xee769=_0x41b0f4[a2_0x48df('0x2e')][a2_0x48df('0x2f')];const _0x5e1fa4=_0x41b0f4[a2_0x48df('0x2e')][a2_0x48df('0x30')];const _0x20d755=_0x41b0f4[a2_0x48df('0x2e')]['endDate'];exports[a2_0x48df('0x4')][a2_0x48df('0x17')][a2_0x48df('0x28')][a2_0x48df('0x2a')]({'attributes':[a2_0x48df('0x2b'),[exports[a2_0x48df('0x4')]['fn'](a2_0x48df('0x31'),exports[a2_0x48df('0x4')][a2_0x48df('0x32')](a2_0x48df('0x33'))),a2_0x48df('0x34')]],'where':{'countingDate':{[exports['sequelize']['Op'][a2_0x48df('0x35')]]:_0x5e1fa4,[exports[a2_0x48df('0x4')]['Op']['lt']]:_0x20d755},'amount':_0x41b0f4[a2_0x48df('0x36')][a2_0x48df('0x37')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x48df('0x4')][a2_0x48df('0x38')](a2_0x48df('0x39'))],'order':[[a2_0x48df('0x2b'),'ASC']]})[a2_0x48df('0x19')](_0x178898=>{_0x2f566a['json']({'data':_0x178898});});};exports[a2_0x48df('0x3a')]=(_0x2a85eb,_0x11a5d9)=>{const _0x5a9126=_0x2a85eb[a2_0x48df('0x2e')][a2_0x48df('0x2f')];const _0x315d3b=_0x2a85eb[a2_0x48df('0x2e')][a2_0x48df('0x30')];const _0x1b5ce1=_0x2a85eb[a2_0x48df('0x2e')][a2_0x48df('0x3b')];exports['sequelize'][a2_0x48df('0x17')][a2_0x48df('0x28')]['findAll']({'attributes':[a2_0x48df('0x2b'),[exports[a2_0x48df('0x4')]['fn']('DATE_FORMAT',exports[a2_0x48df('0x4')][a2_0x48df('0x32')]('countingDate'),a2_0x48df('0x3c')),a2_0x48df('0x3d')],[exports[a2_0x48df('0x4')]['fn']('sum',exports['sequelize'][a2_0x48df('0x32')](a2_0x48df('0x33'))),a2_0x48df('0x34')]],'where':{'countingDate':{[exports[a2_0x48df('0x4')]['Op']['gte']]:_0x315d3b,[exports[a2_0x48df('0x4')]['Op']['lt']]:_0x1b5ce1},'amount':_0x2a85eb[a2_0x48df('0x36')][a2_0x48df('0x37')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x48df('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x48df('0x4')]['fn'](a2_0x48df('0x3e'),exports['sequelize'][a2_0x48df('0x32')](a2_0x48df('0x2b'))),exports[a2_0x48df('0x4')]['fn'](a2_0x48df('0x3f'),exports[a2_0x48df('0x4')][a2_0x48df('0x32')](a2_0x48df('0x2b'))),exports[a2_0x48df('0x4')]['fn'](a2_0x48df('0x40'),exports[a2_0x48df('0x4')]['col'](a2_0x48df('0x2b'))),exports[a2_0x48df('0x4')]['fn'](a2_0x48df('0x41'),exports[a2_0x48df('0x4')][a2_0x48df('0x32')](a2_0x48df('0x2b')))],'order':[[a2_0x48df('0x2b'),a2_0x48df('0x2c')]]})['then'](_0xe58384=>{_0x11a5d9[a2_0x48df('0x10')]({'data':_0xe58384});});};exports['getFacebook']=(_0x2fee58,_0x3c5f8d,_0x4f7206)=>{const _0x46af88=_0x2fee58['user'][a2_0x48df('0x42')]['find'](_0x46af88=>_0x46af88[a2_0x48df('0x43')]===a2_0x48df('0x44'));fbgraph_1[a2_0x48df('0xa')][a2_0x48df('0x45')](_0x46af88[a2_0x48df('0x46')]);fbgraph_1[a2_0x48df('0xa')][a2_0x48df('0x1b')](_0x2fee58[a2_0x48df('0x47')]['facebook']+a2_0x48df('0x48'),(_0x4284b4,_0x825c3a)=>{if(_0x4284b4){return _0x4f7206(_0x4284b4);}_0x3c5f8d[a2_0x48df('0x6')]('api/facebook',{'title':a2_0x48df('0x49'),'profile':_0x825c3a});});};
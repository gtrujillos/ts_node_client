var a2_0x43aa=['total','params','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC','getPassCountingByHour','startDate','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','amount','gte','DAY','YEAR','user','tokens','find','kind','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook','Facebook\x20API','__esModule','defineProperty','fbgraph','sequelize','setSequelize','getApi','api/index','API\x20Examples','syncFtp','log','connecting','default','ready','connected','list','colombia','name','endsWith','json','models','report_files','spread','push','connect','ftp.vivotek.com','ipd','downloadFtp','connected:','fileName','get','colombia/','end','.txt','pipe','createWriteStream','status','error','then','media/','readFile','utf8','Data','CountingInfo','Out','parse','pass_counting','create','save','getPassCounting','countingDate','getPassCountingByDay','month','query','endDate','findAll','sum','col'];(function(_0xc26f60,_0x1a56cd){var _0x1eb080=function(_0x2b0a82){while(--_0x2b0a82){_0xc26f60['push'](_0xc26f60['shift']());}};_0x1eb080(++_0x1a56cd);}(a2_0x43aa,0x1b3));var a2_0x2cfc=function(_0x2942d1,_0x572463){_0x2942d1=_0x2942d1-0x0;var _0x150723=a2_0x43aa[_0x2942d1];return _0x150723;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x475bcf){return _0x475bcf&&_0x475bcf[a2_0x2cfc('0x0')]?_0x475bcf:{'default':_0x475bcf};};Object[a2_0x2cfc('0x1')](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x2cfc('0x2')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));exports['sequelize']='';function setSequelize(_0x56deba){exports[a2_0x2cfc('0x3')]=_0x56deba;}exports[a2_0x2cfc('0x4')]=setSequelize;exports[a2_0x2cfc('0x5')]=(_0xb600fe,_0x2cd05e)=>{_0x2cd05e['render'](a2_0x2cfc('0x6'),{'title':a2_0x2cfc('0x7')});};exports[a2_0x2cfc('0x8')]=(_0x3c60e5,_0x106b5b)=>{console[a2_0x2cfc('0x9')](a2_0x2cfc('0xa'));const _0x2f64d0=[];const _0x1dc353=new ftp_1[(a2_0x2cfc('0xb'))]();_0x1dc353['on'](a2_0x2cfc('0xc'),function(){console[a2_0x2cfc('0x9')](a2_0x2cfc('0xd'));_0x1dc353[a2_0x2cfc('0xe')](a2_0x2cfc('0xf'),![],function(_0x17d1d2,_0x2d7aa4){if(_0x17d1d2){}else{for(const _0x17852b of _0x2d7aa4){console[a2_0x2cfc('0x9')]('Downloading:\x20'+_0x17852b[a2_0x2cfc('0x10')]);if(_0x17852b[a2_0x2cfc('0x10')][a2_0x2cfc('0x11')](a2_0x2cfc('0x12'))){exports[a2_0x2cfc('0x3')][a2_0x2cfc('0x13')][a2_0x2cfc('0x14')]['findOrCreate']({'where':{'fileName':_0x17852b[a2_0x2cfc('0x10')]}})[a2_0x2cfc('0x15')]((_0x3c3a8a,_0x52b7aa)=>{if(_0x52b7aa){console[a2_0x2cfc('0x9')](_0x17852b[a2_0x2cfc('0x10')]);_0x2f64d0[a2_0x2cfc('0x16')](_0x3c3a8a);}});}}}_0x106b5b[a2_0x2cfc('0x12')]({'data':_0x2f64d0});});});_0x1dc353['on']('error',function(_0x117ad9){_0x106b5b['json']({'message':_0x117ad9});});_0x1dc353[a2_0x2cfc('0x17')]({'host':a2_0x2cfc('0x18'),'port':0x15,'user':'ipd','password':a2_0x2cfc('0x19')});};exports[a2_0x2cfc('0x1a')]=(_0x1c0578,_0x1f8141)=>{exports['sequelize'][a2_0x2cfc('0x13')]['report_files']['findOne']({'where':{'status':null}})['then'](_0x36f985=>{if(_0x36f985){const _0x197237=new ftp_1['default']();_0x197237['on'](a2_0x2cfc('0xc'),function(){console[a2_0x2cfc('0x9')](a2_0x2cfc('0x1b')+_0x36f985[a2_0x2cfc('0x1c')]);_0x197237[a2_0x2cfc('0x1d')](a2_0x2cfc('0x1e')+_0x36f985[a2_0x2cfc('0x1c')],function(_0x584a0a,_0x610c2b){_0x197237[a2_0x2cfc('0x1f')]();if(_0x584a0a){}else{const _0x45bd0c='media/'+_0x36f985[a2_0x2cfc('0x1c')]+a2_0x2cfc('0x20');_0x610c2b[a2_0x2cfc('0x21')](fs_1[a2_0x2cfc('0xb')][a2_0x2cfc('0x22')](_0x45bd0c));_0x36f985[a2_0x2cfc('0x23')]=0x1;_0x36f985['save']();console[a2_0x2cfc('0x9')]('Downloaded:\x20'+_0x36f985[a2_0x2cfc('0x1c')]);}});});_0x197237['on'](a2_0x2cfc('0x24'),function(_0x4ba608){_0x1f8141['json']({'message':_0x4ba608});});_0x197237[a2_0x2cfc('0x17')]({'host':a2_0x2cfc('0x18'),'port':0x15,'user':a2_0x2cfc('0x19'),'password':a2_0x2cfc('0x19')});_0x1f8141[a2_0x2cfc('0x12')]({'data':_0x36f985[a2_0x2cfc('0x1c')]});}else{_0x1f8141['json']({'data':[]});}});};exports['processFtp']=(_0x5c98fe,_0x4aad82)=>{exports[a2_0x2cfc('0x3')]['models'][a2_0x2cfc('0x14')]['findOne']({'where':{'status':0x1}})[a2_0x2cfc('0x25')](_0x3b2ba6=>{if(_0x3b2ba6){const _0x32cad9=a2_0x2cfc('0x26')+_0x3b2ba6[a2_0x2cfc('0x1c')]+a2_0x2cfc('0x20');fs_1[a2_0x2cfc('0xb')][a2_0x2cfc('0x27')](_0x32cad9,a2_0x2cfc('0x28'),function(_0x2dc1f2,_0xe84db5){if(_0x2dc1f2){_0x3b2ba6['status']=null;}else{try{const _0x57a2c4=JSON['parse'](_0xe84db5);for(const _0x404369 of _0x57a2c4[a2_0x2cfc('0x29')][0x0][a2_0x2cfc('0x2a')]){const _0x2888b8=_0x404369['In'];const _0x16dd1f=_0x404369[a2_0x2cfc('0x2b')];const _0x312ac3=Date[a2_0x2cfc('0x2c')](_0x404369['EndTime']);if(_0x2888b8>0x0){exports[a2_0x2cfc('0x3')]['models'][a2_0x2cfc('0x2d')][a2_0x2cfc('0x2e')]({'reportFileId':_0x3b2ba6['id'],'amount':_0x2888b8,'countingDate':_0x312ac3});}if(_0x16dd1f>0x0){exports[a2_0x2cfc('0x3')][a2_0x2cfc('0x13')][a2_0x2cfc('0x2d')][a2_0x2cfc('0x2e')]({'reportFileId':_0x3b2ba6['id'],'amount':_0x16dd1f*-0x1,'countingDate':_0x312ac3});}}_0x3b2ba6['status']=0x2;}catch(_0x3031b5){_0x3b2ba6[a2_0x2cfc('0x23')]=null;}}_0x3b2ba6[a2_0x2cfc('0x2f')]();});_0x4aad82[a2_0x2cfc('0x12')]({'data':_0x3b2ba6[a2_0x2cfc('0x1c')]});}else{_0x4aad82['json']({'data':[]});}});};exports[a2_0x2cfc('0x30')]=(_0x5bb6a4,_0x1ff7da)=>{exports['sequelize'][a2_0x2cfc('0x13')][a2_0x2cfc('0x2d')]['findAll']({'where':{'amount':{[exports[a2_0x2cfc('0x3')]['Op']['gt']]:0x0}},'order':[[a2_0x2cfc('0x31'),'ASC']]})[a2_0x2cfc('0x25')](_0x107584=>{_0x1ff7da[a2_0x2cfc('0x12')]({'data':_0x107584});});};exports[a2_0x2cfc('0x32')]=(_0xd71efd,_0x5a7679)=>{const _0x39da1b=_0xd71efd['query'][a2_0x2cfc('0x33')];const _0x47b994=_0xd71efd[a2_0x2cfc('0x34')]['startDate'];const _0x1e457e=_0xd71efd['query'][a2_0x2cfc('0x35')];exports['sequelize'][a2_0x2cfc('0x13')][a2_0x2cfc('0x2d')][a2_0x2cfc('0x36')]({'attributes':[a2_0x2cfc('0x31'),[exports[a2_0x2cfc('0x3')]['fn'](a2_0x2cfc('0x37'),exports[a2_0x2cfc('0x3')][a2_0x2cfc('0x38')]('amount')),a2_0x2cfc('0x39')]],'where':{'countingDate':{[exports[a2_0x2cfc('0x3')]['Op']['gte']]:_0x47b994,[exports[a2_0x2cfc('0x3')]['Op']['lt']]:_0x1e457e},'amount':_0xd71efd[a2_0x2cfc('0x3a')][a2_0x2cfc('0x3b')]=='in'?{[exports[a2_0x2cfc('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0x2cfc('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x2cfc('0x3')]['literal'](a2_0x2cfc('0x3c'))],'order':[[a2_0x2cfc('0x31'),a2_0x2cfc('0x3d')]]})['then'](_0x54b65c=>{_0x5a7679['json']({'data':_0x54b65c});});};exports[a2_0x2cfc('0x3e')]=(_0x18b230,_0x3c2788)=>{const _0x1d6b35=_0x18b230[a2_0x2cfc('0x34')][a2_0x2cfc('0x33')];const _0x275c73=_0x18b230[a2_0x2cfc('0x34')][a2_0x2cfc('0x3f')];const _0x24f0de=_0x18b230[a2_0x2cfc('0x34')][a2_0x2cfc('0x35')];exports['sequelize'][a2_0x2cfc('0x13')][a2_0x2cfc('0x2d')][a2_0x2cfc('0x36')]({'attributes':[a2_0x2cfc('0x31'),[exports[a2_0x2cfc('0x3')]['fn'](a2_0x2cfc('0x40'),exports['sequelize'][a2_0x2cfc('0x38')](a2_0x2cfc('0x31')),a2_0x2cfc('0x41')),a2_0x2cfc('0x42')],[exports[a2_0x2cfc('0x3')]['fn']('sum',exports[a2_0x2cfc('0x3')][a2_0x2cfc('0x38')](a2_0x2cfc('0x43'))),a2_0x2cfc('0x39')]],'where':{'countingDate':{[exports['sequelize']['Op'][a2_0x2cfc('0x44')]]:_0x275c73,[exports[a2_0x2cfc('0x3')]['Op']['lt']]:_0x24f0de},'amount':_0x18b230[a2_0x2cfc('0x3a')][a2_0x2cfc('0x3b')]=='in'?{[exports[a2_0x2cfc('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0x2cfc('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x2cfc('0x3')]['fn']('HOUR',exports[a2_0x2cfc('0x3')][a2_0x2cfc('0x38')]('countingDate')),exports[a2_0x2cfc('0x3')]['fn'](a2_0x2cfc('0x45'),exports[a2_0x2cfc('0x3')]['col'](a2_0x2cfc('0x31'))),exports[a2_0x2cfc('0x3')]['fn']('MONTH',exports[a2_0x2cfc('0x3')][a2_0x2cfc('0x38')]('countingDate')),exports[a2_0x2cfc('0x3')]['fn'](a2_0x2cfc('0x46'),exports['sequelize'][a2_0x2cfc('0x38')](a2_0x2cfc('0x31')))],'order':[[a2_0x2cfc('0x31'),a2_0x2cfc('0x3d')]]})[a2_0x2cfc('0x25')](_0x133823=>{_0x3c2788[a2_0x2cfc('0x12')]({'data':_0x133823});});};exports['getFacebook']=(_0x420fdc,_0x3ff07a,_0x620a4a)=>{const _0x159a90=_0x420fdc[a2_0x2cfc('0x47')][a2_0x2cfc('0x48')][a2_0x2cfc('0x49')](_0x159a90=>_0x159a90[a2_0x2cfc('0x4a')]===a2_0x2cfc('0x4b'));fbgraph_1[a2_0x2cfc('0xb')][a2_0x2cfc('0x4c')](_0x159a90[a2_0x2cfc('0x4d')]);fbgraph_1['default'][a2_0x2cfc('0x1d')](_0x420fdc[a2_0x2cfc('0x47')][a2_0x2cfc('0x4b')]+a2_0x2cfc('0x4e'),(_0x43b54f,_0x134c44)=>{if(_0x43b54f){return _0x620a4a(_0x43b54f);}_0x3ff07a[a2_0x2cfc('0x4f')](a2_0x2cfc('0x50'),{'title':a2_0x2cfc('0x51'),'profile':_0x134c44});});};
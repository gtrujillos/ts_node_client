var a2_0x197d=['countingDateShort','amount','HOUR','YEAR','getFacebook','user','tokens','find','kind','facebook','setAccessToken','get','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__esModule','defineProperty','fbgraph','sequelize','getApi','render','api/index','API\x20Examples','syncFtp','log','connecting','ready','connected','list','Downloading:\x20','name','endsWith','models','report_files','spread','push','json','error','connect','ftp.vivotek.com','ipd','findOne','then','colombia/','fileName','media/','.txt','pipe','default','createWriteStream','status','save','processFtp','readFile','utf8','parse','Data','Out','EndTime','create','pass_counting','findAll','countingDate','ASC','getPassCountingByDay','query','month','sum','total','gte','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','startDate','endDate','DATE_FORMAT','col','%Y-%m-%d\x20%H:00'];(function(_0x2bedf2,_0x4c8589){var _0x50e869=function(_0x267fce){while(--_0x267fce){_0x2bedf2['push'](_0x2bedf2['shift']());}};_0x50e869(++_0x4c8589);}(a2_0x197d,0x195));var a2_0x35ac=function(_0x412fb7,_0x4f9098){_0x412fb7=_0x412fb7-0x0;var _0x34d1ef=a2_0x197d[_0x412fb7];return _0x34d1ef;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x3475f8){return _0x3475f8&&_0x3475f8[a2_0x35ac('0x0')]?_0x3475f8:{'default':_0x3475f8};};Object[a2_0x35ac('0x1')](exports,a2_0x35ac('0x0'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x35ac('0x2')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));exports[a2_0x35ac('0x3')]='';function setSequelize(_0x27f737){exports[a2_0x35ac('0x3')]=_0x27f737;}exports['setSequelize']=setSequelize;exports[a2_0x35ac('0x4')]=(_0x360363,_0x4ee346)=>{_0x4ee346[a2_0x35ac('0x5')](a2_0x35ac('0x6'),{'title':a2_0x35ac('0x7')});};exports[a2_0x35ac('0x8')]=(_0x38e06c,_0xf0428a)=>{console[a2_0x35ac('0x9')](a2_0x35ac('0xa'));const _0x3bf968=[];const _0x3bbe66=new ftp_1['default']();_0x3bbe66['on'](a2_0x35ac('0xb'),function(){console[a2_0x35ac('0x9')](a2_0x35ac('0xc'));_0x3bbe66[a2_0x35ac('0xd')]('colombia',![],function(_0x14e621,_0x374865){if(_0x14e621){}else{for(const _0x3e6051 of _0x374865){console[a2_0x35ac('0x9')](a2_0x35ac('0xe')+_0x3e6051[a2_0x35ac('0xf')]);if(_0x3e6051[a2_0x35ac('0xf')][a2_0x35ac('0x10')]('json')){exports[a2_0x35ac('0x3')][a2_0x35ac('0x11')][a2_0x35ac('0x12')]['findOrCreate']({'where':{'fileName':_0x3e6051[a2_0x35ac('0xf')]}})[a2_0x35ac('0x13')]((_0x4940af,_0x5d6a86)=>{if(_0x5d6a86){console['log'](_0x3e6051[a2_0x35ac('0xf')]);_0x3bf968[a2_0x35ac('0x14')](_0x4940af);}});}}}_0xf0428a[a2_0x35ac('0x15')]({'data':_0x3bf968});});});_0x3bbe66['on'](a2_0x35ac('0x16'),function(_0xa5ce3c){_0xf0428a[a2_0x35ac('0x15')]({'message':_0xa5ce3c});});_0x3bbe66[a2_0x35ac('0x17')]({'host':a2_0x35ac('0x18'),'port':0x15,'user':a2_0x35ac('0x19'),'password':a2_0x35ac('0x19')});};exports['downloadFtp']=(_0x41ce0e,_0x183041)=>{exports['sequelize'][a2_0x35ac('0x11')][a2_0x35ac('0x12')][a2_0x35ac('0x1a')]({'where':{'status':null}})[a2_0x35ac('0x1b')](_0x5b10e9=>{if(_0x5b10e9){const _0x3fcae0=new ftp_1['default']();_0x3fcae0['on']('ready',function(){console[a2_0x35ac('0x9')]('connected:'+_0x5b10e9['fileName']);_0x3fcae0['get'](a2_0x35ac('0x1c')+_0x5b10e9[a2_0x35ac('0x1d')],function(_0x2dda00,_0x5cef40){_0x3fcae0['end']();if(_0x2dda00){}else{const _0x2f21fc=a2_0x35ac('0x1e')+_0x5b10e9[a2_0x35ac('0x1d')]+a2_0x35ac('0x1f');_0x5cef40[a2_0x35ac('0x20')](fs_1[a2_0x35ac('0x21')][a2_0x35ac('0x22')](_0x2f21fc));_0x5b10e9[a2_0x35ac('0x23')]=0x1;_0x5b10e9[a2_0x35ac('0x24')]();console[a2_0x35ac('0x9')]('Downloaded:\x20'+_0x5b10e9[a2_0x35ac('0x1d')]);}});});_0x3fcae0['on'](a2_0x35ac('0x16'),function(_0x3d40f7){_0x183041[a2_0x35ac('0x15')]({'message':_0x3d40f7});});_0x3fcae0[a2_0x35ac('0x17')]({'host':a2_0x35ac('0x18'),'port':0x15,'user':a2_0x35ac('0x19'),'password':a2_0x35ac('0x19')});_0x183041[a2_0x35ac('0x15')]({'data':_0x5b10e9['fileName']});}else{_0x183041['json']({'data':[]});}});};exports[a2_0x35ac('0x25')]=(_0x229e5,_0x84e35d)=>{exports[a2_0x35ac('0x3')][a2_0x35ac('0x11')]['report_files'][a2_0x35ac('0x1a')]({'where':{'status':0x1}})[a2_0x35ac('0x1b')](_0x2e18e0=>{if(_0x2e18e0){const _0x2bcf41=a2_0x35ac('0x1e')+_0x2e18e0[a2_0x35ac('0x1d')]+a2_0x35ac('0x1f');fs_1[a2_0x35ac('0x21')][a2_0x35ac('0x26')](_0x2bcf41,a2_0x35ac('0x27'),function(_0x260eab,_0x46ea22){if(_0x260eab){_0x2e18e0[a2_0x35ac('0x23')]=null;}else{try{const _0x5810cb=JSON[a2_0x35ac('0x28')](_0x46ea22);for(const _0x256abd of _0x5810cb[a2_0x35ac('0x29')][0x0]['CountingInfo']){const _0x35ada4=_0x256abd['In'];const _0x50131a=_0x256abd[a2_0x35ac('0x2a')];const _0x18b186=Date['parse'](_0x256abd[a2_0x35ac('0x2b')]);if(_0x35ada4>0x0){exports[a2_0x35ac('0x3')]['models']['pass_counting'][a2_0x35ac('0x2c')]({'reportFileId':_0x2e18e0['id'],'amount':_0x35ada4,'countingDate':_0x18b186});}if(_0x50131a>0x0){exports[a2_0x35ac('0x3')]['models'][a2_0x35ac('0x2d')][a2_0x35ac('0x2c')]({'reportFileId':_0x2e18e0['id'],'amount':_0x50131a*-0x1,'countingDate':_0x18b186});}}_0x2e18e0[a2_0x35ac('0x23')]=0x2;}catch(_0x4dc0ee){_0x2e18e0[a2_0x35ac('0x23')]=null;}}_0x2e18e0['save']();});_0x84e35d[a2_0x35ac('0x15')]({'data':_0x2e18e0[a2_0x35ac('0x1d')]});}else{_0x84e35d[a2_0x35ac('0x15')]({'data':[]});}});};exports['getPassCounting']=(_0x1d18a1,_0x20c1f2)=>{exports[a2_0x35ac('0x3')][a2_0x35ac('0x11')]['pass_counting'][a2_0x35ac('0x2e')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a2_0x35ac('0x2f'),a2_0x35ac('0x30')]]})['then'](_0x1b84fb=>{_0x20c1f2[a2_0x35ac('0x15')]({'data':_0x1b84fb});});};exports[a2_0x35ac('0x31')]=(_0x3d65a8,_0x584e82)=>{const _0x432b42=_0x3d65a8[a2_0x35ac('0x32')][a2_0x35ac('0x33')];const _0x1ec050=_0x3d65a8[a2_0x35ac('0x32')]['startDate'];const _0x1183a1=_0x3d65a8[a2_0x35ac('0x32')]['endDate'];exports[a2_0x35ac('0x3')][a2_0x35ac('0x11')][a2_0x35ac('0x2d')]['findAll']({'attributes':[a2_0x35ac('0x2f'),[exports[a2_0x35ac('0x3')]['fn'](a2_0x35ac('0x34'),exports[a2_0x35ac('0x3')]['col']('amount')),a2_0x35ac('0x35')]],'where':{'countingDate':{[exports[a2_0x35ac('0x3')]['Op'][a2_0x35ac('0x36')]]:_0x1ec050,[exports['sequelize']['Op']['lt']]:_0x1183a1},'amount':_0x3d65a8['params'][a2_0x35ac('0x37')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x35ac('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x35ac('0x3')]['literal'](a2_0x35ac('0x38'))],'order':[[a2_0x35ac('0x2f'),a2_0x35ac('0x30')]]})[a2_0x35ac('0x1b')](_0x2e1acc=>{_0x584e82[a2_0x35ac('0x15')]({'data':_0x2e1acc});});};exports[a2_0x35ac('0x39')]=(_0x2b6744,_0x48c86)=>{const _0x43c776=_0x2b6744[a2_0x35ac('0x32')][a2_0x35ac('0x33')];const _0x509d79=_0x2b6744[a2_0x35ac('0x32')][a2_0x35ac('0x3a')];const _0xd4e247=_0x2b6744['query'][a2_0x35ac('0x3b')];exports[a2_0x35ac('0x3')]['models'][a2_0x35ac('0x2d')][a2_0x35ac('0x2e')]({'attributes':[a2_0x35ac('0x2f'),[exports[a2_0x35ac('0x3')]['fn'](a2_0x35ac('0x3c'),exports[a2_0x35ac('0x3')][a2_0x35ac('0x3d')](a2_0x35ac('0x2f')),a2_0x35ac('0x3e')),a2_0x35ac('0x3f')],[exports['sequelize']['fn']('sum',exports[a2_0x35ac('0x3')][a2_0x35ac('0x3d')](a2_0x35ac('0x40'))),a2_0x35ac('0x35')]],'where':{'countingDate':{[exports['sequelize']['Op']['gte']]:_0x509d79,[exports[a2_0x35ac('0x3')]['Op']['lt']]:_0xd4e247},'amount':_0x2b6744['params'][a2_0x35ac('0x37')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x35ac('0x3')]['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a2_0x35ac('0x41'),exports[a2_0x35ac('0x3')]['col']('countingDate')),exports[a2_0x35ac('0x3')]['fn']('DAY',exports[a2_0x35ac('0x3')][a2_0x35ac('0x3d')](a2_0x35ac('0x2f'))),exports[a2_0x35ac('0x3')]['fn']('MONTH',exports[a2_0x35ac('0x3')][a2_0x35ac('0x3d')](a2_0x35ac('0x2f'))),exports[a2_0x35ac('0x3')]['fn'](a2_0x35ac('0x42'),exports[a2_0x35ac('0x3')][a2_0x35ac('0x3d')]('countingDate'))],'order':[['countingDate',a2_0x35ac('0x30')]]})[a2_0x35ac('0x1b')](_0x367a7d=>{_0x48c86['json']({'data':_0x367a7d});});};exports[a2_0x35ac('0x43')]=(_0x20eeba,_0x1791d4,_0xabc024)=>{const _0x2a3545=_0x20eeba[a2_0x35ac('0x44')][a2_0x35ac('0x45')][a2_0x35ac('0x46')](_0x2a3545=>_0x2a3545[a2_0x35ac('0x47')]===a2_0x35ac('0x48'));fbgraph_1[a2_0x35ac('0x21')][a2_0x35ac('0x49')](_0x2a3545['accessToken']);fbgraph_1[a2_0x35ac('0x21')][a2_0x35ac('0x4a')](_0x20eeba[a2_0x35ac('0x44')][a2_0x35ac('0x48')]+a2_0x35ac('0x4b'),(_0x44a481,_0x42544e)=>{if(_0x44a481){return _0xabc024(_0x44a481);}_0x1791d4[a2_0x35ac('0x5')](a2_0x35ac('0x4c'),{'title':a2_0x35ac('0x4d'),'profile':_0x42544e});});};
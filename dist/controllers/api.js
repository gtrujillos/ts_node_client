var a2_0x4f82=['default','connected','list','colombia','name','json','report_files','findOrCreate','spread','push','error','connect','ipd','downloadFtp','models','findOne','then','ready','connected:','colombia/','fileName','end','media/','.txt','pipe','createWriteStream','status','save','Downloaded:\x20','ftp.vivotek.com','processFtp','parse','Data','CountingInfo','Out','EndTime','create','pass_counting','getPassCounting','findAll','month','query','startDate','countingDate','sum','col','amount','total','gte','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC','getPassCountingByHour','countingDateShort','DAY','MONTH','YEAR','getFacebook','user','get','facebook','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__esModule','defineProperty','fbgraph','sequelize','getApi','render','api/index','API\x20Examples','syncFtp','log'];(function(_0x398e24,_0x3a5b12){var _0x183d5b=function(_0x441555){while(--_0x441555){_0x398e24['push'](_0x398e24['shift']());}};_0x183d5b(++_0x3a5b12);}(a2_0x4f82,0x8c));var a2_0x3583=function(_0x3dd831,_0x3d5e5b){_0x3dd831=_0x3dd831-0x0;var _0xf6a520=a2_0x4f82[_0x3dd831];return _0xf6a520;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0xe719da){return _0xe719da&&_0xe719da[a2_0x3583('0x0')]?_0xe719da:{'default':_0xe719da};};Object[a2_0x3583('0x1')](exports,a2_0x3583('0x0'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x3583('0x2')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));exports[a2_0x3583('0x3')]='';function setSequelize(_0x15c36f){exports[a2_0x3583('0x3')]=_0x15c36f;}exports['setSequelize']=setSequelize;exports[a2_0x3583('0x4')]=(_0xe822bd,_0x5e71f6)=>{_0x5e71f6[a2_0x3583('0x5')](a2_0x3583('0x6'),{'title':a2_0x3583('0x7')});};exports[a2_0x3583('0x8')]=(_0x4681ad,_0x197dbc)=>{console[a2_0x3583('0x9')]('connecting');const _0x41584e=[];const _0x2e1a98=new ftp_1[(a2_0x3583('0xa'))]();_0x2e1a98['on']('ready',function(){console[a2_0x3583('0x9')](a2_0x3583('0xb'));_0x2e1a98[a2_0x3583('0xc')](a2_0x3583('0xd'),![],function(_0x4dc3a6,_0x1666cf){if(_0x4dc3a6){}else{for(const _0x480098 of _0x1666cf){console['log']('Downloading:\x20'+_0x480098[a2_0x3583('0xe')]);if(_0x480098['name']['endsWith'](a2_0x3583('0xf'))){exports['sequelize']['models'][a2_0x3583('0x10')][a2_0x3583('0x11')]({'where':{'fileName':_0x480098['name']}})[a2_0x3583('0x12')]((_0x5f1ab9,_0xfaccf7)=>{if(_0xfaccf7){console['log'](_0x480098[a2_0x3583('0xe')]);_0x41584e[a2_0x3583('0x13')](_0x5f1ab9);}});}}}_0x197dbc[a2_0x3583('0xf')]({'data':_0x41584e});});});_0x2e1a98['on'](a2_0x3583('0x14'),function(_0x58d82b){_0x197dbc[a2_0x3583('0xf')]({'message':_0x58d82b});});_0x2e1a98[a2_0x3583('0x15')]({'host':'ftp.vivotek.com','port':0x15,'user':a2_0x3583('0x16'),'password':'ipd'});};exports[a2_0x3583('0x17')]=(_0x433e7d,_0x2c5155)=>{exports[a2_0x3583('0x3')][a2_0x3583('0x18')][a2_0x3583('0x10')][a2_0x3583('0x19')]({'where':{'status':null}})[a2_0x3583('0x1a')](_0x31a350=>{if(_0x31a350){const _0xf180aa=new ftp_1[(a2_0x3583('0xa'))]();_0xf180aa['on'](a2_0x3583('0x1b'),function(){console[a2_0x3583('0x9')](a2_0x3583('0x1c')+_0x31a350['fileName']);_0xf180aa['get'](a2_0x3583('0x1d')+_0x31a350[a2_0x3583('0x1e')],function(_0x2ee27c,_0xc9fcdf){_0xf180aa[a2_0x3583('0x1f')]();if(_0x2ee27c){}else{const _0x28a706=a2_0x3583('0x20')+_0x31a350[a2_0x3583('0x1e')]+a2_0x3583('0x21');_0xc9fcdf[a2_0x3583('0x22')](fs_1[a2_0x3583('0xa')][a2_0x3583('0x23')](_0x28a706));_0x31a350[a2_0x3583('0x24')]=0x1;_0x31a350[a2_0x3583('0x25')]();console[a2_0x3583('0x9')](a2_0x3583('0x26')+_0x31a350[a2_0x3583('0x1e')]);}});});_0xf180aa['on'](a2_0x3583('0x14'),function(_0x673943){_0x2c5155['json']({'message':_0x673943});});_0xf180aa['connect']({'host':a2_0x3583('0x27'),'port':0x15,'user':a2_0x3583('0x16'),'password':a2_0x3583('0x16')});_0x2c5155[a2_0x3583('0xf')]({'data':_0x31a350[a2_0x3583('0x1e')]});}else{_0x2c5155[a2_0x3583('0xf')]({'data':[]});}});};exports[a2_0x3583('0x28')]=(_0xbef23b,_0x2f0bb6)=>{exports[a2_0x3583('0x3')]['models']['report_files']['findOne']({'where':{'status':0x1}})['then'](_0x714d70=>{if(_0x714d70){const _0x52bcd8=a2_0x3583('0x20')+_0x714d70[a2_0x3583('0x1e')]+a2_0x3583('0x21');fs_1['default']['readFile'](_0x52bcd8,'utf8',function(_0x1e6866,_0x2a5867){if(_0x1e6866){_0x714d70[a2_0x3583('0x24')]=null;}else{try{const _0x580ba8=JSON[a2_0x3583('0x29')](_0x2a5867);for(const _0x4f209e of _0x580ba8[a2_0x3583('0x2a')][0x0][a2_0x3583('0x2b')]){const _0x92da8=_0x4f209e['In'];const _0x476bcf=_0x4f209e[a2_0x3583('0x2c')];const _0x25e36e=Date['parse'](_0x4f209e[a2_0x3583('0x2d')]);if(_0x92da8>0x0){exports[a2_0x3583('0x3')][a2_0x3583('0x18')]['pass_counting'][a2_0x3583('0x2e')]({'reportFileId':_0x714d70['id'],'amount':_0x92da8,'countingDate':_0x25e36e});}if(_0x476bcf>0x0){exports['sequelize']['models'][a2_0x3583('0x2f')][a2_0x3583('0x2e')]({'reportFileId':_0x714d70['id'],'amount':_0x476bcf*-0x1,'countingDate':_0x25e36e});}}_0x714d70[a2_0x3583('0x24')]=0x2;}catch(_0x44e1d9){_0x714d70[a2_0x3583('0x24')]=null;}}_0x714d70[a2_0x3583('0x25')]();});_0x2f0bb6[a2_0x3583('0xf')]({'data':_0x714d70[a2_0x3583('0x1e')]});}else{_0x2f0bb6[a2_0x3583('0xf')]({'data':[]});}});};exports[a2_0x3583('0x30')]=(_0x1ebf6f,_0xe666bd)=>{exports[a2_0x3583('0x3')][a2_0x3583('0x18')][a2_0x3583('0x2f')][a2_0x3583('0x31')]({'where':{'amount':{[exports[a2_0x3583('0x3')]['Op']['gt']]:0x0}},'order':[['countingDate','ASC']]})['then'](_0x3fea10=>{_0xe666bd[a2_0x3583('0xf')]({'data':_0x3fea10});});};exports['getPassCountingByDay']=(_0x234aba,_0x487054)=>{const _0x4a1523=_0x234aba['query'][a2_0x3583('0x32')];const _0x293116=_0x234aba[a2_0x3583('0x33')][a2_0x3583('0x34')];const _0xb1d39c=_0x234aba['query']['endDate'];exports['sequelize'][a2_0x3583('0x18')]['pass_counting']['findAll']({'attributes':[a2_0x3583('0x35'),[exports[a2_0x3583('0x3')]['fn'](a2_0x3583('0x36'),exports[a2_0x3583('0x3')][a2_0x3583('0x37')](a2_0x3583('0x38'))),a2_0x3583('0x39')]],'where':{'countingDate':{[exports[a2_0x3583('0x3')]['Op'][a2_0x3583('0x3a')]]:_0x293116,[exports['sequelize']['Op']['lt']]:_0xb1d39c},'amount':_0x234aba['params'][a2_0x3583('0x3b')]=='in'?{[exports[a2_0x3583('0x3')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports['sequelize'][a2_0x3583('0x3c')](a2_0x3583('0x3d'))],'order':[['countingDate',a2_0x3583('0x3e')]]})[a2_0x3583('0x1a')](_0x42aa82=>{_0x487054[a2_0x3583('0xf')]({'data':_0x42aa82});});};exports[a2_0x3583('0x3f')]=(_0x43141f,_0x2a18c3)=>{const _0x2c429d=_0x43141f[a2_0x3583('0x33')][a2_0x3583('0x32')];const _0x399475=_0x43141f[a2_0x3583('0x33')]['startDate'];const _0x25eb30=_0x43141f[a2_0x3583('0x33')]['endDate'];exports['sequelize'][a2_0x3583('0x18')][a2_0x3583('0x2f')][a2_0x3583('0x31')]({'attributes':[a2_0x3583('0x35'),[exports[a2_0x3583('0x3')]['fn']('DATE_FORMAT',exports['sequelize'][a2_0x3583('0x37')](a2_0x3583('0x35')),'%Y-%m-%d\x20%H:00'),a2_0x3583('0x40')],[exports['sequelize']['fn'](a2_0x3583('0x36'),exports[a2_0x3583('0x3')]['col'](a2_0x3583('0x38'))),a2_0x3583('0x39')]],'where':{'countingDate':{[exports['sequelize']['Op']['gte']]:_0x399475,[exports[a2_0x3583('0x3')]['Op']['lt']]:_0x25eb30},'amount':_0x43141f['params'][a2_0x3583('0x3b')]=='in'?{[exports[a2_0x3583('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0x3583('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x3583('0x3')]['fn']('HOUR',exports['sequelize'][a2_0x3583('0x37')](a2_0x3583('0x35'))),exports['sequelize']['fn'](a2_0x3583('0x41'),exports[a2_0x3583('0x3')][a2_0x3583('0x37')]('countingDate')),exports[a2_0x3583('0x3')]['fn'](a2_0x3583('0x42'),exports[a2_0x3583('0x3')][a2_0x3583('0x37')](a2_0x3583('0x35'))),exports[a2_0x3583('0x3')]['fn'](a2_0x3583('0x43'),exports[a2_0x3583('0x3')][a2_0x3583('0x37')](a2_0x3583('0x35')))],'order':[[a2_0x3583('0x35'),a2_0x3583('0x3e')]]})[a2_0x3583('0x1a')](_0x55a0d4=>{_0x2a18c3[a2_0x3583('0xf')]({'data':_0x55a0d4});});};exports[a2_0x3583('0x44')]=(_0x504cbc,_0x2949bb,_0xcfb267)=>{const _0x8dfe63=_0x504cbc[a2_0x3583('0x45')]['tokens']['find'](_0x8dfe63=>_0x8dfe63['kind']==='facebook');fbgraph_1[a2_0x3583('0xa')]['setAccessToken'](_0x8dfe63['accessToken']);fbgraph_1[a2_0x3583('0xa')][a2_0x3583('0x46')](_0x504cbc[a2_0x3583('0x45')][a2_0x3583('0x47')]+a2_0x3583('0x48'),(_0x1a7402,_0x417c29)=>{if(_0x1a7402){return _0xcfb267(_0x1a7402);}_0x2949bb[a2_0x3583('0x5')](a2_0x3583('0x49'),{'title':a2_0x3583('0x4a'),'profile':_0x417c29});});};
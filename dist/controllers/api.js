var a2_0xe568=['accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','defineProperty','__esModule','fbgraph','ftp','sequelize','setSequelize','api/index','API\x20Examples','syncFtp','log','connecting','default','ready','connected','colombia','name','endsWith','models','findOrCreate','push','json','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','then','connected:','fileName','get','colombia/','end','.txt','status','save','Downloaded:\x20','processFtp','report_files','utf8','parse','Data','CountingInfo','Out','EndTime','create','pass_counting','findAll','countingDate','getPassCountingByDay','query','month','startDate','endDate','col','amount','total','gte','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC','getPassCountingByHour','%Y-%m-%d\x20%H:00','countingDateShort','HOUR','DAY','YEAR','getFacebook','user','tokens','find','setAccessToken'];(function(_0x48e833,_0x3e79e0){var _0x377aa3=function(_0x3f3418){while(--_0x3f3418){_0x48e833['push'](_0x48e833['shift']());}};_0x377aa3(++_0x3e79e0);}(a2_0xe568,0xe8));var a2_0x1c32=function(_0x3740a1,_0x4af823){_0x3740a1=_0x3740a1-0x0;var _0x47e9d9=a2_0xe568[_0x3740a1];return _0x47e9d9;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x3e6b6d){return _0x3e6b6d&&_0x3e6b6d['__esModule']?_0x3e6b6d:{'default':_0x3e6b6d};};Object[a2_0x1c32('0x0')](exports,a2_0x1c32('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x1c32('0x2')));const ftp_1=__importDefault(require(a2_0x1c32('0x3')));const fs_1=__importDefault(require('fs'));exports[a2_0x1c32('0x4')]='';function setSequelize(_0x54d150){exports['sequelize']=_0x54d150;}exports[a2_0x1c32('0x5')]=setSequelize;exports['getApi']=(_0x359faf,_0x16e568)=>{_0x16e568['render'](a2_0x1c32('0x6'),{'title':a2_0x1c32('0x7')});};exports[a2_0x1c32('0x8')]=(_0x55e437,_0x2d7c9c)=>{console[a2_0x1c32('0x9')](a2_0x1c32('0xa'));const _0x2911b1=[];const _0x4ac51c=new ftp_1[(a2_0x1c32('0xb'))]();_0x4ac51c['on'](a2_0x1c32('0xc'),function(){console[a2_0x1c32('0x9')](a2_0x1c32('0xd'));_0x4ac51c['list'](a2_0x1c32('0xe'),![],function(_0x19557f,_0x17f22b){if(_0x19557f){}else{for(const _0x19c94c of _0x17f22b){console['log']('Downloading:\x20'+_0x19c94c[a2_0x1c32('0xf')]);if(_0x19c94c[a2_0x1c32('0xf')][a2_0x1c32('0x10')]('json')){exports[a2_0x1c32('0x4')][a2_0x1c32('0x11')]['report_files'][a2_0x1c32('0x12')]({'where':{'fileName':_0x19c94c[a2_0x1c32('0xf')]}})['spread']((_0x4a399e,_0x45f280)=>{if(_0x45f280){console[a2_0x1c32('0x9')](_0x19c94c[a2_0x1c32('0xf')]);_0x2911b1[a2_0x1c32('0x13')](_0x4a399e);}});}}}_0x2d7c9c[a2_0x1c32('0x14')]({'data':_0x2911b1});});});_0x4ac51c['on']('error',function(_0x3e7c01){_0x2d7c9c[a2_0x1c32('0x14')]({'message':_0x3e7c01});});_0x4ac51c[a2_0x1c32('0x15')]({'host':a2_0x1c32('0x16'),'port':0x15,'user':a2_0x1c32('0x17'),'password':a2_0x1c32('0x17')});};exports[a2_0x1c32('0x18')]=(_0xdbb753,_0x16a4eb)=>{exports[a2_0x1c32('0x4')][a2_0x1c32('0x11')]['report_files'][a2_0x1c32('0x19')]({'where':{'status':null}})[a2_0x1c32('0x1a')](_0x3cd1dc=>{if(_0x3cd1dc){const _0x20ec2a=new ftp_1[(a2_0x1c32('0xb'))]();_0x20ec2a['on'](a2_0x1c32('0xc'),function(){console[a2_0x1c32('0x9')](a2_0x1c32('0x1b')+_0x3cd1dc[a2_0x1c32('0x1c')]);_0x20ec2a[a2_0x1c32('0x1d')](a2_0x1c32('0x1e')+_0x3cd1dc[a2_0x1c32('0x1c')],function(_0x1e9ad0,_0x2a7337){_0x20ec2a[a2_0x1c32('0x1f')]();if(_0x1e9ad0){}else{const _0x183a53='media/'+_0x3cd1dc[a2_0x1c32('0x1c')]+a2_0x1c32('0x20');_0x2a7337['pipe'](fs_1[a2_0x1c32('0xb')]['createWriteStream'](_0x183a53));_0x3cd1dc[a2_0x1c32('0x21')]=0x1;_0x3cd1dc[a2_0x1c32('0x22')]();console[a2_0x1c32('0x9')](a2_0x1c32('0x23')+_0x3cd1dc[a2_0x1c32('0x1c')]);}});});_0x20ec2a['on']('error',function(_0x179814){_0x16a4eb[a2_0x1c32('0x14')]({'message':_0x179814});});_0x20ec2a['connect']({'host':a2_0x1c32('0x16'),'port':0x15,'user':a2_0x1c32('0x17'),'password':a2_0x1c32('0x17')});_0x16a4eb[a2_0x1c32('0x14')]({'data':_0x3cd1dc[a2_0x1c32('0x1c')]});}else{_0x16a4eb[a2_0x1c32('0x14')]({'data':[]});}});};exports[a2_0x1c32('0x24')]=(_0x2e8067,_0x516173)=>{exports[a2_0x1c32('0x4')][a2_0x1c32('0x11')][a2_0x1c32('0x25')][a2_0x1c32('0x19')]({'where':{'status':0x1}})[a2_0x1c32('0x1a')](_0x85cccb=>{if(_0x85cccb){const _0x4cc146='media/'+_0x85cccb[a2_0x1c32('0x1c')]+a2_0x1c32('0x20');fs_1[a2_0x1c32('0xb')]['readFile'](_0x4cc146,a2_0x1c32('0x26'),function(_0x2f8ad9,_0x229e0d){if(_0x2f8ad9){_0x85cccb[a2_0x1c32('0x21')]=null;}else{try{const _0x25b98e=JSON[a2_0x1c32('0x27')](_0x229e0d);for(const _0x141bd7 of _0x25b98e[a2_0x1c32('0x28')][0x0][a2_0x1c32('0x29')]){const _0x1e9a8a=_0x141bd7['In'];const _0xf3ee6=_0x141bd7[a2_0x1c32('0x2a')];const _0x5e0ecb=Date[a2_0x1c32('0x27')](_0x141bd7[a2_0x1c32('0x2b')]);if(_0x1e9a8a>0x0){exports[a2_0x1c32('0x4')][a2_0x1c32('0x11')]['pass_counting'][a2_0x1c32('0x2c')]({'reportFileId':_0x85cccb['id'],'amount':_0x1e9a8a,'countingDate':_0x5e0ecb});}if(_0xf3ee6>0x0){exports[a2_0x1c32('0x4')]['models']['pass_counting'][a2_0x1c32('0x2c')]({'reportFileId':_0x85cccb['id'],'amount':_0xf3ee6*-0x1,'countingDate':_0x5e0ecb});}}_0x85cccb[a2_0x1c32('0x21')]=0x2;}catch(_0x565b83){_0x85cccb['status']=null;}}_0x85cccb['save']();});_0x516173[a2_0x1c32('0x14')]({'data':_0x85cccb['fileName']});}else{_0x516173[a2_0x1c32('0x14')]({'data':[]});}});};exports['getPassCounting']=(_0x2bb00f,_0x3f7002)=>{exports[a2_0x1c32('0x4')][a2_0x1c32('0x11')][a2_0x1c32('0x2d')][a2_0x1c32('0x2e')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a2_0x1c32('0x2f'),'ASC']]})[a2_0x1c32('0x1a')](_0x5beed4=>{_0x3f7002[a2_0x1c32('0x14')]({'data':_0x5beed4});});};exports[a2_0x1c32('0x30')]=(_0x3080a6,_0x2e87e6)=>{const _0x4bd807=_0x3080a6[a2_0x1c32('0x31')][a2_0x1c32('0x32')];const _0x18c42c=_0x3080a6['query'][a2_0x1c32('0x33')];const _0x1cf3d3=_0x3080a6[a2_0x1c32('0x31')][a2_0x1c32('0x34')];exports[a2_0x1c32('0x4')][a2_0x1c32('0x11')][a2_0x1c32('0x2d')][a2_0x1c32('0x2e')]({'attributes':[a2_0x1c32('0x2f'),[exports['sequelize']['fn']('sum',exports[a2_0x1c32('0x4')][a2_0x1c32('0x35')](a2_0x1c32('0x36'))),a2_0x1c32('0x37')]],'where':{'countingDate':{[exports[a2_0x1c32('0x4')]['Op'][a2_0x1c32('0x38')]]:_0x18c42c,[exports[a2_0x1c32('0x4')]['Op']['lt']]:_0x1cf3d3},'amount':_0x3080a6['params'][a2_0x1c32('0x39')]=='in'?{[exports[a2_0x1c32('0x4')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x1c32('0x4')][a2_0x1c32('0x3a')](a2_0x1c32('0x3b'))],'order':[[a2_0x1c32('0x2f'),a2_0x1c32('0x3c')]]})[a2_0x1c32('0x1a')](_0x194195=>{_0x2e87e6[a2_0x1c32('0x14')]({'data':_0x194195});});};exports[a2_0x1c32('0x3d')]=(_0x480c4c,_0x37f376)=>{const _0x27a8c9=_0x480c4c[a2_0x1c32('0x31')][a2_0x1c32('0x32')];const _0x1a5460=_0x480c4c['query'][a2_0x1c32('0x33')];const _0x4d05ed=_0x480c4c[a2_0x1c32('0x31')][a2_0x1c32('0x34')];exports[a2_0x1c32('0x4')][a2_0x1c32('0x11')]['pass_counting'][a2_0x1c32('0x2e')]({'attributes':[a2_0x1c32('0x2f'),[exports[a2_0x1c32('0x4')]['fn']('DATE_FORMAT',exports['sequelize'][a2_0x1c32('0x35')](a2_0x1c32('0x2f')),a2_0x1c32('0x3e')),a2_0x1c32('0x3f')],[exports[a2_0x1c32('0x4')]['fn']('sum',exports[a2_0x1c32('0x4')]['col'](a2_0x1c32('0x36'))),a2_0x1c32('0x37')]],'where':{'countingDate':{[exports['sequelize']['Op']['gte']]:_0x1a5460,[exports['sequelize']['Op']['lt']]:_0x4d05ed},'amount':_0x480c4c['params']['direction']=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x1c32('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x1c32('0x4')]['fn'](a2_0x1c32('0x40'),exports[a2_0x1c32('0x4')][a2_0x1c32('0x35')](a2_0x1c32('0x2f'))),exports[a2_0x1c32('0x4')]['fn'](a2_0x1c32('0x41'),exports[a2_0x1c32('0x4')][a2_0x1c32('0x35')]('countingDate')),exports[a2_0x1c32('0x4')]['fn']('MONTH',exports[a2_0x1c32('0x4')][a2_0x1c32('0x35')](a2_0x1c32('0x2f'))),exports[a2_0x1c32('0x4')]['fn'](a2_0x1c32('0x42'),exports[a2_0x1c32('0x4')][a2_0x1c32('0x35')](a2_0x1c32('0x2f')))],'order':[[a2_0x1c32('0x2f'),a2_0x1c32('0x3c')]]})[a2_0x1c32('0x1a')](_0x452f7a=>{_0x37f376['json']({'data':_0x452f7a});});};exports[a2_0x1c32('0x43')]=(_0x38d88d,_0x40209d,_0xe703af)=>{const _0x3de247=_0x38d88d[a2_0x1c32('0x44')][a2_0x1c32('0x45')][a2_0x1c32('0x46')](_0x3de247=>_0x3de247['kind']==='facebook');fbgraph_1[a2_0x1c32('0xb')][a2_0x1c32('0x47')](_0x3de247[a2_0x1c32('0x48')]);fbgraph_1[a2_0x1c32('0xb')][a2_0x1c32('0x1d')](_0x38d88d[a2_0x1c32('0x44')]['facebook']+a2_0x1c32('0x49'),(_0x1ca203,_0x1d0a8e)=>{if(_0x1ca203){return _0xe703af(_0x1ca203);}_0x40209d['render'](a2_0x1c32('0x4a'),{'title':a2_0x1c32('0x4b'),'profile':_0x1d0a8e});});};
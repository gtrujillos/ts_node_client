var a2_0x14e9=['json','ftp.vivotek.com','ipd','fileName','get','colombia/','end','media/','pipe','createWriteStream','status','save','Downloaded:\x20','connect','processFtp','models','findOne','then','.txt','readFile','utf8','parse','CountingInfo','Out','EndTime','pass_counting','create','getPassCounting','findAll','ASC','getPassCountingByDay','month','startDate','query','endDate','countingDate','sum','col','total','gte','params','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','%Y-%m-%d\x20%H:00','amount','YEAR','getFacebook','user','find','kind','facebook','setAccessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','__importDefault','__esModule','defineProperty','fbgraph','sequelize','setSequelize','getApi','render','api/index','API\x20Examples','syncFtp','log','default','ready','connected','list','colombia','Downloading:\x20','name','report_files','findOrCreate','push','error'];(function(_0x269cdc,_0x3cd7db){var _0x1c81f4=function(_0x22bd91){while(--_0x22bd91){_0x269cdc['push'](_0x269cdc['shift']());}};_0x1c81f4(++_0x3cd7db);}(a2_0x14e9,0xd3));var a2_0x32d7=function(_0x18b695,_0x12e752){_0x18b695=_0x18b695-0x0;var _0x409397=a2_0x14e9[_0x18b695];return _0x409397;};'use strict';var __importDefault=this&&this[a2_0x32d7('0x0')]||function(_0x5e7d34){return _0x5e7d34&&_0x5e7d34[a2_0x32d7('0x1')]?_0x5e7d34:{'default':_0x5e7d34};};Object[a2_0x32d7('0x2')](exports,a2_0x32d7('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x32d7('0x3')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));exports[a2_0x32d7('0x4')]='';function setSequelize(_0x17b6e2){exports[a2_0x32d7('0x4')]=_0x17b6e2;}exports[a2_0x32d7('0x5')]=setSequelize;exports[a2_0x32d7('0x6')]=(_0x550249,_0x1d93fa)=>{_0x1d93fa[a2_0x32d7('0x7')](a2_0x32d7('0x8'),{'title':a2_0x32d7('0x9')});};exports[a2_0x32d7('0xa')]=(_0xaf32cf,_0x545a45)=>{console[a2_0x32d7('0xb')]('connecting');const _0x591824=[];const _0x1dfef7=new ftp_1[(a2_0x32d7('0xc'))]();_0x1dfef7['on'](a2_0x32d7('0xd'),function(){console[a2_0x32d7('0xb')](a2_0x32d7('0xe'));_0x1dfef7[a2_0x32d7('0xf')](a2_0x32d7('0x10'),![],function(_0x3375d6,_0x419601){if(_0x3375d6){}else{for(const _0x283858 of _0x419601){console[a2_0x32d7('0xb')](a2_0x32d7('0x11')+_0x283858['name']);if(_0x283858[a2_0x32d7('0x12')]['endsWith']('json')){exports[a2_0x32d7('0x4')]['models'][a2_0x32d7('0x13')][a2_0x32d7('0x14')]({'where':{'fileName':_0x283858['name']}})['spread']((_0x1f286c,_0x189f05)=>{if(_0x189f05){console[a2_0x32d7('0xb')](_0x283858[a2_0x32d7('0x12')]);_0x591824[a2_0x32d7('0x15')](_0x1f286c);}});}}}_0x545a45['json']({'data':_0x591824});});});_0x1dfef7['on'](a2_0x32d7('0x16'),function(_0x53f14e){_0x545a45[a2_0x32d7('0x17')]({'message':_0x53f14e});});_0x1dfef7['connect']({'host':a2_0x32d7('0x18'),'port':0x15,'user':a2_0x32d7('0x19'),'password':'ipd'});};exports['downloadFtp']=(_0x4bc29a,_0x2ed8a7)=>{exports['sequelize']['models'][a2_0x32d7('0x13')]['findOne']({'where':{'status':null}})['then'](_0xb7a73a=>{if(_0xb7a73a){const _0x2a55e4=new ftp_1[(a2_0x32d7('0xc'))]();_0x2a55e4['on'](a2_0x32d7('0xd'),function(){console[a2_0x32d7('0xb')]('connected:'+_0xb7a73a[a2_0x32d7('0x1a')]);_0x2a55e4[a2_0x32d7('0x1b')](a2_0x32d7('0x1c')+_0xb7a73a[a2_0x32d7('0x1a')],function(_0x36be50,_0x517313){_0x2a55e4[a2_0x32d7('0x1d')]();if(_0x36be50){}else{const _0x293bd2=a2_0x32d7('0x1e')+_0xb7a73a['fileName']+'.txt';_0x517313[a2_0x32d7('0x1f')](fs_1[a2_0x32d7('0xc')][a2_0x32d7('0x20')](_0x293bd2));_0xb7a73a[a2_0x32d7('0x21')]=0x1;_0xb7a73a[a2_0x32d7('0x22')]();console[a2_0x32d7('0xb')](a2_0x32d7('0x23')+_0xb7a73a['fileName']);}});});_0x2a55e4['on'](a2_0x32d7('0x16'),function(_0x11edbd){_0x2ed8a7[a2_0x32d7('0x17')]({'message':_0x11edbd});});_0x2a55e4[a2_0x32d7('0x24')]({'host':a2_0x32d7('0x18'),'port':0x15,'user':'ipd','password':a2_0x32d7('0x19')});_0x2ed8a7[a2_0x32d7('0x17')]({'data':_0xb7a73a[a2_0x32d7('0x1a')]});}else{_0x2ed8a7['json']({'data':[]});}});};exports[a2_0x32d7('0x25')]=(_0x259847,_0x4b409a)=>{exports[a2_0x32d7('0x4')][a2_0x32d7('0x26')][a2_0x32d7('0x13')][a2_0x32d7('0x27')]({'where':{'status':0x1}})[a2_0x32d7('0x28')](_0x4f4f56=>{if(_0x4f4f56){const _0x49dd59=a2_0x32d7('0x1e')+_0x4f4f56[a2_0x32d7('0x1a')]+a2_0x32d7('0x29');fs_1[a2_0x32d7('0xc')][a2_0x32d7('0x2a')](_0x49dd59,a2_0x32d7('0x2b'),function(_0x2375e7,_0x13814f){if(_0x2375e7){_0x4f4f56[a2_0x32d7('0x21')]=null;}else{try{const _0x39cec1=JSON[a2_0x32d7('0x2c')](_0x13814f);for(const _0x5a37f8 of _0x39cec1['Data'][0x0][a2_0x32d7('0x2d')]){const _0x4e3604=_0x5a37f8['In'];const _0x1dd660=_0x5a37f8[a2_0x32d7('0x2e')];const _0xd564a9=Date[a2_0x32d7('0x2c')](_0x5a37f8[a2_0x32d7('0x2f')]);if(_0x4e3604>0x0){exports[a2_0x32d7('0x4')][a2_0x32d7('0x26')][a2_0x32d7('0x30')][a2_0x32d7('0x31')]({'reportFileId':_0x4f4f56['id'],'amount':_0x4e3604,'countingDate':_0xd564a9});}if(_0x1dd660>0x0){exports[a2_0x32d7('0x4')]['models']['pass_counting'][a2_0x32d7('0x31')]({'reportFileId':_0x4f4f56['id'],'amount':_0x1dd660*-0x1,'countingDate':_0xd564a9});}}_0x4f4f56['status']=0x2;}catch(_0x55ee20){_0x4f4f56[a2_0x32d7('0x21')]=null;}}_0x4f4f56[a2_0x32d7('0x22')]();});_0x4b409a[a2_0x32d7('0x17')]({'data':_0x4f4f56[a2_0x32d7('0x1a')]});}else{_0x4b409a[a2_0x32d7('0x17')]({'data':[]});}});};exports[a2_0x32d7('0x32')]=(_0x3855df,_0x42a6d6)=>{exports[a2_0x32d7('0x4')][a2_0x32d7('0x26')]['pass_counting'][a2_0x32d7('0x33')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[['countingDate',a2_0x32d7('0x34')]]})[a2_0x32d7('0x28')](_0x48e47e=>{_0x42a6d6[a2_0x32d7('0x17')]({'data':_0x48e47e});});};exports[a2_0x32d7('0x35')]=(_0x236def,_0x353356)=>{const _0x2712a7=_0x236def['query'][a2_0x32d7('0x36')];const _0x1aea5f=_0x236def['query'][a2_0x32d7('0x37')];const _0xf544c2=_0x236def[a2_0x32d7('0x38')][a2_0x32d7('0x39')];exports[a2_0x32d7('0x4')]['models']['pass_counting'][a2_0x32d7('0x33')]({'attributes':[a2_0x32d7('0x3a'),[exports['sequelize']['fn'](a2_0x32d7('0x3b'),exports[a2_0x32d7('0x4')][a2_0x32d7('0x3c')]('amount')),a2_0x32d7('0x3d')]],'where':{'countingDate':{[exports[a2_0x32d7('0x4')]['Op'][a2_0x32d7('0x3e')]]:_0x1aea5f,[exports[a2_0x32d7('0x4')]['Op']['lt']]:_0xf544c2},'amount':_0x236def[a2_0x32d7('0x3f')][a2_0x32d7('0x40')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x32d7('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x32d7('0x4')]['literal'](a2_0x32d7('0x41'))],'order':[[a2_0x32d7('0x3a'),a2_0x32d7('0x34')]]})[a2_0x32d7('0x28')](_0x18c6ed=>{_0x353356[a2_0x32d7('0x17')]({'data':_0x18c6ed});});};exports[a2_0x32d7('0x42')]=(_0x78b250,_0x1bafa3)=>{const _0x82ace8=_0x78b250[a2_0x32d7('0x38')][a2_0x32d7('0x36')];const _0x14cf61=_0x78b250[a2_0x32d7('0x38')][a2_0x32d7('0x37')];const _0x471657=_0x78b250[a2_0x32d7('0x38')][a2_0x32d7('0x39')];exports['sequelize'][a2_0x32d7('0x26')][a2_0x32d7('0x30')]['findAll']({'attributes':[a2_0x32d7('0x3a'),[exports[a2_0x32d7('0x4')]['fn']('DATE_FORMAT',exports['sequelize']['col'](a2_0x32d7('0x3a')),a2_0x32d7('0x43')),'countingDateShort'],[exports['sequelize']['fn'](a2_0x32d7('0x3b'),exports[a2_0x32d7('0x4')][a2_0x32d7('0x3c')](a2_0x32d7('0x44'))),a2_0x32d7('0x3d')]],'where':{'countingDate':{[exports[a2_0x32d7('0x4')]['Op'][a2_0x32d7('0x3e')]]:_0x14cf61,[exports[a2_0x32d7('0x4')]['Op']['lt']]:_0x471657},'amount':_0x78b250['params']['direction']=='in'?{[exports[a2_0x32d7('0x4')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x32d7('0x4')]['fn']('HOUR',exports[a2_0x32d7('0x4')]['col']('countingDate')),exports['sequelize']['fn']('DAY',exports[a2_0x32d7('0x4')]['col'](a2_0x32d7('0x3a'))),exports[a2_0x32d7('0x4')]['fn']('MONTH',exports[a2_0x32d7('0x4')]['col'](a2_0x32d7('0x3a'))),exports[a2_0x32d7('0x4')]['fn'](a2_0x32d7('0x45'),exports[a2_0x32d7('0x4')][a2_0x32d7('0x3c')](a2_0x32d7('0x3a')))],'order':[[a2_0x32d7('0x3a'),a2_0x32d7('0x34')]]})[a2_0x32d7('0x28')](_0x527ef1=>{_0x1bafa3[a2_0x32d7('0x17')]({'data':_0x527ef1});});};exports[a2_0x32d7('0x46')]=(_0x557fac,_0x1b87bd,_0x2f0242)=>{const _0x4da671=_0x557fac[a2_0x32d7('0x47')]['tokens'][a2_0x32d7('0x48')](_0x4da671=>_0x4da671[a2_0x32d7('0x49')]===a2_0x32d7('0x4a'));fbgraph_1[a2_0x32d7('0xc')][a2_0x32d7('0x4b')](_0x4da671['accessToken']);fbgraph_1[a2_0x32d7('0xc')]['get'](_0x557fac[a2_0x32d7('0x47')]['facebook']+a2_0x32d7('0x4c'),(_0x254b53,_0x4028ef)=>{if(_0x254b53){return _0x2f0242(_0x254b53);}_0x1b87bd[a2_0x32d7('0x7')](a2_0x32d7('0x4d'),{'title':'Facebook\x20API','profile':_0x4028ef});});};
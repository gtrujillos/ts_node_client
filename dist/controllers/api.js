var a2_0x33d3=['MONTH','YEAR','getFacebook','user','tokens','find','facebook','setAccessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','__esModule','defineProperty','fbgraph','ftp','sequelize','setSequelize','getApi','render','api/index','API\x20Examples','syncFtp','connecting','ready','connected','list','colombia','Downloading:\x20','json','models','report_files','findOrCreate','name','log','push','connect','ipd','downloadFtp','then','default','connected:','get','colombia/','fileName','end','status','save','Downloaded:\x20','ftp.vivotek.com','processFtp','findOne','media/','utf8','Data','CountingInfo','parse','EndTime','pass_counting','create','getPassCounting','countingDate','ASC','getPassCountingByDay','query','month','startDate','findAll','sum','col','amount','total','params','literal','getPassCountingByHour','endDate','%Y-%m-%d\x20%H:00','DAY'];(function(_0x4b43ed,_0x823488){var _0x1033f9=function(_0x5b9d98){while(--_0x5b9d98){_0x4b43ed['push'](_0x4b43ed['shift']());}};_0x1033f9(++_0x823488);}(a2_0x33d3,0xee));var a2_0x4bf8=function(_0x31d61a,_0x39c7ec){_0x31d61a=_0x31d61a-0x0;var _0x36aac0=a2_0x33d3[_0x31d61a];return _0x36aac0;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x33db24){return _0x33db24&&_0x33db24[a2_0x4bf8('0x0')]?_0x33db24:{'default':_0x33db24};};Object[a2_0x4bf8('0x1')](exports,a2_0x4bf8('0x0'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x4bf8('0x2')));const ftp_1=__importDefault(require(a2_0x4bf8('0x3')));const fs_1=__importDefault(require('fs'));exports[a2_0x4bf8('0x4')]='';function setSequelize(_0x1dbae0){exports[a2_0x4bf8('0x4')]=_0x1dbae0;}exports[a2_0x4bf8('0x5')]=setSequelize;exports[a2_0x4bf8('0x6')]=(_0x553323,_0x447e41)=>{_0x447e41[a2_0x4bf8('0x7')](a2_0x4bf8('0x8'),{'title':a2_0x4bf8('0x9')});};exports[a2_0x4bf8('0xa')]=(_0x4d1344,_0x1933e9)=>{console['log'](a2_0x4bf8('0xb'));const _0x1899cc=[];const _0x437847=new ftp_1['default']();_0x437847['on'](a2_0x4bf8('0xc'),function(){console['log'](a2_0x4bf8('0xd'));_0x437847[a2_0x4bf8('0xe')](a2_0x4bf8('0xf'),![],function(_0x279ed7,_0x2bf166){if(_0x279ed7){}else{for(const _0x1cfa51 of _0x2bf166){console['log'](a2_0x4bf8('0x10')+_0x1cfa51['name']);if(_0x1cfa51['name']['endsWith'](a2_0x4bf8('0x11'))){exports[a2_0x4bf8('0x4')][a2_0x4bf8('0x12')][a2_0x4bf8('0x13')][a2_0x4bf8('0x14')]({'where':{'fileName':_0x1cfa51[a2_0x4bf8('0x15')]}})['spread']((_0x47c447,_0x2493ec)=>{if(_0x2493ec){console[a2_0x4bf8('0x16')](_0x1cfa51[a2_0x4bf8('0x15')]);_0x1899cc[a2_0x4bf8('0x17')](_0x47c447);}});}}}_0x1933e9['json']({'data':_0x1899cc});});});_0x437847['on']('error',function(_0xc4fe52){_0x1933e9['json']({'message':_0xc4fe52});});_0x437847[a2_0x4bf8('0x18')]({'host':'ftp.vivotek.com','port':0x15,'user':a2_0x4bf8('0x19'),'password':a2_0x4bf8('0x19')});};exports[a2_0x4bf8('0x1a')]=(_0x2758c0,_0x16cde1)=>{exports['sequelize'][a2_0x4bf8('0x12')][a2_0x4bf8('0x13')]['findOne']({'where':{'status':null}})[a2_0x4bf8('0x1b')](_0x438e3d=>{if(_0x438e3d){const _0xc23839=new ftp_1[(a2_0x4bf8('0x1c'))]();_0xc23839['on']('ready',function(){console[a2_0x4bf8('0x16')](a2_0x4bf8('0x1d')+_0x438e3d['fileName']);_0xc23839[a2_0x4bf8('0x1e')](a2_0x4bf8('0x1f')+_0x438e3d[a2_0x4bf8('0x20')],function(_0x173a27,_0x3143d1){_0xc23839[a2_0x4bf8('0x21')]();if(_0x173a27){}else{const _0x3ec9c4='media/'+_0x438e3d[a2_0x4bf8('0x20')]+'.txt';_0x3143d1['pipe'](fs_1[a2_0x4bf8('0x1c')]['createWriteStream'](_0x3ec9c4));_0x438e3d[a2_0x4bf8('0x22')]=0x1;_0x438e3d[a2_0x4bf8('0x23')]();console['log'](a2_0x4bf8('0x24')+_0x438e3d['fileName']);}});});_0xc23839['on']('error',function(_0x37952e){_0x16cde1[a2_0x4bf8('0x11')]({'message':_0x37952e});});_0xc23839[a2_0x4bf8('0x18')]({'host':a2_0x4bf8('0x25'),'port':0x15,'user':a2_0x4bf8('0x19'),'password':'ipd'});_0x16cde1['json']({'data':_0x438e3d[a2_0x4bf8('0x20')]});}else{_0x16cde1[a2_0x4bf8('0x11')]({'data':[]});}});};exports[a2_0x4bf8('0x26')]=(_0x1de269,_0x329c39)=>{exports[a2_0x4bf8('0x4')]['models'][a2_0x4bf8('0x13')][a2_0x4bf8('0x27')]({'where':{'status':0x1}})[a2_0x4bf8('0x1b')](_0x33258c=>{if(_0x33258c){const _0x35a384=a2_0x4bf8('0x28')+_0x33258c[a2_0x4bf8('0x20')]+'.txt';fs_1['default']['readFile'](_0x35a384,a2_0x4bf8('0x29'),function(_0x51aa91,_0x29661e){if(_0x51aa91){_0x33258c[a2_0x4bf8('0x22')]=null;}else{try{const _0x5bf191=JSON['parse'](_0x29661e);for(const _0x3b85db of _0x5bf191[a2_0x4bf8('0x2a')][0x0][a2_0x4bf8('0x2b')]){const _0x547229=_0x3b85db['In'];const _0x2fcb7c=_0x3b85db['Out'];const _0x34b223=Date[a2_0x4bf8('0x2c')](_0x3b85db[a2_0x4bf8('0x2d')]);if(_0x547229>0x0){exports[a2_0x4bf8('0x4')][a2_0x4bf8('0x12')][a2_0x4bf8('0x2e')][a2_0x4bf8('0x2f')]({'reportFileId':_0x33258c['id'],'amount':_0x547229,'countingDate':_0x34b223});}if(_0x2fcb7c>0x0){exports[a2_0x4bf8('0x4')][a2_0x4bf8('0x12')][a2_0x4bf8('0x2e')][a2_0x4bf8('0x2f')]({'reportFileId':_0x33258c['id'],'amount':_0x2fcb7c*-0x1,'countingDate':_0x34b223});}}_0x33258c[a2_0x4bf8('0x22')]=0x2;}catch(_0x5883e3){_0x33258c[a2_0x4bf8('0x22')]=null;}}_0x33258c['save']();});_0x329c39[a2_0x4bf8('0x11')]({'data':_0x33258c[a2_0x4bf8('0x20')]});}else{_0x329c39[a2_0x4bf8('0x11')]({'data':[]});}});};exports[a2_0x4bf8('0x30')]=(_0x85d5b5,_0x2dee30)=>{exports[a2_0x4bf8('0x4')][a2_0x4bf8('0x12')][a2_0x4bf8('0x2e')]['findAll']({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a2_0x4bf8('0x31'),a2_0x4bf8('0x32')]]})[a2_0x4bf8('0x1b')](_0x342309=>{_0x2dee30[a2_0x4bf8('0x11')]({'data':_0x342309});});};exports[a2_0x4bf8('0x33')]=(_0x15d21b,_0x21c4fc)=>{const _0x3a1003=_0x15d21b[a2_0x4bf8('0x34')][a2_0x4bf8('0x35')];const _0x427115=_0x15d21b[a2_0x4bf8('0x34')][a2_0x4bf8('0x36')];const _0x12488c=_0x15d21b[a2_0x4bf8('0x34')]['endDate'];exports['sequelize'][a2_0x4bf8('0x12')][a2_0x4bf8('0x2e')][a2_0x4bf8('0x37')]({'attributes':[a2_0x4bf8('0x31'),[exports[a2_0x4bf8('0x4')]['fn'](a2_0x4bf8('0x38'),exports['sequelize'][a2_0x4bf8('0x39')](a2_0x4bf8('0x3a'))),a2_0x4bf8('0x3b')]],'where':{'countingDate':{[exports[a2_0x4bf8('0x4')]['Op']['gte']]:_0x427115,[exports['sequelize']['Op']['lt']]:_0x12488c},'amount':_0x15d21b[a2_0x4bf8('0x3c')]['direction']=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x4bf8('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x4bf8('0x4')][a2_0x4bf8('0x3d')]('YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))')],'order':[[a2_0x4bf8('0x31'),a2_0x4bf8('0x32')]]})[a2_0x4bf8('0x1b')](_0x417716=>{_0x21c4fc['json']({'data':_0x417716});});};exports[a2_0x4bf8('0x3e')]=(_0x44c326,_0x49bfca)=>{const _0x4788f0=_0x44c326[a2_0x4bf8('0x34')]['month'];const _0x3f1a25=_0x44c326['query']['startDate'];const _0x5007f6=_0x44c326[a2_0x4bf8('0x34')][a2_0x4bf8('0x3f')];exports[a2_0x4bf8('0x4')][a2_0x4bf8('0x12')]['pass_counting'][a2_0x4bf8('0x37')]({'attributes':['countingDate',[exports[a2_0x4bf8('0x4')]['fn']('DATE_FORMAT',exports['sequelize'][a2_0x4bf8('0x39')](a2_0x4bf8('0x31')),a2_0x4bf8('0x40')),'countingDateShort'],[exports[a2_0x4bf8('0x4')]['fn'](a2_0x4bf8('0x38'),exports['sequelize']['col'](a2_0x4bf8('0x3a'))),'total']],'where':{'countingDate':{[exports[a2_0x4bf8('0x4')]['Op']['gte']]:_0x3f1a25,[exports['sequelize']['Op']['lt']]:_0x5007f6},'amount':_0x44c326[a2_0x4bf8('0x3c')]['direction']=='in'?{[exports[a2_0x4bf8('0x4')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a2_0x4bf8('0x4')]['fn']('HOUR',exports['sequelize'][a2_0x4bf8('0x39')](a2_0x4bf8('0x31'))),exports[a2_0x4bf8('0x4')]['fn'](a2_0x4bf8('0x41'),exports[a2_0x4bf8('0x4')][a2_0x4bf8('0x39')](a2_0x4bf8('0x31'))),exports[a2_0x4bf8('0x4')]['fn'](a2_0x4bf8('0x42'),exports[a2_0x4bf8('0x4')][a2_0x4bf8('0x39')](a2_0x4bf8('0x31'))),exports['sequelize']['fn'](a2_0x4bf8('0x43'),exports['sequelize'][a2_0x4bf8('0x39')](a2_0x4bf8('0x31')))],'order':[[a2_0x4bf8('0x31'),'ASC']]})[a2_0x4bf8('0x1b')](_0x1cc654=>{_0x49bfca[a2_0x4bf8('0x11')]({'data':_0x1cc654});});};exports[a2_0x4bf8('0x44')]=(_0xa856a9,_0x54228d,_0x228507)=>{const _0x5bf27b=_0xa856a9[a2_0x4bf8('0x45')][a2_0x4bf8('0x46')][a2_0x4bf8('0x47')](_0x5bf27b=>_0x5bf27b['kind']===a2_0x4bf8('0x48'));fbgraph_1[a2_0x4bf8('0x1c')][a2_0x4bf8('0x49')](_0x5bf27b['accessToken']);fbgraph_1[a2_0x4bf8('0x1c')][a2_0x4bf8('0x1e')](_0xa856a9[a2_0x4bf8('0x45')][a2_0x4bf8('0x48')]+a2_0x4bf8('0x4a'),(_0x1c03fe,_0x491fc2)=>{if(_0x1c03fe){return _0x228507(_0x1c03fe);}_0x54228d[a2_0x4bf8('0x7')](a2_0x4bf8('0x4b'),{'title':'Facebook\x20API','profile':_0x491fc2});});};
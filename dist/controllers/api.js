var a2_0x5c36=['push','error','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','then','connected:','fileName','get','colombia/','end','media/','.txt','createWriteStream','status','save','Downloaded:\x20','processFtp','default','utf8','parse','CountingInfo','pass_counting','create','findAll','countingDate','getPassCountingByDay','month','query','startDate','endDate','sum','col','amount','total','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC','getPassCountingByHour','DATE_FORMAT','countingDateShort','DAY','MONTH','getFacebook','tokens','kind','facebook','accessToken','user','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','__importDefault','__esModule','defineProperty','fbgraph','ftp','sequelize','getApi','render','api/index','API\x20Examples','syncFtp','log','connecting','ready','connected','colombia','Downloading:\x20','endsWith','json','models','report_files','findOrCreate','name','spread'];(function(_0x24531,_0x2aa084){var _0x140f5f=function(_0x1efc2d){while(--_0x1efc2d){_0x24531['push'](_0x24531['shift']());}};_0x140f5f(++_0x2aa084);}(a2_0x5c36,0x128));var a2_0x353e=function(_0x364892,_0x3d573d){_0x364892=_0x364892-0x0;var _0x342a5e=a2_0x5c36[_0x364892];return _0x342a5e;};'use strict';var __importDefault=this&&this[a2_0x353e('0x0')]||function(_0x3ff1ad){return _0x3ff1ad&&_0x3ff1ad[a2_0x353e('0x1')]?_0x3ff1ad:{'default':_0x3ff1ad};};Object[a2_0x353e('0x2')](exports,a2_0x353e('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x353e('0x3')));const ftp_1=__importDefault(require(a2_0x353e('0x4')));const fs_1=__importDefault(require('fs'));exports[a2_0x353e('0x5')]='';function setSequelize(_0x1ee4da){exports[a2_0x353e('0x5')]=_0x1ee4da;}exports['setSequelize']=setSequelize;exports[a2_0x353e('0x6')]=(_0x16ad54,_0x462708)=>{_0x462708[a2_0x353e('0x7')](a2_0x353e('0x8'),{'title':a2_0x353e('0x9')});};exports[a2_0x353e('0xa')]=(_0x8c047,_0x2e951f)=>{console[a2_0x353e('0xb')](a2_0x353e('0xc'));const _0x37058e=[];const _0x265328=new ftp_1['default']();_0x265328['on'](a2_0x353e('0xd'),function(){console[a2_0x353e('0xb')](a2_0x353e('0xe'));_0x265328['list'](a2_0x353e('0xf'),![],function(_0x56c38f,_0x313265){if(_0x56c38f){}else{for(const _0x16bb75 of _0x313265){console[a2_0x353e('0xb')](a2_0x353e('0x10')+_0x16bb75['name']);if(_0x16bb75['name'][a2_0x353e('0x11')](a2_0x353e('0x12'))){exports[a2_0x353e('0x5')][a2_0x353e('0x13')][a2_0x353e('0x14')][a2_0x353e('0x15')]({'where':{'fileName':_0x16bb75[a2_0x353e('0x16')]}})[a2_0x353e('0x17')]((_0x26c1c8,_0x2d5fce)=>{if(_0x2d5fce){console[a2_0x353e('0xb')](_0x16bb75[a2_0x353e('0x16')]);_0x37058e[a2_0x353e('0x18')](_0x26c1c8);}});}}}_0x2e951f[a2_0x353e('0x12')]({'data':_0x37058e});});});_0x265328['on'](a2_0x353e('0x19'),function(_0x3d1fda){_0x2e951f[a2_0x353e('0x12')]({'message':_0x3d1fda});});_0x265328[a2_0x353e('0x1a')]({'host':a2_0x353e('0x1b'),'port':0x15,'user':a2_0x353e('0x1c'),'password':a2_0x353e('0x1c')});};exports[a2_0x353e('0x1d')]=(_0x5b2ab8,_0x43a642)=>{exports[a2_0x353e('0x5')][a2_0x353e('0x13')][a2_0x353e('0x14')][a2_0x353e('0x1e')]({'where':{'status':null}})[a2_0x353e('0x1f')](_0x21954a=>{if(_0x21954a){const _0x5b952f=new ftp_1['default']();_0x5b952f['on'](a2_0x353e('0xd'),function(){console['log'](a2_0x353e('0x20')+_0x21954a[a2_0x353e('0x21')]);_0x5b952f[a2_0x353e('0x22')](a2_0x353e('0x23')+_0x21954a[a2_0x353e('0x21')],function(_0x4aa12a,_0x41e61e){_0x5b952f[a2_0x353e('0x24')]();if(_0x4aa12a){}else{const _0x49c598=a2_0x353e('0x25')+_0x21954a[a2_0x353e('0x21')]+a2_0x353e('0x26');_0x41e61e['pipe'](fs_1['default'][a2_0x353e('0x27')](_0x49c598));_0x21954a[a2_0x353e('0x28')]=0x1;_0x21954a[a2_0x353e('0x29')]();console[a2_0x353e('0xb')](a2_0x353e('0x2a')+_0x21954a[a2_0x353e('0x21')]);}});});_0x5b952f['on']('error',function(_0x565812){_0x43a642[a2_0x353e('0x12')]({'message':_0x565812});});_0x5b952f['connect']({'host':a2_0x353e('0x1b'),'port':0x15,'user':a2_0x353e('0x1c'),'password':a2_0x353e('0x1c')});_0x43a642['json']({'data':_0x21954a[a2_0x353e('0x21')]});}else{_0x43a642[a2_0x353e('0x12')]({'data':[]});}});};exports[a2_0x353e('0x2b')]=(_0x4de92e,_0x206980)=>{exports[a2_0x353e('0x5')][a2_0x353e('0x13')][a2_0x353e('0x14')][a2_0x353e('0x1e')]({'where':{'status':0x1}})[a2_0x353e('0x1f')](_0x16df03=>{if(_0x16df03){const _0x3813a3=a2_0x353e('0x25')+_0x16df03[a2_0x353e('0x21')]+a2_0x353e('0x26');fs_1[a2_0x353e('0x2c')]['readFile'](_0x3813a3,a2_0x353e('0x2d'),function(_0x265368,_0x4726fb){if(_0x265368){_0x16df03[a2_0x353e('0x28')]=null;}else{try{const _0x402a01=JSON[a2_0x353e('0x2e')](_0x4726fb);for(const _0x3a7883 of _0x402a01['Data'][0x0][a2_0x353e('0x2f')]){const _0x575a2b=_0x3a7883['In'];const _0x164b1f=_0x3a7883['Out'];const _0x2fae5d=Date['parse'](_0x3a7883['EndTime']);if(_0x575a2b>0x0){exports[a2_0x353e('0x5')]['models'][a2_0x353e('0x30')][a2_0x353e('0x31')]({'reportFileId':_0x16df03['id'],'amount':_0x575a2b,'countingDate':_0x2fae5d});}if(_0x164b1f>0x0){exports[a2_0x353e('0x5')]['models'][a2_0x353e('0x30')][a2_0x353e('0x31')]({'reportFileId':_0x16df03['id'],'amount':_0x164b1f*-0x1,'countingDate':_0x2fae5d});}}_0x16df03[a2_0x353e('0x28')]=0x2;}catch(_0x487ce4){_0x16df03[a2_0x353e('0x28')]=null;}}_0x16df03[a2_0x353e('0x29')]();});_0x206980[a2_0x353e('0x12')]({'data':_0x16df03[a2_0x353e('0x21')]});}else{_0x206980[a2_0x353e('0x12')]({'data':[]});}});};exports['getPassCounting']=(_0x2b0437,_0x3fc885)=>{exports[a2_0x353e('0x5')]['models'][a2_0x353e('0x30')][a2_0x353e('0x32')]({'where':{'amount':{[exports[a2_0x353e('0x5')]['Op']['gt']]:0x0}},'order':[[a2_0x353e('0x33'),'ASC']]})[a2_0x353e('0x1f')](_0x3f157c=>{_0x3fc885[a2_0x353e('0x12')]({'data':_0x3f157c});});};exports[a2_0x353e('0x34')]=(_0x5ae0cc,_0x4e5349)=>{const _0x539b7a=_0x5ae0cc['query'][a2_0x353e('0x35')];const _0x436a80=_0x5ae0cc[a2_0x353e('0x36')][a2_0x353e('0x37')];const _0x4bb37b=_0x5ae0cc[a2_0x353e('0x36')][a2_0x353e('0x38')];exports[a2_0x353e('0x5')][a2_0x353e('0x13')]['pass_counting']['findAll']({'attributes':[a2_0x353e('0x33'),[exports[a2_0x353e('0x5')]['fn'](a2_0x353e('0x39'),exports[a2_0x353e('0x5')][a2_0x353e('0x3a')](a2_0x353e('0x3b'))),a2_0x353e('0x3c')]],'where':{'countingDate':{[exports['sequelize']['Op'][a2_0x353e('0x3d')]]:_0x436a80,[exports[a2_0x353e('0x5')]['Op']['lt']]:_0x4bb37b},'amount':_0x5ae0cc[a2_0x353e('0x3e')][a2_0x353e('0x3f')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a2_0x353e('0x5')]['Op']['lt']]:0x0}},'group':[exports[a2_0x353e('0x5')][a2_0x353e('0x40')](a2_0x353e('0x41'))],'order':[['countingDate',a2_0x353e('0x42')]]})['then'](_0x46ff57=>{_0x4e5349[a2_0x353e('0x12')]({'data':_0x46ff57});});};exports[a2_0x353e('0x43')]=(_0x45e5bf,_0x9a24e3)=>{const _0x216469=_0x45e5bf[a2_0x353e('0x36')][a2_0x353e('0x35')];const _0x5ce6cb=_0x45e5bf[a2_0x353e('0x36')][a2_0x353e('0x37')];const _0x3e6dc1=_0x45e5bf[a2_0x353e('0x36')][a2_0x353e('0x38')];exports[a2_0x353e('0x5')][a2_0x353e('0x13')]['pass_counting'][a2_0x353e('0x32')]({'attributes':[a2_0x353e('0x33'),[exports[a2_0x353e('0x5')]['fn'](a2_0x353e('0x44'),exports['sequelize']['col']('countingDate'),'%Y-%m-%d\x20%H:00'),a2_0x353e('0x45')],[exports['sequelize']['fn'](a2_0x353e('0x39'),exports[a2_0x353e('0x5')][a2_0x353e('0x3a')](a2_0x353e('0x3b'))),'total']],'where':{'countingDate':{[exports[a2_0x353e('0x5')]['Op'][a2_0x353e('0x3d')]]:_0x5ce6cb,[exports[a2_0x353e('0x5')]['Op']['lt']]:_0x3e6dc1},'amount':_0x45e5bf['params'][a2_0x353e('0x3f')]=='in'?{[exports[a2_0x353e('0x5')]['Op']['gt']]:0x0}:{[exports[a2_0x353e('0x5')]['Op']['lt']]:0x0}},'group':[exports[a2_0x353e('0x5')]['fn']('HOUR',exports[a2_0x353e('0x5')][a2_0x353e('0x3a')]('countingDate')),exports[a2_0x353e('0x5')]['fn'](a2_0x353e('0x46'),exports[a2_0x353e('0x5')]['col']('countingDate')),exports[a2_0x353e('0x5')]['fn'](a2_0x353e('0x47'),exports[a2_0x353e('0x5')]['col'](a2_0x353e('0x33'))),exports[a2_0x353e('0x5')]['fn']('YEAR',exports[a2_0x353e('0x5')][a2_0x353e('0x3a')](a2_0x353e('0x33')))],'order':[['countingDate','ASC']]})[a2_0x353e('0x1f')](_0x30b5d3=>{_0x9a24e3[a2_0x353e('0x12')]({'data':_0x30b5d3});});};exports[a2_0x353e('0x48')]=(_0x58f964,_0x1a9e79,_0x417d2a)=>{const _0x3ab8c0=_0x58f964['user'][a2_0x353e('0x49')]['find'](_0x3ab8c0=>_0x3ab8c0[a2_0x353e('0x4a')]===a2_0x353e('0x4b'));fbgraph_1[a2_0x353e('0x2c')]['setAccessToken'](_0x3ab8c0[a2_0x353e('0x4c')]);fbgraph_1[a2_0x353e('0x2c')]['get'](_0x58f964[a2_0x353e('0x4d')][a2_0x353e('0x4b')]+a2_0x353e('0x4e'),(_0x1639df,_0x29ca84)=>{if(_0x1639df){return _0x417d2a(_0x1639df);}_0x1a9e79[a2_0x353e('0x7')](a2_0x353e('0x4f'),{'title':'Facebook\x20API','profile':_0x29ca84});});};
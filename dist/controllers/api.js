var a2_0x372a=['direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','endDate','DATE_FORMAT','col','amount','params','HOUR','DAY','MONTH','YEAR','getFacebook','user','find','kind','setAccessToken','facebook','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook','__esModule','fbgraph','ftp','sequelize','setSequelize','getApi','api/index','API\x20Examples','syncFtp','log','connecting','default','connected','list','colombia','Downloading:\x20','name','endsWith','report_files','push','json','error','ipd','downloadFtp','models','then','ready','colombia/','fileName','end','.txt','createWriteStream','status','Downloaded:\x20','processFtp','media/','readFile','utf8','parse','Data','CountingInfo','Out','EndTime','pass_counting','create','save','findAll','ASC','getPassCountingByDay','query','month','startDate','countingDate','sum','total'];(function(_0x903cb0,_0x51ae10){var _0x58ff7e=function(_0x4852b7){while(--_0x4852b7){_0x903cb0['push'](_0x903cb0['shift']());}};_0x58ff7e(++_0x51ae10);}(a2_0x372a,0x145));var a2_0x363a=function(_0x22b555,_0x6223c9){_0x22b555=_0x22b555-0x0;var _0x29765f=a2_0x372a[_0x22b555];return _0x29765f;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0xf8c15d){return _0xf8c15d&&_0xf8c15d[a2_0x363a('0x0')]?_0xf8c15d:{'default':_0xf8c15d};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x363a('0x1')));const ftp_1=__importDefault(require(a2_0x363a('0x2')));const fs_1=__importDefault(require('fs'));exports[a2_0x363a('0x3')]='';function setSequelize(_0x1b5105){exports[a2_0x363a('0x3')]=_0x1b5105;}exports[a2_0x363a('0x4')]=setSequelize;exports[a2_0x363a('0x5')]=(_0x107b3f,_0x55c50e)=>{_0x55c50e['render'](a2_0x363a('0x6'),{'title':a2_0x363a('0x7')});};exports[a2_0x363a('0x8')]=(_0x408257,_0x27e8d7)=>{console[a2_0x363a('0x9')](a2_0x363a('0xa'));const _0xf1c243=[];const _0x1b5a56=new ftp_1[(a2_0x363a('0xb'))]();_0x1b5a56['on']('ready',function(){console[a2_0x363a('0x9')](a2_0x363a('0xc'));_0x1b5a56[a2_0x363a('0xd')](a2_0x363a('0xe'),![],function(_0x515bfa,_0x4c206c){if(_0x515bfa){}else{for(const _0x592975 of _0x4c206c){console[a2_0x363a('0x9')](a2_0x363a('0xf')+_0x592975[a2_0x363a('0x10')]);if(_0x592975[a2_0x363a('0x10')][a2_0x363a('0x11')]('json')){exports[a2_0x363a('0x3')]['models'][a2_0x363a('0x12')]['findOrCreate']({'where':{'fileName':_0x592975[a2_0x363a('0x10')]}})['spread']((_0x3162f9,_0x9ed463)=>{if(_0x9ed463){console['log'](_0x592975[a2_0x363a('0x10')]);_0xf1c243[a2_0x363a('0x13')](_0x3162f9);}});}}}_0x27e8d7[a2_0x363a('0x14')]({'data':_0xf1c243});});});_0x1b5a56['on'](a2_0x363a('0x15'),function(_0x5c8483){_0x27e8d7[a2_0x363a('0x14')]({'message':_0x5c8483});});_0x1b5a56['connect']({'host':'ftp.vivotek.com','port':0x15,'user':a2_0x363a('0x16'),'password':a2_0x363a('0x16')});};exports[a2_0x363a('0x17')]=(_0xa63d1a,_0x292f4b)=>{exports[a2_0x363a('0x3')][a2_0x363a('0x18')][a2_0x363a('0x12')]['findOne']({'where':{'status':null}})[a2_0x363a('0x19')](_0x453100=>{if(_0x453100){const _0x18bee3=new ftp_1[(a2_0x363a('0xb'))]();_0x18bee3['on'](a2_0x363a('0x1a'),function(){console[a2_0x363a('0x9')]('connected:'+_0x453100['fileName']);_0x18bee3['get'](a2_0x363a('0x1b')+_0x453100[a2_0x363a('0x1c')],function(_0x484cbe,_0x4cabce){_0x18bee3[a2_0x363a('0x1d')]();if(_0x484cbe){}else{const _0x4dfa76='media/'+_0x453100[a2_0x363a('0x1c')]+a2_0x363a('0x1e');_0x4cabce['pipe'](fs_1['default'][a2_0x363a('0x1f')](_0x4dfa76));_0x453100[a2_0x363a('0x20')]=0x1;_0x453100['save']();console[a2_0x363a('0x9')](a2_0x363a('0x21')+_0x453100[a2_0x363a('0x1c')]);}});});_0x18bee3['on'](a2_0x363a('0x15'),function(_0x17c157){_0x292f4b[a2_0x363a('0x14')]({'message':_0x17c157});});_0x18bee3['connect']({'host':'ftp.vivotek.com','port':0x15,'user':'ipd','password':a2_0x363a('0x16')});_0x292f4b[a2_0x363a('0x14')]({'data':_0x453100[a2_0x363a('0x1c')]});}else{_0x292f4b[a2_0x363a('0x14')]({'data':[]});}});};exports[a2_0x363a('0x22')]=(_0x410237,_0x5217d4)=>{exports[a2_0x363a('0x3')][a2_0x363a('0x18')][a2_0x363a('0x12')]['findOne']({'where':{'status':0x1}})[a2_0x363a('0x19')](_0x55ad0f=>{if(_0x55ad0f){const _0x4a9abf=a2_0x363a('0x23')+_0x55ad0f[a2_0x363a('0x1c')]+a2_0x363a('0x1e');fs_1['default'][a2_0x363a('0x24')](_0x4a9abf,a2_0x363a('0x25'),function(_0x55790d,_0x225776){if(_0x55790d){_0x55ad0f[a2_0x363a('0x20')]=null;}else{try{const _0xd77aba=JSON[a2_0x363a('0x26')](_0x225776);for(const _0xa80156 of _0xd77aba[a2_0x363a('0x27')][0x0][a2_0x363a('0x28')]){const _0x39a1e2=_0xa80156['In'];const _0x43b951=_0xa80156[a2_0x363a('0x29')];const _0x4b52f2=Date[a2_0x363a('0x26')](_0xa80156[a2_0x363a('0x2a')]);if(_0x39a1e2>0x0){exports[a2_0x363a('0x3')]['models'][a2_0x363a('0x2b')][a2_0x363a('0x2c')]({'reportFileId':_0x55ad0f['id'],'amount':_0x39a1e2,'countingDate':_0x4b52f2});}if(_0x43b951>0x0){exports[a2_0x363a('0x3')]['models']['pass_counting'][a2_0x363a('0x2c')]({'reportFileId':_0x55ad0f['id'],'amount':_0x43b951*-0x1,'countingDate':_0x4b52f2});}}_0x55ad0f[a2_0x363a('0x20')]=0x2;}catch(_0x9c3039){_0x55ad0f[a2_0x363a('0x20')]=null;}}_0x55ad0f[a2_0x363a('0x2d')]();});_0x5217d4[a2_0x363a('0x14')]({'data':_0x55ad0f[a2_0x363a('0x1c')]});}else{_0x5217d4[a2_0x363a('0x14')]({'data':[]});}});};exports['getPassCounting']=(_0x461e93,_0x1981bc)=>{exports['sequelize'][a2_0x363a('0x18')]['pass_counting'][a2_0x363a('0x2e')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[['countingDate',a2_0x363a('0x2f')]]})['then'](_0x40dcb4=>{_0x1981bc['json']({'data':_0x40dcb4});});};exports[a2_0x363a('0x30')]=(_0x409260,_0x2750ae)=>{const _0x529cbb=_0x409260[a2_0x363a('0x31')][a2_0x363a('0x32')];const _0x48525a=_0x409260[a2_0x363a('0x31')][a2_0x363a('0x33')];const _0x40fa7a=_0x409260[a2_0x363a('0x31')]['endDate'];exports[a2_0x363a('0x3')][a2_0x363a('0x18')][a2_0x363a('0x2b')][a2_0x363a('0x2e')]({'attributes':[a2_0x363a('0x34'),[exports['sequelize']['fn'](a2_0x363a('0x35'),exports[a2_0x363a('0x3')]['col']('amount')),a2_0x363a('0x36')]],'where':{'countingDate':{[exports['sequelize']['Op']['gte']]:_0x48525a,[exports[a2_0x363a('0x3')]['Op']['lt']]:_0x40fa7a},'amount':_0x409260['params'][a2_0x363a('0x37')]=='in'?{[exports[a2_0x363a('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0x363a('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x363a('0x3')]['literal'](a2_0x363a('0x38'))],'order':[[a2_0x363a('0x34'),a2_0x363a('0x2f')]]})[a2_0x363a('0x19')](_0xc4fda4=>{_0x2750ae[a2_0x363a('0x14')]({'data':_0xc4fda4});});};exports[a2_0x363a('0x39')]=(_0x224a32,_0x31283b)=>{const _0x1227d3=_0x224a32[a2_0x363a('0x31')][a2_0x363a('0x32')];const _0x50d63f=_0x224a32[a2_0x363a('0x31')][a2_0x363a('0x33')];const _0x2ed1a7=_0x224a32[a2_0x363a('0x31')][a2_0x363a('0x3a')];exports[a2_0x363a('0x3')]['models'][a2_0x363a('0x2b')][a2_0x363a('0x2e')]({'attributes':['countingDate',[exports[a2_0x363a('0x3')]['fn'](a2_0x363a('0x3b'),exports[a2_0x363a('0x3')][a2_0x363a('0x3c')](a2_0x363a('0x34')),'%Y-%m-%d\x20%H:00'),'countingDateShort'],[exports[a2_0x363a('0x3')]['fn'](a2_0x363a('0x35'),exports['sequelize']['col'](a2_0x363a('0x3d'))),a2_0x363a('0x36')]],'where':{'countingDate':{[exports[a2_0x363a('0x3')]['Op']['gte']]:_0x50d63f,[exports[a2_0x363a('0x3')]['Op']['lt']]:_0x2ed1a7},'amount':_0x224a32[a2_0x363a('0x3e')][a2_0x363a('0x37')]=='in'?{[exports[a2_0x363a('0x3')]['Op']['gt']]:0x0}:{[exports[a2_0x363a('0x3')]['Op']['lt']]:0x0}},'group':[exports[a2_0x363a('0x3')]['fn'](a2_0x363a('0x3f'),exports[a2_0x363a('0x3')][a2_0x363a('0x3c')](a2_0x363a('0x34'))),exports[a2_0x363a('0x3')]['fn'](a2_0x363a('0x40'),exports[a2_0x363a('0x3')][a2_0x363a('0x3c')](a2_0x363a('0x34'))),exports['sequelize']['fn'](a2_0x363a('0x41'),exports[a2_0x363a('0x3')][a2_0x363a('0x3c')](a2_0x363a('0x34'))),exports['sequelize']['fn'](a2_0x363a('0x42'),exports[a2_0x363a('0x3')][a2_0x363a('0x3c')](a2_0x363a('0x34')))],'order':[['countingDate',a2_0x363a('0x2f')]]})[a2_0x363a('0x19')](_0x145a77=>{_0x31283b[a2_0x363a('0x14')]({'data':_0x145a77});});};exports[a2_0x363a('0x43')]=(_0x4970fb,_0x5d312d,_0x15b469)=>{const _0x38ff64=_0x4970fb[a2_0x363a('0x44')]['tokens'][a2_0x363a('0x45')](_0x38ff64=>_0x38ff64[a2_0x363a('0x46')]==='facebook');fbgraph_1['default'][a2_0x363a('0x47')](_0x38ff64['accessToken']);fbgraph_1[a2_0x363a('0xb')]['get'](_0x4970fb[a2_0x363a('0x44')][a2_0x363a('0x48')]+a2_0x363a('0x49'),(_0x25e091,_0x212594)=>{if(_0x25e091){return _0x15b469(_0x25e091);}_0x5d312d[a2_0x363a('0x4a')](a2_0x363a('0x4b'),{'title':'Facebook\x20API','profile':_0x212594});});};
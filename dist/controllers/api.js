var a2_0x5960=['render','api/index','API\x20Examples','syncFtp','log','connecting','default','ready','connected','list','name','endsWith','json','models','report_files','spread','push','error','connect','ipd','downloadFtp','findOne','then','connected:','get','colombia/','end','media/','pipe','createWriteStream','status','save','Downloaded:\x20','fileName','ftp.vivotek.com','processFtp','.txt','utf8','parse','Data','CountingInfo','Out','EndTime','pass_counting','create','getPassCounting','countingDate','ASC','getPassCountingByDay','query','startDate','endDate','findAll','col','amount','total','gte','params','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','countingDateShort','direction','HOUR','DAY','YEAR','getFacebook','user','tokens','setAccessToken','accessToken','api/facebook','Facebook\x20API','__importDefault','__esModule','fbgraph','ftp','sequelize','setSequelize','getApi'];(function(_0x1f0a2f,_0x29cfa3){var _0x492cd2=function(_0x3e17e4){while(--_0x3e17e4){_0x1f0a2f['push'](_0x1f0a2f['shift']());}};_0x492cd2(++_0x29cfa3);}(a2_0x5960,0x1d9));var a2_0x2b92=function(_0xc99892,_0x3e0fd6){_0xc99892=_0xc99892-0x0;var _0x1aa2a9=a2_0x5960[_0xc99892];return _0x1aa2a9;};'use strict';var __importDefault=this&&this[a2_0x2b92('0x0')]||function(_0x3fd470){return _0x3fd470&&_0x3fd470[a2_0x2b92('0x1')]?_0x3fd470:{'default':_0x3fd470};};Object['defineProperty'](exports,a2_0x2b92('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a2_0x2b92('0x2')));const ftp_1=__importDefault(require(a2_0x2b92('0x3')));const fs_1=__importDefault(require('fs'));exports[a2_0x2b92('0x4')]='';function setSequelize(_0x292574){exports[a2_0x2b92('0x4')]=_0x292574;}exports[a2_0x2b92('0x5')]=setSequelize;exports[a2_0x2b92('0x6')]=(_0x9472e5,_0x684fb2)=>{_0x684fb2[a2_0x2b92('0x7')](a2_0x2b92('0x8'),{'title':a2_0x2b92('0x9')});};exports[a2_0x2b92('0xa')]=(_0x2551e5,_0x408500)=>{console[a2_0x2b92('0xb')](a2_0x2b92('0xc'));const _0x46216d=[];const _0x345612=new ftp_1[(a2_0x2b92('0xd'))]();_0x345612['on'](a2_0x2b92('0xe'),function(){console[a2_0x2b92('0xb')](a2_0x2b92('0xf'));_0x345612[a2_0x2b92('0x10')]('colombia',![],function(_0x446ab7,_0x2a2f07){if(_0x446ab7){}else{for(const _0x53f5c0 of _0x2a2f07){console[a2_0x2b92('0xb')]('Downloading:\x20'+_0x53f5c0[a2_0x2b92('0x11')]);if(_0x53f5c0[a2_0x2b92('0x11')][a2_0x2b92('0x12')](a2_0x2b92('0x13'))){exports['sequelize'][a2_0x2b92('0x14')][a2_0x2b92('0x15')]['findOrCreate']({'where':{'fileName':_0x53f5c0['name']}})[a2_0x2b92('0x16')]((_0x45e94e,_0x20fef6)=>{if(_0x20fef6){console[a2_0x2b92('0xb')](_0x53f5c0[a2_0x2b92('0x11')]);_0x46216d[a2_0x2b92('0x17')](_0x45e94e);}});}}}_0x408500['json']({'data':_0x46216d});});});_0x345612['on'](a2_0x2b92('0x18'),function(_0x5e0044){_0x408500['json']({'message':_0x5e0044});});_0x345612[a2_0x2b92('0x19')]({'host':'ftp.vivotek.com','port':0x15,'user':'ipd','password':a2_0x2b92('0x1a')});};exports[a2_0x2b92('0x1b')]=(_0xa2269,_0x195d8e)=>{exports[a2_0x2b92('0x4')][a2_0x2b92('0x14')]['report_files'][a2_0x2b92('0x1c')]({'where':{'status':null}})[a2_0x2b92('0x1d')](_0x3f5b35=>{if(_0x3f5b35){const _0x37e646=new ftp_1[(a2_0x2b92('0xd'))]();_0x37e646['on'](a2_0x2b92('0xe'),function(){console[a2_0x2b92('0xb')](a2_0x2b92('0x1e')+_0x3f5b35['fileName']);_0x37e646[a2_0x2b92('0x1f')](a2_0x2b92('0x20')+_0x3f5b35['fileName'],function(_0x518b2f,_0x5d8d62){_0x37e646[a2_0x2b92('0x21')]();if(_0x518b2f){}else{const _0x8b207=a2_0x2b92('0x22')+_0x3f5b35['fileName']+'.txt';_0x5d8d62[a2_0x2b92('0x23')](fs_1[a2_0x2b92('0xd')][a2_0x2b92('0x24')](_0x8b207));_0x3f5b35[a2_0x2b92('0x25')]=0x1;_0x3f5b35[a2_0x2b92('0x26')]();console['log'](a2_0x2b92('0x27')+_0x3f5b35[a2_0x2b92('0x28')]);}});});_0x37e646['on']('error',function(_0xcbaec9){_0x195d8e['json']({'message':_0xcbaec9});});_0x37e646['connect']({'host':a2_0x2b92('0x29'),'port':0x15,'user':a2_0x2b92('0x1a'),'password':a2_0x2b92('0x1a')});_0x195d8e[a2_0x2b92('0x13')]({'data':_0x3f5b35[a2_0x2b92('0x28')]});}else{_0x195d8e[a2_0x2b92('0x13')]({'data':[]});}});};exports[a2_0x2b92('0x2a')]=(_0x11021c,_0x4b4675)=>{exports[a2_0x2b92('0x4')][a2_0x2b92('0x14')]['report_files'][a2_0x2b92('0x1c')]({'where':{'status':0x1}})[a2_0x2b92('0x1d')](_0x43399d=>{if(_0x43399d){const _0x44db9a=a2_0x2b92('0x22')+_0x43399d[a2_0x2b92('0x28')]+a2_0x2b92('0x2b');fs_1[a2_0x2b92('0xd')]['readFile'](_0x44db9a,a2_0x2b92('0x2c'),function(_0x5d97d0,_0xaead48){if(_0x5d97d0){_0x43399d['status']=null;}else{try{const _0x3f82ce=JSON[a2_0x2b92('0x2d')](_0xaead48);for(const _0x3be4f7 of _0x3f82ce[a2_0x2b92('0x2e')][0x0][a2_0x2b92('0x2f')]){const _0x263892=_0x3be4f7['In'];const _0x2461e2=_0x3be4f7[a2_0x2b92('0x30')];const _0x3188a1=Date[a2_0x2b92('0x2d')](_0x3be4f7[a2_0x2b92('0x31')]);if(_0x263892>0x0){exports[a2_0x2b92('0x4')][a2_0x2b92('0x14')][a2_0x2b92('0x32')][a2_0x2b92('0x33')]({'reportFileId':_0x43399d['id'],'amount':_0x263892,'countingDate':_0x3188a1});}if(_0x2461e2>0x0){exports[a2_0x2b92('0x4')][a2_0x2b92('0x14')][a2_0x2b92('0x32')]['create']({'reportFileId':_0x43399d['id'],'amount':_0x2461e2*-0x1,'countingDate':_0x3188a1});}}_0x43399d[a2_0x2b92('0x25')]=0x2;}catch(_0x4c9182){_0x43399d[a2_0x2b92('0x25')]=null;}}_0x43399d[a2_0x2b92('0x26')]();});_0x4b4675['json']({'data':_0x43399d[a2_0x2b92('0x28')]});}else{_0x4b4675[a2_0x2b92('0x13')]({'data':[]});}});};exports[a2_0x2b92('0x34')]=(_0x6d503d,_0xa14c93)=>{exports[a2_0x2b92('0x4')][a2_0x2b92('0x14')]['pass_counting']['findAll']({'where':{'amount':{[exports[a2_0x2b92('0x4')]['Op']['gt']]:0x0}},'order':[[a2_0x2b92('0x35'),a2_0x2b92('0x36')]]})[a2_0x2b92('0x1d')](_0x4a64a4=>{_0xa14c93[a2_0x2b92('0x13')]({'data':_0x4a64a4});});};exports[a2_0x2b92('0x37')]=(_0x25ad4c,_0x2dc80b)=>{const _0x4fbc25=_0x25ad4c[a2_0x2b92('0x38')]['month'];const _0x130e73=_0x25ad4c['query'][a2_0x2b92('0x39')];const _0x361a09=_0x25ad4c[a2_0x2b92('0x38')][a2_0x2b92('0x3a')];exports[a2_0x2b92('0x4')][a2_0x2b92('0x14')][a2_0x2b92('0x32')][a2_0x2b92('0x3b')]({'attributes':[a2_0x2b92('0x35'),[exports[a2_0x2b92('0x4')]['fn']('sum',exports[a2_0x2b92('0x4')][a2_0x2b92('0x3c')](a2_0x2b92('0x3d'))),a2_0x2b92('0x3e')]],'where':{'countingDate':{[exports[a2_0x2b92('0x4')]['Op'][a2_0x2b92('0x3f')]]:_0x130e73,[exports['sequelize']['Op']['lt']]:_0x361a09},'amount':_0x25ad4c[a2_0x2b92('0x40')]['direction']=='in'?{[exports[a2_0x2b92('0x4')]['Op']['gt']]:0x0}:{[exports[a2_0x2b92('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x2b92('0x4')][a2_0x2b92('0x41')](a2_0x2b92('0x42'))],'order':[['countingDate','ASC']]})['then'](_0x4e6db6=>{_0x2dc80b['json']({'data':_0x4e6db6});});};exports[a2_0x2b92('0x43')]=(_0x28c224,_0x3e5f90)=>{const _0x1b40b1=_0x28c224[a2_0x2b92('0x38')]['month'];const _0x2147a9=_0x28c224['query'][a2_0x2b92('0x39')];const _0x4fc779=_0x28c224[a2_0x2b92('0x38')][a2_0x2b92('0x3a')];exports['sequelize'][a2_0x2b92('0x14')][a2_0x2b92('0x32')][a2_0x2b92('0x3b')]({'attributes':[a2_0x2b92('0x35'),[exports[a2_0x2b92('0x4')]['fn']('DATE_FORMAT',exports['sequelize'][a2_0x2b92('0x3c')](a2_0x2b92('0x35')),'%Y-%m-%d\x20%H:00'),a2_0x2b92('0x44')],[exports[a2_0x2b92('0x4')]['fn']('sum',exports[a2_0x2b92('0x4')][a2_0x2b92('0x3c')](a2_0x2b92('0x3d'))),a2_0x2b92('0x3e')]],'where':{'countingDate':{[exports[a2_0x2b92('0x4')]['Op']['gte']]:_0x2147a9,[exports[a2_0x2b92('0x4')]['Op']['lt']]:_0x4fc779},'amount':_0x28c224['params'][a2_0x2b92('0x45')]=='in'?{[exports[a2_0x2b92('0x4')]['Op']['gt']]:0x0}:{[exports[a2_0x2b92('0x4')]['Op']['lt']]:0x0}},'group':[exports[a2_0x2b92('0x4')]['fn'](a2_0x2b92('0x46'),exports[a2_0x2b92('0x4')][a2_0x2b92('0x3c')](a2_0x2b92('0x35'))),exports[a2_0x2b92('0x4')]['fn'](a2_0x2b92('0x47'),exports[a2_0x2b92('0x4')]['col']('countingDate')),exports[a2_0x2b92('0x4')]['fn']('MONTH',exports[a2_0x2b92('0x4')][a2_0x2b92('0x3c')]('countingDate')),exports[a2_0x2b92('0x4')]['fn'](a2_0x2b92('0x48'),exports[a2_0x2b92('0x4')][a2_0x2b92('0x3c')](a2_0x2b92('0x35')))],'order':[[a2_0x2b92('0x35'),a2_0x2b92('0x36')]]})[a2_0x2b92('0x1d')](_0x59a177=>{_0x3e5f90[a2_0x2b92('0x13')]({'data':_0x59a177});});};exports[a2_0x2b92('0x49')]=(_0x556264,_0x354192,_0x5a372d)=>{const _0x152f3b=_0x556264[a2_0x2b92('0x4a')][a2_0x2b92('0x4b')]['find'](_0x152f3b=>_0x152f3b['kind']==='facebook');fbgraph_1['default'][a2_0x2b92('0x4c')](_0x152f3b[a2_0x2b92('0x4d')]);fbgraph_1['default'][a2_0x2b92('0x1f')](_0x556264[a2_0x2b92('0x4a')]['facebook']+'?fields=id,name,email,first_name,last_name,gender,link,locale,timezone',(_0x53d604,_0x579e27)=>{if(_0x53d604){return _0x5a372d(_0x53d604);}_0x354192['render'](a2_0x2b92('0x4e'),{'title':a2_0x2b92('0x4f'),'profile':_0x579e27});});};
{"version":3,"file":"util.js","sourceRoot":"","sources":["../lib/util.ts"],"names":[],"mappings":";;AAAA,mCAAoC;AAYpC,SAAgB,cAAc,CAAC,MAAc;IAC3C,MAAM,aAAa,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC;IAC9C,MAAM,MAAM,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;IACjC,MAAM,oBAAoB,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC;IAEhD,MAAM,OAAO,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,oBAAoB,GAAG,CAAC,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IACrF,MAAM,EAAE,MAAM,EAAE,GAAG,OAAO,CAAC;IAE3B,OAAO;QACL,EAAE,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC,CAAC;QAC1B,SAAS,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC,CAAC;QACjC,MAAM;QACN,OAAO;QACP,MAAM;KACP,CAAC;AACJ,CAAC;AAfD,wCAeC;AASD,SAAgB,eAAe,CAAC,MAAc;IAC5C,MAAM,UAAU,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;IAC7B,MAAM,SAAS,GAAG,MAAM,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;IAE1C,OAAO;QACL,SAAS;QACT,UAAU;QACV,MAAM;KACP,CAAC;AACJ,CAAC;AATD,0CASC;AAED,4CAA4C;AAC5C,SAAgB,UAAU,CAAC,GAAW;IACpC,MAAM,GAAG,GAAG,mBAAU,CAAC,KAAK,CAAC,CAAC;IAC9B,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;IAEhB,OAAO,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;AAC3B,CAAC;AALD,gCAKC;AAOD,SAAgB,cAAc,CAAC,SAAiB;IAC9C,MAAM,UAAU,GAA8B,EAAE,CAAC;IAEjD,MAAM,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACnC,MAAM,QAAQ,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;IAE1B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QACrC,MAAM,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;QACtB,MAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QAEhC,IAAI,KAAK,GAAG,CAAC,CAAC,IAAI,KAAK,KAAK,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;YAC3C,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;SAClE;KACF;IAED,OAAO;QACL,QAAQ;QACR,UAAU;KACX,CAAC;AACJ,CAAC;AAnBD,wCAmBC;AAED,SAAgB,aAAa,CAAC,GAAW,EAAE,GAAW;IACpD,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IACrB,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACtB,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC;AAC3D,CAAC;AAJD,sCAIC;AAED,SAAgB,YAAY;IAC1B,OAAO,aAAa,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC;AACtC,CAAC;AAFD,oCAEC","sourcesContent":["import { createHash } from \"crypto\";\nimport { spawn } from \"child_process\";\n\nexport interface RTPPacket {\n  id: number;\n  timestamp: number;\n  marker: number;\n\n  payload: Buffer;\n  length: number;\n}\n\nexport function parseRTPPacket(buffer: Buffer): RTPPacket {\n  const hasExtensions = (buffer[0] >> 4) & 0x01;\n  const marker = (buffer[1]) >>> 7;\n  const num_csrc_identifiers = (buffer[0] & 0x0F);\n\n  const payload = buffer.slice((num_csrc_identifiers * 4) + (hasExtensions ? 16 : 12));\n  const { length } = payload;\n\n  return {\n    id: buffer.readUInt16BE(2),\n    timestamp: buffer.readUInt32BE(4),\n    marker,\n    payload,\n    length\n  };\n}\n\nexport interface RTCPPacket {\n  timestamp: number;\n  packetType: number;\n\n  buffer: Buffer;\n}\n\nexport function parseRTCPPacket(buffer: Buffer): RTCPPacket {\n  const packetType = buffer[1];\n  const timestamp = buffer.readUInt32BE(16);\n\n  return {\n    timestamp,\n    packetType,\n    buffer\n  };\n}\n\n// utility function for using crypto library\nexport function getMD5Hash(str: string): string {\n  const md5 = createHash(\"md5\");\n  md5.update(str);\n\n  return md5.digest(\"hex\");\n}\n\ninterface Transport {\n  protocol: string;\n  parameters: { [key: string]: string };\n}\n\nexport function parseTransport(transport: string): Transport {\n  const parameters: { [key: string]: string } = {};\n\n  const parts = transport.split(\";\");\n  const protocol = parts[0];\n\n  for (let i = 0; i < parts.length; i++) {\n    const part = parts[i];\n    const index = part.indexOf(\"=\");\n\n    if (index > -1 && index !== part.length - 1) {\n      parameters[part.substring(0, index)] = part.substring(index + 1);\n    }\n  }\n  \n  return {\n    protocol,\n    parameters\n  };\n}\n\nexport function randInclusive(min: number, max: number): number {\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\nexport function generateSSRC(): number {\n  return randInclusive(1, 0xffffffff);\n}"]}